!function(e){var t,n=e.sPlusPlus,i=e.ZSEvents,a=i.topic,o=i.Groups,l=i.Names,r=e.ZSClass,s=e.ZSConstants.FeatureConstants,c=e.document,f=e.ZSConstants.wCC,u=e.UIUtil.Component,m=[],v=[["fnal","Arial","Arial"],["fnab","Arial Black","Arial Black"],["fnba","Book Antiqua","Book Antiqua"],["fnci","Calibri","Calibri"],["fncs","Comic Sans MS","Comic Sans MS"],["fncn","Courier New","Courier New"],["fngd","Garamond","Garamond"],["fnga","Georgia","Georgia"],["fnlc","Lucida Console","Lucida Console"],["fnta","Tahoma","Tahoma"],["fntn","Times New Roman","Times New Roman"],["fntms","Trebuchet MS","Trebuchet MS"],["fnva","Verdana","Verdana"]],d=c.getElementById(f.MI+s.FONT_FAMILY+f.IDENTITY),C=d?d.parentElement:void 0;function p(e,t,n){return g(e.styleName[3],t,n)}function g(e,n,i){C&&e&&-1!=m.indexOf(e)?t=e:isCanvasGrid?e=r.CellStyleDef.getFontNameUI(n,i):function(e){if(C&&e){d.innerHTML="";for(var t=-1,n=0;n<m.length;n++){if(0==n&&e<m[n]){var i=c.createElement("option");i.value=e,i.style.fontFamily=e,i.title=e,i.text=e,d.appendChild(i),t=n}else if(n>0&&m[n-1]<e&&e<m[n]){var i=c.createElement("option");i.value=e,i.style.fontFamily=e,i.title=e,i.text=e,d.appendChild(i),t=n}var a=m[n],o=c.createElement("option");o.value=a,o.style.fontFamily=a,o.title=a,o.text=a,d.appendChild(o)}if(t>=0)m.splice(t,0,e);else{var i=c.createElement("option");i.value=e,i.style.fontFamily=e,i.title=e,i.text=e,d.appendChild(i),m.splice(m.length,0,e)}u.zcombo(d,"refresh"),g(e)}}(e),u.zcombo(d,"setValue",e)}d&&function(e){e.innerHTML="";for(var t=0;t<v.length;t++){var n=v[t],i=c.createElement("option");i.value=n[1],i.style.fontFamily=n[1],i.title=n[2],i.text=n[2],m.push(n[1]),e.appendChild(i)}u.zcombo(e,"refresh")}(d),a.register(o.Listener,l.SheetAction.ACTIVE_CELL.INFO,p,"VALUE","RID","VERSION"),u.bind(d,"zselectboxitemclick",function(i,a){!function(i){var a=n.view.getActiveGridID(),o=n.view.getResourceID(a),l=n.view.getSheetID(a),r=n.view.getVersionID(a),s=n.view.getSelectedSheets(a),c=n.view.getSheetState(a,l).getRanges()[0];(!c.isSingle()||c.isSingle()&&t!=i.value)&&e.UserAction.FONTFAMILY(o,s,r,i.value)}(a)}),u.bind(d,"zselectboxbeforefocus",function(e,t){return!1})}(this);
!function(e){var t,n=e.sPlusPlus,i=e.ZSEvents,o=i.topic,l=i.Groups,r=i.Names,s=e.ZSConstants.FeatureConstants,a=e.document,c=e.ZSConstants.wCC,u=e.UIUtil.Component,p=[8,9,10,11,12,14,16,18,20,22,24,26,28,32,40,48,56,64,72],v=a.getElementById(c.MI+s.FONT_SIZE+c.IDENTITY),d=v?v.parentElement:void 0;function f(e){return m(e.styleName[2])}function m(e){d&&e&&-1!=p.indexOf(e)?(t=e,u.zcombo(v,"setValue",e)):function(e){if(d&&e){v.innerHTML="";for(var t=-1,n=0;n<p.length;n++){if(0==n&&e<p[n]){var i=document.createElement("option");i.value=e,i.style.fontSize=e,i.title=e+"pt",i.text=e,v.appendChild(i),t=n}else if(n>0&&p[n-1]<e&&e<p[n]){var i=document.createElement("option");i.value=e,i.style.fontSize=e,i.title=e+"pt",i.text=e,v.appendChild(i),t=n}var o=p[n],l=a.createElement("option");l.value=o,l.title=o+"pt",l.text=o,v.appendChild(l)}if(t>=0)p.splice(t,0,e);else{var i=document.createElement("option");i.value=e,i.style.fontSize=e,i.title=e+"pt",i.text=e,v.appendChild(i),p.splice(p.length,0,e)}u.zcombo(v,"refresh"),m(e)}}(e)}v&&function(e){e.innerHTML="";for(var t=0;t<p.length;t++){var n=p[t],i=a.createElement("option");i.value=n,i.title=n+"pt",i.text=n,10==n&&i.setAttribute("selected","true"),e.appendChild(i)}u.zcombo(e,"refresh")}(v),o.register(l.Listener,r.SheetAction.ACTIVE_CELL.INFO,f,"VALUE"),u.bind(v,"zselectboxitemclick",function(i,o){!function(i){var o=n.view.getActiveGridID(),l=n.view.getResourceID(o),r=n.view.getSheetID(o),s=n.view.getVersionID(o),a=n.view.getSelectedSheets(o),c=i.value?i.value+"pt":i.value,u=n.view.getSheetState(o,r).getRanges()[0];(!u.isSingle()||u.isSingle()&&t!=i.value)&&e.UserAction.FONTSIZE(l,a,s,c)}(o)}),u.bind(v,"zselectboxbeforefocus",function(e,t){return!1})}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,a=(n.topic,n.Groups,n.Names,e.ZSConstants.FeatureConstants),r=e.document,i=e.UserAction,o=(e.ZSConstants.wCC,e.UIUtil.Component,t.view.Toolbar.Feature[a.DATA_DUPLICATES]),s=t.view.Toolbar.Feature[a.DATA_CLEANING],l={};function c(e,n){var a=t.view.getActiveGridID(),o=t.view.getResourceID(a),l=t.view.getVersionID(a),c=(t.view.getSheetID(a),t.view.getSelectedSheets(a)),u=(new ZSClass.ParamGenerator(c,o,l,!0),(e=e||s.getRange())?JSUtil.Range.parseRange(o,l,e).range:"");i.ReadTable(o,c,l,u,n),r.querySelector("#removeDuplicates").style.display="none",r.querySelector(".sPDatCln .ZsLoader").style.display="none",r.querySelector("#columnContainer").innerHTML="",r.querySelector("#columnLoader").style.display="block"}function u(e,n){var a=t.view.getActiveGridID(),r=t.view.getResourceID(a),o=t.view.getVersionID(a),l=(t.view.getSheetID(a),t.view.getSelectedSheets(a)),c=new ZSClass.ParamGenerator(l,r,o,!0),u=(n=n||s.getRange())?JSUtil.Range.parseRange(r,o,n).range:"",g=c.getSheets(),d=u?c.getCustomRanges(u):c.getRanges(),v=c.getActiveCell(),S=-2==e?v.c:e;s.tableInstance.setCurrentCol(S),i.ReadFrequencyTable(r,o,g,d,v,S)}l.CLUSTER=1,l.MISSING_VALUE=2,l.DUPLICATE=3,l.FIND_UNIQUE=4,l.FIND_COLUMN_FREQUENCY=5,window.addEventListener("DC_Duplicate_view_On_Open",function(e){c(void 0,e.detail.curentScope==l.DUPLICATE?"duplicate":"unique")}),window.addEventListener("frequency",function(){u(arguments[0].detail.col)}),o.readTable=c,o.LoadFrequency=u}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSEvents,n=s.topic,i=s.Groups,o=s.Names,a=e.ZSConstants.FeatureConstants,c=(e.document,e.ZSConstants.wCC),r=(e.UIUtil.Component,e.ZSConstants.I18N,0),v=t.view.Toolbar.Feature[a.WRAPTEXT];function I(e){r=e.styleName[8]&&"wrap"==e.styleName[8]?1:0;var t=document.getElementById(c.MI+a.WRAPTEXT+c.IDENTITY);t&&(r?t.parentElement.classList.add("shIconActive"):t.parentElement.classList.remove("shIconActive"))}n.register(i.Listener,o.SheetAction.ACTIVE_CELL.INFO,I,"VALUE"),v.execute=function(s){r=1==r?0:1;var n=t.view.getActiveGridID(),i=t.view.getResourceID(n),o=(t.view.getSheetID(n),t.view.getVersionID(n)),a=t.view.getSelectedSheets(n);e.UserAction.WRAP(i,a,o,r)}}(this);
!function(e){var t,n,i,a=e.sPlusPlus,o=e.ZSEvents,r=o.topic,c=o.Groups,s=o.Names,E=e.ZSConstants.FeatureConstants,g=e.document,I=e.ZSConstants.I18N,l=e.ZSConstants.wCC,u=e.UIUtil.Component,d=e.UserAction,S=g.getElementById("popupmenu"),M=a.view.Toolbar.Feature[E.MERGE],m=0,R=1,D=2,C=3,v=4,b=D,A=b,T="UNMERGE_ICON",p="MERGE_CELL_ICON",G="MERGE_CENTER_ICON",w="MERGE_ACROSS_ICON",N="MERGE_DOWN_ICON",O="unmergeIco",U="mergeCellIco",f="mergeCenterIco",H="mergeAcrossIco",L="mergeDownIco",h=(e.UIUtil,b),_=g.getElementById(l.MI+E.MERGE+l.IDENTITY),k=_.parentElement,V=JSUtil.fn.debounce(function(e,t,n,i){!function(e,t,n,i){var o=a.data.getWorkBook(e,n).getSheetObj(t);if(i.isSingle())W(h),u.disable(k);else{if(u.enable(k),o.Merge.isIntersecting(i))return void W(m);i.isRowRange()&&h===C||i.isColRange()&&h===v?W(b):W(h)}}(e,t,n,i)},200);function y(){var e=t.action?t.action:A;!function(e,t){e,h=t}(P(e),e),W(m),r.unregister(c.Listener,s.SheetAction.MERGE_CELLS.ADD,y),r.unregister(c.Listener,s.SheetAction.MERGE_ACROSS.ADD,y)}function B(){W(h),r.unregister(c.Listener,s.SheetAction.MERGE_CELLS.REMOVE,B)}function W(e){!function(e){_.innerHTML="",_.appendChild(e)}(P(e)),function(e){_.title=e}(function(e){var t;switch(e){case m:t=I["MenuItem.HomeTab.Unmerge"];break;case R:t=I["MenuItem.HomeTab.Merge.Cells"];break;case D:t=I["MenuItem.HomeTab.MergeAndCenter"];break;case C:t=I["MenuItem.HomeTab.Merge.Down"];break;case v:t=I["MenuItem.HomeTab.Merge.Across"]}return t}(e)),A=e}function P(e){var t;switch(e){case m:t=T;break;case R:t=p;break;case D:t=G;break;case C:t=N;break;case v:t=w}return d.getTemplate([t])[t]}function Z(e){var n=void 0!=e.action?e.action:A,i=a.view.getActiveGridID(),o=a.view.getResourceID(i),E=(a.view.getSheetID(i),a.view.getVersionID(i)),g=a.view.getSelectedSheets(i);n===m?(d.SplitRange(o,g,E,Y),r.register(c.Listener,s.SheetAction.MERGE_CELLS.REMOVE,B)):(d.MergeRange(o,g,E,n),r.register(c.Listener,s.SheetAction.MERGE_CELLS.ADD,y),r.register(c.Listener,s.SheetAction.MERGE_ACROSS.ADD,y)),t=e}function Y(){var e=a.view.getActiveGridID(),t=a.view.getResourceID(e),n=a.view.getSheetID(e),i=a.view.getSheetState(e,n).getActiveCellRange(),o=a.view.getVersionID(e);r.publish(c.Selector.BoundUpdate.Cell,s.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:n,VERSION:o,ActiveCellRange:i,ROW:i.startRow,COL:i.startCol,TYPE:void 0})}r.register(c.Selector.DomUpdate.Range,s.Selection.BOUND_UPDATE.ADD,V,"RID","SHEETID","VERSION","ActiveRange"),n={id:l.SUBMENUITEM+E.MERGE+l.IDENTITY,"data-type":"list","data-content-type":"icon-text",relativeto:"parent"},i=[{type:"radio",data:'{"SVGIconId":"#'+U+' svgWidHgt","label":"'+I["MenuItem.HomeTab.Merge.Cells"]+'", "action": '+R+"}"},{type:"radio",data:'{"SVGIconId":"#'+H+' svgWidHgt","label":"'+I["MenuItem.HomeTab.Merge.Across"]+'", "action": '+v+"}"},{type:"radio",data:'{"SVGIconId":"#'+L+' svgWidHgt","label":"'+I["MenuItem.HomeTab.Merge.Down"]+'", "action": '+C+"}"},{type:"radio",data:'{"SVGIconId":"#'+f+' svgWidHgt","label":"'+I["MenuItem.HomeTab.MergeAndCenter"]+'", "action": '+D+"}"},{"data-item-type":"separator"},{type:"radio",data:'{"SVGIconId":"#'+O+' svgWidHgt","label":"'+I["MenuItem.HomeTab.Unmerge"]+'", "action": '+m+"}"}],a.view.Menu.create(i,n,S).then(function(){u.bind("#"+l.SUBMENUITEM+E.MERGE+l.IDENTITY,"zmenuitemclick",function(e,t){Z(t.menuitem.data().ZCOpts)})}),M.execute=Z}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,o=e.UserAction,i=t.view.Toolbar.Feature[n.CUT],r=(t.view.Toolbar.Feature[n.COPY],document.createElement("div"));r.setAttribute("contenteditable",!0),r.setAttribute("id","copyEditor"),r.style.width="1000px",r.style.height="0px",r.style.position="absolute",r.style.top="-100010px",r.style.left="-100010px",document.body.appendChild(r),i.execute=function(n){var i=t.view.getActiveGridID(),a=t.view.getResourceID(i),d=t.view.getSelectedSheets(i),s=t.view.getVersionID(i),l=t.view.getSheetID(i),u=t.view.getSheetState(i,l).getRanges();!function(e,t,n,i){o.Cut(t,n,i,void 0,!1,!0)}(0,a,d,s),function(n,o,i,a,d,s){for(var l=t.data.getWorkBook(n,d).getSheetObj(o),u=l.Row,v=l.Column,c={},g=!1,w=0;w<s.length;w++){var C=s[w],p=C.startRow,b=C.startCol,h=C.endRow,m=C.endCol,R=(C.getRowSpan(),l.Row.Visibility.getOnCount(p,h),C.getColSpan(),l.Column.hidden.getOnCount(b,m),e.isCanvasGrid?t.view.getGridComponent(i).isInViewPort(C.startRow,C.startCol,C.endRow,C.endCol):t.view.getGridComponent(i).isInViewPort(C));if(!R){g=!0;break}for(var f=p;f<=h;f=u.Visibility.nextNonHidden(f)){c[f]||(c[f]={});for(var y=b;y<=m;y=v.hidden.nextNonHidden(y)){var S=t.view.getGridComponent(i).getCellRef(n,o,d,f,y);c[f][y]=S.data}}}if(!g){var x=e.UserAction.TableGeneratorUtility(n,o,i,d,c);r.innerHTML="",r.appendChild(x),function(){var e=document.createRange();e.selectNodeContents(r);var t=window.getSelection();t.removeAllRanges(),t.addRange(e)}(),document.execCommand("copy"),r.blur()}}(a,l,i,0,s,u)}}(this);
!function(t){var n=t.sPlusPlus,s=t.ZSEvents,o=(s.topic,s.Groups,s.Names,t.ZSConstants.FeatureConstants),e=(t.document,t.UserAction);t.ZSConstants.wCC,t.UIUtil.Component;n.view.Toolbar.Feature[o.RECAST].recastAction=function(t,n,s,o,i){e.invokeRecastAction(t,n,s,o,i)}}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,o=(t.document,t.ZSConstants.I18N,t.ZSConstants.wCC),s=t.ZSEvents,a=s.topic,i=s.Groups,u=s.Names,l=t.UIUtil.Component,r=e.view.Toolbar.Feature[n.SEND_AS_ATTACHMENT];e.view.Toolbar.Feature[n.COPY];r.execute=function(t){},r.openMailDialog=function(){r.openDialog()},a.register(i.UI,u.Toolbar.INIT_MENU,function(t){t.id==o.TB+"FILE"+o.POPUP+o.CONTAINER&&-1!=ZSConstants.Meta.DisableFeaturesList.indexOf(n.SEND_AS_ATTACHMENT)&&l.disable(r.menuElem)},"DOM")}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSConstants,o=(e.UserAction,e.ZSClass),n=e.ZSConstants.I18N,a=e.ZSEvents,s=i.FeatureConstants,r=a.topic,S=a.Groups,c=a.Names,u=t.data.UserInfo,D=t.view.Toolbar.Feature[s.COPY],v=new o.TBNotification(n["Statusbar.Copying"],{mode:"STD",type:"info"});D.execute=function(i){if(-1==ZSConstants.Meta.HideFeaturesList.indexOf(s.COPY)){var o=t.view.getActiveGridID(),n=t.view.getResourceID(o),a=t.view.getSheetID(o),r=t.view.getVersionID(o),S=t.view.getSelectedSheets(o),c=t.view.getSheetState(o,a).getRanges();v.show(!0),function(t,i,o,n,a,s,r){t.repeat||(t.preventDefault(),e.UserAction.CopyData(i,o,n,a,s,r))}(i,n,a,o,S,r,c)}},r.register(S.Listener,c.ServerAction.REQ_QSTATUS,function(e){var i=t.view.getActiveGridID(),o=t.view.getResourceID(i),n=t.view.getSheetID(i);r.publish(S.Selector.BoundUpdate.Copy,c.Selection.BOUND_UPDATE.HIDE,{RID:o,SHEETID:n,VERSION:e,VisualCueStatus:0})},"VERSION"),r.register(S.Listener,c.KeyBoard.Escape,function(e,i,n){var a=t.view.getActiveGridID(),s=t.view.getSelectedSheets(a),D=t.view.getActiveState(a),v=u.activeInfo.getCopyState();if(!D.getFormatPainterState())if(v){var I=o.SelectorHelper.Constants;r.publish(S.Selector.BoundUpdate.Copy,c.Selection.BOUND_UPDATE.HIDE,{RID:e,SHEETID:s[0],VERSION:n,VisualCueStatus:I.CUESTATUS.HIDDEN})}else r.publish(S.Selector.BoundUpdate.Copy,c.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:s[0],VERSION:n})},"RID","SHEETID","VERSION"),r.register(S.Selector.BoundUpdate.Copy,c.Selection.BOUND_UPDATE.ADD,function(){var e=v.isShown;v.remove(),t.data.UserInfo.activeInfo.getCopyState()&&e&&new o.TBNotification(n["Statusbar.Copied"],{timeOut:1e3,type:"info"}).show()})}(this);
!function(e){if(!e.isCanvasGrid){var t,o=e.sPlusPlus,i=e.ZSClass.UIPaneComponent.prototype,n=o.data.UserInfo,a=e.ZSEvents,s=a.topic,l=a.Groups,r=a.Names;i.PlaceCopySelection=function(e,i,n,a,s){var l=o.data.getWorkBook(e,n).getSheetObj(i),r=l.Row.auxiliaryAxis.getPos(s.startRow),c=l.Column.auxiliaryAxis.getPos(s.startCol),p=l.Row.auxiliaryAxis.getPos(s.endRow+1),u=l.Column.auxiliaryAxis.getPos(s.endCol+1),C=o.view.getSheetState(this.gridID,i);t=i;var S=C.getZoom();this.CopySelection&&this.CopySelection.place(a,r*S,c*S,(p-r)*S,(u-c)*S)},i.RemoveCopySelection=function(e,t,o,i){this.CopySelection&&this.CopySelection.hide(i)},i.RepaintCopySelection=function(e,o,i){if(o==t)for(var a={ranges:function(){return n.activeInfo.getCopyDetails().Ranges}},c=a.ranges(),p=0;c&&p<c.length;p++){var u=c[p],C={RID:e,SHEETID:o,VERSION:i,ActiveRange:u,RANGEID:u.id};s.publish(l.Selector.DomUpdate.Copy,r.Selection.BOUND_UPDATE.ADD,C)}}}}(this);
!function(e){var t=e.sPlusPlus,o=e.ZSClass,D=e.ZSEvents,a=D.topic,r=D.Groups,n=D.Names,i=new o.IDGenerator,E=t.data.UserInfo,S={add:function(e,o,D,a,r,n,i,E){var s=t.data.getWorkBook(e,D).getSheetObj(o).Pivot;for(var I in a){var c=a[I];if(s.isIntersecting(c)&&!i)return}S.addData(e,r,D,a,n,i,E),S.addDOM(e,o,D,n)},addData:function(e,t,D,a,r,n,E){i.flush();var S=[];for(var I in a){var c=a[I];if(void 0!=c.sr){var d=new o.Range(c.sr,c.sc,c.er,c.ec),l=i.get();d.id=l,S.push(d)}else S.push(c)}s.addDetails(e,t,D,S,r,n,E)},addDOM:function(e,t,o,D){for(var i={RID:e,SHEETID:t,VERSION:o},E=s.ranges(),S=0;S<E.length;S++){var I=E[S];i.ActiveRange=I,i.RANGEID=I.id,a.publish(r.Selector.DomUpdate.Copy,n.Selection.BOUND_UPDATE.ADD,i)}},remove:function(e,t,o){S.removeDOM(e,t,o),S.removeData(e,t,o)},removeData:function(e,t,o){i.flush(),s.clearDetails()},removeDOM:function(e,t,o,D,i){if(D)a.publish(r.Selector.DomUpdate.Copy,n.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:t,VERSION:o,RANGEID:D});else for(var E=s.ranges(),S=0;E&&S<E.length;S++){D=E[S].id,a.publish(r.Selector.DomUpdate.Copy,n.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:t,VERSION:o,RANGEID:D})}},hide:function(e,t,o,D){E.activeInfo.setVisualCueStatus(D),S.removeDOM(e,t,o)},show:function(e,t,o){var D,i=s.ranges();if(-1!=s.sheets().indexOf(t))for(var E=0;i&&E<i.length;E++){var S=i[E];D={RID:e,SHEETID:t,VERSION:o,ActiveRange:S,RANGEID:S.id},a.publish(r.Selector.DomUpdate.Copy,n.Selection.BOUND_UPDATE.ADD,D)}}},s={ranges:function(){return E.activeInfo.getCopyDetails().Ranges},sheets:function(){return E.activeInfo.getCopyDetails().Sheets},addDetails:function(e,t,o,D,a,r){E.activeInfo.addCopyDetails(e,t,o,D,a,r)},clearDetails:function(){E.activeInfo.clearCopyRange()}};a.register(r.Selector.BoundUpdate.Copy,n.Selection.BOUND_UPDATE.ADD,S.add,"RID","SHEETID","VERSION","RANGES","SHEETS","IS_SERVER_CLIP","IS_COPY","Category"),a.register(r.Selector.BoundUpdate.Copy,n.Selection.BOUND_UPDATE.ADDDATA,S.addData,"RID","SHEETS","VERSION","RANGES","IS_SERVER_CLIP"),a.register(r.Selector.BoundUpdate.Copy,n.Selection.BOUND_UPDATE.REMOVE,S.remove,"RID","SHEETID","VERSION"),a.register(r.Selector.BoundUpdate.Copy,n.Selection.BOUND_UPDATE.REMOVEDOM,S.removeDOM,"RID","SHEETID","VERSION","RANGEID","RANGE"),a.register(r.Selector.BoundUpdate.Copy,n.Selection.BOUND_UPDATE.REMOVEDATA,S.removeData,"RID","SHEETID","VERSION"),a.register(r.Selector.BoundUpdate.Copy,n.Selection.BOUND_UPDATE.HIDE,S.hide,"RID","SHEETID","VERSION","VisualCueStatus"),a.register(r.Selector.BoundUpdate.Copy,n.Selection.BOUND_UPDATE.SHOW,S.show,"RID","SHEETID","VERSION")}(this);
!function(e){var t=e.sPlusPlus,r=e.ZSClass,i=e.ZSEvents,o=i.topic,n=i.Groups,a=i.Names,s=(new r.IDGenerator,t.data.UserInfo),c=function(e){var t={};t.id=e,s.activeInfo.clearCopyRange(),s.activeInfo.chartsInfo={},s.activeInfo.chartsInfo=t},C=function(){delete s.activeInfo.chartsInfo};o.register(n.Listener,a.UserAction.COPY_CHART.ADD,c,"ID"),o.register(n.Listener,a.UserAction.COPY_CHART.CLEAR,C),o.register(n.Listener,a.UserAction.COPY_CHART.PASTE,function(e){if(s.activeInfo.chartsInfo){var t=s.activeInfo.chartsInfo.id,r=(new ZSChart.Controller.ZSCController,sPlusPlus),i=r.view.getActiveGridID(),c=r.view.getResourceID(i),C=r.view.getSheetID(i),l=r.view.getVersionID(i),I=r.view.getSheetState(i,C),h=r.data.getWorkBook(c,l).getSheetObj(C),f=I.Cell.row,v=I.Cell.col,u=h.Row.auxiliaryAxis.getPos(f),A=h.Column.auxiliaryAxis.getPos(v),g=new ZSChart.Utility.ChartAgent,S=g.getChartMeta(t);S.chartMeta.left=A,S.chartMeta.top=u,S.setForClone(!0);var R=g.getRequestObject(S,"new");S.setForClone(!1),o.publish(n.Listener,a.SheetAction.CHARTS.BLUR,{RID:c,SHEETID:C,VERSION:l,CHARTID:t}),ZSChart.Server.Action.updateChartOnGrid(c,C,l,R)}})}(this);
!function(t){var e,s=t.ZSClass,i=t.ZSConstants.I18N;function n(t,e){this.parent=t,this.inputToSelect=e.inputToSelect,this.cssClass=e.cssClass}n.prototype={createElement:function(){(e=document.createElement("span")).innerText=i.Copy,e.setAttribute("id","copyURL"),e.addEventListener("click",function(){this.inputToSelect&&JSUtil.fn.selectDivText(this.inputToSelect),document.execCommand("copy"),this.copy.classList.add("sucState"),this.copy.innerText=i["CopyToClipboard.Copied"];var t=this.copy;setTimeout(function(){t.classList.remove("sucState"),t.innerText=i.Copy,window.getSelection().removeAllRanges()},1e3)}.bind(this)),e.classList.add(this.cssClass),this.copy=e,this.parent.appendChild(e)}},s.CopyToClipboard=n}(this);
!function(e){var t,n=e.sPlusPlus,i=(ZSClass.Editors,e.document),o=e.ZSEvents,a=(o.topic,o.Groups,o.Names,e.ZSConstants.I18N),r=i.createElement("div");function s(){var e=i.createRange();e.selectNodeContents(r);var t=window.getSelection();t.removeAllRanges(),t.addRange(e)}function d(){i.execCommand("copy")}r.setAttribute("contenteditable",!0),r.setAttribute("id","copyEditor"),r.style.width="1000px",r.style.height="0px",r.style.position="absolute",r.style.top="-100010px",r.style.left="-100010px",i.body.appendChild(r),e.UserAction.CopyData=function(o,l,c,p,C,v,g){for(var h,u=n.data.getWorkBook(o,C).getSheetObj(l),w=u.Row,m=u.Column,f={},y=!1,b=0;b<v.length;b++){var R=v[b],S=R.startRow,A=R.startCol,x=R.endRow,I=R.endCol,N=(R.getRowSpan(),u.Row.Visibility.getOnCount(S,x)),T=(R.getColSpan(),u.Column.hidden.getOnCount(A,I));if(!(e.isCanvasGrid?n.view.getGridComponent(c).isInViewPort(R.startRow,R.startCol,R.endRow,R.endCol):n.view.getGridComponent(c).isInViewPort(R))){y=!0;break}for(var U=S;U<=x;U=w.Visibility.nextNonHidden(U)){f[U]||(f[U]={});for(var E=A;E<=I;E=m.hidden.nextNonHidden(E)){var M=n.view.getGridComponent(c).getCellRef(o,l,C,U,E);f[U][E]=M.data}}}if((Math.min(u.MaxUsedRow,x)-S+1-N)*(Math.min(u.MaxUsedCol,I)-A+1-T)>1e4&&!g&&function(){var o=JSUtil.fn.replaceParams(a.PasteOutSideLimit,new Array("<a  href='#'>","</a>")),r=i.createElement("div");r.id="containerDivId";var s=i.createElement("div"),d=i.createElement("div"),l=i.createElement("span");l.innerHTML=o,d.className="shBtnNtftInfoTxt",d.appendChild(l),r.appendChild(d),s.className="flt_right mt20";var c=i.createElement("BUTTON"),p=i.createTextNode(a.CopyToClipboardButtonMsg);c.appendChild(p),c.className="ZsbtnInfo Zsbtn",c.addEventListener("click",function(){var i=n.view.getActiveGridID(),o=n.view.getResourceID(i),a=n.view.getSheetID(i),r=n.view.getVersionID(i),s=n.view.getSelectedSheets(i),d=n.view.getSheetState(i,a),l=d.getRanges();t.hide(),e.UserAction.CopyData(o,a,i,s,r,l,!0)}),s.appendChild(c),r.appendChild(s),(t=new ZSClass.InfoBanner(r)).show()}(),y||g){var D=!1;g&&(D=!0),function(t,n,i,o,a,r){e.UserAction.CopyToClipAction(t,n,i,o,a,r)}(o,p,C,void 0,!1,D)}else h=e.UserAction.TableGeneratorUtility(o,l,c,C,f),r.innerHTML="",r.appendChild(h),s(),d(),r.blur(),e.UserAction.Copy(o,p,C,void 0,!0,!0)},e.UserAction.CopyResponseHandling=function(e){r.innerHTML="",r.innerHTML=e,s(),d(),r.blur()}}(this);
!function(s){s.sPlusPlus;var t=s.ZSClass.Selector;(t.Design||(t.Design={})).CutCopy={class:"cutCopySelection",edges:{top:!0,bottom:!0,left:!0,right:!0}}}(this);
!function(e){var t,a,n=e.sPlusPlus,i=e.ZSConstants,o=i.FeatureConstants,r=e.ZSConstants.wCC,l=n.data.AppRegistry.COPY_SOURCE,s=e.UserAction,c=e.UIUtil.Component,d=e.ZSEvents,m=e.document,u=e.ZSConstants.I18N,S=d.topic,A=d.Groups,T=d.Names,E=m.getElementById("popupmenu"),I=(u=e.ZSConstants.I18N,n.view.Toolbar.Feature[o.PASTE]);function g(e){var t=e.clipboardData,a=t.getData("text/plain"),i=t.getData("text/html"),o=m.createElement("html");o.innerHTML=i;var r=o.getElementsByTagName("table"),c=r&&r[0],d=c&&c.getAttribute("source"),E=o.getElementsByTagName("img");if(((E=E&&E[0])&&E.getAttribute("source"))!=n.data.AppRegistry.COPY_SOURCE+" "+n.data.AppRegistry.COPY_CHART_SOURCE){if(d!==l&&d!==n.data.AppRegistry.NO_DOWNLOAD_COPY_SOURCE)if(0==o.textContent.trim().length)i="";else if(i&&encodeURIComponent(i).length>1e6){if(encodeURIComponent(a).length>1e6)return void ZSClass.ZSAlert(u.ErrorExceedingPastedData);i=""}var I=function(e,t,a){var n,i=a.clipboardData,o=(new DOMParser).parseFromString(t,"text/html"),r=!1;if(i.files&&i.files.length>0&&t&&0==t.length)n=i.files[0];else{if(!i.items)return;for(var l=0;l<i.items.length;l++)if(-1!==i.items[l].type.indexOf("image")){r=!0;break}var s=o.childNodes[0].childNodes,c=void 0!==s&&void 0!==s[0]&&"HEAD"===s[0].nodeName&&void 0!==s[1]&&"BODY"===s[1].nodeName&&void 0!==s[1].childNodes[0]&&"IMG"===s[1].childNodes[0].nodeName;if(c||0===e.length&&0===t.length||r&&0==t.length)for(var l=0;l<i.items.length;l++)if(-1!==i.items[l].type.indexOf("image")){n=i.items[l].getAsFile();break}}return n}(a,i,e);""===i&&a&&encodeURIComponent(a).length>1e6?ZSClass.ZSAlert(u.ErrorExceedingPastedData):(e.preventDefault(),s.handleClipData(a,i,I),m.removeEventListener("paste",g))}else S.publish(A.Listener,T.UserAction.COPY_CHART.PASTE)}t={id:r.SUBMENUITEM+o.PASTE+r.IDENTITY,data:'{"componentOptions":{"label":"'+u["MenuItem.HomeTab.PasteSpecial"]+'","type":"text_only"}}',relativeto:"parent"},a=[{data:'{"label":"'+u["MenuItem.HomeTab.Paste.All"]+'", "action": "ALL"}'},{data:'{"label":"'+u["MenuItem.HomeTab.Paste.Values"]+'", "action": "VALUES"}'},{data:'{"label":"'+u["MenuItem.HomeTab.Paste.Formats"]+'", "action": "FORMATS"}'},{data:'{"label":"'+u["MenuItem.HomeTab.Paste.Formulas"]+'", "action": "FORMULAS"}'},{data:'{"label":"'+u["MenuItem.HomeTab.Paste.Notes"]+'", "action": "COMMENTS"}'},{data:'{"label":"'+u["MenuItem.HomeTab.Paste.ValuesAndNumberFormats"]+'", "action": "VALUES_AND_NUMBERFORMATS"}'},{data:'{"label":"'+u["MenuItem.HomeTab.Paste.FormulasAndNumberFormats"]+'", "action": "FORMULAS_AND_NUMBERFORMATS"}'},{data:'{"label":"'+u["MenuItem.HomeTab.Paste.AllExceptNotes"]+'", "action": "ALL_EXCEPT_COMMENTS"}'},{data:'{"label":"'+u["MenuItem.HomeTab.Paste.AllExceptBorders"]+'", "action": "ALL_EXCEPT_BORDERS"}'},{data:'{"label":"'+u["MenuItem.HomeTab.Paste.Validation"]+'", "action": "VALIDATION"}'},{mtype:"separator"},{data:'{"label":"'+u["MenuItem.HomeTab.Paste.Transpose"]+'", "action": "TRANSPOSE"}'}],n.view.Menu.create(a,t,E).then(function(){c.bind("#"+r.SUBMENUITEM+o.PASTE+r.IDENTITY,"zmenuitemclick",function(e,t){!function(e,t){var a=t.action,i=!1;"TRANSPOSE"==a&&(i=!0);var o=n.view.getActiveGridID(),r=n.view.getResourceID(o),l=(n.view.getSheetID(o),n.view.getVersionID(o)),s=n.view.getSelectedSheets(o);UserAction.PasteFromSheet(r,s,l,a,i)}(0,t.data)})}),S.register(A.Selector.BoundUpdate.Copy,T.Selection.BOUND_UPDATE.ADD,function(e){var t=I.getHolder();if(t){var a=t.querySelector("#"+r.MI+o.PASTE+r.IDENTITY),n=t.querySelector("#"+r.MI+o.PASTE+r.SPLIT+r.IDENTITY);e=e>=0?"enable":"disable",c.doToolbarAction(t.id,{item:i.PASTE,action:e,callback:function(){c[e]("#"+a.id),c[e]("#"+n.id)}})}},"IS_COPY"),S.register(A.Selector.BoundUpdate.Copy,T.Selection.BOUND_UPDATE.HIDE,function(e){var t=I.getHolder();if(t){var a=t.querySelector("#"+r.MI+o.PASTE+r.SPLIT+r.IDENTITY);c.doToolbarAction(t.id,{item:i.PASTE,action:"enable",callback:function(){c.enable("#"+a.id)}})}},"VisualCueStatus"),I.execute=function(e){var t=n.view.getActiveGridID(),a=n.view.getResourceID(t),i=(n.view.getSheetID(t),n.view.getVersionID(t)),o=n.view.getSelectedSheets(t);UserAction.PasteFromSheet(a,o,i,"ALL",!1)},I.executeShortCut=function(e){m.addEventListener("paste",g)},e.addSheetAndPaste=function(e){var t=n.view.getActiveGridID(),a=n.view.getResourceID(t),i=n.view.getVersionID(t),o=n.view.getSelectedSheets(t);if(e)r=(r=(r=m.querySelector("#frmExt").innerText).replace(/&quot/g,'"')).replace(/&#39;/g,"'"),m.querySelector("#frmExt").remove();else var r=ext_html;UserAction.AddSheetAndPaste(a,o,i,r)}}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSEvents,E=i.topic,S=i.Groups,s=i.Names,n=e.ZSConstants.CommandConstants,A={TYPE:0,META:1};E.register(S.Listener,s.UserAction.UserNotification,function(e,i,r,I){for(var a in I){var c=I[a],T=c[A.TYPE],o=c[A.META];switch(T){case n.MACRO:E.publish(S.UserAction,s.UserAction.MACRO.UPDATE_MACROACTION_RESULTS,{meta:o});break;case n.CUT_PASTE:var D=t.view.getActiveGridID(),R=t.view.getSheetID(D);E.publish(S.Listener,s.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:R,VERSION:r});case n.SYSTEMCLIP_PASTE:case n.SERVERCLIP_PASTE_RANGE:case n.PASTESPECIAL:var l=t.view.getActiveGridID(),C=(i=t.view.getSheetID(l),c[1][0][1][0]);if(C){var v=t.view.getSelectedSheets(l),g=new ZSClass.ParamGenerator(v,e,r,!0,!0).getSheets();E.publish(S.Selector.BoundUpdate.Range,s.Selection.BOUND_UPDATE.FLUSH,{RID:e,SHEETID:i,VERSION:r}),JSUtil.fn.getIndexOf(i,g);for(var u=0;u<C.length;u++){var P=new ZSClass.Range(C[u].sr,C[u].sc,C[u].er,C[u].ec);E.publish(S.Selector.BoundUpdate.Range,s.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:i,VERSION:r,RANGE:P,accumulate:1})}}case n.FILLSERIES:if(l=t.view.getActiveGridID(),i=t.view.getSheetID(l),c[1][0][1][0].length>1)return void E.publish(S.Listener,s.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:i,VERSION:r});(void 0===c[1][0][2]||c[1][0][2]||c[1][0][5])&&n.PASTESPECIAL!==T&&"TRANSPOSE"!==c[1][0][3]&&(c.push(I[a][1][0][4][0][0]),E.publish(S.Listener,s.CellAction.WidgetAction.RECAST_WIDEGT,{RID:e,SHEETID:i,VERSION:r,META:c}))}}},"RID","SHEETID","VERSION","META")}(this);
!function(e){var t=e.sPlusPlus,a=t.data.UserInfo,i=t.data.AppRegistry.COPY_SOURCE;e.UserAction.handleClipData=function(e,s,o){var n=t.view.getActiveGridID(),r=t.view.getResourceID(n),c=t.view.getVersionID(n),d=t.view.getSelectedSheets(n),g=a.activeInfo.getCopyState();void 0!==t.data.isRecastAction&&t.data.isRecastAction&&(t.data.isRecastAction=!1);var v=t.view.getActiveState(n),A=v.getFormatPainterRange(),O=v.getFormatPainterState();i=t.data.UserInfo.Permission.isDownloadOff?t.data.AppRegistry.NO_DOWNLOAD_COPY_SOURCE:i;var u=O?A:a.activeInfo.getCopyDetails();s&&s.indexOf(i)>=0&&0!=Object.keys(u).length||0==g?UserAction.PasteFromSheet(r,d,c,"ALL",!1):s.length>0?UserAction.PasteOutsideSource(r,d,c,s,!0):e.length>0?UserAction.PasteOutsideSource(r,d,c,e):void 0!==o&&UserAction.PasteOutsideSource(r,d,c,s,!0,o)}}(this);
!function(e){if(!e.isCanvasGrid){var t=e.ZSClass,a=t.UILayer,s=document.getElementById("popupmenu"),n=e.UIUtil.Component,i=ZSConstants.FeatureConstants,o=e.ZSConstants.ActionConstants,d=e.sPlusPlus,c=d.view.Toolbar.Feature[i.RECAST],u=e.ZSConstants.I18N,m=null,r=-1,l=e.ZSConstants.FeatureConstants,E=d.view.Toolbar.Feature[l.TEXT_TO_COLUMN],p=["source_format","destination_format","SEPARATOR","T2T","ALL","VALUES","FORMATS","FORMULAS","COMMENTS","VALUES_AND_NUMBERFORMATS","FORMULAS_AND_NUMBERFORMATS","ALL_EXCEPT_COMMENTS","ALL_EXCEPT_BORDERS","VALIDATION","FILL_DEFAULT","FILL_COPY","FILL_FORMATS","FILL_EXCEPT_FORMATS"],I=["CopyPasteMatchWithSource","CopyPasteMatchWithDestination","SEPARATOR","TexttoColumns.Title","MenuItem.HomeTab.Paste.All","MenuItem.HomeTab.Paste.Values","MenuItem.HomeTab.Paste.Formats","MenuItem.HomeTab.Paste.Formulas","MenuItem.HomeTab.Paste.Notes","MenuItem.HomeTab.Paste.ValuesAndNumberFormats","MenuItem.HomeTab.Paste.FormulasAndNumberFormats","MenuItem.HomeTab.Paste.AllExceptNotes","MenuItem.HomeTab.Paste.AllExceptBorders","MenuItem.HomeTab.Paste.Validation","FillSeries.Default","FillSeries.CopyCells","FillSeries.FillFormats","FillSeries.FillWithOutFormats"],S={copy:"FILL_COPY",default:"FILL_DEFAULT"},A={SYSTEMCLIP_PASTE:{s:0,e:3},SERVERCLIP_PASTE_RANGE:{s:4,e:13},FILLSERIES:{s:14,e:17}},T=e.ZSEvents,L=T.topic,R=T.Groups,P=T.Names;h.prototype=new a,h.prototype.setDirection=function(e,t){e?this.Dom.classList.add("pasteLeft"):this.Dom.classList.remove("pasteLeft"),t?this.Dom.classList.add("pasteTop"):this.Dom.classList.remove("pasteTop")},h.prototype.addRecastButton=function(){var e=document.createElement("div");e.className="pasteWid";var t=document.createElement("div");t.className="shIcon cpWidget",t.setAttribute("data-menu-id","pasteWidgetPopUp"),e.appendChild(t),t.addEventListener("mousedown",function(e){e.stopPropagation(),n.triggerEvent(e,document)}),this.Dom.appendChild(e)},h.prototype.createListHolder=function(){if(s){(m=document.createElement("ul")).setAttribute("data-ctype","zmenu"),m.id="pasteWidgetPopUp",m.setAttribute("data-content-type","icon-text");for(var e=0;e<I.length;e++){var a=document.createElement("li");a.id="menuItem"+e,"SEPARATOR"===p[e]?a.setAttribute("data-item-type","separator"):(a.setAttribute("data-item-type","checkbox"),a.setAttribute("data-value",p[e]),a.innerText=u[I[e]]),m.appendChild(a)}s.appendChild(m),function(){n.bind(m,"zmenuitemclick",function(e,a){for(var s=document.getElementById(m.id).getElementsByTagName("li"),i=0;i<s.length;i++)"checked"===s[i].getAttribute("checked")&&"menuItem3"!==a.data.id&&n.zmenu("#"+m.id,"setMenuItemsAttribute",["#"+s[i].id],"checked",!1);"menuItem3"===a.data.id&&n.zmenu("#"+m.id,"setMenuItemsAttribute",["#menuItem3"],"checked",!1),"menuItem3"!==a.data.id&&n.zmenu("#"+m.id,"setMenuItemsAttribute",["#"+a.data.id],"checked",!0);var o=d.view.getActiveGridID(),u=d.view.getResourceID(o),r=d.view.getSelectedSheets(o),l=d.view.getVersionID(o);if("menuItem3"===a.data.id){var p=d.view.getSheetID(o),I=d.data.RecastInfo.aparams.rangeList[0][0],S=new t.Range(I.sr,I.sc,I.er,I.ec);L.publish(R.Selector.BoundUpdate.Range,P.Selection.BOUND_UPDATE.ADD,{RID:u,SHEETID:p,VERSION:l,RANGE:S}),E.openDialog()}else c.recastAction(u,r,l,e,a)}),m.addEventListener("mousedown",function(e){e.stopPropagation()}),n.bind(m,"zmenubeforeshow",function(e,t){var a=document.getElementById(m.id).getElementsByTagName("li");if(r!==d.data.RecastInfo.actionId){r=d.data.RecastInfo.actionId;for(var s=0;s<a.length;s++)"checked"===a[s].getAttribute("checked")&&n.zmenu("#"+m.id,"setMenuItemsAttribute",["#"+a[s].id],"checked",!1);switch(d.data.RecastInfo.action){case o.SYSTEMCLIP_PASTE:n.zmenu("#"+m.id,"setMenuItemsAttribute",["#menuItem0"],"checked",!0);break;case o.SERVERCLIP_PASTE_RANGE:case o.COPY_PASTE:n.zmenu("#"+m.id,"setMenuItemsAttribute",["#menuItem"+p.indexOf(d.data.RecastInfo.popUpOptionType)],"checked",!0);break;case o.FILLSERIES:n.zmenu("#"+m.id,"setMenuItemsAttribute",["#menuItem"+p.indexOf(S[d.data.RecastInfo.popUpOptionType])],"checked",!0)}}for(var s=0;s<a.length;s++)a[s].style.display="none";var i=-1,c=-1,u=[];switch(d.data.RecastInfo.action){case o.SYSTEMCLIP_PASTE:i=A.SYSTEMCLIP_PASTE.s,c=A.SYSTEMCLIP_PASTE.e,d.data.RecastInfo.isT2COption&&!d.data.RecastInfo.isRecastActionOption&&(u.push(0),u.push(1),u.push(2)),d.data.RecastInfo.isT2COption||(u.push(2),u.push(3));break;case o.SERVERCLIP_PASTE_RANGE:case o.COPY_PASTE:i=A.SERVERCLIP_PASTE_RANGE.s,c=A.SERVERCLIP_PASTE_RANGE.e;break;case o.FILLSERIES:i=A.FILLSERIES.s,c=A.FILLSERIES.e}for(var s=i;s<=c;s++)a[s].style.display="";for(var s=0;s<u.length;s++)a[u[s]].style.display="none"})}.call(this)}},h.prototype.addRecastOption=function(){!m&&this.createListHolder()},t.UIPasteWidgetLayer=h}function h(e,t){a.call(this,e,t),this.addRecastButton(),this.addRecastOption(),this.Dom.addEventListener("mousedown",function(e){e.stopPropagation(),n.triggerEvent(e,document)})}}(this);
!function(t){t.ZSClass.UILayerController;var i=t.ZSClass.UIPasteWidgetLayer;function e(t,i){this.parent=t,this.properties=i,this.active={},this.inActive=[]}e.prototype={getLayer:function(t){return this.isExist(t)?this.active[t]:(this.inActive.length?this.active[t]=this.inActive.pop():this.active[t]=new i(this.parent,this.properties),this.active[t])},place:function(t,i,e,s,n){var r=this.getLayer(t);r.place(i,e,s,n),r.show(this.parent)},isExist:function(t){return!!this.active[t]},hide:function(t,i,e){this.isExist(0)&&this.active[0].hide()},setDirection:function(t,i,e){this.active[t].setDirection(i,e)}},ZSClass.UIPasteWidgetController=e}(this);
!function(s){s.sPlusPlus;var t=s.ZSClass.Selector;(t.Design||(t.Design={})).PasteWidget={class:"pasteWidget",edges:{top:!0,left:!0,bottom:!0,right:!0}}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,i=e.ZSConstants.wCC,s=e.UserAction,o=e.UIUtil.Component,r=e.ZSEvents,a=r.topic,c=r.Groups,u=r.Names,v=t.view.Toolbar.Feature[n.UNDO],D=document.getElementById(i.MI+n.UNDO+i.IDENTITY);function l(){o.disable(D)}l(),a.register(c.Listener,u.DocAction.UNDO_REDO.COUNTS,function(e,t){"enable"==(e?"enable":"disable")?o.enable(D):l()},"UNDO","REDO"),v.execute=function(e){var n=t.view.getActiveGridID(),i=t.view.getResourceID(n),o=(t.view.getSheetID(n),t.view.getVersionID(n));!function(e,n,i,o){if(!e.repeat){e.preventDefault();var r=t.view.getActiveGridID(),i=t.view.getSelectedSheets(r);s.Undo(n,i,o)}}(e,i,t.view.getSelectedSheets(n),o)}}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSConstants.FeatureConstants,n=e.ZSConstants.wCC,s=e.UserAction,o=e.UIUtil.Component,c=e.ZSEvents,r=c.topic,v=c.Groups,a=c.Names,u=t.view.Toolbar.Feature[i.REDO],D=document.getElementById(n.MI+i.REDO+n.IDENTITY);function l(){o.disable(D)}l(),r.register(v.Listener,a.DocAction.UNDO_REDO.COUNTS,function(e,t){"enable"==(t?"enable":"disable")?o.enable(D):l()},"UNDO","REDO"),u.execute=function(e){var i=t.view.getActiveGridID(),n=t.view.getResourceID(i),o=(t.view.getSheetID(i),t.view.getVersionID(i));t.view.getSelectedSheets(i),function(e,i,n,o){if(!e.repeat){e.preventDefault();var c=t.view.getActiveGridID(),r=t.view.getSelectedSheets(c);s.Redo(i,r,o)}}(e,n,0,o)},u.executeRepeat=function(e){var i=t.view.getActiveGridID(),n=t.view.getResourceID(i),o=t.view.getVersionID(i),c=t.view.getSelectedSheets(i);s.RepeatAction(n,c,o)}}(this);
!function(e){var r=e.sPlusPlus,t=e.ZSEvents,a=t.topic,n=t.Groups,i=t.Names,s=e.ZSClass,o=e.JSUtil,l=e.UserAction;a.register(n.Listener,i.DocMeta.ACTION_IDENTIFIER,function(t,S,I){var c=r.data.UserInfo.Transients.UndoRedo.getObj(t),d=c.UndoTransientAO,R=c.RedoTransientAO,O=d.hasOwnProperty(I),E=R.hasOwnProperty(I);if(O||E){if(O)for(var D in d)if(I<parseInt(D)&&delete d[D],I===parseInt(D)){var f=d[D];delete d[D];break}if(E)for(var D in R)if(I<parseInt(D)&&delete R[D],I===parseInt(D)){f=R[D],delete R[D];break}new e.ZSClass.ParamGenerator;var p=f.params.rangeList,v=f.params.sheetList,A=f.params.undoRedoOptions;if(A&&!!A.FOCUS_SOURCE&&f.params.srcRangeList&&(p=f.params.srcRangeList),!A||!A.STOPSELECTION){var U=A&&A.allowRowScroll,u=A&&A.allowColScroll,w=f.params.activeCell,C=w.s,T=p[o.fn.getIndexOf(C,v)];void 0!=T&&function(e,t,o,S,I,c,d){var R=I.r,O=I.c,E=r.view.getActiveGridID(),D=r.view.getSheetID(E);if(D!=t)l.SwitchSheet(e,D,o,t,f);else{a.publish(n.Selector.BoundUpdate.Range,i.Selection.BOUND_UPDATE.ADDRANGES,{RID:e,SHEETID:t,VERSION:o,RANGES:S,accumulate:1});var f=new s.Range(R,O,R,O);a.publish(n.Selector.BoundUpdate.Cell,i.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:o,ActiveCellRange:f,ROW:R,COL:O}),c?l.ScrollRowIntoView(e,t,o,R):d?l.ScrollColIntoView(e,t,o,O):l.ScrollCellIntoView(e,t,o,R,O)}}(t,C,S,T,w,U,u)}}},"RESOURCE_ID","VERSION","xaid"),a.register(n.Listener,i.GridAction.RELOAD,function(e,t,a){var n=r.data.UserInfo.Transients.UndoRedo.getObj(e),i=n.UndoTransientAO,s=n.RedoTransientAO;for(var o in i)delete i[o];for(var o in s)delete s[o]},"RID","VERSION","XAID")}(this);
!function(E){var s=E.ZSEvents,e=s.topic,T=s.Groups,_=s.Names,c=E.sPlusPlus,a=E.ZSDevTools.Logger,O=E.ZSConstants.ActionConstants;E.ZSClass.ActionObject;function A(E){var s=E.getAction(),A=c.data.UserInfo.Transients.UndoRedo.getObj(E.getParams().RID);switch(s){case O.BOLD:case O.ITALIC:case O.UNDERLINE:case O.STRIKETHROUGH:case O.FONTFAMILY:case O.FONTSIZE:case O.ALIGN:case O.COLOR:case O.TEXTCOLOR:case O.WRAP:case O.HALIGN:case O.VALIGN:case O.FORMAT_DATE:case O.FORMAT_CURRENCY:case O.FORMAT_ACCOUNTING:case O.CLEARFORMATS:case O.FORMAT_COMMA:case O.FORMAT_PERCENT:case O.FORMAT_TEXT:case O.FORMAT_INCREMENT_DECIMAL:case O.FORMAT_DECREMENT_DECIMAL:case O.BORDERS:case O.CLEARCONTENTS:case O.CLEARSTYLES:case O.CLEARALL:case O.HYPERLINK:case O.HEIGHT:case O.WIDTH:case O.MERGE_SPLIT:case O.MERGE_RANGE:case O.MERGE_ACROSS:case O.MERGE_DOWN:case O.MERGE_AND_CENTER:case O.CHECKBOX_ADD:case O.CHECKBOX_EDIT:case O.CHECKBOX_CLEAR:case O.MAP_FILTER_VIEW:A.setLastAction(E);case O.SUBMIT:case O.COPY_PASTE_CONTENT:case O.SYSTEMCLIP_PASTE:case O.CUT_PASTE:case O.COPY_PASTE:case O.COMPUTE_SUM:case O.COMPUTE_SUM_C:case O.PASTESPECIAL_FORMATS:case O.REPLACE:case O.REPLACE_ALL:case O.REPEAT_ACTION:case O.CREATE_FILTER:case O.REMOVE_FILTER:case O.APPLY_FILTER:case O.FILTER_BY_VALUE:case O.FILTER_BY_CELL_COLOR:case O.FILTER_BY_FONT_COLOR:case O.CONDITIONAL_FORMAT_APPLY:case O.CONDITIONAL_FORMAT_EDIT:case O.CONDITIONAL_FORMAT_DELETE:case O.COLOR_SCALES_APPLY:case O.CONDITIONAL_STYLE_REORDER:case O.CONDITIONAL_FORMAT_CLEAR_RULE:case O.ICON_SET_APPLY:case O.FORMATCELLS_GRID:case O.DATA_VALIDATION_APPLY:case O.DATA_VALIDATION_CLEAR:case O.CELL_COMMENT:case O.SORT:case O.INSERT_COPY_ROW:case O.INSERT_COPY_COLUMN:case O.INSERT_CUT_ROW:case O.INSERT_CUT_COLUMN:case O.INSERT_ROW:case O.INSERT_COL:case O.DELETE_ROW:case O.DELETE_COL:case O.FILLSERIES:case O.FILLSERIES_AUTO:case O.HIDE_GRID:case O.IMAGE_NEW:case O.IMAGE_MOVE:case O.IMAGE_CLONE:case O.IMAGE_RESIZE:case O.IMAGE_REMOVE:case O.IMAGE_CUT_PASTE:case O.IMAGE_REPLACE:case O.IMAGE_COPY_PASTE:case O.INSERT_CELL_LEFT:case O.INSERT_CELL_TOP:case O.DELETE_CELL_RIGHT:case O.DELETE_CELL_BOTTOM:case O.CHART_MOVE:case O.CHART_EDIT:case O.CHART_DELETE:case O.CHART_RESIZE:case O.CHART_QUICK_EDIT:case O.CHART_QUICK_STYLE:case O.CHART_PASTE_STYLE:case O.CHART_PUBLISH:case O.CHART_UNPUBLISH:case O.CHART_NEW:case O.CHART_MOVE_TO_NEW_SHEET:case O.DRAG_DROP:case O.PICKLIST_CREATE:case O.PICKLIST_APPLY:case O.PICKLIST_REMOVE:case O.PICKLIST_EDIT:case O.PICKLIST_EMPTY_REMOVE:case O.SPARKLINE_CREATE:case O.SPARKLINE_UNGROUP:case O.SPARKLINE_GROUP:case O.SPARKLINE_REMOVE:case O.SPARKLINE_GROUP_REMOVE:case O.EDIT_SPARKLINE_DATA:case O.EDIT_SPARKLINE_GROUP_DATA:case O.CHANGE_SPARKLINE_ORIENTATION:case O.SPARKLINE_PROPERTIES:case O.HIDE_COLUMNS:case O.HIDE_ROWS:case O.UNHIDE_COLUMNS:case O.UNHIDE_ROWS:case O.CREATE_PIVOT:case O.EDIT_PIVOT:case O.APPLYFILTER_PIVOT:case O.MOVE_PIVOT:case O.COPY_PIVOT:case O.SORT_PIVOT:case O.CHANGE_PIVOT_SOURCE:case O.CHANGE_PIVOT_SUBTOTALOPTION:case O.CHANGE_PIVOT_GRANDTOTALROWOPTION:case O.CHANGE_PIVOT_GRANDTOTALCOLOPTION:case O.DELETE_PIVOT:case O.GROUPING_PIVOT_FIELDS:case O.COUNT_EMPTY_CELLS:case O.GET_DATA_DUPLICATES:case O.DATA_CLEANSING_REPLACE_ALL:case O.TEXTTOCOLUMNS_APPLY:A.add(E),e.publish(T.Listener,_.DocAction.UNDO_REDO.ACTION),e.publish(T.Listener,_.DocAction.UNDO_REDO.COUNTS,{UNDO:A.isUndoPossible(),REDO:A.isRedoPossible(),REPEAT_ACTION:!!A.getLastAction()});break;case O.UNDO:A.undo(),e.publish(T.Listener,_.DocAction.UNDO_REDO.COUNTS,{UNDO:A.isUndoPossible(),REDO:A.isRedoPossible(),REPEAT_ACTION:!!A.getLastAction()});break;case O.REDO:A.redo(),e.publish(T.Listener,_.DocAction.UNDO_REDO.COUNTS,{UNDO:A.isUndoPossible(),REDO:A.isRedoPossible(),REPEAT_ACTION:!!A.getLastAction()});break;default:a.log("Not Registered UNDO REDO : ",E)}}c.data.UserInfo.ActionRecorder={record:A}}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSEvents,s=i.topic,n=i.Groups,o=i.Names,r=e.ZSConstants.FeatureConstants,c=e.document,a=e.UserAction,v=e.ZSConstants.wCC,I=(e.UIUtil.Component,t.view.Toolbar.Feature[r.BOLD]),u=0;function g(e){s.register(n.Listener,o.DocAction.DOCUMENT.TOGGLE_VIEW,l,"isRegister"),s.register(n.Listener,o.SheetAction.ACTIVE_CELL.INFO,D,"RID","SHEETID","VERSION","VALUE")}function l(e){g()}function D(e,i,s,n){var o=t.data.getWorkBook(e,s).CellStyle.getStyleDef(n.Format),a=c.getElementById(v.MI+r.BOLD+v.IDENTITY);u=0,"bold"==o[4]&&(u=1),a&&(u?a.classList.add("shIconActive"):a.classList.remove("shIconActive"))}g("register"),I.execute=function(e){var i=t.view.getActiveGridID(),s=t.view.getResourceID(i),n=(t.view.getSheetID(i),t.view.getVersionID(i));!function(e,i,s,n){if(!e.repeat){var o=t.view.getActiveGridID(),s=t.view.getSelectedSheets(o);u=1==u?0:1,a.BOLD(i,s,n,u),e.preventDefault(),e.stopPropagation()}}(e,s,t.view.getSelectedSheets(i),n)}}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSEvents,s=i.topic,n=i.Groups,o=i.Names,c=e.ZSConstants.FeatureConstants,I=(e.UIUtil.Component,e.document,e.UserAction),a=(e.ZSConstants.I18N,e.ZSConstants.wCC),r=t.view.Toolbar.Feature[c.ITALIC],v=0;function u(e,i,s,n){"italic"==t.data.getWorkBook(e,s).CellStyle.getStyleDef(n.Format)[5]?(v=1,l(!0)):(v=0,l(!1))}function l(e){var t=document.getElementById(a.MI+c.ITALIC+a.IDENTITY);t&&(v?t.classList.add("shIconActive"):t.classList.remove("shIconActive"))}s.register(n.Listener,o.SheetAction.ACTIVE_CELL.INFO,u,"RID","SHEETID","VERSION","VALUE"),r.execute=function(e){var i=t.view.getActiveGridID(),s=t.view.getResourceID(i),n=(t.view.getSheetID(i),t.view.getVersionID(i));!function(e,i,s,n){if(!e.repeat){v=1==v?0:1;var o=t.view.getActiveGridID(),s=t.view.getSelectedSheets(o);I.ITALIC(i,s,n,v),e.preventDefault(),e.stopPropagation()}}(e,s,t.view.getSelectedSheets(i),n)}}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSEvents,n=s.topic,o=s.Groups,i=s.Names,a=e.ZSConstants.FeatureConstants,c=(e.document,e.ZSConstants.I18N,e.ZSConstants.wCC),r=(e.UIUtil.Component,e.UserAction),I=t.view.Toolbar.Feature[a.UNDERLINE],u=0;function v(e,s,n,o){"solid"==t.data.getWorkBook(e,n).CellStyle.getStyleDef(o.Format)[7]?(u=1,E(!0)):(u=0,E(!1))}function E(e){var t=document.getElementById(c.MI+a.UNDERLINE+c.IDENTITY);t&&(u?t.classList.add("shIconActive"):t.classList.remove("shIconActive"))}n.register(o.Listener,i.SheetAction.ACTIVE_CELL.INFO,v,"RID","SHEETID","VERSION","VALUE"),I.execute=function(e){var s=t.view.getActiveGridID(),n=t.view.getResourceID(s),o=(t.view.getSheetID(s),t.view.getVersionID(s));!function(e,t,s,n){e.repeat||(u=1==u?0:1,r.UNDERLINE(t,s,n,u),e.preventDefault(),e.stopPropagation())}(e,n,t.view.getSelectedSheets(s),o)}}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSEvents,n=s.topic,o=s.Groups,i=s.Names,c=e.ZSConstants.FeatureConstants,r=(e.document,e.ZSConstants.I18N,e.ZSConstants.wCC),I=(e.UIUtil.Component,e.UserAction),a=t.view.Toolbar.Feature[c.STRIKETHROUGH],u=0;function v(e,s,n,o){var i,I,a=t.data.getWorkBook(e,n).CellStyle.getStyleDef(o.Format);u="solid"==a[6]?1:0,i=u,(I=document.getElementById(r.MI+c.STRIKETHROUGH+r.IDENTITY))&&(i?I.classList.add("shIconActive"):I.classList.remove("shIconActive"))}n.register(o.Listener,i.SheetAction.ACTIVE_CELL.INFO,v,"RID","SHEETID","VERSION","VALUE"),a.execute=function(e){e.preventDefault();var s=t.view.getActiveGridID(),n=t.view.getResourceID(s),o=(t.view.getSheetID(s),t.view.getVersionID(s));!function(e,t,s,n){e.repeat||(u=1==u?0:1,I.STRIKETHROUGH(t,s,n,u))}(e,n,t.view.getSelectedSheets(s),o)}}(this);
!function(e){var t,o,r,i,n=e.sPlusPlus,s=e.ZSEvents,a=s.topic,c=s.Groups,v=s.Names,l=e.ZSConstants.FeatureConstants,D=e.document,R=(e.ZSConstants.I18N,e.ZSConstants.wCC),g=e.UIUtil.Component,I=n.view.Toolbar.Feature[l.FILL_COLOR],u="#FCE6A4";n.view.Events.Key;function O(e){u=e,t&&(t.style.borderBottom="3px solid "+u)}(t=D.getElementById(R.MI+l.FILL_COLOR+R.IDENTITY))&&(t.style.borderBottom="3px solid "+u),a.register(c.Listener,v.FormatAction.ONCHANGE_FILLCOLOR,O,"COLOR_CODE"),o=D.getElementById(R.MI+l.FILL_COLOR+R.SPLIT+R.IDENTITY),r=D.querySelector(".ui-zoho-sheet"),g.bind(o,"zcolorchooserpick",function(t,o){var r=n.view.getActiveGridID(),i=n.view.getResourceID(r),s=(n.view.getSheetID(r),n.view.getVersionID(r)),l=n.view.getSelectedSheets(r),D=o.color;e.UserAction.COLOR(i,l,s,D),a.publish(c.Listener,v.FormatAction.ONCHANGE_FILLCOLOR,{COLOR_CODE:D})}),g.bind(o,"zcolorchoosercolorpanmouseover zcolorchoosernocolorbuttonmouseover",function(e,t){var o="transparent";t.colorpanData&&(o=t.colorpanData.color),function(e){i=e;var t=n.view.getActiveGridID(),o=n.view.getSheetID(t),r=n.view.getSheetState(t,o).getRanges();for(var s in r){var a=r[s];L(a)}}(o)}),g.bind(o,"zcolorchooserpickerclose",function(e,t){S()}),g.bind(o,"zcolorchooserbeforepickeropen",function(e,i){r.classList.add("rangeBgRmv"),t&&(t.parentElement.style.backgroundColor="#F5F5F5");var s=function(){var e,t=n.view.getActiveGridID(),o=n.view.getResourceID(t),r=n.view.getSheetID(t),i=n.view.getVersionID(t),s=n.data.getWorkBook(o,i),a=s.getSheetObj(r).activeCellData;if(a){var c=a.Format,v=s.CellStyle.getStyleDef(c);e=v[0]}return e}();s&&g.zcolorchooser(o,"setValue",s)}),g.bind(o,"zcolorchooserbeforepickerclose",function(e,o){r.classList.remove("rangeBgRmv"),t&&(t.parentElement.style.backgroundColor="")}),g.bind(o,"zcolorchoosercolorpanmouseout zcolorchoosernocolorbuttonmouseout",function(e,t){S()});var C={BACKGROUNDCOLOR:0,BORDER:11};function w(t,o,r,n,s){return"transparent"!==i?(s[C.BACKGROUNDCOLOR]=i,e.isCanvasGrid||(s[C.BORDER][0]||(s[C.BORDER][0]="transparent"),s[C.BORDER][1]||(s[C.BORDER][1]="transparent"),s[C.BORDER][2]||(s[C.BORDER][2]="transparent"),s[C.BORDER][3]||(s[C.BORDER][3]="transparent"))):e.isCanvasGrid||(s[C.BACKGROUNDCOLOR]="#fff"),s=ZSClass.CellDecorator.getStyle(s,n)}function L(e){var t=n.view.getActiveGridID(),o=n.view.getResourceID(t),r=n.view.getSheetID(t),i=n.view.getVersionID(t);a.publish(c.Listener,v.Layers.Preview.Place,{RID:o,SHEETID:r,VERSION:i,RANGE:e,CALLBACK:w})}var S=function(){var e=window.ZSEvents,t=e.topic,o=e.Groups,r=e.Names,i=n.view.getActiveGridID(),s=n.view.getResourceID(i),a=n.view.getSheetID(i),c=n.view.getVersionID(i);t.publish(o.Listener,r.Layers.Preview.RemoveAll,{RID:s,SHEETID:a,VERSION:c})};if(e.isCanvasGrid){function E(e){var t=n.view.getActiveGridID(),o=n.view.getResourceID(t),r=n.view.getSheetID(t),i=n.view.getVersionID(t);a.publish(c.Listener,v.Layers.Preview.Place,{RID:o,SHEETID:r,VERSION:i,RANGE:e,CALLBACK:function(e,t,s,a,c){var v=n.data.getWorkBook(o,i),l=v.getSheetObj(r),D=a.Format||l.ColStyleNames.getStyle(t)||"Default",R=v.CellStyle.getStyleDef(D);c[C.BACKGROUNDCOLOR]=R[C.BACKGROUNDCOLOR]}})}S=function(){var e=n.view.getActiveGridID(),t=n.view.getSheetID(e),o=n.view.getSheetState(e,t).getRanges();for(var r in o){E(o[r])}}}I.quickAction=function(t){var o=n.view.getActiveGridID(),r=n.view.getResourceID(o),i=n.view.getVersionID(o),s=(n.view.getSheetID(o),n.view.getSelectedSheets(o));e.UserAction.COLOR(r,s,i,u)}}(this);
!function(e){var t,o,r,i,n,s=e.sPlusPlus,c=e.ZSEvents,a=c.topic,v=c.Groups,l=c.Names,O=e.ZSConstants.FeatureConstants,u=(e.document,e.ZSConstants.I18N,e.ZSConstants.wCC),R=e.UIUtil.Component,D=s.view.Toolbar.Feature[O.TEXT_COLOR],g="#E31414";s.view.Events.Key;function I(e){g=e;var t=document.getElementById(u.MI+O.TEXT_COLOR+u.IDENTITY);t&&(t.style.borderBottom="3px solid "+g)}function C(e){""===(o=e.styleName[1])&&(o="#000000")}(t=document.getElementById(u.MI+O.TEXT_COLOR+u.IDENTITY))&&(t.style.borderBottom="3px solid "+g),a.register(v.Listener,l.FormatAction.ONCHANGE_FONTCOLOR,I,"COLOR_CODE"),a.register(v.Listener,l.SheetAction.ACTIVE_CELL.INFO,C,"VALUE"),r=document.getElementById(u.MI+O.TEXT_COLOR+u.SPLIT+u.IDENTITY),i=document.querySelector(".ui-zoho-sheet"),R.bind(r,"zcolorchooserpick",function(t,r){"default"==r.color&&(r.color="#000000"),o=r.color;var i=s.view.getActiveGridID(),n=s.view.getResourceID(i),c=(s.view.getSheetID(i),s.view.getVersionID(i)),O=s.view.getSelectedSheets(i);e.UserAction.TEXTCOLOR(n,O,c,o),a.publish(v.Listener,l.FormatAction.ONCHANGE_FONTCOLOR,{COLOR_CODE:o})}),R.bind(r,"zcolorchoosercolorpanmouseover zcolorchooserdefaultcolorbuttonmouseover",function(e,t){var o="#000";t.colorpanData&&(o=t.colorpanData.color),function(e){n=e;var t=s.view.getActiveGridID(),o=s.view.getSheetID(t),r=s.view.getSheetState(t,o).getRanges();for(var i in r){var c=r[i];S(c)}}(o)}),R.bind(r,"zcolorchooserpickerclose",function(e,t){d()}),R.bind(r,"zcolorchooserbeforepickeropen",function(e,o){i.classList.add("rangeBgRmv"),t&&(t.parentElement.style.backgroundColor="#F5F5F5");var n=function(){var e,t=s.view.getActiveGridID(),o=s.view.getResourceID(t),r=s.view.getSheetID(t),i=s.view.getVersionID(t),n=s.data.getWorkBook(o,i),c=n.getSheetObj(r).activeCellData;if(c){var a=c.Format,v=n.CellStyle.getStyleDef(a);e=v[1]}return e}();R.zcolorchooser(r,"setValue",n||"#000000")}),R.bind(r,"zcolorchooserbeforepickerclose",function(e,o){i.classList.remove("rangeBgRmv"),t&&(t.parentElement.style.backgroundColor="")}),R.bind(r,"zcolorchoosercolorpanmouseout zcolorchooserdefaultcolorbuttonmouseout",function(e,t){d()});var E={BACKGROUNDCOLOR:0,COLOR:1,BORDER:11};function w(e,t,o,r,i){return i[E.COLOR]=n,(i=ZSClass.CellDecorator.getStyle(i,r))[E.BACKGROUNDCOLOR]&&!i[E.BORDER][0]&&(i[E.BORDER][0]="transparent"),i[E.BACKGROUNDCOLOR]&&!i[E.BORDER][1]&&(i[E.BORDER][1]="transparent"),i[E.BACKGROUNDCOLOR]&&!i[E.BORDER][2]&&(i[E.BORDER][2]="transparent"),i[E.BACKGROUNDCOLOR]&&!i[E.BORDER][3]&&(i[E.BORDER][3]="transparent"),i}function S(e){var t=window.ZSEvents,o=t.topic,r=t.Groups,i=t.Names,n=s.view.getActiveGridID(),c=s.view.getResourceID(n),a=s.view.getSheetID(n),v=s.view.getVersionID(n);o.publish(r.Listener,i.Layers.Preview.Place,{RID:c,SHEETID:a,VERSION:v,RANGE:e,CALLBACK:w})}var d=function(){var e=window.ZSEvents,t=e.topic,o=e.Groups,r=e.Names,i=s.view.getActiveGridID(),n=s.view.getResourceID(i),c=s.view.getSheetID(i),a=s.view.getVersionID(i);t.publish(o.Listener,r.Layers.Preview.RemoveAll,{RID:n,SHEETID:c,VERSION:a})};if(e.isCanvasGrid){function L(e){var t=window.ZSEvents,o=t.topic,r=t.Groups,i=t.Names,n=s.view.getActiveGridID(),c=s.view.getResourceID(n),a=s.view.getSheetID(n),v=s.view.getVersionID(n);o.publish(r.Listener,i.Layers.Preview.Place,{RID:c,SHEETID:a,VERSION:v,RANGE:e,CALLBACK:function(e,t,o,r,i){var n=s.data.getWorkBook(c,v),l=n.getSheetObj(a),O=r.Format||l.ColStyleNames.getStyle(t)||"Default",u=n.CellStyle.getStyleDef(O);i[E.COLOR]=u[E.COLOR]}})}d=function(){var e=s.view.getActiveGridID(),t=s.view.getSheetID(e),o=s.view.getSheetState(e,t).getRanges();for(var r in o){L(o[r])}}}D.quickAction=function(t){var o=s.view.getActiveGridID(),r=s.view.getResourceID(o),i=(s.view.getSheetID(o),s.view.getVersionID(o)),n=s.view.getSelectedSheets(o);e.UserAction.TEXTCOLOR(r,n,i,g)}}(this);
!function(e){var t,I,i=e.sPlusPlus,n=e.document,a=e.UserAction,T=e.ZSConstants.FeatureConstants,o=e.ZSEvents,l=o.topic,d=o.Groups,N=o.Names,E=n.getElementById("popupmenu"),c=e.ZSConstants.I18N,r=e.ZSConstants.wCC,g=e.UIUtil.Component;function A(e){var n={id:r.SUBMENUITEM+T.HALIGN+r.IDENTITY,"data-type":"list","data-content-type":"icon-text"},o=[{data:'{"label":"'+c["MenuItem.Horizontal.Alignment"]+'", "itemType": "itemgroup"}'},{id:r.MI+T.HALIGN+"_LEFT"+r.IDENTITY,data:'{"SVGIconId":"#alignmentIco svgWidHgt","label":"'+c["MenuItem.HomeTab.Align.Left"]+'", "direction":"left", "align":"halign", "itemType":"radio"}'},{id:r.MI+T.HALIGN+"_CENTER"+r.IDENTITY,data:'{"SVGIconId":"#centerAlignIco svgWidHgt","label":"'+c["MenuItem.HomeTab.Align.Center"]+'", "direction":"center", "align":"halign", "itemType":"radio"}'},{id:r.MI+T.HALIGN+"_RIGHT"+r.IDENTITY,data:'{"SVGIconId":"#rightAlignIco svgWidHgt","label":"'+c["MenuItem.HomeTab.Align.Right"]+'", "direction":"right", "align":"halign", "itemType":"radio"}'},{data:'{"label":"'+c["MenuItem.Vertical.Alignment"]+'", "itemType": "itemgroup"}'},{id:r.MI+T.VALIGN+"_TOP"+r.IDENTITY,data:'{"SVGIconId":"#topAlignIco svgWidHgt","label":"'+c["MenuItem.HomeTab.Align.Top"]+'", "direction":"top", "align":"valign", "itemType":"radio"}'},{id:r.MI+T.VALIGN+"_MIDDLE"+r.IDENTITY,data:'{"SVGIconId":"#middleAlignIco svgWidHgt","label":"'+c["MenuItem.HomeTab.Align.Middle"]+'", "direction":"middle", "align":"valign", "itemType":"radio"}'},{id:r.MI+T.VALIGN+"_BOTTOM"+r.IDENTITY,data:'{"SVGIconId":"#bottomAlignIco svgWidHgt","label":"'+c["MenuItem.HomeTab.Align.Bottom"]+'", "direction":"bottom", "align":"valign", "itemType":"radio"}'}];i.view.Menu.create(o,n,e).then(function(){g.bind("#"+r.SUBMENUITEM+T.HALIGN+r.IDENTITY,"zmenuitemclick",function(e,t){var I=t.data.direction,n=i.view.getActiveGridID(),T=i.view.getResourceID(n),o=i.view.getVersionID(n),l=(i.view.getSheetID(n),i.view.getSelectedSheets(n));"halign"==t.data.align?a.HALIGN(T,l,o,I):a.VALIGN(T,l,o,I)})}),l.register(d.Listener,N.SheetAction.ACTIVE_CELL.INFO,m,"RID","SHEETID","VERSION","VALUE"),g.bind("#"+r.SUBMENUITEM+T.HALIGN+r.IDENTITY,"zmenubeforeshow",function(e,i){!function(){var e="#"+r.MI+T.HALIGN+"_LEFT"+r.IDENTITY,i="#"+r.MI+T.VALIGN+"_TOP"+r.IDENTITY;if(t)switch(t){case"start":e="#"+r.MI+T.HALIGN+"_LEFT"+r.IDENTITY;break;case"center":e="#"+r.MI+T.HALIGN+"_CENTER"+r.IDENTITY;break;case"end":e="#"+r.MI+T.HALIGN+"_RIGHT"+r.IDENTITY}if(I)switch(I){case"top":i="#"+r.MI+T.VALIGN+"_TOP"+r.IDENTITY;break;case"middle":i="#"+r.MI+T.VALIGN+"_MIDDLE"+r.IDENTITY;break;case"bottom":i="#"+r.MI+T.VALIGN+"_BOTTOM"+r.IDENTITY}document.getElementById(r.SUBMENUITEM+T.HALIGN+r.IDENTITY).querySelectorAll("li").forEach(function(e){e.id&&g.zmenu("#"+r.SUBMENUITEM+T.HALIGN+r.IDENTITY,"setMenuItemsAttribute",["#"+e.id],"checked",!1)}),g.zmenu("#"+r.SUBMENUITEM+T.HALIGN+r.IDENTITY,"setMenuItemsAttribute",[e],"checked",!0),g.zmenu("#"+r.SUBMENUITEM+T.HALIGN+r.IDENTITY,"setMenuItemsAttribute",[i],"checked",!0)}()})}function m(e,n,a,T){var o=i.data.getWorkBook(e,a);t=o.CellStyle.getStyleDef(T.Format)[9],I=o.CellStyle.getStyleDef(T.Format)[10];var l=T.CellType;t||"FLOAT"!==l&&"NUMBER"!==l&&"PERCENTAGE"!==l&&"CURRENCY"!==l&&"ACCOUNTING"!==l&&"DATE"!==l&&"TIME"!==l&&"DATETIME"!==l&&"FRACTION"!==l&&"SCIENTIFIC"!==l&&"BOOLEAN"!==l&&"SSN"!==l&&"ZIPCODE"!==l&&"ZIPCODE4"!==l&&"PHONENUMBER"!==l||(t="end")}A(E),i.view.SubMenu.transient[T.HALIGN]=A,i.view.Toolbar.transient.destructor[T.HALIGN]=function(){t=void 0}}(this);
!function(e){var t,n,o,r,i,s,c,a,l,d=e.sPlusPlus,u=e.document,E=e.ZSEvents,v=E.topic,I=E.Groups,p=E.Names,D=e.ZSConstants.FeatureConstants,R=(e.ZSConstants.ActionConstants,u.getElementById("popupmenu")),T=e.UIUtil.Component,m=(e.ZSConstants.I18N,e.ZSConstants.wCC),b=d.view.Toolbar.Feature[D.BORDER],y=(d.view.Events.Key,e.JSUtil),C="rgb(0, 0, 0)",g=17;function O(t,n){var r=C.substring(4,C.length-1).split(","),i=o.children[0].getAttribute("category")+" "+y.fn.rgbToHex(r),s=d.view.getActiveGridID(),c=d.view.getResourceID(s),a=(d.view.getSheetID(s),d.view.getVersionID(s)),l=d.view.getSelectedSheets(s),u=n?n.bt:g;g=u,e.UserAction.BORDER(c,l,a,u,i),n&&v.publish(I.Listener,p.FormatAction.ONCHANGE_BORDER_DATA,{BORDER_INFO:n})}function S(e){e.stopPropagation();var n=this.innerHTML;(o.innerHTML=n,o.children[0].id="bSa",t.style.display="none",i)&&O(0,{bt:i})}function B(e){l&&l.classList.remove("active"),this.classList.add("active"),l=this,i=this.getAttribute("bt"),c.innerHTML=l.innerHTML,O(0,{bt:i})}var L=!1;function A(e){L?(t.style.display="none",L=!1):(t.style.display="block",L=!0)}function N(e){L&&-1==e.path.indexOf(r)&&(t.style.display="none",L=!1)}b.execute=O,v.register(I.UI,p.Layout.TEMPLATE_LOADED,function(){(c=document.getElementById(m.MI+D.BORDER+m.IDENTITY)).addEventListener("click",O),a=document.getElementById(m.SUBMENUITEM+D.BORDER+m.SPLIT+m.IDENTITY);var e=UserAction.getTemplate(["BORDER_TEMPLATE"]).BORDER_TEMPLATE.querySelector("#borderMenu");s=e,R.appendChild(e),T.zpopover(a,{isContentHTMLEncoded:!0,className:"bdrpop",content:"#borderMenu",open:function(){document.body.classList.add("rangeBdrRmv")},close:function(){i=void 0,t.style.display="none",L=!1,document.body.classList.remove("rangeBdrRmv"),l&&l.classList.remove("active"),l=void 0}}),function(e){t=e.querySelector("#bdrDrpDwn"),n=e.querySelector("#sbF"),o=e.querySelector("#bdrSelBox"),r=e.querySelector("#dropDownPart");var s,c=e.querySelector("#borderVariety");n.addEventListener("click",A),e.addEventListener("click",N);for(var a=e.querySelector("#bdrDrpDwnList").children,l=0;l<a.length;l++)a[l].addEventListener("click",S);a=c.children;for(var l=0;l<a.length;l++)a[l].addEventListener("click",B);s=e.querySelector("#borderColorPalette"),T.bind(s,"zcolorselectpick",function(e,t){C=t.rgb,i&&O(0,{bt:i})}),UIUtil.Component.initComponent(s)}(s)}),v.register(I.UI,p.Toolbar.DROPDOWN_CLICK,function(e){"TB_HOME_CONTAINER"==e.relatedPaneId&&setTimeout(function(){document.querySelector("#menuitem_"+m.MI+D.BORDER+m.IDENTITY)},100)},"UI")}(this),function(e){var t=e.sPlusPlus,n=e.ZSEvents,o=n.topic,r=n.Groups,i=n.Names,s=e.ZSConstants.FeatureConstants,c=e.document,a=(e.ZSConstants.I18N,e.ZSConstants.wCC),l=e.UIUtil.Component;e.ZSConstants.ActionConstants.BORDER_BOTTOM,t.view.Toolbar.Feature[s.BORDER];o.register(r.Listener,i.FormatAction.ONCHANGE_BORDER_DATA,u,"BORDER_INFO");var d=c.getElementById(a.MI+s.BORDER+a.IDENTITY);function u(e){var t=d?d.parentElement.parentElement:void 0;e.bt;var n="#"+t.id;l.zbutton(n,"changeIcon",{primary:e.icon},"#"+a.MI+s.BORDER+a.IDENTITY)}}(this);
!function(r){var o=r.UserAction;function t(){this.border={colour:"0.0138in solid",thickNess:"#000000"}}t.prototype={setBackgroundColour:function(r){this.border.colour=r},setBorderThickness:function(r){this.border.thickNess=r},getBorderStyle:function(){return this.border.thickNess+" "+this.border.colour},resetDefault:function(){this.border={colour:"0.0138in solid",thickNess:"#000000"}}},o.BorderManager=t}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,i=n.topic,a=n.Groups,r=n.Names,u=e.ZSConstants.FeatureConstants,s=(e.document,e.UserAction,e.ZSConstants.wCC,e.ZSConstants.CommandConstants);e.UIUtil.Component;i.register(a.Listener,r.DocMeta.DOC_SETTINGS,function(e){e&&e[s.DATE]&&(e=e[s.DATE],t.view.SubMenu.transient[u.DATE](e))},"DOC_SETTINGS")}(this),function(e){var t,n,i,a,r=e.sPlusPlus,u=e.ZSConstants.FeatureConstants,s=e.document,o=e.ZSConstants.wCC,T=s.getElementById("popupmenu"),E=e.ZSConstants.I18N,c=e.ZSConstants.CommandConstants,D=e.UIUtil.Component,m=e.ZSEvents,A=m.topic,l=m.Groups,I=e.JSUtil,d=m.Names,C=r.view.Toolbar.Feature[u.DATE];function S(e,t,n,i){var a=document.createElement("li");a.setAttribute("data",'{"label":"'+t+'"}'),a.setAttribute("data-item-type","itemgroup"),i.appendChild(a),function(e,t,n){if(!e)return;for(var i=e.length-1;i>=0;i--)if(void 0!=e[i])for(var a in e[i]){var r=e[i][a],u='{"label":"'+a+'"}',s=document.createElement("li");s.setAttribute("data",u),s.setAttribute("data-shortcutkey",r),s.setAttribute("data-skip-shortcut-format",!0),s.addEventListener("click",v.bind(null,t,r)),n.appendChild(s)}}(n,e,i)}function v(t,n){var i=r.view.getActiveGridID(),a=r.view.getResourceID(i),u=(r.view.getSheetID(i),r.view.getVersionID(i)),s=r.view.getSelectedSheets(i);e.UserAction.FORMAT_DATE(a,s,u,t,n)}function p(e,t){t.preventDefault();var n=r.view.getActiveGridID(),u=r.view.getResourceID(n),s=r.view.getSheetID(n),o=r.view.getVersionID(n),T=r.view.getSheetState(n,s),E=(r.view.getSelectedSheets(n),T.getRanges()[0],"");E="TIME"==e?I.Date.currentTime():"DATEANDTIME"==e?I.Date.currentDate(a,i)+" "+I.Date.currentTime():I.Date.currentDate(a,i),A.publish(l.Gesture.Selector.CellEdit,d.GESTURE.ACTION.ACTUATE,{RID:u,SHEETID:s,VERSION:o}),A.publish(l.Listener,d.CellAction.VALUE.SET,{RID:u,SHEETID:s,VERSION:o,ROW:T.getActiveRow(),COL:T.getActiveCol(),VALUE:{DisplayValue:E},FOCUS:!0})}function M(e){p("DATE",e)}C.execute=M,C.currentDate=M,C.currentTime=function(e){p("TIME",e)},C.currentDateAndTime=function(e){p("DATEANDTIME",e)},A.register(l.Listener,d.DocMeta.DOCUMENT_LOCALE,function(e,t){e&&(i=e,a=t)},"DATE_SEPARATOR","LOCALE_DATEFORMAT"),r.view.SubMenu.transient[u.DATE]=function(e){var i=e[c.FORMAT_DATE],a=e[c.TIME],r=e[c.TIME_DURATION],s=e[c.DEFAULT_DATETIME];!function(e,n,i){var a=!1;t?(t.innerHTML="",a=!0):((t=document.createElement("ul")).id=o.SUBMENUITEM+u.DATE+o.IDENTITY,t.setAttribute("data-mtype","submenu"),T.appendChild(t)),S("Date",E["MenuItem.FormatTab.Date"],e,t),S("DateTime",E["MenuItem.FormatTab.DateAndTime"],i.concat(n),t),a&&(D.zmenu(t,"destroy"),D.zmenu(t))}(i,e[c.DATETIME],s),function(e,t){var i=!1;n?(n.innerHTML="",i=!0):((n=document.createElement("ul")).id=o.SUBMENUITEM+"DURATION"+o.IDENTITY,n.setAttribute("data-mtype","submenu"),T.appendChild(n)),S("Time",E["MenuItem.FormatTab.Time"],e,n),S("Time",E["MenuItem.FormatTab.Duration"],t,n),i&&(D.zmenu(n,"destroy"),D.zmenu(n))}(a,r)}}(this);
!function(e){var t,n=e.sPlusPlus,r=e.ZSEvents,o=r.topic,a=r.Groups,i=r.Names,s=e.ZSConstants.FeatureConstants,C=e.document,l=e.ZSConstants.I18N,u=e.ZSConstants.wCC,c=e.UIUtil.Component,R=e.ZSConstants.CommandConstants,E="en_US",d=(c=e.UIUtil.Component,n.view.Toolbar.Feature[s.CURRENCY]),g=C.getElementById(u.MI+s.CURRENCY+u.IDENTITY),N=g&&g.parentElement;d.execute=function(){for(var t=n.view.getActiveGridID(),r=n.view.getResourceID(t),o=(n.view.getSheetID(t),n.view.getVersionID(t)),a=n.view.getSelectedSheets(t),i=E,s=i.substring(0,i.indexOf("_")),C=i.substring(i.indexOf("_")+1,i.length),l=0;l<n.data.AppRegistry.localeInfo.EURO_LIST.length;l++){var u=n.data.AppRegistry.localeInfo.EURO_LIST[l];C===u.KEY.substring(u.KEY.indexOf("(")+1,u.KEY.length-1)&&(i=s+"_FR")}e.UserAction.FORMAT_CURRENCY(r,a,o,i)},o.register(a.Listener,i.DocMeta.DOC_SETTINGS,function(e){if(e&&e[R.CURRENCY]){var r=(t=e[R.CURRENCY])[R.WORKBOOKLOCALE].language,o=t[R.WORKBOOKLOCALE].country;E=r+"_"+o,t.currencyType=E,N&&c.doToolbarAction(N.id,{item:s.CURRENCY,action:"changeLabel",callback:function(){c.zbutton(N,"changeLabel",t[R.CURRENCYSYMBOL],g.id),document.querySelector("#"+g.id).title=l[t[R.CURRENCYNAME]]}}),n.view.SubMenu.transient[s.CURRENCY](t)}},"DOC_SETTINGS"),o.register(a.Listener,i.FormatAction.ONCHANGE_CURRENCY,function(e){e.type&&(c.zbutton(N,"changeLabel",e.iconText,g.id),document.querySelector("#"+g.id).title=e.label,E=e.type)},"CURRENCY_INFO")}(this),function(e){var t,n,r=e.sPlusPlus,o=e.document,a=e.ZSConstants.FeatureConstants,i=e.ZSConstants.wCC,s=e.ZSConstants.I18N,C=e.UIUtil.Component,l=e.ZSEvents,u=(l.topic,l.Groups,l.Names,e.ZSConstants.CommandConstants),c=o.getElementById("popupmenu");r.view.Toolbar.Feature[a.CURRENCY];function R(a,i){var s=o.createElement("li");s.setAttribute("data-icon-text",a.CURRENCY),s.setAttribute("data-label",i),s.addEventListener("click",function(t){var o=r.view.getActiveGridID(),a=r.view.getResourceID(o),i=r.view.getSelectedSheets(o),s=r.view.getVersionID(o),C=function(e){return{formatType:"CURRENCY",frmtAction:"generate",negFrmt:0,thousandsep:!0,decimals:2,leadingzeroes:1,language:n,symbol:e.KEY.substring(e.KEY.indexOf("(")+1,e.KEY.length-1)}}(t);e.UserAction.FORMATCELLS_GRID(a,i,s,null,null,C)}.bind(null,a)),t.appendChild(s)}r.view.SubMenu.transient[a.CURRENCY]=function(l){var E=l[u.WORKBOOKLOCALE];n=E.language+"("+E.country+")";var d=l[u.CURRENCYNAME],g=!1;t?(t.innerHTML="",g=!0):((t=o.createElement("li")).id=i.SUBMENUITEM+a.CURRENCY+i.IDENTITY,t.setAttribute("data-content-type","icon-text"),t.setAttribute("data-ctype","zmenu"),c.appendChild(t));var N=r.data.AppRegistry.localeInfo;if(N){var I=N.CURRENCY_MAP,U=N.CURRENCY_LIST_WITH_UNIQUES;for(var f in I)-1!=f.indexOf(E.country)&&(n=f);if(-1==U.indexOf(n))for(f=0;f<U.length;f++){var p=U[f];I[p].CURRENCY_NAME===I[n].CURRENCY_NAME&&(n=p)}var v={"en(US)":"Format.Currency.USDollar","fr(FR)":"Format.Currency.Euro","en(GB)":"Format.Currency.BritishPound","zh(CN)":"Format.Currency.ChineseYuan","en(IN)":"Format.Currency.IndianRupee"};for(var f in N.TOP_CURRENCY_LIST=v,-1==Object.keys(v).indexOf(n)&&I[n]&&!function(t){if(!r.data.AppRegistry.localeInfo)return e.ZSDevTools.Logger.log("Locale Info Empty. Please chcek API call response"),!1;var n=r.data.AppRegistry.localeInfo.TOP_CURRENCY_LIST;for(var o in n)if(s[n[o]]===t)return!0;return!1}(s[d])&&R(I[n],s[d]),v){var S=v[f];R(I[f],s[S])}c.appendChild(t),g&&(C.zmenu(t,"destroy"),C.zmenu(t))}else e.ZSDevTools.Logger.log("Locale Info Empty. Please chcek API call response")},r.view.Toolbar.transient.destructor[a.CURRENCY]=function(){}}(this);
!function(e){var t,n=e.sPlusPlus,o=e.ZSEvents,a=o.topic,i=o.Groups,r=o.Names,s=e.ZSConstants.FeatureConstants,C=e.document,l=e.ZSConstants.I18N,c=e.ZSConstants.wCC,u=e.UIUtil.Component,N=e.ZSConstants.CommandConstants,I="en_US",d=(u=e.UIUtil.Component,n.view.Toolbar.Feature[s.ACCOUNTING]),E=C.getElementById(c.MI+s.ACCOUNTING+c.IDENTITY),R=E&&E.parentElement;d.execute=function(){var t=n.view.getActiveGridID(),o=n.view.getResourceID(t),a=(n.view.getSheetID(t),n.view.getVersionID(t)),i=n.view.getSelectedSheets(t);e.UserAction.FORMAT_ACCOUNTING(o,i,a,I)},a.register(i.Listener,r.DocMeta.DOC_SETTINGS,function(e){if(e&&e[N.CURRENCY]){var o=(t=e[N.CURRENCY])[N.WORKBOOKLOCALE].language,a=t[N.WORKBOOKLOCALE].country;I=o+"_"+a,t.currencyType=I,R&&u.doToolbarAction(R.id,{item:s.ACCOUNTING,action:"changeLabel",callback:function(){u.zbutton(R,"changeLabel",t[N.CURRENCYSYMBOL],E.id),document.querySelector("#"+E.id).title=l[t[N.CURRENCYNAME]]}}),n.view.SubMenu.transient[s.ACCOUNTING](t)}},"DOC_SETTINGS"),a.register(i.Listener,r.FormatAction.ONCHANGE_CURRENCY,function(e){e.type&&(u.zbutton(R,"changeLabel",e.iconText,E.id),document.querySelector("#"+E.id).title=e.label,I=e.type)},"CURRENCY_INFO")}(this),function(e){var t,n,o=e.sPlusPlus,a=e.document,i=e.ZSConstants.FeatureConstants,r=e.ZSConstants.wCC,s=e.ZSConstants.I18N,C=e.UIUtil.Component,l=e.ZSEvents,c=(l.topic,l.Groups,l.Names,e.ZSConstants.CommandConstants),u=a.getElementById("popupmenu");o.view.Toolbar.Feature[i.CURRENCY];function N(i,r){var s=a.createElement("li");s.setAttribute("data-icon-text",i.CURRENCY),s.setAttribute("data-label",r),s.addEventListener("click",function(t){var a=o.view.getActiveGridID(),i=o.view.getResourceID(a),r=o.view.getSelectedSheets(a),s=o.view.getVersionID(a),C=function(e){return{formatType:"ACCOUNTING",frmtAction:"generate",thousandsep:!0,decimals:2,leadingzeroes:1,language:n,symbol:e.KEY.substring(e.KEY.indexOf("(")+1,e.KEY.length-1)}}(t);e.UserAction.FORMATCELLS_GRID(i,r,s,null,null,C)}.bind(null,i)),t.appendChild(s)}o.view.SubMenu.transient[i.ACCOUNTING]=function(l){var I=l[c.WORKBOOKLOCALE];n=I.language+"("+I.country+")";var d=l[c.CURRENCYNAME],E=!1;t?(t.innerHTML="",E=!0):((t=a.createElement("li")).id=r.SUBMENUITEM+i.ACCOUNTING+r.IDENTITY,t.setAttribute("data-content-type","icon-text"),t.setAttribute("data-ctype","zmenu"),u.appendChild(t));var R=o.data.AppRegistry.localeInfo;if(R){var v=R.TOP_CURRENCY_LIST,U=R.CURRENCY_MAP,g=R.CURRENCY_LIST_WITH_UNIQUES;for(var A in U)-1!=A.indexOf(I.country)&&(n=A);if(-1==g.indexOf(n))for(A=0;A<g.length;A++){var T=g[A];U[T].CURRENCY_NAME===U[n].CURRENCY_NAME&&(n=T)}for(var A in-1==Object.keys(v).indexOf(n)&&U[n]&&!function(t){if(!o.data.AppRegistry.localeInfo)return e.ZSDevTools.Logger.log("Locale Info Empty. Please chcek API call response"),!1;var n=o.data.AppRegistry.localeInfo.TOP_CURRENCY_LIST;for(var a in n)if(s[n[a]]===t)return!0;return!1}(s[d])&&N(U[n],s[d]),v){var O=v[A];N(U[A],s[O])}u.appendChild(t),E&&(C.zmenu(t,"destroy"),C.zmenu(t))}else e.ZSDevTools.Logger.log("Locale Info Empty. Please chcek API call response")},o.view.Toolbar.transient.destructor[i.ACCOUNTING]=function(){}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,o=n.topic,i=n.Groups,l=n.Names,a=e.ZSConstants.FeatureConstants,E=e.UIUtil.Component,s=e.document,c=(e.ZSConstants.I18N,e.ZSConstants.wCC),r=(e.ZSConstants.JSKeyCode,E=e.UIUtil.Component,t.view.Toolbar.Feature[a.PERCENTAGE]);function C(e,t,n,o){var i="PERCENTAGE"===(void 0!=o?o.CellType:"")?"check":"uncheck",l=s.getElementById(c.MI+a.PERCENTAGE+c.IDENTITY);l&&E.doToolbarAction(l.parentElement.id,{item:a.PERCENTAGE,action:i,callback:function(){E.zbutton("#"+l.parentElement.id,i,"#"+l.id)}})}o.register(i.Listener,l.SheetAction.ACTIVE_CELL.INFO,C,"RID","SHEETID","VERSION","VALUE"),r.execute=function(n){var o,i=t.view.getActiveGridID(),l=t.view.getResourceID(i),a=t.view.getSheetID(i),E=t.view.getVersionID(i),s=t.view.getSheetState(i,a).Cell,c=s.row,r=s.col;t.view.fetchCellData(l,a,E,c,r,["DisplayValue","ActualValue","Format","Formula","CellComment","Hyperlink","CellType"],i,function(e){o=e[c][r]},function(t){e.ZSClass.Logger.log("couldn't retrieve data",t)});var C=void 0!=o?o.CellType:"",u=t.view.getSelectedSheets(i);"PERCENTAGE"===C?e.UserAction.FORMAT_PERCENT(l,u,E,"STANDARD"):e.UserAction.FORMAT_PERCENT(l,u,E)}}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSEvents,n=(i.topic,i.Groups,i.Names,e.ZSConstants.FeatureConstants),s=(e.document,e.ZSConstants.I18N,e.ZSConstants.wCC,e.UIUtil.Component,t.view.Toolbar.Feature[n.INCREASE_DEC]);function o(i){var n=t.view.getActiveGridID(),s=t.view.getResourceID(n),o=t.view.getVersionID(n);t.view.getSheetID(n);!function(i,n,s,o){if(i.repeat)return;var r=t.view.getActiveGridID(),u=t.view.getSelectedSheets(r);e.UserAction.FORMAT_INCREMENT_DECIMAL(n,u,o)}(i,s,0,o)}s.execute=o,s.ShortCut=o}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSEvents,n=(i.topic,i.Groups,i.Names,e.ZSConstants.FeatureConstants),s=(e.document,e.ZSConstants.I18N,e.ZSConstants.wCC,e.UIUtil.Component,t.view.Toolbar.Feature[n.DECREASE_DEC]);function o(i){var n=t.view.getActiveGridID(),s=t.view.getResourceID(n),o=t.view.getVersionID(n);t.view.getSheetID(n);!function(i,n,s,o){if(i.repeat)return;var r=t.view.getActiveGridID(),u=t.view.getSelectedSheets(r);e.UserAction.FORMAT_DECREMENT_DECIMAL(n,u,o)}(i,s,0,o)}s.execute=o,s.ShortCut=o}(this);
!function(e){var t,i,r=e.sPlusPlus,o=e.document,a=(e.UserAction,e.ZSConstants),s=a.FeatureConstants,n=e.ZSEvents,l=n.topic,c=n.Groups,g=n.Names,v=o.getElementById("popupmenu"),d=a.I18N,I=a.wCC,S=e.UIUtil.Component,A=e.ZSConstants.JSKeyCode,u=r.data.Defaults.MAX_ROW,D=r.view.Toolbar.Feature[s.FILTER],w=0,E=1,C=2,F=3,T=4,R=!1;if(-1!=ZSConstants.Meta.HideFeaturesList.indexOf(s.USER_LEVEL_FILTER)){!function(){var e={id:I.SUBMENUITEM+s.FILTER+I.IDENTITY,"data-ctype":"zmenu","data-min-width":150},t=[{id:"cellValueFilter",data:'{"label":"'+d["MenuItem.HomeTab.Filter.CellValue"]+'", "action": '+w+"}"},{id:"cellColorFilter",data:'{"label":"'+d["MenuItem.HomeTab.Filter.CellColor"]+'", "action": '+E+"}"},{id:"textColorFilter",data:'{"label":"'+d["MenuItem.HomeTab.Filter.TextColor"]+'", "action": '+C+"}"},{id:"clearFilter",data:'{"label":"'+d["MenuItem.HomeTab.Filter.ClearFilter"]+'", "action": '+F+"}"},{mtype:"separator"},{id:"reApplyFilter",data:'{"shortcutkey":"Ctrl+Alt+L", "label":"'+d["MenuItem.HomeTab.Filter.Reapply"]+'", "action": '+T+"}"}];if(!R){r.view.Menu.create(t,e,v).then(function(){S.bind("#"+I.SUBMENUITEM+s.FILTER+I.IDENTITY,"zmenuitemclick",function(e,t){p(e,void 0,void 0,void 0,t.data)})});var i=o.getElementById(e.id);S.bind(i,"zmenubeforeshow",function(){!function(){var e=r.view.getActiveGridID(),t=r.view.getResourceID(e),i=r.view.getSheetID(e),o=r.view.getVersionID(e),a=r.data.getWorkBook(t,o).getSheetObj(i),n=r.view.getSheetState(e,i).getActiveCellRange().startCol,l=!1,c=!1,g=a.DataFilters.getAllRanges();for(var v in g){var d=g[v],A=d.properties;l=!!(A&&A.appliedColumns&&A.appliedColumns.length),c=!(!l||-1===A.appliedColumns.indexOf(n))}var u=!l,D=!c;S.zmenu("#"+I.SUBMENUITEM+s.FILTER+I.IDENTITY,"setMenuItemsAttribute",["#clearFilter"],"disabled",D),S.zmenu("#"+I.SUBMENUITEM+s.FILTER+I.IDENTITY,"setMenuItemsAttribute",["#reApplyFilter"],"disabled",u)}()}),R=!0}}();var h,m,f={};L(),D.execute=p,D.reApply=O,l.register(c.UI,g.Menu.SHOW_FILTER_OPTION,function(o,a,s,n,l,c){if(e.isCanvasGrid)!function(e,o,a,s,n,l){var c={dateFormat:i};if(f.isFilterDialogOpen||f.col!=o){f.isFilterDialogOpen=!1,f.col=o;var g=r.view.getActiveGridID(),v=r.view.getResourceID(g),d=r.view.getSheetID(g),I=r.view.getVersionID(g),S=r.data.getWorkBook(v,I),A=S.ProtectedSheets.isSheetLocked(d);if(S.isEditable()&&!A){var u={applyFilter:B,clearFilter:V,sortFilter:H,dialogClose:b};t||(t=new ZSClass.Filter.Dialog(u,c),x());var D=r.view.getGridComponent(g),w=D.getHeights(),E=D.getWidths(),C=E[1]+E[2],F=w[1]+w[2],T=t.getDialogPos(),R=T.height,h=T.width,m=D.getZoom();a*m+h>C&&(a=a-h/m<0?n+p:a-h/m+n);var p=r.view.measures.gridLeft,O=r.view.measures.gridTop,L=!1;s*m+R>F&&(s=s-R/m<0?O:s-R/m-l,L=!0),t.show(s*m+l,a*m,L),y(),k(v,d,I,e,o)}}else U()}(o,a,s,n,l,c);else{var g={dateFormat:i};if(f.isFilterDialogOpen||f.col!=a){f.isFilterDialogOpen=!1,f.col=a;var v=r.view.getActiveGridID(),d=r.view.getResourceID(v),I=r.view.getSheetID(v),S=r.view.getVersionID(v),A=r.data.getWorkBook(d,S),u=A.ProtectedSheets.isSheetLocked(I);if(A.isEditable()&&!u){var D=r.view.getGridComponent(v);e.isCanvasGrid||(D.allowToScroll=!1);var w=r.view.getSheetState(v,I),E=w.getZoom(),C=A.getSheetObj(I),F=(s=C.Column.auxiliaryAxis.getPos(a),n=C.Row.auxiliaryAxis.getPos(o),C.Row.auxiliaryAxis.getDim(o)*E),T=(C.Column.auxiliaryAxis.getDim(a)-l)*E,R=C.Row.FreezedCount,h=a>=C.Column.FreezedCount,m=o>=R,p={applyFilter:B,clearFilter:V,sortFilter:H,dialogClose:b};t||(t=new ZSClass.Filter.Dialog(p,g),x());var O=t.getDialogPos(),L=O.height,N=O.width,G=w.getScrollLefts(),P=w.getScrollTops(),M=w.getScreenWidths(),W=w.getScreenHeights(),_=h?G[0]-M[1]:G[1],Z=m?P[0]-W[1]:P[1],j=M[0]+M[1],Y=W[0]+W[1];s=0+s*E-_,n=0+n*E-Z,n=Math.max(n,0),s=Math.max(s,0);var z=r.view.measures.gridLeft,K=r.view.measures.gridTop;s=s+z+T;var J=!1;(n=n+K+F)+L>=Y&&(n=n-L<0?K:n-L-c,J=!0),s+N>=j&&(s=s-N<0?l+z:s-N+l),t.show(n,s,J),y(),k(d,I,S,o,a)}}else U()}},"ROW","COL","LEFT","TOP","WIDTH","HEIGHT"),l.register(c.Listener,g.SheetAction.ACTIVE_CELL.INFO,U),l.register(c.UI,g.Menu.SHOW_PIVOTFILTER_OPTION,U),l.register(c.UserAction,g.SheetAction.DATAFILTER.FILTER_INFO,M,"data","INDEX","clientData"),l.register(c.UserAction,g.SheetAction.DATAFILTER.FILTER_DATA,P,"RID","SHEETID","VERSION","RANGE","COL","INDEX","DATA"),l.register(c.UserAction,g.SheetAction.DATAFILTER.ONAPPLY,G,"TYPE"),l.register(c.UserAction,g.SheetAction.DATAFILTER.REMOVE,G,"TYPE"),l.register(c.Listener,g.DocAction.WORKSHEETS.SWITCHSHEET,W,"RID","NEWSHEETID","VERSION"),l.register(c.UI,g.Layout.DEFER_JS_LOADED,W,"RID","SHEETID","VERSION"),l.register(c.UserAction,g.SheetAction.SCROLL_POSITION.DummyScroll,U),l.register(c.UI,g.Toolbar.DIALOG_OPEN,U),l.register(c.Listener,g.DocMeta.DOCUMENT_LOCALE,function(r,o){i=e.JSUtil.Range.getDateFormat(r,o),t&&t.changeDateFormat(i)},"DATE_SEPARATOR","LOCALE_DATEFORMAT"),l.register(c.UserAction,g.SheetAction.DATAFILTER.ONAPPLY,function(t,i,o){if(void 0!=h){var a=r.view.getActiveGridID(),s=m,n=h,l=new ZSClass.Range(n,s,n,s),c=r.view.getGridComponent(a);!(e.isCanvasGrid?c.isViewPortIntersects(l.startRow,l.startCol,l.endRow,l.endCol):c.isViewPortIntersects(l))&&e.UserAction.ScrollCellIntoView(t,i,o,n,s),h=void 0,m=void 0}},"RID","SHEETID","VERSION")}function p(t,i,o,a,s){var n=r.view.getActiveGridID(),l=(i=r.view.getResourceID(n),a=r.view.getVersionID(n),r.view.getSelectedSheets(n)),c=(o=r.view.getSheetID(n),r.data.getWorkBook(i,a).getSheetObj(o).DataFilters),g=r.view.getSheetState(n,o).getActiveCol();if(s)switch(s.action){case w:e.UserAction.FilterByCellValue(i,l,a);break;case E:e.UserAction.FilterByCellColor(i,l,a);break;case C:e.UserAction.FilterByTextColor(i,l,a);break;case F:var v=new ZSClass.Range(0,g,u-1,g),d=g-c.getIntersectedRanges(v)[0].startCol;e.UserAction.ClearFilter(i,l,a,v,d);break;case T:O(t)}else c.isRangesAvailable()?e.UserAction.RemoveFilter(i,l,a):e.UserAction.AddFilter(i,l,a)}function O(t){var i=r.view.getActiveGridID(),o=r.view.getResourceID(i),a=r.view.getVersionID(i),s=r.view.getSelectedSheets(i);e.UserAction.ReApplyFilter(o,s,a),t.preventDefault()}function L(){f={isFilterDialogOpen:!0,col:void 0}}function b(){var t=r.view.getActiveGridID(),i=r.view.getGridComponent(t);e.isCanvasGrid||(i.allowToScroll=!0),L()}function U(){if(t&&!f.isFilterDialogOpen){t.close();var e=r.view.Events.Key;e.focusContext(e.Entry.CellEditor.Context)}}function y(){var e=r.view.Events.Key;e.focusContext(e.Entry.Filter.Context)}function x(){var e=r.view.Events.Key.Entry.Filter.Context.keyDown;e[A.ESC]=function(){U()},e[A.PURE_PRINTABLE_CHAR]=N,e[A.TAB]=N,e[A.SUPER+"+"+A.V]=N,e[A.LEFT]=N,e[A.RIGHT]=N,e[A.UP]=N,e[A.DOWN]=N,e[A.ENTER]=N,e[A.SUPER+"+"+A.A]=N}function N(){return!1}function k(i,o,a,s,n){var l=r.data.getWorkBook(i,a).getSheetObj(o),c=r.view.getActiveGridID(),g=(r.view.getSelectedSheets(c),l.DataFilters),v=new ZSClass.Range(s,n,s,n),d=n-g.getIntersectedRanges(v)[0].startCol;t.index=d,e.UserAction.GetFilterInfo(i,[o],a,v,n,d,void 0,void 0)}function G(e){var t=o.getElementById(I.MI+s.FILTER+I.IDENTITY);t&&t.parentElement.classList[e]("shIconActive");"remove"==e&&U()}function P(t,i,o,a,s,n,l){var c=r.data.getWorkBook(t,o).getSheetObj(i),g=r.view.getActiveGridID(),v=(r.view.getSelectedSheets(g),c.DataFilters.getIntersectedRanges(a)[0]);if(Object.keys(l).length){var d={};d.cD=l.DisplayValue,d.tcs=l.Format.color,d.ccs=l.Format.bgColor,v.properties.data[n]?M(v.properties.data[n],d):e.UserAction.GetFilterInfo(t,[i],o,a,s,n,!1,d)}else e.UserAction.GetFilterInfo(t,[i],o,a,s,n,void 0,void 0)}function M(e,i,r){void 0!=r&&(e.cD=r.cD,e.ccs=r.ccs,e.tcs=r.tcs),i==t.index&&t.generateData(e)}function V(t){var i=r.view.getActiveGridID(),o=r.view.getResourceID(i),a=r.view.getSelectedSheets(i),s=r.view.getVersionID(i),n=r.view.getSheetID(i),l=r.data.getWorkBook(o,s).getSheetObj(n),c=f.col,g=new ZSClass.Range(0,c,u-1,c),v=r.view.getSheetState(i,n),d=v.getScrollTops()[0],I=v.getScrollLefts()[0];h=l.Row.auxiliaryAxis.findAbs(d),m=l.Column.auxiliaryAxis.findAbs(I),e.UserAction.ClearFilter(o,a,s,g,t)}function B(t,i,o,a,s,n,l,c){var g=r.view.getActiveGridID(),v=r.view.getResourceID(g),d=r.view.getSelectedSheets(g),I=r.view.getVersionID(g),S=r.view.getSheetID(g),A=r.data.getWorkBook(v,I).getSheetObj(S),D=A.DataFilters,w=f.col,E=new ZSClass.Range(0,w,u-1,w),C=D.getIntersectedRanges(E)[0],F=new ZSClass.Range(C.startRow,C.startCol,C.endRow,C.endCol),T=r.view.getSheetState(g,S),R=T.getScrollTops()[0],p=T.getScrollLefts()[0];h=A.Row.auxiliaryAxis.findAbs(R),m=A.Column.auxiliaryAxis.findAbs(p),e.UserAction.ApplyFilter(v,d,I,F,t,i,o,a,s,n,l,c)}function H(t){var i=r.view.getActiveGridID(),o=r.view.getResourceID(i),a=r.view.getSelectedSheets(i),s=r.view.getVersionID(i),n=r.view.getSheetID(i),l=r.data.getWorkBook(o,s).getSheetObj(n).DataFilters,c=(r.view.getSheetState(i,n),f.col),g=new ZSClass.Range(0,c,u-1,c),v=l.getIntersectedRanges(g)[0],d=g.startCol-v.startCol,I=[],S={};S.f=d,S.s="ASC"==t,I.push(S),e.UserAction.executeSort(o,a,s,I,v,!1,!0,!1,1)}function W(e,t,i){G(r.data.getWorkBook(e,i).getSheetObj(t).DataFilters.isRangesAvailable()?"add":"remove")}}(this);
!function(e){var t=e.sPlusPlus,i=e.document,r=(e.UserAction,e.ZSConstants),l=r.FeatureConstants,n=e.UIUtil,a=e.ZSEvents,o=a.topic,s=a.Groups,c=a.Names,d=i.getElementById("popupmenu"),u=r.I18N,I=r.wCC,v=e.UIUtil.Component,g=e.ZSConstants.JSKeyCode,m=t.data.Defaults.MAX_ROW;if(-1==r.Meta.HideFeaturesList.indexOf(l.USER_LEVEL_FILTER)){var S,E,T,F,A,f,D,y,w=t.view.Toolbar.Feature[l.FILTER],b=0,p=1,R=2,C=3,h=4,M=5,U=8,N=9,L=10,k=11,O=12,q=13,B=14,x=!1,V=!1,_=void 0;!function(){var e={id:I.SUBMENUITEM+l.FILTER+I.IDENTITY,"data-ctype":"zmenu","data-min-width":150},r=[{id:"createFilter",data:'{"label":"'+u["MenuItem.HomeTab.Filter.CreateFilter"]+'", "action": '+O+"}"},{id:"removeFilter",data:'{"label":"'+u["MenuItem.HomeTab.Filter.RemoveFilter"]+'", "action": '+q+"}"},{mtype:"separator"},{id:"reApplyFilter",data:'{"shortcutkey":"Ctrl+Alt+L", "label":"'+u["MenuItem.HomeTab.Filter.Reapply"]+'", "action": '+h+"}"},{id:"clearFilter",data:'{"label":"'+u["MenuItem.HomeTab.Filter.ClearFilter"]+'", "action": '+C+"}"},{mtype:"separator"},{id:"setAsDefaultFilter",data:'{"label":"'+u["MenuItem.HomeTab.Filter.SetAsDefaultFilter"]+'" , "action": '+M+"}"},{id:"saveFilterView",data:'{"label":"'+u["MenuItem.HomeTab.Filter.SaveAsFilterView"]+'" , "action": '+U+"}"},{id:"manageFilters",data:'{"label":"'+u["MenuItem.HomeTab.Filter.ManageFilters"]+'", "action": '+B+"}"}];if(!x){t.view.Menu.create(r,e,d).then(function(){v.bind("#"+I.SUBMENUITEM+l.FILTER+I.IDENTITY,"zmenuitemclick",function(e,t){Y(e,void 0,void 0,void 0,t.data)})});var a=i.getElementById(e.id);v.bind(a,"zmenubeforeshow",function(){var e,t=document.getElementById("setAsDefaultFilter");t.querySelector(".shInfoIcon")&&t.querySelector(".shInfoIcon").remove(),t.appendChild(((e=document.createElement("span")).classList.add("shInfoIcon","ml10","mt0","mr0","curPtr"),n.fn.addIcon(e,"infoLineIcon"),e.setAttribute("title",u["Filter.SetAsDefaultFilterView.ToolTip"]),e.setAttribute("data-title-max-display-time",1e4),e)),K(!0),P()}),!function(e){(T=document.createElement("li")).id="filterViewMenu",T.setAttribute("data",'{"label":"'+u["MenuItem.HomeTab.Filter.NamedFilters"]+'"}'),T.setAttribute("data-menu-id","filterViewSubMenu"),e.appendChild(T),t="filterViewSubMenu",i='{"type": "text_only"}',(F=document.createElement("ul")).id=t,F.setAttribute("data-ctype","zmenu"),F.setAttribute("data",'{"componentOptions":'+i),F.style.display="none",v.bind(F,"zmenubeforeshow",function(){!_&&!V&&T.classList.add("ZsMiRt")}),d.appendChild(F);var t,i}(a.querySelector("ul")),x=!0}}();var G=!1;!function(){var e={id:I.SUBMENUITEM+l.FILTER+"_CM"+I.IDENTITY,"data-ctype":"zmenu","data-min-width":150},r=[{id:"cellValueFilter",data:'{"label":"'+u["MenuItem.HomeTab.Filter.CellValue"]+'", "action": '+b+"}"},{id:"cellColorFilter",data:'{"label":"'+u["MenuItem.HomeTab.Filter.CellColor"]+'", "action": '+p+"}"},{id:"textColorFilter",data:'{"label":"'+u["MenuItem.HomeTab.Filter.TextColor"]+'", "action": '+R+"}"}];if(!G){t.view.Menu.create(r,e,d).then(function(){v.bind("#"+I.SUBMENUITEM+l.FILTER+"_CM"+I.IDENTITY,"zmenuitemclick",function(e,t){Y(e,void 0,void 0,void 0,t.data)})});var n=i.getElementById(e.id);v.bind(n,"zmenubeforeshow",function(){P()}),G=!0}}();var H,Z,z={};j(),w.execute=Y,w.reApply=W,o.register(s.UI,c.Menu.SHOW_FILTER_OPTION,function(i,r,l,n,a,o){if(e.isCanvasGrid)!function(e,i,r,l,n,a){var o={dateFormat:E};if(z.isFilterDialogOpen||z.col!=i){z.isFilterDialogOpen=!1,z.col=i;var s=t.view.getActiveGridID(),c=t.view.getResourceID(s),d=t.view.getSheetID(s),u=t.view.getVersionID(s),I=t.data.getWorkBook(c,u),v=I.ProtectedSheets.isSheetLocked(d);if(I.isEditable()&&!v){var g={applyFilter:Ee,clearFilter:Se,sortFilter:Te,dialogClose:oe};S||(S=new ZSClass.Filter.Dialog(g,o),de());var m=t.view.getSheetState(s,d),T=m.getScreenHeights(),F=m.getScreenWidths(),A=F[0]+F[1],f=T[0]+T[1],D=S.getDialogPos(),y=D.height,w=D.width,b=t.view.getGridComponent(s).getZoom();r*b+w>A&&(r=r-w/b<0?n+p:r-w/b+n);var p=t.view.measures.gridLeft,R=t.view.measures.gridTop,C=!1;l*b+y>f&&(l=l-y/b<0?R:l-y/b-a,C=!0),S.show(l*b+a,r*b,C),ce(),Ie(c,d,u,e,i)}}else se()}(i,r,l,n,a,o);else{var s={dateFormat:E};if(z.isFilterDialogOpen||z.col!=r){z.isFilterDialogOpen=!1,z.col=r;var c=t.view.getActiveGridID(),d=t.view.getResourceID(c),u=t.view.getSheetID(c),I=t.view.getVersionID(c),v=t.data.getWorkBook(d,I),g=v.ProtectedSheets.isSheetLocked(u);if(v.isEditable()&&!g){var m=t.view.getGridComponent(c);e.isCanvasGrid||(m.allowToScroll=!1);var T=t.view.getSheetState(c,u),F=T.getZoom(),A=v.getSheetObj(u),f=(l=A.Column.auxiliaryAxis.getPos(r),n=A.Row.auxiliaryAxis.getPos(i),A.Row.auxiliaryAxis.getDim(i)*F),D=(A.Column.auxiliaryAxis.getDim(r)-a)*F,y=A.Row.FreezedCount,w=r>=A.Column.FreezedCount,b=i>=y,p={applyFilter:Ee,clearFilter:Se,sortFilter:Te,dialogClose:oe};S||(S=new ZSClass.Filter.Dialog(p,s),de());var R=S.getDialogPos(),C=R.height,h=R.width,M=T.getScrollLefts(),U=T.getScrollTops(),N=T.getScreenWidths(),L=T.getScreenHeights(),k=w?M[0]-N[1]:M[1],O=b?U[0]-L[1]:U[1],q=N[0]+N[1],B=L[0]+L[1];l=0+l*F-k,n=0+n*F-O,n=Math.max(n,0),l=Math.max(l,0);var x=t.view.measures.gridLeft,V=t.view.measures.gridTop;l=l+x+D;var _=!1;(n=n+V+f)+C>=B&&(n=n-C<0?V:n-C-o,_=!0),l+h>=q&&(l=l-h<0?a+x:l-h+a),S.show(n,l,_),ce(),Ie(d,u,I,i,r)}}else se()}},"ROW","COL","LEFT","TOP","WIDTH","HEIGHT"),o.register(s.Listener,c.SheetAction.ACTIVE_CELL.INFO,se),o.register(s.UI,c.Menu.SHOW_PIVOTFILTER_OPTION,se),o.register(s.UserAction,c.SheetAction.DATAFILTER.FILTER_INFO,me,"data","INDEX","clientData"),o.register(s.UserAction,c.SheetAction.DATAFILTER.FILTER_DATA,ge,"RID","SHEETID","VERSION","RANGE","COL","INDEX","DATA"),o.register(s.UserAction,c.SheetAction.DATAFILTER.ONAPPLY,ve,"TYPE"),o.register(s.UserAction,c.SheetAction.DATAFILTER.REMOVE,ve,"TYPE"),o.register(s.Listener,c.DocAction.WORKSHEETS.SWITCHSHEET,function(e,i,r){ve(t.data.getWorkBook(e,r).getSheetObj(i).DataFilters.isRangesAvailable()?"add":"remove")},"RID","NEWSHEETID","VERSION"),o.register(s.UserAction,c.SheetAction.SCROLL_POSITION.DummyScroll,se),o.register(s.UI,c.Toolbar.DIALOG_OPEN,se),o.register(s.Listener,c.DocMeta.DOCUMENT_LOCALE,function(t,i){E=e.JSUtil.Range.getDateFormat(t,i),S&&S.changeDateFormat(E)},"DATE_SEPARATOR","LOCALE_DATEFORMAT"),o.register(s.UserAction,c.SheetAction.DATAFILTER.ONAPPLY,function(i,r,l){if(void 0!=H){t.view.getActiveGridID();var n=Z,a=H;new ZSClass.Range(a,n,a,n),e.UserAction.ScrollCellIntoView(i,r,l,a,n),H=void 0,Z=void 0}},"RID","SHEETID","VERSION")}function P(){var e=t.view.getActiveGridID(),i=t.view.getResourceID(e),r=t.view.getSheetID(e),n=t.view.getVersionID(e),a=t.data.getWorkBook(i,n).getSheetObj(r),o=t.view.getSheetState(e,r).getActiveCellRange().startCol,s=!1,c=a.DataFilters,d=a.DataFilters.getAllRanges();for(var u in d){var g=d[u];if(g&&g.properties){var m=g.properties;!(!(s=!(!m.appliedColumns||!m.appliedColumns.length))||-1===m.appliedColumns.indexOf(o))}}var S=!s,E=!s,T=c.isRangesAvailable();v.zmenu("#"+I.SUBMENUITEM+l.FILTER+I.IDENTITY,"setMenuItemsAttribute",["#reApplyFilter"],"disabled",S),v.zmenu("#"+I.SUBMENUITEM+l.FILTER+I.IDENTITY,"setMenuItemsAttribute",["#clearFilter"],"disabled",E),v.zmenu("#"+I.SUBMENUITEM+l.FILTER+"_CM"+I.IDENTITY,"setMenuItemsAttribute",["#clearFilter"],"disabled",E),v.zmenu("#"+I.SUBMENUITEM+l.FILTER+"_CM"+I.IDENTITY,"setMenuItemsAttribute",["#reApplyFilter"],"disabled",S),v.zmenu("#"+I.SUBMENUITEM+l.FILTER+I.IDENTITY,"setMenuItemsAttribute",["#saveFilterView"],"disabled",!s),v.zmenu("#"+I.SUBMENUITEM+l.FILTER+I.IDENTITY,"setMenuItemsAttribute",["#setAsDefaultFilter"],"disabled",!T),T?(v.zmenu("#"+I.SUBMENUITEM+l.FILTER+I.IDENTITY,"hideMenuItems",["#createFilter"]),v.zmenu("#"+I.SUBMENUITEM+l.FILTER+I.IDENTITY,"showMenuItems",["#removeFilter"])):(v.zmenu("#"+I.SUBMENUITEM+l.FILTER+I.IDENTITY,"showMenuItems",["#createFilter"]),v.zmenu("#"+I.SUBMENUITEM+l.FILTER+I.IDENTITY,"hideMenuItems",["#removeFilter"]))}function Y(i,r,l,n,a){var o=t.view.getActiveGridID(),s=(r=t.view.getResourceID(o),n=t.view.getVersionID(o),t.view.getSelectedSheets(o)),c=(l=t.view.getSheetID(o),t.data.getWorkBook(r,n).getSheetObj(l).DataFilters),d=t.view.getSheetState(o,l),I=(d.getActiveCellRange(),d.getActiveCol()),v=c.isRangesAvailable();if(a)switch(a.action){case O:v||e.UserAction.AddFilter(r,s,n);break;case q:v&&e.UserAction.RemoveFilter(r,s,n);break;case b:e.UserAction.FilterByCellValue(r,s,n);break;case p:e.UserAction.FilterByCellColor(r,s,n);break;case R:e.UserAction.FilterByTextColor(r,s,n);break;case C:var S=new ZSClass.Range(0,I,m-1,I);e.UserAction.ClearFilter(r,s,n,S,-1);break;case h:v&&W(i);break;case U:!function(t,i,r){A||function(t,i,r){var l={width:400,title:u["MenuItem.HomeTab.Filter.SaveAsFilterView"],dialogClass:"nRtD",close:function(){y.querySelector("#filterName").value=""}},n=e.UserAction.getTemplate(["namedFilters"]).namedFilters;n.querySelector("#filterName").addEventListener("input",function(e){var t=e.value.trim(),i=y.querySelector("#nR_addBtn"),r=t.length>0&&""!=t;return i.disabled=!r,r}.bind(null,n.querySelector("#filterName"))),n.querySelector("#nR_addBtn").addEventListener("click",ne.bind(this,t,i,r)),n.querySelector("#cancelBtn").addEventListener("click",function(){A.close()}),(y=document.createElement("div")).id="DI_NAMEDFILTERS",y.setAttribute("class","usrLlFltr "),A=new e.ZSClass.Dialog(y,l),y.appendChild(n)}(t,i,r);(function(e){y.querySelector("#nR_container"),y.querySelector("#nR_noResult");y.querySelector("#nR_addBtn").disabled=!0})(),A.open(),function(){A.rID,A.sheetID,A.version;A.getKeyContext().keyDown[g.ENTER]=function(e,t,i,r){return ne(t,i,r),e.preventDefault(),!1}}(),y.querySelector("#filterName").focus()}(r,l,n);break;case M:e.UserAction.SetAsDefaultFilter(r,s,n);break;case B:!function(i,r,l){f||(n=t.view.getActiveGridID(),t.view.getSelectedSheets(n),a={width:480,title:u["MenuItem.HomeTab.Filter.ManageFilters"],dialogClass:"nRtD"},(o=e.UserAction.getTemplate(["manageFilters"]).manageFilters).querySelector("#clBtn").addEventListener("click",function(){f.close()}),(D=document.createElement("div")).id="DI_MANAGEFILTERS",D.setAttribute("class","usrLlFltrMng "),D.appendChild(o),f=new e.ZSClass.Dialog(D,a),D.classList.remove("nRtD"));var n,a,o;_&&$(_);f.open()}()}else c.isRangesAvailable()?e.UserAction.RemoveFilter(r,s,n):e.UserAction.AddFilter(r,s,n)}function W(i){var r=t.view.getActiveGridID(),l=t.view.getResourceID(r),n=t.view.getVersionID(r),a=t.view.getSelectedSheets(r),o=t.view.getSheetID(r);t.data.getWorkBook(l,n).getSheetObj(o).DataFilters.isRangesAvailable()&&e.UserAction.ReApplyFilter(l,a,n),i.preventDefault()}function j(){z={isFilterDialogOpen:!0,col:void 0}}function K(i){var r=t.view.getActiveGridID(),n=t.view.getResourceID(r),a=t.view.getSheetID(r),o=t.view.getVersionID(r);F.innerHTML="",v.zmenu(F,"destroy"),!_&&v.zmenu("#"+I.SUBMENUITEM+l.FILTER+I.IDENTITY,"setMenuItemsAttribute",["#manageFilters"],"disabled",!0),!_&&v.zmenu("#"+I.SUBMENUITEM+l.FILTER+I.IDENTITY,"setMenuItemsAttribute",["#filterViewMenu"],"disabled",!0),i&&(_=void 0),e.UserAction.GetFilterViews(n,[a],o,X,void 0)}function X(e){T.classList.remove("ZsMiRt"),void 0!=e&&e.views.length>0?(_=e.views,v.zmenu("#"+I.SUBMENUITEM+l.FILTER+I.IDENTITY,"setMenuItemsAttribute",["#manageFilters"],"disabled",!1),v.zmenu("#"+I.SUBMENUITEM+l.FILTER+I.IDENTITY,"setMenuItemsAttribute",["#filterViewMenu"],"disabled",!1),V=!1,function(e,t,i){for(var r=Object.keys(t).length,l=0;l<r;l++){var n=t[l],a=document.createElement("li");a.innerText=n,a.addEventListener("click",J.bind(null,N,n,!1)),e.appendChild(a)}v.zmenu(e)}(F,_)):(_=void 0,F.style.minWidth="100px",v.zmenu("#"+I.SUBMENUITEM+l.FILTER+I.IDENTITY,"setMenuItemsAttribute",["#manageFilters"],"disabled",!0),v.zmenu("#"+I.SUBMENUITEM+l.FILTER+I.IDENTITY,"setMenuItemsAttribute",["#filterViewMenu"],"disabled",!0),V=!0)}function J(i,r,l,n){var a=t.view.getActiveGridID(),o=t.view.getResourceID(a),s=t.view.getSheetID(a),c=t.view.getVersionID(a),d=t.view.getSelectedSheets(a);switch(void 0!=r&&(r=encodeURIComponent(r)),void 0!=n&&(n=encodeURIComponent(n)),i){case N:l?e.UserAction.ApplyDefaultFilter(o,d,c):e.UserAction.MapFilterView(o,[s],c,r);break;case L:e.UserAction.RenameFilterView(o,[s],c,r,n,l);break;case k:e.UserAction.DeleteFilterView(o,[s],c,r,l)}}function $(e){var t=D.querySelector("#manage_container");if(t.querySelectorAll(".filterEle").forEach(function(e){e.remove()}),Object.keys(e).length){t.querySelector(".noFltr").style.display="none";for(var i=0;i<Object.keys(e).length;i++){var r=e[i],l=t.querySelector(".cloneEle").cloneNode(!0);l.setAttribute("class","wid wid100 cFMng filterEle"),l.style.display="block";var n=l.querySelector(".dspTblRow").cloneNode(!0);n.setAttribute("name","editFilterEle"),n.setAttribute("filterName",r),n.querySelector("#filterName").innerText=r,n.style.display="block";var a=n.querySelector("#edit"),o=n.querySelector("#del"),s=n.querySelector("#update"),c=n.querySelector("#cancel");a.addEventListener("click",Q.bind(null,n)),o.addEventListener("click",re.bind(null,n,l)),s.addEventListener("click",ee.bind(null,n)),c.addEventListener("click",ie.bind(null,n,!0)),l.querySelector(".dspTbl").appendChild(n),t.appendChild(l)}}else t.querySelector(".noFltr").style.display="block"}function Q(e){D.querySelector("#manage_container").querySelectorAll(".filterEle").forEach(function(e){ie(e.querySelector("[name='editFilterEle']"))}),e.querySelector("#renameFilterName").value=e.querySelector("#filterName").innerText,e.querySelector("#filterName").style.display="none",e.querySelector("#edit").style.display="none",e.querySelector("#del").style.display="none",e.querySelector("#renameFilterName").style.display="block",e.querySelector("#update").style.display="block",e.querySelector("#cancel").style.display="block",e.querySelector("#renameFilterName").focus(),UIUtil.Component.disable("#clBtn")}function ee(e){var t=e.querySelector("#filterName").innerText,i=e.querySelector("#renameFilterName").value.trim().replace(/\s\s+/g," ");if(ae(i))if(le(i)){t!=i?te(i,function(){J(L,t,!1,i);var r=_.indexOf(i);-1!=r&&_.splice(r,1),r=_.indexOf(t),_[r]=i,$(_),ie(e,!1)},function(){e.querySelector("#renameFilterName").focus()}):ie(e,!0)}else ZSClass.ZSAlert(u.FilterNameCannotContainMsg,{title:u["Alert.Title.InvalidFilterName"]});else ZSClass.ZSAlert(u.Namecannotbeempty,{title:u["Alert.Title.EnterName"]})}function te(e,t,i){if(function(e){if(_)for(var t=0;t<Object.keys(_).length;t++)if(e==_[t])return!0;return!1}(e)){var r=new ZSClass.ZSConfirm(u["Error.Filters.Already.Exist.Override"],u["Alert.Title.FilterNameExist"]);r.onYES(function(){t&&t(),UIUtil.Component.enable("#clBtn")}),r.onNO(function(){i&&i()}),r=r.execute()}else t&&t(),UIUtil.Component.enable("#clBtn")}function ie(e,t){t&&UIUtil.Component.enable("#clBtn"),e.querySelector("#filterName").style.display="block",e.querySelector("#edit").style.display="block",e.querySelector("#del").style.display="block",e.querySelector("#renameFilterName").style.display="none",e.querySelector("#update").style.display="none",e.querySelector("#cancel").style.display="none"}function re(e,t){var i=e.querySelector("#filterName").innerText;t.classList.add("bOr","aDd");var r=D.querySelector("#manage_container");J(k,i,!1);var l=_.indexOf("filterName");_.splice(l,1),setTimeout(function(){t.remove(),!_.length&&(r.querySelector(".noFltr").style.display="block")},500)}function le(e){return new RegExp("^[a-zA-Z0-9-_&\\s]+$").test(e)}function ne(i,r,l){var n=t.view.getActiveGridID(),a=t.view.getSelectedSheets(n),o=(t.data.getWorkBook(i,l),y.querySelector("#filterName")),s=o.value.trim().replace(/\s\s+/g," ");if(ae(s))if(le(s)){s=encodeURIComponent(s);var c=function(){K()};te(o.value,function(){e.UserAction.SaveFilterView(i,a,l,s,c),o.value="",A.close()},function(){A.open(),o.value=decodeURIComponent(s),o.focus()})}else ZSClass.ZSAlert(u.FilterNameCannotContainMsg,{title:u["Alert.Title.InvalidFilterName"]});else ZSClass.ZSAlert(u.Namecannotbeempty,{title:u["Alert.Title.EnterName"]})}function ae(e){return null!=e&&""!=e&&void 0!=e&&e.length>0}function oe(){var i=t.view.getActiveGridID(),r=t.view.getGridComponent(i);e.isCanvasGrid||(r.allowToScroll=!0),j()}function se(){if(S&&!z.isFilterDialogOpen){S.close();var e=t.view.Events.Key;e.focusContext(e.Entry.CellEditor.Context)}}function ce(){var e=t.view.Events.Key;e.focusContext(e.Entry.Filter.Context)}function de(){var e=t.view.Events.Key.Entry.Filter.Context.keyDown;e[g.ESC]=function(){se()},e[g.PURE_PRINTABLE_CHAR]=ue,e[g.TAB]=ue,e[g.SUPER+"+"+g.V]=ue,e[g.LEFT]=ue,e[g.RIGHT]=ue,e[g.UP]=ue,e[g.DOWN]=ue,e[g.ENTER]=ue,e[g.SUPER+"+"+g.A]=ue}function ue(){return!1}function Ie(i,r,l,n,a){var o=t.data.getWorkBook(i,l).getSheetObj(r),s=t.view.getActiveGridID(),c=(t.view.getSelectedSheets(s),o.DataFilters),d=new ZSClass.Range(n,a,n,a),u=a-c.getIntersectedRanges(d)[0].startCol;S.index=u,e.UserAction.GetFilterInfo(i,[r],l,d,a,u,void 0,void 0)}function ve(e){var t=i.getElementById(I.MI+l.FILTER+I.IDENTITY);t&&t.parentElement.classList[e]("shIconActive");"remove"==e&&se()}function ge(i,r,l,n,a,o,s){var c=t.data.getWorkBook(i,l).getSheetObj(r),d=t.view.getActiveGridID(),u=(t.view.getSelectedSheets(d),c.DataFilters.getIntersectedRanges(n)[0]);if(Object.keys(s).length){var I={};I.cD=s.DisplayValue,I.tcs=s.Format.color,I.ccs=s.Format.bgColor,u.data[o]?me(u.data[o],I):e.UserAction.GetFilterInfo(i,[r],l,n,a,o,!1,I)}else e.UserAction.GetFilterInfo(i,[r],l,n,a,o,void 0,void 0)}function me(e,t,i){void 0!=i&&(e.cD=i.cD,e.ccs=i.ccs,e.tcs=i.tcs),t==S.index&&S.generateData(e)}function Se(i){var r=t.view.getActiveGridID(),l=t.view.getResourceID(r),n=t.view.getSelectedSheets(r),a=t.view.getVersionID(r),o=t.view.getSheetID(r),s=t.data.getWorkBook(l,a).getSheetObj(o),c=s.DataFilters,d=z.col,u=new ZSClass.Range(0,d,m-1,d),I=c.getIntersectedRanges(u)[0],v=(new ZSClass.Range(I.startRow,I.startCol,I.endRow,I.endCol),t.view.getSheetState(r,o)),g=v.getScrollTops()[0],S=v.getScrollLefts()[0];H=s.Row.auxiliaryAxis.findAbs(g),Z=s.Column.auxiliaryAxis.findAbs(S),e.UserAction.ClearFilter(l,n,a,u,i)}function Ee(i,r,l,n,a,o,s,c){var d=t.view.getActiveGridID(),u=t.view.getResourceID(d),I=t.view.getSelectedSheets(d),v=t.view.getVersionID(d),g=t.view.getSheetID(d),S=t.data.getWorkBook(u,v).getSheetObj(g),E=S.DataFilters,T=z.col,F=new ZSClass.Range(0,T,m-1,T),A=E.getIntersectedRanges(F)[0],f=new ZSClass.Range(A.startRow,A.startCol,A.endRow,A.endCol),D=t.view.getSheetState(d,g),y=D.getScrollTops()[0],w=D.getScrollLefts()[0];H=S.Row.auxiliaryAxis.findAbs(y),Z=S.Column.auxiliaryAxis.findAbs(w),e.UserAction.ApplyFilter(u,I,v,f,i,r,l,n,a,o,s,c)}function Te(i){var r=t.view.getActiveGridID(),l=t.view.getResourceID(r),n=t.view.getSelectedSheets(r),a=t.view.getVersionID(r),o=t.view.getSheetID(r),s=t.data.getWorkBook(l,a).getSheetObj(o).DataFilters,c=(t.view.getSheetState(r,o),z.col),d=new ZSClass.Range(0,c,m-1,c),u=s.getIntersectedRanges(d)[0],I=d.startCol-u.startCol,v=[],g={};g.f=I,g.s="ASC"==i,v.push(g),e.UserAction.executeSort(l,n,a,v,u,!1,!0,!1,1)}}(this);
!function(e){var t,a,n,l=e.sPlusPlus,r=e.ZSConstants.FeatureConstants,o=e.ZSConstants.I18N,i=e.ZSConstants.wCC,s=l.view.Toolbar.Feature[r.DATA_CLEANING],c=e.ZSEvents,d=c.topic,u=c.Groups,g=c.Names,v=(e.document,e.JSUtil),I=l.data.AppRegistry.JSPath,C=e.UIUtil.Component,A=l.view.Toolbar.Feature[r.DATA_DUPLICATES],S=1,D=2,w=3,h=4,b=5,p=!1,E=!1,R=-2,m=!1;function f(){void 0==t&&(t=module.getModule("SA/Controller/SheetAppController")),m||(t.init(s.getPanel()),m=!0)}window.addEventListener("DC_CANCEL",function(){s.togglePanel()}),window.addEventListener("showEmptyRecords",function(){var t=s.tableInstance.getCurrentCol(),a=new e.DCZoomLayer,n=s.tableInstance.sc,l=s.tableInstance.ec;new e.DataAccumulator(s.EmptyRows,n,l,function(){var e=arguments[0];a.hideLoader(),a.setData(e),a.setHeaders(s.tableInstance.headers),a.scrollIntoView(0,t+1),a.highlightSelectedCol(t,e.length)})}),window.addEventListener("DC",function(){var t=arguments[0].detail,a=t.col;if(a==R){var n=l.view.getActiveGridID(),r=l.view.getSheetID(n),o=sPlusPlus.view.getSheetState(n,r).getActiveCellRange();T(t.mode,o.startCol,!0,s.getRange(),arguments[0].detail.callback)}t.level;var i=t.mode;s.tableInstance.created&&void 0!=a&&s.tableInstance.setCurrentCol(a);var c=e.module,d=c.getModule("SA/UI/Registry"),u=c.getModule("SA/UI/Constants/ClassNames");d.getComponent(u.SIDEBAR_FOOTER).updateBand(""),L(i,a,arguments[0].detail.callback)});var L=JSUtil.fn.debounce(function(e,t,a){M(),T(e,t,!1,s.getRange(),a)},500);function N(t){var a=t.col;if(s.tableInstance.created&&void 0!=a&&s.tableInstance.setCurrentCol(a),t.mode==D){var n,r=module.getModule("SA/UI/Component/FillMissingValue/Constants"),o=t.level,i=s.JSONConstants,c=i.FILL_EMPTY_WITH_PREVIOUS_NON_EMPTY;switch(o){case r.DEFAULT_VALUE:c=i.FILL_EMPTY_WITH_VALUE,n=t.value;break;case r.MAX_OCCUR:c=i.FILL_EMPTY_WITH_MODE;break;case r.AVERAGE:c=i.FILL_EMPTY_WITH_AVERAGE}!function(t,a){var n=l.view.getActiveGridID(),r=l.view.getResourceID(n),o=l.view.getVersionID(n);if(s.tableInstance.created){var i=s.tableInstance,c=i.sr,d=i.currCol,u=d,g=i.er,v=i.sn,I=new Array;I.push(v);var C=new ZSClass.Range(c,u,g,d)}else var I=l.view.getSelectedSheets(n);e.UserAction.fillEmptyCells(r,o,I,C,t,a,s.getEmptyCellsCount)}(c,n)}else{var d=t.data.clusters;if(d){var u=function(t){if(t){var a=[];for(var n in t){var l=t[n];if(l.checked){var r=l.groups,o=l.replaceBy;for(var i in r)r[i].checked&&r[i].value!==o&&a.push({v:e.encodeURIComponent(r[i].value),rv:e.encodeURIComponent(o)})}}return a}}(d);u&&e.UserAction.replaceAll(u,t.callback,s.getRange(),s.tableInstance.getCurrentCol())}}}function T(a,n,r,o,i){r&&s.tableInstance.reset();var c=l.view.getActiveGridID(),d=l.view.getResourceID(c),u=l.view.getVersionID(c),g=l.view.getSelectedSheets(c);switch(void 0==t&&(t=module.getModule("SA/Controller/SheetAppController")),a){case S:e.UserAction.clusterData(a,d,g,u,null,o,n,r,!1,s.clusterCallback,i);break;case D:!r&&s.tableInstance.created?U(i):e.UserAction.clusterData(a,d,g,u,null,null,n,r,!0,s.clusterCallback,i);break;case w:f(),t.load({columns:[{key:R,value:""}],mode:3}),t.onSidebarOperationMenuChange(void 0,void 0,void 0,3),A.readTable(void 0,"duplicate");break;case h:f(),t.load({columns:[{key:R,value:""}],mode:4}),t.onSidebarOperationMenuChange(void 0,void 0,void 0,4),A.readTable(void 0,"unique");break;case b:f();c=l.view.getActiveGridID(),d=l.view.getResourceID(c),u=l.view.getVersionID(c),l.view.getSheetID(c),g=l.view.getSelectedSheets(c);var v=new ZSClass.ParamGenerator(g,d,u,!0),I=v.getSheets(),C=v.getRanges(),p=v.getActiveCell(),E=p.c;UserAction.ReadFrequencyTable(d,u,I,C,p,E,!0)}}function U(t){var a=l.view.getActiveGridID(),r=l.view.getResourceID(a),o=l.view.getVersionID(a);l.view.getSheetID(a);if(s.tableInstance.created){var i=s.tableInstance,c=i.sr,d=i.currCol,u=d,g=i.er,v=i.sn;(C=new Array).push(v);var I=new ZSClass.Range(c,u,g,d)}else var C=l.view.getSelectedSheets(a);var A=e.module;!t&&(t=A.getModule("SA/Controller/SheetAppUIController").showFillMissingValueView),e.UserAction.getEmptyCellsCount(r,o,C,I,function(e){!function(e,t){var a=s.tableInstance.getColumnType(s.tableInstance.getCurrentCol());t&&t(e,a),n=e}(e,t)})}window.addEventListener("DC_Action",function(){E=!1,N(arguments[0].detail)}),function(t){var a=e.ZSConstants.I18N,n={id:i.SUBMENUITEM+r.DATA_CLEANING+i.IDENTITY,ctype:"zmenu",data:'{"componentOptions":{"type":"text_only"}}',relativeto:"parent"},o=[{id:"dc1",data:'{"label":"'+a["SidePanel.DataCleaning.FixSpelling"]+'", "action": '+S+"}"},{id:"dc2",data:'{"label":"'+a["SidePanel.DataCleaning.FixMissing"]+'", "action": '+D+"}"},{id:"dc3",data:'{"label":"'+a["SidePanel.DataCleaning.Duplicates"]+'", "action": '+w+"}"},{id:"dc4",data:'{"label":"'+a["SidePanel.DataCleaning.Uniques"]+'", "action": '+h+"}"},{id:"dc5",data:'{"label":"'+a["SidePanel.DataCleaning.Frequency"]+'", "action": '+b+"}"}];p||(l.view.Menu.create(o,n,t).then(function(){C.bind("#"+i.SUBMENUITEM+r.DATA_CLEANING+i.IDENTITY,"zmenuitemclick",function(e,t){var n=l.view.getActiveGridID(),r=l.view.getResourceID(n),o=l.view.getVersionID(n),i=(l.view.getSheetID(n),l.view.getSelectedSheets(n));new ZSClass.ParamGenerator(i,r,o,!0).getRanges()[0].length>=2?ZSClass.ZSAlert(a["action.not.support.multiselection"],{title:a["Alert.Title.InvalidCellRange"]}):(s.initPanel(),s.openPanel(),"dc3"!=t.data.id&&"dc4"!=t.data.id&&s.showLoader(),T(t.data.action,null,!0))})}),p=!0)}();var _=function(t,a){var n=l.view.getActiveGridID(),r=(l.view.getVersionID(n),l.view.getResourceID(n),l.view.getSheetID(n));l.view.getSheetState(n,r);if("A"==a[0].srcElement.nodeName){var o=a[1].row,i=s.tableInstance.getCurrentCol(),c=new e.DCZoomLayer;c.setHeaders(s.tableInstance.headers);var d=s.tableInstance.sc,u=s.tableInstance.ec;new e.DataAccumulator(t,o,d,u,function(){var e=arguments[0];c.setData(e),c.highlightSelectedCol(i,e.length)})}};function M(){if(s.tableInstance.created){var e=l.view.getActiveGridID(),t=l.view.getResourceID(e),a=l.view.getVersionID(e),n=l.view.getSheetID(e),r=s.tableInstance,o=r.sr,i=r.currCol,c=i,v=r.er,I=r.sn;(new Array).push(I);var C=new ZSClass.Range(o,c,v,i);d.publish(u.Listener,g.UserAction.HIGHLIGHT_RANGE.ADD,{RID:t,SHEETID:n,VERSION:a,RANGEID:200,RANGE:C,COLOR:"#b79715"})}}window.addEventListener("DC_PREVIEW",function(){var t=s.tableInstance.getCurrentCol(),a=new e.DCZoomLayer;a.showLoader();var n=s.tableInstance.sc,l=s.tableInstance.ec;new e.DataAccumulator(arguments[0].detail.rows,n,l,function(){var e=arguments[0];a.hideLoader(),a.setData(e),a.setHeaders(s.tableInstance.headers),a.scrollIntoView(0,t+1),a.highlightSelectedCol(t,e.length)})}),window.addEventListener("DC_Action_Refresh",function(){N(arguments[0].detail),E=!0;var e=s.tableInstance.getCurrentCol();void 0==t&&(t=module.getModule("SA/Controller/SheetAppController")),t.triggerColumnChange(e,!0)}),s.cleanseData=T,s.clusterCallback=function(a,n,r){if(n){var o=!s.tableInstance.created,i=JSON.parse(JSON.stringify(n)).clusters;if(s.tableInstance.setCurrentCol(i.col),null!=i.tableRange&&s.tableInstance.setRange(i.tableRange.sn,i.tableRange.sr,i.tableRange.sc,i.tableRange.er,i.tableRange.ec,i.tableRange.headers),s.tableInstance.created){var c=l.view.getActiveGridID(),I=l.view.getResourceID(c),C=l.view.getVersionID(c),A=l.data.getWorkBook(I,C).getSheetObj(s.tableInstance.sn).Prop.getName();A=(/[-\s]/.test(A)?"'"+A+"'":A)+".";var S=e.JSUtil.Cell.getReference(s.tableInstance.sr,s.tableInstance.sc),w=e.JSUtil.Cell.getReference(s.tableInstance.er,s.tableInstance.ec);s.openPanel(),s.setRange(A+S+":"+w),o?(function(a,n,l,r){var o=e.module;if(o.getModule("SA/Sheet2App"),void 0==t&&(t=o.getModule("SA/Controller/SheetAppController")),n){n.forEach(function(e,t,a){e.value||(a[t]={key:e.key,value:"COLUMN "+v.Object.getCharForNum(e.key+1)})});var i={columns:n,currentCol:l,mode:r};f(),t.load(i,_)}}(i.values,s.tableInstance.headers,i.col,a),a==D&&U(r)):r&&r(i.values)}d.publish(u.UI,g.SidePanel.DATACLEANING.HIDE_LOADER)}},s.getEmptyCellsCount=U,s.getPreviousFillCount=function(){return n},s.ACTION_FIX_MISSPELLING=S,s.highlightCurrentColumn=M,s.ACTION_FILL_MISSING_VALUES=D,s.loadSheet2App=f,s.isSheetAppLoaded=m,d.register(u.Selector.BoundUpdate.Range,g.Selection.BOUND_UPDATE.ADD,function(e,a,n,l,r,o){s.isOpen()&&(void 0==t&&(t=module.getModule("SA/Controller/SheetAppController")),l.isCol()&&t.triggerColumnChange(l.startCol,!0))},"RID","SHEETID","VERSION","RANGE","accumulate","TYPE"),d.register(u.Listener,g.UserAction.DATACLEANING.HIGHLIGHT,function(e,t,a,n){for(var r=l.view.getActiveGridID(),o=(e=l.view.getResourceID(r),t=l.view.getSheetID(r),a=l.view.getVersionID(r),0),i=(s.tableInstance.getCurrentCol(),0);i<n.length;i++){var c=n[i];d.publish(u.Listener,g.Layers.Recalculate.Place,{RID:e,SHEETID:t,VERSION:a,ID:o++,RANGE:new ZSClass.Range(c[0],c[1],c[2],c[3])})}},"RID","SHEETID","VERSION","DATA"),d.register(u.Listener,g.UserAction.DATACLEANING.COUNT,function(e,n,l,r){if(void 0==a&&(a=module.getModule("SA/Controller/SheetAppUIController")),a.showMessage(r+" "+o["SidePanel.DataCleaning.Updated"]),E){var i=s.tableInstance.getCurrentCol();void 0==t&&(t=module.getModule("SA/Controller/SheetAppController")),t.triggerColumnChange(i,!0),E=!1}},"RID","SHEETID","VERSION","DATA"),d.register(u.UI,g.Layout.DEFER_JS_LOADED,function(){var e=[I+"../js/SheetAppDC/handsontable.min.js",I+"../compressedJS/sheet2app_compressed.js"],t=[I+"../styles/SheetAppDC/handsontable.min.css"];UserAction.loadDependency(e),UserAction.loadCSS(t)})}(this);
!function(e){e.window;var t,a=e.ZSEvents,i=(a.topic,a.Groups,a.Names,e.ZSConstants.I18N);function r(){this.parent=document.querySelector("body"),this.create()}r.prototype.create=function(){(t=document.createElement("div")).id="rPtMd",t.classList.add("rPtM","sPDCLayer");var e=this;window.onkeydown=function(t){27==(t=t||window.event).keyCode&&e.destroy()},this.parent.appendChild(t);var a=document.createElement("div");a.classList.add("rPtMc");var r=document.createElement("div");r.classList.add("rPtMcB"),t.appendChild(r),t.appendChild(a);var s=document.createElement("div");s.classList.add("pEsc"),s.innerText=i["Zia.Esc"],r.addEventListener("click",this.destroy),r.appendChild(s);var n=document.createElement("article");n.classList.add("rPtMcA"),a.appendChild(n);var d=document.createElement("section");d.classList.add("rPtMcAs"),n.appendChild(d);var o=document.createElement("div");o.id="rPtGrd",o.innerText=i["SidePanel.DataCleaning.Preview"],d.appendChild(o);var c=document.createElement("div");c.id="rPtCrt",c.classList.add("bgClr");var l=document.createElement("div");l.classList.add("rPtMcAc"),this.loader=document.createElement("span"),this.loader.classList.add("ZsLoader"),this.loader.style.display="none",l.appendChild(this.loader);var h=document.createElement("article");h.id="zViewSpace",l.appendChild(h),a.appendChild(l)},r.prototype.createGrid=function(){if(!this.grid){var a=t.querySelector("#zViewSpace");this.grid=new e.Handsontable(a,{rowHeaders:!1,colHeaders:!0}),e.grid=this.grid}},r.prototype.showLoader=function(){this.loader&&(this.loader.style.display="block")},r.prototype.hideLoader=function(){this.loader&&(this.loader.style.display="none")},r.prototype.setHeaders=function(e){var t=[];for(var a in t.push(""),e){var i=e[a];-1!=i.key&&t.push(i.value)}this.grid&&this.grid.updateSettings({colHeaders:t,manualColumnFreeze:!0,fixedColumnsLeft:1})},r.prototype.highlightSelectedCol=function(e,t){for(var a=0;a<t;a++)this.grid.setCellMeta(a,e+1,"className","sPDataHighLight");this.grid.render()},r.prototype.setData=function(e){this.grid||this.createGrid(),this.grid.loadData(e)},r.prototype.scrollIntoView=function(e,t){this.grid&&this.grid.selectCell(e,t)},r.prototype.destroy=function(){var e=document.querySelector("#rPtMd");e.parentNode.removeChild(e)},e.DCZoomLayer=r}(this),function(e){var t=e.sPlusPlus,a=e.ZSClass;function i(e,t,a,i){this.callback=i,this.numOfFetches=0,this.create(),this.iterateClusters(e,t,a)}i.prototype={create:function(){this.store={},this.ranges=[]},iterateClusters:function(e,t,i){for(var r in e){var s=e[r],n=new a.Range(s,t,s,i);this.accumulateRanges(n)}this.fetchData()},accumulateRanges:function(e){this.ranges.push(e)},fetchData:function(){var e=t.view.getActiveGridID(),a=t.view.getResourceID(e),i=t.view.getSheetID(e),r=t.view.getVersionID(e),s=this;for(var n in this.ranges){var d=this.ranges[n];this.numOfFetches++,t.view.fetchRangeData(a,i,r,d,["DisplayValue"],!0,e,function(e){s.setData.call(s,e)},function(){})}},setData:function(e){this.numOfFetches--;var t=Object.keys(e);for(var a in t){var i=[],r=t[a],s=parseInt(r);if(!isNaN(s)){i.push(s+1);var n=e[r],d=Object.keys(n);for(var o in d){var c=d[o],l=e[r][c].DisplayValue;i.push(l)}this.store[s+1]=i}}0==this.numOfFetches&&this.callback(this.getData())},getData:function(){var e=[],t=Object.keys(this.store);for(var a in t){var i=t[a],r=[];r.push(this.store[i]);for(var s=0;s<r.length;s++)e.push(r[s])}return e}},e.DataAccumulator=i}(this);
!function(e){var t,i,r,s=e.sPlusPlus,o=e.ZSConstants.FeatureConstants,n=e.ZSEvents,a=n.topic,l=n.Groups,c=n.Names;function g(o,n,a,l){var c=function(e,i,o,n,a){var l={submit:w,close:u};t||(t=new ZSClass.PickFromList(l));var c=n.range&&a[n.range.startCol]?a[n.range.startCol].DisplayValue:a;c=c.sort(v),t.show(c,r),JSUtil.Mouse.BindOnExternalClick(t.container,u),g=s.view.Events.Key,g.focusContext(g.Entry.PickList.Context);var g}.bind(this,o,n,a,l),g={filterBy:"COL",skipNumbers:!0,activeCell:i,skipActiveCellData:!0};if(l&&l.range){if(!l.hasString){return void c([])}new ZSClass.UniqueData(o,n,a,l.range,["DisplayValue","CellType"],c,g)}else e.UserAction.PickFromList(o,[n],a,!1,c)}function v(e,t){var i=e.toLowerCase(),r=t.toLowerCase();return i<r?-1:i>r?1:0}function u(){if(t){t.close();var e=s.view.Events.Key;e.focusContext(e.Entry.CellEditor.Context)}}function w(t){var i=s.view.getActiveGridID(),r=s.view.getResourceID(i),o=s.view.getSelectedSheets(i),n=s.view.getSheetID(i),g=s.view.getVersionID(i),v=s.view.getSheetState(i,n),w=v.getActiveRow(),S=v.getActiveCol();e.UserAction.SubmitCell(r,o,g,t,w,S),u(),a.publish(l.Selector.BoundUpdate.CellEdit,c.Selection.BOUND_UPDATE.REMOVE,{RID:r,SHEETID:n,VERSION:g})}s.view.Toolbar.Feature[o.PICKFROMLIST].execute=function(){if(t&&""==t.getDisplay())return;var o=s.view.getActiveGridID(),n=s.view.getResourceID(o),a=s.view.getSelectedSheets(o),l=s.view.getSheetID(o),c=s.view.getVersionID(o);if((r=function(e,t,r){var o=s.data.getWorkBook(e,r).getSheetObj(t),n=s.view.getActiveGridID(),a=s.view.getSheetState(n,t),l=a.getActiveRow(),c=a.getActiveCol();i={row:l,col:c};var g=a.getZoom(),v=o.Column.auxiliaryAxis.getPos(c)*g,u=o.Row.auxiliaryAxis.getPos(l)*g,w=o.Row.auxiliaryAxis.getDim(l)*g,S=o.Row.FreezedCount,C=o.Column.FreezedCount,h=c>=C,d=l>=S,f=a.getScrollLefts(),D=a.getScrollTops(),A=h?f[0]:f[1],I=d?D[0]:D[1],E=h?a.getScreenWidths()[1]:0,L=d?a.getScreenHeights()[1]:0,p=a.getScreenHeights()[0],m=a.getScreenWidths()[0],x=s.view.measures.gridTop,y=s.view.measures.gridLeft,R=!(m+A<=v||A>v);u=(u=u+L-I)+w+x,v=(v=v+E-A)+y;var P=p+x+a.getScreenHeights()[1];return P<u&&(R=!1),{height:P-u,top:u,left:v,isCellInView:R}}(n,l,c)).isCellInView){var v=g;e.UserAction.getPickListRange(n,a,c,v)}},a.register(l.Listener,c.Browser.ScreenViewport,u),a.register(l.Listener,c.SheetAction.ACTIVE_CELL.INFO,u),a.register(l.Listener,c.GridAction.WheelXYPaneContainerScroll,u)}(this);
!function(t){var e=t.sPlusPlus,o=t.ZSEvents,a=o.topic,i=o.Groups,n=o.Names,r=(t.ZSClass,t.UserAction,t.ZSConstants.CommandConstants),T=function(t,e){var o=t[r.FORMATTYPE];return"DATE"==o||"DATETIME"==o||"CUSTOM"==o&&("DATE"==e||"DATETIME"==e)};function E(t,e,o,r,T,E,s){T=T?decodeURIComponent(T):void 0,E=s||!1,a.publish(i.Listener,n.UserAction.DATEPICKER,{ACTUALVALUE:r,DATEFRMT:T,TIMEFRMT:E})}a.register(i.Selector.DomUpdate.CellEdit,n.Selection.BOUND_UPDATE.ADD,function(t,o,a,i,n){if(n){var s=e.view.getActiveGridID(),A=e.data.getWorkBook(t,a).getSheetObj(o),D=i.startRow,l=i.startCol;e.view.fetchRangeDataFromWorker(t,o,a,i,["ActualValue","Pattern","Formula","CellType"],!1,s,function(i){var n=i[D][l],s=n.ActualValue,c=n.Pattern,u=n.Formula,v=n.CellType,M=A.DataValidation.getInfo(D,l);if(void 0!=c){var C=T(c,v),d=function(t,o,a,i,n,T,E,s){var A=e.data.getWorkBook(t,a).getSheetObj(o),D=s[r.FORMATTYPE],l=Date.parse(i);"CUSTOM"!=D||isNaN(i)||(l=void 0);var c=!(!n||"="!=n[0]),u=A.Picklist.isXists(T,E);return!(!(l||""==i&&"CUSTOM"!=D)||c||u)}(t,o,a,s,u,D,l,c),I="UNDEFINED"==v?"DATETIME"==c[r.FORMATTYPE]:"DATETIME"==v;C&&d?E(0,0,0,s,c[r.DATEFMRT],c[r.TIMEFMRT],I):M&&"DATE"==M.properties.type&&E(0,0,0,s,void 0,void 0,void 0)}},function(){})}},"RID","SHEETID","VERSION","ActiveRange","MOUSECLICK")}(this);
!function(e){var t,i=e.sPlusPlus,o=e.ZSConstants.FeatureConstants,n=e.ZSEvents,r=n.topic,a=n.Groups,s=n.Names,l=!1,c=void 0,u=!1,C=[],f=0,L=i.view.Toolbar.Feature[o.AUTOCOMPLETE];i.data.Defaults.MAX_ROW;var g=JSUtil.fn.debounce(function(t,i,o,n){e.UserAction.PickFromList(t,[i],o,!0,n)},100);function v(e,t){var i=e.toLowerCase(),o=t.toLowerCase();return i<o?-1:i>o?1:0}function w(e,t,i,o,n){clearTimeout(f),f=setTimeout(function(){var r=function(e,t){for(var i="",o=!1,n=0,r=(C=(C=t.DisplayValue?t.DisplayValue:t).sort(v)).length-1,a=e.toLowerCase();r>=n;){var s=(r+n)/2|0,c=C[s],u=c.toLowerCase();if(c&&0==u.indexOf(a)){i&&i.toLowerCase()==u&&(o=!1),i=C[s];var f=C[s-1],L=C[s+1];if(f&&u!=f.toLowerCase()&&0==f.toLowerCase().indexOf(a)||L&&u!=L.toLowerCase()&&0==L.toLowerCase().indexOf(e.toLowerCase()))return;if(o)return;o=!0}if(C[s].toLowerCase()<a)n=s+1;else{if(!(C[s].toLowerCase()>a))return;r=s-1}}""==i&&(l=!0);return i}(o,n);r&&E(r,e,t,i)},10)}function E(e,i,o,n){var l=t.length;if(!(l>=e.length)&&-1!=e.toLowerCase().indexOf(t.toLowerCase())){var u=e.slice(t.length,e.length);r.publish(a.Listener,s.CellAction.CELLSUGGESTION.ADD,{RID:i,SHEETID:o,VERSION:n,VALUE:t+u,POS:l}),c=e}}function S(){l=!1,c=void 0}r.register(a.Listener,s.CellAction.CELLSUGGESTION.GET,function(o,n){if(L.isEnabled){var r=i.view.getActiveGridID(),a=i.view.getResourceID(r),s=i.view.getSheetID(r),f=i.view.getVersionID(r),v=i.data.getWorkBook(a,f).getSheetObj(s),S=i.view.getSheetState(r,s),O=S.getActiveCellRange(),D=O.startCol,d=O.startRow;if(!v.DataValidation.isIntersecting(S.getActiveCellRange())){var A=o.slice(0,n),h=new RegExp("[a-zA-Z]");o.length==n&&!l&&h.test(A)&&(t=A,c&&0==c.toLowerCase().indexOf(A.toLowerCase())?E(c,a,s,f):function(t,i,o,n,r,a){C.length?w(i,o,n,t,C):(C=[],!u&&e.UserAction.getPickListRange(i,[o],n,function(e,i,o,n){var s=function(e,t,i,o,n,r){r=r[o],w.call(this,e,t,i,n,r)}.bind(this,e,i,o,a,t);if(u=!0,n&&n.range){var l={activeCell:{row:r,col:a},skipNumbers:!0,filterBy:"COL",skipActiveCellData:!0};if(!n.hasString)return;new ZSClass.UniqueData(e,i,o,n.range,["DisplayValue","CellType"],s,l)}else s=w.bind(this,e,i,o,t),g(e,i,o,s)}))}(A,a,s,f,d,D))}}},"VALUE","SELCTIONPOS"),r.register(a.Listener,s.CellAction.CELLSUGGESTION.RESET_MATCH,S),r.register(a.Selector.DomUpdate.CellEdit,s.Selection.BOUND_UPDATE.REMOVE,function(){C=[],u=!1,S()})}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSConstants.FeatureConstants,n=e.UserAction,o=t.view.Toolbar.Feature[i.HIDE_ROWS],s=t.data.Defaults.MAX_ROW,a=t.data.Defaults.MAX_COL,d=e.ZSEvents,r=d.topic,D=d.Groups,S=d.Names,l=e.JSUtil;o.hide=function(){var e=t.view.getActiveGridID(),i=t.view.getResourceID(e),o=(t.view.getSheetID(e),t.view.getVersionID(e)),s=t.view.getSelectedSheets(e);n.HideRow(i,s,o,"HIDE")},o.show=function(){var e=t.view.getActiveGridID(),i=t.view.getResourceID(e),o=(t.view.getSheetID(e),t.view.getVersionID(e)),s=t.view.getSelectedSheets(e);n.HideRow(i,s,o,"SHOW")},r.register(D.Listener,S.SheetAction.HIDEROWS.ON_AFTER_ADD,function(e,i,n,o,d){if(d){var R=t.data.getWorkBook(e,n).getSheetObj(i),u=[];for(var v in o){var I,c=(I=o[v][0])+o[v][1]-1;I=(I=R.Row.Visibility.nextNonHidden(c))>=s?R.Row.Visibility.prevNonHidden(c):I;var E=R.Column.hidden.isHidden(0)?R.Column.hidden.nextNonHidden(0):0,w=R.Column.hidden.isHidden(a-1)?R.Column.hidden.prevNonHidden(a-1):a-1,g=new ZSClass.Range(I,E,I,w);!l.array.isRangeExists(g,u)&&u.push(g);var h=new ZSClass.Range(I,E,I,E)}r.publish(D.Selector.BoundUpdate.Range,S.Selection.BOUND_UPDATE.ADDRANGES,{RID:e,SHEETID:i,VERSION:n,RANGES:u,accumulate:1}),r.publish(D.Selector.BoundUpdate.Cell,S.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:i,VERSION:n,ActiveCellRange:h,ROW:h.startRow,COL:h.startCol})}},"RID","SHEETID","VERSION","data","ISACTIONOWNER")}(this);
!function(e){var i=e.sPlusPlus,t=e.ZSConstants.FeatureConstants,n=e.UserAction,s=i.view.Toolbar.Feature[t.HIDE_COLUMNS],o=e.ZSEvents,a=o.topic,r=o.Groups,d=o.Names,l=i.data.Defaults.MAX_ROW,D=i.data.Defaults.MAX_COL,S=e.JSUtil;s.show=function(){var e=i.view.getActiveGridID(),t=i.view.getResourceID(e),s=(i.view.getSheetID(e),i.view.getVersionID(e)),o=i.view.getSelectedSheets(e);n.HideCol(t,o,s,"SHOW")},s.hide=function(){var e=i.view.getActiveGridID(),t=i.view.getResourceID(e),s=(i.view.getSheetID(e),i.view.getVersionID(e)),o=i.view.getSelectedSheets(e);n.HideCol(t,o,s,"HIDE")},a.register(r.Listener,d.SheetAction.HIDECOLS.ON_AFTER_ADD,function(e,t,n,s,o){if(o){var v=i.data.getWorkBook(e,n).getSheetObj(t),R=[];for(var u in s){var I,c=(I=s[u][0])+s[u][1]-1;I=(I=v.Column.hidden.nextNonHidden(c))>=D?v.Column.hidden.prevNonHidden(c):I;var E=v.Row.Visibility.isHidden(0)?v.Row.Visibility.nextNonHidden(0):0,w=v.Row.Visibility.isHidden(l-1)?v.Row.Visibility.prevNonHidden(l-1):l-1,g=new ZSClass.Range(E,I,w,I);!S.array.isRangeExists(g,R)&&R.push(g);var A=new ZSClass.Range(E,I,E,I)}a.publish(r.Selector.BoundUpdate.Range,d.Selection.BOUND_UPDATE.ADDRANGES,{RID:e,SHEETID:t,VERSION:n,RANGES:R,accumulate:1}),a.publish(r.Selector.BoundUpdate.Cell,d.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:n,ActiveCellRange:A,ROW:A.startRow,COL:A.startCol})}},"RID","SHEETID","VERSION","data","ISACTIONOWNER")}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSEvents,n=i.topic,o=i.Groups,r=i.Names,s=e.UIUtil.Component,a=e.ZSConstants,I=e.ZSConstants.I18N,g=(a.CommandConstants,a.FeatureConstants),E=a.wCC,d=t.view.Toolbar.Feature[g.IMAGE];var c=function(e,t,i,n){var o=Math.min(i/e,n/t);return{width:e*o,height:t*o}};function v(t,i,n,o){e.UserAction.uploadImage(t,i,n,o)}-1!=ZSConstants.Meta.DisableFeaturesList.indexOf(g.IMAGE)&&s.disable(d.imageBtn),d.remove=function(){var e=t.view.getActiveGridID(),i=t.view.getResourceID(e),s=t.view.getSheetID(e),a=t.view.getVersionID(e);n.publish(o.Listener,r.UserAction.IMAGES.DELETE,{RID:i,SHEETID:s,VERSION:a})},d.saveAS=function(){var e=t.view.getActiveGridID(),i=t.view.getGridComponent(e).Image.getActive(),n=Object.keys(i)[0],o=t.view.getResourceID(e),r=t.view.getSheetID(e),s=t.view.getVersionID(e),a=t.data.getWorkBook(o,s).getSheetObj(r).Images.get(n),I=document.createElement("img"),g=a.getURL();I.src=g;var E=a.getWidth(),d=a.getHeight();document.body.appendChild(I),I.onload=function(){var e,t=document.createElement("canvas"),i=t.getContext("2d");t.width=E,t.height=d,i.drawImage(I,0,0,E,d),e=-1==g.indexOf("u_n")?g:(e=t.toDataURL("image/png;base64")).replace("image/png","image/octet-stream");var n=document.createElement("a");n.href=e,n.download=a.getName(),document.body.appendChild(n),n.click(),document.body.removeChild(n)},document.body.removeChild(I)},d.clone=function(){var e=t.view.getActiveGridID(),i=t.view.getResourceID(e),s=t.view.getSheetID(e),a=t.view.getVersionID(e);n.publish(o.Listener,r.UserAction.IMAGES.CLONE,{RID:i,SHEETID:s,VERSION:a})},d.resize=function(){var e=t.view.getActiveGridID(),i=t.view.getResourceID(e),s=t.view.getSheetID(e),a=t.view.getVersionID(e);n.publish(o.Listener,r.UserAction.IMAGES.RESIZE_TO_ORIGINAL,{RID:i,SHEETID:s,VERSION:a})},d.replace=function(e){var i=t.view.getActiveGridID(),s=t.view.getResourceID(i),a=t.view.getSheetID(i),I=t.view.getVersionID(i);n.publish(o.Listener,r.UserAction.IMAGES.REPLACE,{RID:s,SHEETID:a,VERSION:I})},n.register(o.Listener,r.SheetAction.IMAGES.UPLOAD,function(i,n,o,r,s){var a=t.data.getWorkBook(i,o).getSheetObj(n),I=a.Prop.Name,g=t.view.getActiveGridID(),E=t.view.getSheetState(g,n),d=t.view.getSelectedSheets(g),v=[],A=-1==t.data.AppRegistry.ZFSNG_PRODUCT_TYPE,D=a.Row.auxiliaryAxis,u=a.Column.auxiliaryAxis;e.ZSDevTools.Logger.log("Inserting image data >>> ",s),s&&e.ZSDevTools.Logger.log("cond check >>> ","INSERT"!==s.onInsertType);var l,S,m,R,M=s&&"INSERT"!==s.onInsertType?"IMAGE_REPLACE":"IMAGE_NEW",h=!(!s||"Library"!==s.insertFrom),w=!!s&&s.isInsertFromWeb;for(var G in r){var p={},T=r[G],f={};["IMAGE_EXTENSION","IMAGE_NAME","IMAGE_HEIGHT","IMAGE_WIDTH","AUTHOR_ID","RESOURCE_ID","IMAGE_URL","IMAGE_ID"].forEach(function(e){T[e]&&(f[e]=encodeURIComponent(T[e]))});var L=E.getScreenHeights()[0],_=E.getScreenWidths()[0],O=Math.round(_/1.3),C=Math.round(L/1.3),N=f.IMAGE_WIDTH,b=f.IMAGE_HEIGHT;if(N&&b&&(N>O||b>C)){var U=c(N,b,O,C);N=Math.round(U.width),b=Math.round(U.height)}var y,P,H,x,F,V,k=E.getScrollTops()[0],W=E.getScrollLefts()[0];if(S)H=Math.round(l+parseInt(m)/2),x=Math.round(S+parseInt(R)/2),y=D.findAbs(x),P=u.findAbs(H),F=x-D.getPos(y),V=H-u.getPos(P);else{var Z=b||0,j=N||0;x=Math.round(L/2-Z/2+k),H=Math.round(_/2-j/2+W),y=a.Row.auxiliaryAxis.findAbs(x),P=a.Column.auxiliaryAxis.findAbs(H),F=0,V=0}l=H,S=x,m=N||40,R=b||40,p={row:y,column:P,sRowDiff:F,sColDiff:V,resId:f.RESOURCE_ID,imgNm:f.IMAGE_NAME,isRemoteMode:A,insertFromLib:h},s&&"INSERT"!==s.onInsertType&&(p.imgId=s.onInsertType),s&&f.IMAGE_URL&&w&&(p.imgurl=f.IMAGE_URL),s&&f.IMAGE_ID&&(p.imgId=f.IMAGE_ID),N&&(p.imgWd=N),b&&(p.imgHt=b),v.push(p)}r.length&&e.UserAction.ImageAction(i,d,o,I,M,v)},"RID","SHEETID","VERSION","IMAGES","DATA"),n.register(o.Listener,r.UserAction.DRAG_DROP.DROPEND,function(e,t,i,n){var o=n[0].name,r=o.lastIndexOf("."),s=o.substring(r+1).toLowerCase(),a={onDrop:v},g={allowedFileTypes:["png","bmp","jpeg","jpg","svg","gif"],maxFileSize:1e7,alertMsg:I["LP.UPLOAD.ERROR_MSG.MAX_LIMIT"]};-1!=g.allowedFileTypes.indexOf(s)&&new ZSClass.DragAndDrop(e,t,i,n,g,a).validate()},"RID","SHEETID","VERSION","FILES"),n.register(o.UI,r.Layout.DEFER_JS_LOADED,function(){s.addFComponentsFiles()}),n.register(o.UI,r.Toolbar.INIT_MENU,function(e){if("TB_INSERT_POPUP_CONTAINER"==e.id){var i=t.view.getActiveGridID(),n=t.view.getSheetID(i),o=t.view.getResourceID(i),r=t.view.getVersionID(i),a=t.data.getWorkBook(o,r).ProtectedSheets.isSheetLocked(n),I=ZSConstants.Meta.DisableFeaturesList;a||-1!=I.indexOf(g.IMAGE)?s.disable("#"+E.MI+g.IMAGE+E.MENU):s.enable("#"+E.MI+g.IMAGE+E.MENU)}},"DOM")}(this);
!function(e){if(!e.isCanvasGrid){var t=e.sPlusPlus,a=e.ZSClass,n=a.UIGridComponent.prototype,i=e.ZSConstants.CommandConstants;n.onImageMeta=function(e,t,a,n){for(var i=0,o=n.length;i<o;i++)this.onInsertImage(e,t,a,n[i])},n.onInsertImages=function(e,t,a,n){for(var o=0,s=n.length;o<s;o++){this.onInsertImage(e,t,a,n[o]);var g=n[o][i.IMAGE_ID];this.Image.focus(g)}},n.onInsertImage=function(e,t,a,n){var g=n[i.IMAGE_ID];o.call(this,e,t,a,g),s.call(this,e,t,a,g)},n.DeleteImage=function(e,t,a,n){(function(e,t,a,n){this.Image.delete(n)}).call(this,e,t,a,n)},n.onDeleteImage=function(e,t,a,n){for(var o=0,s=n.length;o<s;o++){var l=n[o][i.IMAGE_ID];g.call(this,e,t,a,l)}},n.onMoveImage=function(e,t,a,n){for(var i=0,o=n.length;i<o;i++)this.moveImage(e,t,a,n[i])},n.moveImage=function(e,t,a,n){var s=n[i.IMAGE_ID];o.call(this,e,t,a,s)},n.onResizeImage=function(e,t,a,n){for(var i=0,o=n.length;i<o;i++)this.resizeImage(e,t,a,n[i])},n.resizeImage=function(e,t,a,n){var s=n[i.IMAGE_ID];o.call(this,e,t,a,s)},n.CloneImage=function(e,t,n,i){(function(e,t,n,i){var o=new a.Layer.Modules.Clone.Helper(100,100);this.Image.clone(i,o)}).call(this,e,t,n,i)},n.onRepaintImage=function(e,a,n){(function(e,a,n){var i=t.data.getWorkBook(e,n).getSheetObj(a).Images.getMap();for(var g in i)o.call(this,e,a,n,g),s.call(this,e,a,n,g)}).call(this,e,a,n)},n.onReplaceImage=function(e,t,a,n){for(var i=0,o=n.length;i<o;i++)this.replace(e,t,a,n[i])},n.replace=function(e,t,a,n){var g=n[i.IMAGE_ID];o.call(this,e,t,a,g),s.call(this,e,t,a,g)},n.ResizeToOriginal=function(e,a,n,i,o,s){i=i||l.call(this);(function(e,a,n,i,o,s){t.data.getWorkBook(e,n).getSheetObj(a).Images.get(i),this.Image.resizeToOriginal(i)}).call(this,e,a,n,i,o,s)},n.replaceImage=function(e,t,a,n){n=n||l.call(this);this.Image.replaceImage(n)}}function o(e,a,n,i){t.data.getWorkBook(e,n).getSheetObj(a).Images.get(i)&&this.Image&&this.Image.place(i)}function s(e,a,n,i){t.data.getWorkBook(e,n).getSheetObj(a).Images.get(i);this.Image&&this.Image.setImageSrc(i)}function g(e,t,a,n){this.Image.remove(n)}function l(){var e=this.Image.getActive();for(var t in e)return t}}(this);
!function(t){var e=t.ZSClass,a=e.Layer||(e.Layer={}),i=a.Image||(a.Image={});function n(){var t=document.createElement("div"),e=document.createElement("img");t.appendChild(e),t.classList.add("ZSOLEImage"),this.image=e,this.Dom=t}n.prototype={setName:function(t){this.image.name=t},setImageSrc:function(t){this.image.src=t},getNaturalHeight:function(){return this.image.naturalHeight},getNaturalWidth:function(){return this.image.naturalWidth},appendTo:function(t){t.appendChild(this.Dom)},remove:function(){this.Dom.remove()}},i.UIImage=n}(this);
!function(e){var t,i=e.sPlusPlus,r=e.ZSConstants,n=e.ZSEvents,I=n.topic,o=n.Groups,s=n.Names,E=r.FeatureConstants,a=r.I18N,c=e.UIUtil.Component,S=r.wCC,u=i.view.Toolbar.Feature[E.HIDEGRIDLINES];document.querySelector(".gridContainer");function d(e){t=!!e[1]}I.register(o.Listener,s.SheetAction.GRID_LINES.META,d,"SHOW_GRID"),I.register(o.Listener,s.SheetAction.GRID_LINES.MODIFY,d,"SHOW_GRID"),I.register(o.Listener,s.DocMeta.ACTIVE_SHEET,function(e,r,n){var I=i.data.getWorkBook(e,n).getSheetObj(r);t=I.IsShowGrid},"RID","ACTIVE_SHEET","VERSION"),u.execute=function(){t=!t;var r=i.view.getActiveGridID(),n=i.view.getResourceID(r),I=(i.view.getSheetID(r),i.view.getVersionID(r)),o=i.view.getSelectedSheets(r);e.UserAction.hideGridInViewport(n,o,I,t)},I.register(o.UI,s.Toolbar.INIT_MENU,function(e){for(var i=document.querySelectorAll("#"+S.MI+E.HIDEGRIDLINES+S.MENU),r=0;r<i.length;r++)if(i[r].parentElement,"TB_VIEW_POPUP_CONTAINER"==e.id){var n=t?a["View.Gridlines.Hide"]:a["View.Gridlines.Show"];c.zmenu("#TB_VIEW_POPUP_CONTAINER","setMenuItemsAttribute",["#"+S.MI+E.HIDEGRIDLINES+S.MENU],"label",n);var I=document.querySelector(".gridContainer");t?I.classList.add("hideGrid"):I.classList.remove("hideGrid")}},"DOM")}(this);
!function(e){var t,r,n,i,a,s,o,l,u,c,d=e.sPlusPlus,E=e.ZSConstants.FeatureConstants,A=e.ZSConstants.wCC,C=e.document,R=e.JSUtil,v=e.UIUtil.Component,F=d.view.measures,b=(e.ZSEvents,ZSEvents.topic),g=ZSEvents.Names,m=ZSEvents.Groups,z=d.view.Toolbar.Feature[E.FREEZE],w=0,S=1,p=2,h=3,I=4,f=5,D=6,L=7,M=R.fn,O=e.ZSConstants.I18N,Z=d.data.Defaults;function U(){var e=C.createElement("li");return e.setAttribute("mtype","separator"),e}function k(e){var t=d.view.getActiveGridID(),r=d.view.getResourceID(t),n=d.view.getSheetID(t),i=d.view.getVersionID(t),a=d.data.getWorkBook(r,i),s=d.view.getSelectedSheets(t),o=d.view.getSheetState(t,n),l=o.getActiveRow()>Z.MAX_ROW_FREEZE-1?Z.MAX_ROW_FREEZE-1:o.getActiveRow(),u=o.getActiveCol()>Z.MAX_COL_FREEZE-1?Z.MAX_COL_FREEZE-1:o.getActiveCol(),c=a.getSheetObj(n),E=c.Column.FreezedCount,A=c.Row.FreezedCount;switch(e){case I:UserAction.Freeze(r,s,i,l+1,E);break;case f:UserAction.Freeze(r,s,i,A,u+1);break;case D:UserAction.Freeze(r,s,i,0,E);break;case L:UserAction.Freeze(r,s,i,A,0);break;case S:UserAction.Freeze(r,s,i,1,E);break;case p:UserAction.Freeze(r,s,i,A,1);break;case w:UserAction.Freeze(r,s,i,l+1,u+1);break;case h:UserAction.Freeze(r,s,i,0,0)}}function P(t,r,n,i,a){if(l){var s=d.view.getActiveGridID();if(t&&r&&n){if(t!==d.view.getResourceID(s)||r!==d.view.getSheetID(s)||n!==d.view.getVersionID(s))return}else t=d.view.getResourceID(s),r=d.view.getSheetID(s),n=d.view.getVersionID(s);var o,u,c,E=d.data.getWorkBook(t,n),A=d.view.getSheetState(s,r),C=E.getSheetObj(r),R=a||C.Column.FreezedCount,v=i||C.Row.FreezedCount,b=d.view.getGridComponent(s);if(e.isCanvasGrid)o=b.getHeight(),u=b.getWidth(),c=b.getZoom();else{var g=b.getRects();o=g.height,u=g.width,c=A.getZoom()}var m=(o-(F.Grid.ColHeader+F.Grid.HScrollBar))/c,z=(u-(F.Grid.RowHeader+F.Grid.VScrollBar))/c,w=(C.Row.auxiliaryAxis.findAbs(m),C.Column.auxiliaryAxis.findAbs(z),C.Row.auxiliaryAxis.getPos(v)/m*100),S=C.Column.auxiliaryAxis.getPos(R)/z*100;w>=90||S>=90?l.show():l.isShown&&l.hide()}}u=C.getElementById("popupmenu"),(c=C.createElement("ul")).id=A.SUBMENUITEM+E.FREEZE+A.IDENTITY,c.appendChild(function(){var e=C.createElement("li");return e.setAttribute("data",'{"label":"'+O["MenuItem.DataTab.Freeze.FreezeFirstRow"]+'"}'),e.setAttribute("id","freezeFirstRow"),e.addEventListener("click",function(){k(S)}),e}()),c.appendChild(function(){var e=C.createElement("li");return e.setAttribute("data",'{"label":"'+O["MenuItem.DataTab.Freeze.FreezeFirstColumn"]+'"}'),e.setAttribute("id","freezeFirstCol"),e.addEventListener("click",function(){k(p)}),e}()),c.appendChild(U()),c.appendChild(((t=C.createElement("li")).setAttribute("data",'{"label":"freeze upto 2nd Row"}'),t.setAttribute("id","freezeRow"),t.addEventListener("click",function(){k(I)}),t)),c.appendChild(((r=C.createElement("li")).setAttribute("data",'{"label":"freeze upto B Column"}'),r.setAttribute("id","freezeCol"),r.addEventListener("click",function(){k(f)}),r)),c.appendChild(((n=C.createElement("li")).setAttribute("data",'{"label":"Freeze upto Row 2 & B Column"}'),n.setAttribute("id","freezeCell"),n.addEventListener("click",function(){k(w)}),n)),i=U(),c.appendChild(i),c.appendChild(((a=C.createElement("li")).setAttribute("data",'{"label":"'+O["FreezePanes.UnfreezeRow"]+'"}'),a.addEventListener("click",function(){k(D)}),a)),c.appendChild(((s=C.createElement("li")).setAttribute("data",'{"label":"'+O["FreezePanes.UnfreezeCol"]+'"}'),s.addEventListener("click",function(){k(L)}),s)),c.appendChild(((o=C.createElement("li")).setAttribute("data",'{"label":"'+O["FreezePanes.UnfreezeCells"]+'"}'),o.addEventListener("click",function(){k(h)}),o)),u.appendChild(c),v.bind(c,"zmenubeforeshow",function(e,l){!function(e,l){var u,c,E,A=d.view.getActiveGridID(),C=d.view.getResourceID(A),F=d.view.getSheetID(A),b=d.view.getVersionID(A),g=d.data.getWorkBook(C,b).getSheetObj(F),m=g.Column.FreezedCount,z=g.Row.FreezedCount,w=d.view.getSheetState(A,F),S=(w.getActiveCellRange(),w.getActiveCellRange()),p=(S.startRow,S.startCol,S.endRow),h=S.endCol;u=p,c=h,u=p>Z.MAX_ROW_FREEZE-1?Z.MAX_ROW_FREEZE-1:p,c=h>Z.MAX_COL_FREEZE-1?Z.MAX_COL_FREEZE-1:h,E=R.Object.getCharForNum(c+1),v.zmenu(l.menu,"setMenuItemsAttribute",[t],"label",M.replaceParams(O["FreezePanes.FreezeRowUpto"],new Array(u+1+""))),v.zmenu(l.menu,"setMenuItemsAttribute",[r],"label",M.replaceParams(O["FreezePanes.FreezeColUpto"],new Array(E))),v.zmenu(l.menu,"setMenuItemsAttribute",[n],"label",M.replaceParams(O["FreezePanes.FreezeCellsUpto"],new Array(u+1+"",E))),v.enable(r),v.enable(t);var I=O["FreezePanes.Unfreeze"],f=O["FreezePanes.and"],D=z>1?O["FreezePanes.Rows"]:O["FreezePanes.Row"],L=m>1?O["FreezePanes.Cols"]:O["FreezePanes.Col"],U=I+" "+D,k=I+" "+L,P=I+" "+D+" "+f+" "+L;v.zmenu(l.menu,"setMenuItemsAttribute",[a],"label",U),v.zmenu(l.menu,"setMenuItemsAttribute",[s],"label",k),v.zmenu(l.menu,"setMenuItemsAttribute",[o],"label",P),a.style.display=0==z?"none":"",s.style.display=0==m?"none":"",o.style.display=0!=z&&0!=m?"":"none",i.style.display=0==z&&0==m?"none":""}(0,l)}),z.execute=k,b.register(m.UI,g.Layout.TEMPLATE_LOADED_DEFER,function(){var e=C.createElement("t");e.innerText=O["FreezePanes.GetBetterVisibility"],e.className="shBtnNtftInfoTxt",l=new ZSClass.InfoBanner(e),!0,P()}),b.register(m.Listener,g.Browser.RESIZE,P),b.register(m.Listener,g.SheetAction.ZOOM.On,P),b.register(m.Listener,g.SheetAction.HIDEROWS.ADD,P),b.register(m.Listener,g.SheetAction.HIDEROWS.REMOVE,P),b.register(m.Listener,g.SheetAction.ROW_HEADERS.RESIZE.ENUMERATE,P),b.register(m.Listener,g.SheetAction.HIDECOLS.ADD,P),b.register(m.Listener,g.SheetAction.HIDECOLS.REMOVE,P),b.register(m.Listener,g.SheetAction.COLUMN_HEADERS.RESIZE.ENUMERATE,P),b.register(m.Listener,g.SheetMeta.FREEZE,P,"RID","SHEETID","VERSION","FreezedRow","FreezedCol")}(this);
!function(e){var t,n,r,s,l,a,o,i,c,u,v,S=e.sPlusPlus,R=e.ZSEvents,g=R.topic,f=R.Groups,p=R.Names,E=e.ZSConstants.FeatureConstants,h=e.JSUtil,L=e.ZSConstants.I18N,d=(e.document,e.ZSClass),I=d.Range,D=S.data.Defaults.MAX_COL;function A(e,t,n){return h.Range.parseRange(e,t,n)}function w(e,t,n){return h.Range.parseRange(e,t,n)||!isNaN(n)}function C(e,t,n,r,s){var l=v[h.Math.hash(e,t,D)];return l.startsWith("'")&&(l=l.substring(1,l.length-1)),r.DisplayValue=l,s}function m(){g.publish(f.Listener,p.Layers.Preview.RemoveAll,{RID:t,SHEETID:r,VERSION:n})}function V(){UserAction.PasteFromClipBoard(s,l,a,i,o),c.close()}S.view.Toolbar.Feature[E.SOLVER].execute=function(e,i,c,u,v,R,g){var f=S.view.getActiveGridID();t=S.view.getResourceID(f),n=S.view.getVersionID(f),r=sPlusPlus.view.getSheetID(f);var p=S.view.getSelectedSheets(f);if(function(e,t,n,r,s){var l=!0;A(e,t,n)&&A(e,t,r)||(l=!1);for(var a=0;a<s.length;a++)if(!A(e,t,s[a].getExpression())||!w(e,t,s[a].getValue())){l=!1;break}return l}(t,n,e,i,R)){var E={constrLHS:"",constrRHS:"",constrREL:""};R.forEach(function(e,r,s){e.getExpression();var l=h.Range.parseRange(t,n,e.getExpression()),a=l.sheetName,o=l.range,i=h.Cell.getReference(o.startRow,o.startCol);E.constrLHS+=a+","+i+",",E.constrRHS+=e.getValue()+",",E.constrREL+=e.getOperator()+",",r==s.length-1&&(E.constrLHS=E.constrLHS.slice(0,E.constrLHS.length-1),E.constrRHS=E.constrRHS.slice(0,E.constrRHS.length-1),E.constrREL=E.constrREL.slice(0,E.constrREL.length-1))}),UserAction.solver(t,n,p,e,i,c,u,g,v,E),s=t,a=n;var I=new h.Range.parseRange(t,n,i);l=[I.sheetID],o=I.range}else d.ZSAlert(L["GoalSeek.Msg.InvalidCell"],{title:L["Alert.Title.InvalidCellRange"]})},g.register(f.Listener,p.UserAction.SOLVER.RESP_HANDLE,function(t){var n,r,s,l,a,o=(t=t).solution,R=t.noNumber,E=t.exceptionformulaConstraint,A=t.exceptionformula,w=t.exception;if(null==R)if(null==A)if(null==E)if(null==w){if(null!=o){t.clientUpdatJson;var H=t.resultValue,N=t.variableCellValues;return i=N,t.oldValues,function(t){c||function(){var t=e.UserAction.getTemplate(["solverResponseTemplate"]).solverResponseTemplate;u=t.querySelector("#solverResultVal"),t.querySelector("#okBtn").addEventListener("click",V),t.querySelector("#clBtn").addEventListener("click",function(){c.close()});var n=document.createElement("div");n.id="DI_SOLVER_RESULT",n.appendChild(t);var r={modal:!0,width:560,title:L["MenuItem.DataTab.Solver"],close:m,open:function(){}};c=new d.Dialog(n,r)}(),u.innerText=t,c.open()}(H),n=t.clientUpdatJson,r=S.view.getActiveGridID(),s=S.view.getResourceID(r),l=S.view.getSheetID(r),a=S.view.getVersionID(r),v={},void e.ZSResponseParser.ExtractCellInfo(n,s,l).forEach(function(e){v[h.Math.hash(e.r,e.c,D)]=e.displayValue,g.publish(f.Listener,p.Layers.Preview.Place,{RID:s,SHEETID:l,VERSION:a,RANGE:new I(e.r,e.c,e.r,e.c),CALLBACK:C})})}}else d.ZSAlert(w);else d.ZSAlert(E);else d.ZSAlert(A);else d.ZSAlert(R)},["RESPONSE"])}(this);
!function(e){var t,n,s,a,i,r=e.sPlusPlus,l=e.ZSEvents,o=l.topic,g=l.Groups,u=l.Names,c=e.ZSConstants.FeatureConstants,v=e.JSUtil,S=(e.document,e.ZSClass),I=S.Range,d=e.ZSConstants.I18N,p=e.UIUtil.Component,C=r.data.Defaults.MAX_COL,h=r.view.Toolbar.Feature[c.GOAL_SEEK];function w(e,t,n,s,a){var r=i[v.Math.hash(e,t,C)];return r.startsWith("'")&&(r=r.substring(1,r.length-1)),s.DisplayValue=r,a}h.execute=function(){var i,l,o=r.view.getActiveGridID(),g=r.view.getResourceID(o),u=r.view.getSheetID(o),c=r.view.getVersionID(o),I=r.data.getWorkBook(g,c),C=I.getSheetObj(u).Prop.getName(),h=C,w=C,A=document.querySelector("#gsTargetCell").textContent,D=document.querySelector("#gsVariantCell").textContent;if(A.contains(".")){var R=A.split("."),f=R[0];w=v.fn.removeSingleQuotes(f),A=R[1]}if(D.contains(".")){var m=D.split("."),E=m[0];h=v.fn.removeSingleQuotes(E),D=m[1]}A&&D||(i=d["GoalSeek.Msg.InvalidCell"],l=d["Alert.Title.InvalidCellRange"]);var L=p.zspinner("#gsResult","getValue");if(i||L||(i=d["GoalSeek.Msg.Blank"],l=d["Alert.Title.EnterResultValue"]),i)S.ZSAlert(i,{title:l});else{var P=r.view.getSelectedSheets(o),V=I.SheetList.getIdByName(h);t=g,s=c,n=[V],a=new v.Range.parseRange(g,c,D).range,e.UserAction.goalSeek(g,P,c,h,w,D,A,L)}},o.register(g.Listener,u.UserAction.GOALSEEK_PROMPT,function(l,c,d,p,A,D){void 0!=D?(h.closeDialog(),h.openResultDialog(p,A,D),l.clientUpdatJson,h.initCopyParams(t,s,n,a,D),R=l.clientUpdatJson,f=r.view.getActiveGridID(),m=r.view.getResourceID(f),E=r.view.getSheetID(f),L=r.view.getVersionID(f),i={},e.ZSResponseParser.ExtractCellInfo(R,m,E).forEach(function(e){var t=new I(e.r,e.c,e.r,e.c);i[v.Math.hash(e.r,e.c,C)]=e.displayValue,o.publish(g.Listener,u.Layers.Preview.Place,{RID:m,SHEETID:E,VERSION:L,RANGE:t,CALLBACK:w})})):S.ZSAlert(p);var R,f,m,E,L},"response","columnIndex","rowIndex","message","TargetCellValue","solution")}(this);
!function(e){var t,r,i,s,o=e.sPlusPlus,a=e.ZSEvents,n=e.ZSConstants,l=a.topic,c=a.Groups,E=a.Names,m=e.ZSConstants.FeatureConstants,p=e.JSUtil,g=(e.document,e.ZSClass),T=(g.Range,n.I18N),R=(e.UIUtil.Component,o.view.Toolbar.Feature[m.IMPORT]);function S(t,r,i,s,a,n,l){var c=o.view.getActiveGridID(),E=o.view.getResourceID(c),m=o.view.getVersionID(c),p=o.view.getSelectedSheets(c);e.UserAction.fileImport(E,p,m,r,i,t,s,d.initial,a,n,l)}function I(e,t,r,i){R.openDialog(),R.Dialog.fileAttach(i)}var u,d={replaceDocument:function(t,r,i){i.ln,o.data.UserInfo.loginName;e.location.reload()},replaceCurrentSheet:function(e,t,r){r.ln==o.data.UserInfo.loginName&&R.closeDialog()},initial:function(r,i,s,a,n){if(UserAction.importingNotification&&UserAction.importingNotification.remove(),!P(a)&&a.rid){var l=o.view.getActiveGridID();switch(n){case"IMPORT_CREATE_NEW":case"IMPORT_AS_TEMPLATE":R.closeDialog();var c=UserAction.getTemplate(["STATUS_ALERT"]).STATUS_ALERT;c.querySelector("#msg").innerText=T["Import.SuccessMsg"];var E=c.querySelector("#fileLink");E.href=o.data.AppRegistry.ctxpath+o.data.AppRegistry.ClientURI+a.rid,E.target="_blank",E.innerText=a.fname,E.title=a.fname;var m=[{text:T["MenuItem.FileTab.Open"],primary:!0,click:function(){window.open(E.href,"_blank")}},{text:T.Close,cilck:function(){R.closeDialog()}}];g.ZSAlert(c,{type:"success",title:T["Alert.Title.ImportSuccessful"],isHtml:!0,buttons:m});break;case"IMPORT_REPLACE_DATA_STARTING_AT_CELL":i=o.view.getSelectedSheets(l);var S=p.Range.parseRange(r,s,t);a.startCell=S.range,e.UserAction.import(r,i,s,n,a,P),R.closeDialog(),new g.TBNotification(T["Import.ProgressMsg.ReplaceDataStartingAtCell"],{type:"info"}).show();break;case"IMPORT_INSERT_AS_NEW_SHEETS":A(l,r,i,s,a,n,T["Import.ProgressMsg.InsertNewSheets"]);break;case"IMPORT_REPLACE_SPREADSHEET":A(l,r,i,s,a,n,T["Import.ProgressMsg.ReplaceSpreadsheet"]);break;case"IMPORT_REPLACE_CURRENTSHEET":A(l,r,i,s,a,n,T["Import.ProgressMsg.ReplaceCurrentSheet"]);break;case"IMPORT_APPEND_ROWS_TO_CURRENTSHEET":A(l,r,i,s,a,n,T["Import.ProgressMsg.AppendRowsToCurrentSheet"])}}}};function A(t,r,i,s,a,n,l){i=o.view.getSelectedSheets(t);var c=o.view.getSheetID(t),E=o.view.getSheetState(t,c).getActiveRange().getLabel(),m=p.Range.parseRange(r,s,E);a.startCell=m.range,e.UserAction.import(r,i,s,n,a,P),R.closeDialog(),new g.TBNotification(l,{type:"info"}).show()}function P(e){u&&u.remove();var t,r=!1,i=T["Error.Import"],s=!0;if(400===e.status||500==e.status)r=!0,"Error.Import.FileSizeExceed"==e.responseText&&(R.Dialog?R.Dialog.errorMsg="errorMsg2":t=T["Import.Error.FileSizeExceed"]);else if(200===e.status&&null!=e.em){var o=e.em;if(-2==o)R.openEncryptedDialog(e.files),document.getElementById("SetPassword").focus(),r=!0;else if(103==o)document.getElementById("wrongPasswordMessage").style.visibility="visible",document.getElementById("SetPassword").focus(),document.getElementById("SetPassword").select(),document.getElementById("ApplyBtn").disabled=!0;else{s=!1,r=!0;var a=o.split("#");i=p.fn.replaceParams(T[a[0]],new Array(a[1]+""))}}if(r)if(R.Dialog)R.Dialog.showErrorMsg(i,s);else{var n=t||i;(u=new g.TBNotification(n,{mode:"STD",type:"error",showCloseBtn:!0})).show()}return r||R.closePasswordDialog(),r}R.execute=function(){switch(this.importOption,this.importOption){case"createNew":r="IMPORT_CREATE_NEW";break;case"importAsTemplate":r="IMPORT_AS_TEMPLATE";break;case"replaceSpreadsheet":r="IMPORT_REPLACE_SPREADSHEET";break;case"insertSheets":r="IMPORT_INSERT_AS_NEW_SHEETS";break;case"replaceCurrSheet":r="IMPORT_REPLACE_CURRENTSHEET";break;case"appendRows":r="IMPORT_APPEND_ROWS_TO_CURRENTSHEET";break;case"replaceData":r="IMPORT_REPLACE_DATA_STARTING_AT_CELL";var e=this.DOM.container.querySelector("#scell").textContent;t=e.trim()}"csv"!=this.format&&"tsv"!=this.format||(this.isURLImport?"Custom"==(s=UIUtil.Component.zcombo(this.DOM.delimiter2,"getValue"))&&""==(s=this.DOM.customDelimiter2.value.trim())&&(s="csv"==this.format?"Comma":"Tab"):"Custom"==(s=UIUtil.Component.zcombo(this.DOM.delimiter1,"getValue"))&&""==(s=this.DOM.customDelimiter1.value.trim())&&(s="csv"==this.format?"Comma":"Tab")),i=this.isURLImport,S(r,this.files,i,s,null)},R.executeFromCloudImport=S,R.importEncryptedAction=function(e,t){S(r,t,i,s,e)},R.hideWrongPasswordMessage=function(){document.getElementById("wrongPasswordMessage").style.visibility="hidden",document.getElementById("ApplyBtn").disabled=!1},l.register(c.Listener,E.UserAction.TEMPLATE_IMPORT,function(){R.openDialog(),importOptions[1].checked=!0,importDialogObject.querySelector("#importOptions").style.display="none"}),l.register(c.Listener,E.DocAction.IMPORT.REPLACE_SPREADSHEET,d.replaceDocument,"RID","VERSION","IMPORT"),l.register(c.Listener,E.DocAction.IMPORT.REPLACE_CURRENTSHEET,d.replaceCurrentSheet,"RID","VERSION","IMPORT"),l.register(c.Listener,E.UserAction.DRAG_DROP.DROPEND,function(e,t,r,i){var s=i[0].name,o=s.lastIndexOf("."),a=s.substring(o+1).toLowerCase(),n={onDrop:I},l={allowedFileTypes:["ods","xlsx","xls","xlsm","csv","tsv","sxc"],maxFileSize:1e7,alertMsg:T["Error.Import.FileSizeExceed"]};-1!=l.allowedFileTypes.indexOf(a)&&new g.DragAndDrop(e,t,r,i,l,n).validate()},"RID","SHEETID","VERSION","FILES")}(this);
!function(e){var s,t=e.sPlusPlus,o=e.ZSConstants.FeatureConstants,i=e.document,n=(e.UserAction,e.ZSConstants.wCC,e.ZSConstants.I18N),r=(e.UIUtil.Component,t.data.AppRegistry);t.view.Toolbar.Feature[o.IMPORT_FROM_CLOUD_DRIVES].openDialog=function(){var e,t;s||(e=n["MenuItem.FileTab.LoadingCloudDrives"],t={mode:"STD",type:"info",showCloseBtn:!1},s=new ZSClass.TBNotification(e,t)),s.show();var o=window.location.host,a=i.createElement("iframe");a.id="cloudPicker",a.style.width="100%",a.style.height="100%",a.style.zIndex="999",a.style.top="0px",a.style.position="absolute",a.src="//"+r.gadgetUrl+"/CloudPicker?frameorigin=https://"+o+"&sources=gdrive,box,skydrive,dropbox&fileMimeTypes=gsheet,xlsx,xls,xlsm,ods,sxc,csv,tsv&fileExtensions=xlsx,xls,xlsm,ods,sxc,csv,tsv&zservice=zsheet&attachLimit=1&serURL=https://"+o+"/sheet/appsheet/pages/CloudPicker.jsp",a.addEventListener("load",function(e){s.remove()}),a.addEventListener("error",function(e){s.remove()}),i.body.appendChild(a)}}(this);
!function(e){var o,t,r,s,i=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,a=e.document,l=e.UserAction,d=(e.ZSConstants.wCC,e.ZSConstants.I18N),u=e.JSUtil,v=(e.UIUtil.Component,i.data.AppRegistry),c=i.view.Toolbar.Feature[n.EXPORT_TO_CLOUD_DRIVES];function p(e,o,t,r){var s={mode:o,type:t,showCloseBtn:r};return new ZSClass.TBNotification(e,s)}function D(e){var o;switch(e){case"gdrive":o="Google Drive";break;case"box":o="Box";break;case"skydrive":o="SkyDrive";break;case"dropbox":o="Dropbox"}return o}c.openDialog=function(){o||(o=p(d["MenuItem.FileTab.LoadingCloudDrives"],"STD","info")),o.show();var e=window.location.host,t=i.view.getActiveGridID(),r=i.view.getResourceID(t),s=i.view.getVersionID(t),n=i.data.getWorkBook(r,s),l=a.createElement("iframe");l.style.width="100%",l.style.height="100%",l.style.zIndex="999",l.style.top="0px",l.style.position="absolute",l.src="//"+v.gadgetUrl+"/CloudUploader?frameorigin=https://"+e+"&sources=gdrive,box,skydrive,dropbox&fileName="+n.Name+"&zservice=zsheet&serURL=https://"+e+"/sheet/appsheet/pages/CloudUploader.jsp",l.addEventListener("load",function(e){o.remove()}),l.addEventListener("error",function(e){o.remove()}),a.body.appendChild(l)},c.execute=function(e,o,n){t||(t=p(u.fn.replaceParams(d["MenuItem.FileTab.ExportToCloudDrives.SavingTo"],[D(e)]),"STD","info")),t.show();var a=i.view.getActiveGridID(),v=i.view.getResourceID(a),c=i.view.getVersionID(a);l.exportToCloudDrives(v,c,e,o,n,function(e,o){t.remove(),e=D(e),"success"==o.status?(r||(r=p(u.fn.replaceParams(d["MenuItem.FileTab.ExportToCloudDrives.SavedTo"],[e]),"DYN","info",!0)),r.show()):(s||(s=p(u.fn.replaceParams(d["MenuItem.FileTab.ExportToCloudDrives.ErrorMsg"],[e]),"DYN","info",!0)),s.show())}.bind(null,e))}}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSConstants.FeatureConstants,n=(e.document,e.ZSConstants.I18N,e.ZSConstants.wCC,e.UIUtil.Component,e.ZSEvents);n.topic,n.Groups,n.Names;t.view.Toolbar.Feature[s.SET_AS_TEXT].execute=function(s){var n=t.view.getActiveGridID(),i=t.view.getResourceID(n),o=(t.view.getSheetID(n),t.view.getVersionID(n)),r=t.view.getSelectedSheets(n);e.UserAction.FORMAT_TEXT(i,r,o)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,s=n.topic,i=n.Groups,o=n.Names,I=e.ZSConstants.FeatureConstants,C=e.document,A=(e.ZSConstants.I18N,e.ZSConstants.wCC),S=(e.UIUtil.Component,e.ZSConstants.CommandConstants),a=(e.ZSConstants.JSKeyCode,e.UIUtil.Component,e.UIUtil,0),r=t.view.Toolbar.Feature[I.THOUSAND_SEPARATOR],c=C.getElementById(A.MI+I.THOUSAND_SEPARATOR+A.IDENTITY),O={44:"COMMA_ICON",46:"DOT_ICON",39:"COMMA_ICON",160:"SPACE_ICON"};function E(e,t,n,s){var i=s.Pattern;a=i&&i[S.ISGROUPINGUSED]?1:0,c&&(a?c.classList.add("shIconActive"):c.classList.remove("shIconActive"))}s.register(i.Listener,o.SheetAction.ACTIVE_CELL.INFO,E,"RID","SHEETID","VERSION","VALUE"),s.register(i.Listener,o.DocMeta.DOC_SETTINGS,function(e){if(e&&e[S.DECIMAL_SEPARATOR]){c.innerHTML="";var t=e[S.DECIMAL_SEPARATOR],n=O[t.codePointAt(0)],s=UserAction.getTemplate([n]);c.appendChild(s[n])}},"DOC_SETTINGS"),r.execute=function(n){var s=t.view.getActiveGridID(),i=t.view.getResourceID(s),o=(t.view.getSheetID(s),t.view.getVersionID(s)),I=t.view.getSelectedSheets(s);e.UserAction.FORMAT_COMMA(i,I,o)}}(this);
!function(e){var t,n,a=e.sPlusPlus,r=e.ZSEvents,i=r.topic,E=r.Groups,T=r.Names,o=e.ZSConstants.FeatureConstants,l=e.ZSConstants.CommandConstants,A=e.document,I=ZSConstants.I18N,C=e.UserAction,c=e.ZSConstants.wCC,s=e.UIUtil.Component,u=A.getElementById("popupmenu"),R=a.view.Toolbar.Feature[o.FORMATCELLS],S=a.view.Toolbar.Feature[o.THOUSAND_SEPARATOR],L=[["GENERAL",I.General],["FLOAT",I.Number],["ACCOUNTING",I["SidePanel.FormatCells.Accounting"]],["CURRENCY",I["SidePanel.FormatCells.Currency"]],["DATE",I["MenuItem.FormatTab.Date"]],["TIME",I.Time],["PERCENTAGE",I["MenuItem.FormatTab.Percentage"]],["FRACTION",I["SidePanel.FormatCells.Fraction"]],["SCIENTIFIC",I["SidePanel.FormatCells.Scientific"]],["STRING",I["SidePanel.FormatCells.Text"]],["REGIONAL",I["SidePanel.FormatCells.Regional"]],["CUSTOM",I["Chart.Colors.Custom"]],["MoreFormats",I["MenuItem.FormatTab.MoreFormats"]]],O=A.getElementById(c.MI+"AUTOMATIC_FORMAT"+c.IDENTITY);function M(e,a){switch(e){case"CURRENCY":a.setAttribute("data-menu-id",c.SUBMENUITEM+o.CURRENCY+c.IDENTITY);break;case"DATE":a.setAttribute("data-menu-id",c.SUBMENUITEM+o.DATE+c.IDENTITY);break;case"TIME":a.setAttribute("data-menu-id",c.SUBMENUITEM+"DURATION"+c.IDENTITY);break;case"REGIONAL":t=a;break;case"CUSTOM":n=a;break;case"ACCOUNTING":a.setAttribute("data-menu-id",c.SUBMENUITEM+o.ACCOUNTING+c.IDENTITY)}}function N(e){var t=a.view.getActiveGridID(),n=a.view.getResourceID(t),r=a.view.getSelectedSheets(t),i=a.view.getVersionID(t);switch(e){case"GENERAL":R.GENERAL(n,r,i);break;case"FLOAT":R.FLOAT(n,r,i,"0",!1,"2","1",R.LOCALE());break;case"FRACTION":R.FRACTION(n,r,i,"0/0?");break;case"SCIENTIFIC":var E=2;R.SCIENTIFIC(n,r,i,E,R.LOCALE());break;case"STRING":R.TEXT(n,r,i);break;case"REGIONAL":R.REGIONAL(n,r,i,R.LOCALE(),"ZipCode");break;case"PERCENTAGE":E="2";R.PERCENTAGE(n,r,i,E,R.LOCALE());break;case"THOUSANDSEPARATOR":S.execute();break;case"MoreFormats":R.openDialog()}}function m(e){"DATETIME"==e?e="DATE":"DURATION"==e&&(e="TIME");for(var t=0;t<L.length;t++){var n=L[t];e==n[0]&&O&&(O.innerText=n[1])}}function d(){return{formatType:"AUTOMATIC",frmtAction:"generate"}}function f(e,t,n,a,r,i,E){var T={formatType:"NUMBER",frmtAction:"generate",negFrmt:e,thousandsep:t,decimals:n,leadingzeroes:a,language:r};return i&&i.length>0&&(T.prefix=i),E&&E.length>0&&(T.suffix=E),T}function U(e){return{formatType:"FRACTION",frmtAction:"generate",format:e}}function F(e,t){return{formatType:"SCIENTIFIC",frmtAction:"generate",decimals:e,language:t}}function g(){return{formatType:"TEXT",frmtAction:"generate"}}function v(e,t){return{formatType:"REGIONAL",frmtAction:"generate",language:e,format:t}}function D(e,t){return{formatType:"PERCENTAGE",frmtAction:"generate",decimals:e,language:t}}function b(e,t,n,a){if(e){var r=A.createElement("ul");for(var i in r.id=t,r.setAttribute("data-height",240),e){var E=A.createElement("li");E.innerText=a?decodeURIComponent(e[i]):e[i],E.action=i,E.addEventListener("click",n.bind(null,E)),r.appendChild(E)}u.appendChild(r)}}function p(e){var t=a.view.getActiveGridID(),n=a.view.getResourceID(t),r=a.view.getSelectedSheets(t),i=a.view.getVersionID(t),E={formatType:"CUSTOM",frmtAction:"submit",format:encodeURIComponent(e.innerText)};C.FORMATCELLS_GRID(n,r,i,null,null,E)}function G(e){var t=e.action,n=a.view.getActiveGridID(),r=a.view.getResourceID(n),i=a.view.getSelectedSheets(n),E=a.view.getVersionID(n);R.REGIONAL(r,i,E,R.LOCALE(),t)}function h(e){var t=A.querySelector("#"+c.SUBMENUITEM+"FORMATCELLS_CUSTOM"+c.IDENTITY);if(t&&(s.zmenu(t,"destroy"),t.innerHTML=""),0!=e.length){s.enable(n);for(var a=[],r=0;r<e.length;r++)a.push(e[r].value);!function(e,t,n,a){if(e){var r=A.querySelector("#"+t);if(!r){var r=A.createElement("ul");r.id=t}for(var i in r.setAttribute("data-height",240),r.setAttribute("data-width",150),e){var E=A.createElement("li");E.innerText=a?decodeURIComponent(e[i]):e[i],E.action=i,E.addEventListener("click",n.bind(null,E)),r.appendChild(E)}}}(a,c.SUBMENUITEM+"FORMATCELLS_CUSTOM"+c.IDENTITY,p,!1),s.zmenu(t)}else s.disable(n)}!function(){if(u){var e=A.createElement("ul");e.id="formatCellsMenu",e.className="shMenuNoRadius";for(var t=0;t<L.length;t++){if(t==L.length-1){var n=A.createElement("li");n.setAttribute("data-item-type","separator"),e.appendChild(n)}var n=A.createElement("li"),a=L[t];n.innerText=a[1],M(a[0],n),n.addEventListener("click",N.bind(n,a[0])),e.appendChild(n)}u.appendChild(e)}}(),R.GENERAL=function(e,t,n){C.FORMATCELLS_GRID(e,t,n,null,null,{formatType:"AUTOMATIC",frmtAction:"generate"})},R.FLOAT=function(e,t,n,a,r,i,E,T,o,l){C.FORMATCELLS_GRID(e,t,n,null,null,f(a,r,i,E,T,o,l))},R.FRACTION=function(e,t,n,a){C.FORMATCELLS_GRID(e,t,n,null,null,U(a))},R.SCIENTIFIC=function(e,t,n,a,r){C.FORMATCELLS_GRID(e,t,n,null,null,F(a,r))},R.TEXT=function(e,t,n){C.FORMATCELLS_GRID(e,t,n,null,null,{formatType:"TEXT",frmtAction:"generate"})},R.REGIONAL=function(e,t,n,a,r){C.FORMATCELLS_GRID(e,t,n,null,null,v(a,r))},R.PERCENTAGE=function(e,t,n,a,r){C.FORMATCELLS_GRID(e,t,n,null,null,D(a,r))},R.GENERAL_PARAMS=d,R.FLOAT_PARAMS=f,R.FRACTION_PARAMS=U,R.SCIENTIFIC_PARAMS=F,R.TEXT_PARAMS=g,R.REGIONAL_PARAMS=v,R.PERCENTAGE_PARAMS=D,R.UpdateCustomFormats=h,i.register(E.Listener,T.SheetAction.ACTIVE_CELL.INFO,function(t,n,r,i,E,T){var o="GENERAL";if(i.hasOwnProperty("Pattern")){var A=i.Pattern;JSUtil.Object.isEmpty(A)||(o=A[l.FORMATTYPE]),m(o)}else{var I=a.view.getActiveGridID();a.view.getSelectedSheets(I),r=a.view.getVersionID(I),a.view.fetchCellData(t,n,r,E,T,["Pattern"],I,function(e){var t=e[E][T].Pattern;JSUtil.Object.isEmpty(t)||(o=t[l.FORMATTYPE]),m(o)},function(t){e.ZSClass.Logger.log(" couldn't retrieve data from cell  ",t)})}},"RID","SHEETID","VERSION","VALUE","ROW","COLUMN"),i.register(E.Listener,T.DocMeta.DOCUMENT_LOCALE,function(e,a){a&&!JSUtil.Object.isEmpty(a.USERLEVELCUSTOMFORMATS)?(b(a.USERLEVELCUSTOMFORMATS,c.SUBMENUITEM+"FORMATCELLS_CUSTOM"+c.IDENTITY,p,!0),n.setAttribute("data-menu-id",c.SUBMENUITEM+"FORMATCELLS_CUSTOM"+c.IDENTITY),s.enable(n)):s.disable(n),JSUtil.Object.isEmpty(e)?s.disable(t):(b(e,c.SUBMENUITEM+"FORMATCELLS_REGIONAL"+c.IDENTITY,G,!1),t.setAttribute("data-menu-id",c.SUBMENUITEM+"FORMATCELLS_REGIONAL"+c.IDENTITY),s.enable(t))},"FORMATCELLS_REGIONAL","FORMATCELLS_CUSTOM"),i.register(E.Listener,T.CellMeta.FORMATCELLS_CLIENT_CUSTOM,h),i.register(E.Listener,T.DocMeta.DOC_SETTINGS,function(){s.enable(O)})}(this);
!function(e){var t,n,i,r,o=e.sPlusPlus,s=e.ZSEvents,a=s.topic,T=s.Groups,c=s.Names,g=e.ZSConstants.CommandConstants,l=e.ZSConstants.JSKeyCode;function u(e){if(e&&e[g.DATE]){var t=(e=e[g.DATE])[g.FORMAT_DATE],n=e[g.TIME];i=A(t[t.length-1]),r=A(n[n.length-2])}}function A(e){for(var t in e)return e[t]}var E=e.sPlusPlus.view.Events.Key.Entry.ShortCut.Context.keyDown;E[l.CTRL+"+"+l.SHIFT+"+"+l.ONE]=function(e,i,r,s){var a=o.view.getActiveGridID(),T=o.view.getSelectedSheets(a);UserAction.FORMATCELLS_GRID(i,T,s,null,null,{formatType:"NUMBER",frmtAction:"generate",negFrmt:"0",thousandsep:!0,decimals:"2",leadingzeroes:"1",language:t+"("+n+")"})},E[l.CTRL+"+"+l.SHIFT+"+"+l.TWO]=function(){var e=o.view.getActiveGridID(),i=o.view.getResourceID(e),s=o.view.getVersionID(e),a=o.view.getSelectedSheets(e);UserAction.FORMATCELLS_GRID(i,a,s,null,null,{formatType:"DATETIME",frmtAction:"generate",format:r,language:t+"("+n+")"})},E[l.CTRL+"+"+l.SHIFT+"+"+l.THREE]=function(){var e=o.view.getActiveGridID(),r=o.view.getResourceID(e),s=o.view.getVersionID(e),a=o.view.getSelectedSheets(e);UserAction.FORMATCELLS_GRID(r,a,s,null,null,{formatType:"DATETIME",frmtAction:"generate",format:i,language:t+"("+n+")"})},E[l.CTRL+"+"+l.SHIFT+"+"+l.SIX]=function(){var e=o.view.getActiveGridID(),i=o.view.getResourceID(e),r=o.view.getVersionID(e),s=o.view.getSelectedSheets(e);UserAction.FORMATCELLS_GRID(i,s,r,null,null,{formatType:"SCIENTIFIC",frmtAction:"generate",decimals:2,language:t+"("+n+")"})},a.register(T.Listener,c.DocMeta.DOCUMENT_LOCALE,function(e,i,r){t=e,n=i,r},"LANGUAGE","COUNTRY","LOCALE_DATEFORMAT"),a.register(T.UI,c.Layout.DYNAMIC_DATA_RESPONSE,u,"RESPONSE"),a.register(T.Listener,c.DocMeta.DOC_SETTINGS,u,"DOC_SETTINGS")}(this);
!function(t){var e,i,s,o,r,a,n,l,d=t.sPlusPlus,u=t.document,m=(t.UIUtil.Component,t.UserAction),c=(t.JSUtil,t.ZSConstants),p=c.FeatureConstants,h=(c.CommandConstants,c.I18N),C=c.wCC,y=t.ZSClass.ZSAlert,F=t.ZSEvents,S=F.topic,T=F.Groups,v=F.Names,A=d.view.Toolbar.Feature[p.FORMATCELLS],M=[];function f(){a.appendChild(n);m.FORMATCELLS_CLIENT(s,o,r,{formatType:"CUSTOM",frmtAction:"readCustomFormats"},function(t){a.removeChild(n),a=e.querySelector("#custFormatList");var i=e.querySelector("#custFormatList"),s=t.USERLEVELCUSTOMFORMATS;if(s&&s.length>0){i.innerText="",i.removeAttribute("style");for(var o=0;o<s.length;o++){var r=new N(s[o]);M.push(r),a.appendChild(r.dom)}}else i.setAttribute("style","text-align:center;line-height: 265px"),i.innerText="0 "+h["FormatCells.CustomFormats"]})}function E(){a.innerHTML="",M=[],A.openDialog(null,"custom")}function L(){var t={formatType:"CUSTOM",frmtAction:"saveCustomFormats",format:l.value};m.FORMATCELLS_CLIENT(s,o,r,t,function(t){if(t.CUSTOMFORMAT){var i=e.querySelector("#custFormatList");i.hasAttribute("style")&&(i.innerText="",i.removeAttribute("style"));var s=new N(t.CUSTOMFORMAT);a.appendChild(s.dom),M.push(s)}else if(t.cusFrmtStatus&&"FormatNotSupported"==t.cusFrmtStatus){var o=h["FormatCells.CustomFormat.AlertMessage"];y(o,{title:h["Alert.Title.InvalidFormatCode"]})}},A.UpdateCustomFormats.bind(this,M))}function O(){var t={formatType:"CUSTOM",frmtAction:"saveAndApplyCustomFormats",format:l.value};m.FORMATCELLS_CLIENT(s,o,r,t,function(e){var a=e.cusFrmtStatus;if("FormatNotSupported"==a){var n=h["FormatCells.CustomFormat.AlertMessage"];y(n,{title:h["Alert.Title.InvalidFormatCode"]})}else"FormatSupported"==a&&(i.close(),m.FORMATCELLS_GRID(s,o,r,null,null,t))},A.UpdateCustomFormats.bind(this,M))}function N(t){this.value=decodeURIComponent(t),this.init()}N.prototype={init:function(){var t=m.getTemplate(["MANAGE_FORMAT_LIST"]);this.dom=u.createElement("li"),this.dom.appendChild(t.MANAGE_FORMAT_LIST),this.displayName=this.dom.querySelector("#roCustName"),this.displayName.innerText=this.value,this.viewMode=this.dom.querySelector("#viewAction"),this.input=this.dom.querySelector("#rwCustName"),this.input.value=this.value,this.input.style.display="none",this.editMode=this.dom.querySelector("#editAction"),this.editMode.style.display="none",this.bindEvents()},bindEvents:function(){this.dom.querySelector("#rwCustName").addEventListener("keydown",function(){}),this.dom.querySelector("#deleteCustFrmt").addEventListener("click",this.deleteFormat.bind(this)),this.dom.querySelector("#editCustFrmt").addEventListener("click",this.editFormat.bind(this)),this.dom.querySelector("#updateCustFrmt").addEventListener("click",this.updateFormat.bind(this)),this.dom.querySelector("#cancelCustFrmt").addEventListener("click",this.cancelEdit.bind(this))},editFormat:function(){this.viewMode.style.display="none",this.displayName.style.display="none",this.editMode.style.display="",this.input.style.display=""},deleteFormat:function(){this.dom.parentNode.removeChild(this.dom);for(var t=M.indexOf(this),i=0;i<M.length;i++)t==i&&M.splice(t,1);var a={formatType:"CUSTOM",frmtAction:"deleteCustomFormats",index:t};if(m.FORMATCELLS_CLIENT(s,o,r,a,null,A.UpdateCustomFormats.bind(this,M)),0==e.querySelector("#custFormatList").querySelectorAll("li").length){var n=e.querySelector("#custFormatList");n.setAttribute("style","text-align:center;line-height: 265px"),n.innerText="0 "+h["FormatCells.CustomFormats"]}},updateFormat:function(){var t={formatType:"CUSTOM",frmtAction:"updateCustomFormats",index:M.indexOf(this),format:this.input.value};m.FORMATCELLS_CLIENT(s,o,r,t,function(t){if(t.cusFrmtStatus&&"FormatNotSupported"==t.cusFrmtStatus){var e=h["FormatCells.CustomFormat.AlertMessage"];y(e,{title:h["Alert.Title.InvalidFormatCode"]})}else this.displayName.innerText=decodeURIComponent(t.CUSTOMFORMAT),this.viewMode.style.display="",this.editMode.style.display="none",this.input.style.display="none",this.displayName.style.display="",this.input.value=""}.bind(this),A.UpdateCustomFormats.bind(this,M))},cancelEdit:function(){this.viewMode.style.display="",this.editMode.style.display="none",this.input.style.display="none",this.displayName.style.display="",l.value=""}},S.register(T.UI,v.Toolbar.FORMAT.OPEN_MANAGEFORMAT,function(d,c,p){s=d,o=c,r=p,i||function(){(n=u.createElement("span")).className="ZsLoader";var s=m.getTemplate(["MANAGE_FORMAT"]).MANAGE_FORMAT,o={modal:!0,width:750,dialogClass:"fmcell",title:h.FormatCells,open:f};(e=u.createElement("div")).id=C.DI+"ManageFormat"+C.IDENTITY,e.appendChild(s),e.querySelector("#fCloseDlg").addEventListener("click",E),e.querySelector("#addBtn").addEventListener("click",L),e.querySelector("#addApplyBtn").addEventListener("click",O),l=e.querySelector("#valueInput"),a=e.querySelector("#custFormatList"),i=new t.ZSClass.Dialog(e,o)}(),i.open()},"RID","SHEETLIST","VERSION")}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,i=(e.document,e.UserAction),a=t.view.Toolbar.Feature[n.COLOR_SCALE],s=e.ZSConstants.ColorscaleTheme;a.quickAction=function(e){var n=t.view.getActiveGridID(),a=t.view.getResourceID(n),o=t.view.getSheetID(n),g=t.view.getSheetState(n,o),r=t.view.getSelectedSheets(n),S=t.view.getVersionID(n),c=s[e];c.istheme=!0,c.datarange=JSUtil.Range.getRangesInString(a,S,g.getRanges()),c.asn=JSUtil.Range.findASN(a,S,c.datarange),i.applyConditionalFormat(c,void 0,a,r,S,"COLOR_SCALES_APPLY")}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,i=(e.document,e.UserAction),a=t.view.Toolbar.Feature[n.ICON_SET],s=e.ZSConstants.IconSetTheme;a.quickAction=function(e){var n=t.view.getActiveGridID(),a=t.view.getResourceID(n),o=t.view.getSheetID(n),g=t.view.getSheetState(n,o),r=t.view.getVersionID(n),S=t.view.getSelectedSheets(n),c=s[e];c.istheme=!0,c.datarange=JSUtil.Range.getRangesInString(a,r,g.getRanges()),c.asn=JSUtil.Range.findASN(a,r,c.datarange),i.applyConditionalFormat(c,void 0,a,S,r,"ICON_SET_APPLY")}}(this);
!function(e){var t=e.sPlusPlus,i=(t.SML.Client,e.ZSConstants.FeatureConstants),n=(e.document,e.ZSConstants.wCC,e.ZSConstants.I18N,e.UserAction);t.view.Toolbar.Feature[i.CONDITIONAL_FORMAT_CLEAR_RULE].execute=function(){var e=t.view.getActiveGridID(),i=t.view.getResourceID(e),s=t.view.getSheetID(e),o=t.view.getVersionID(e),a=t.view.getSheetState(e,s),r=t.view.getSelectedSheets(e),c=a.getActiveRange();n.clearConditionalFormat(i,r,o,c)}}(this);
!function(e){var t,a=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,r=e.document,o=(e.ZSConstants.I18N,e.ZSConstants.wCC),u=(a.view.Toolbar.Feature[n.CONDITIONFORMAT],r.getElementById("popupmenu")),C=a.view.Toolbar.Feature[n.COLOR_SCALE],l=a.view.Toolbar.Feature[n.ICON_SET],s=a.view.Toolbar.Feature[n.CF_CLASSIC],T=a.view.Toolbar.Feature[n.CF_MANAGE];(t=r.createElement("ul")).setAttribute("ctype","zmenu"),t.id=o.SUBMENUITEM+n.CONDITIONFORMAT+o.IDENTITY,s&&s.createElement(t),C&&C.createElement(t),l&&l.createElement(t),T&&T.createElement(t),u.appendChild(t)}(this);
!function(e){var t=e.sPlusPlus,a=e.ZSConstants.FeatureConstants;e.document,e.ZSConstants.I18N,e.ZSConstants.wCC;t.view.Toolbar.Feature[a.CREATE_DATA_VALIDATION].readDataValidation=function(){var e=t.view.getActiveGridID(),a=t.view.getResourceID(e),s=t.view.getSheetID(e),i=t.view.getSelectedSheets(e),n=t.view.getVersionID(e),o=t.view.getSheetState(e,s).getRanges(),r=t.data.getWorkBook(a,n).getSheetObj(s).Prop.Name;UserAction.ValidateDvRange(a,i,r,n,o,JSUtil.Range.getDateFormats())}}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSConstants.FeatureConstants;e.document,e.ZSConstants.I18N,e.ZSConstants.wCC;t.view.Toolbar.Feature[s.CLEAR_DATA_VALIDATION].execute=function(){var e=t.view.getActiveGridID(),s=t.view.getResourceID(e),n=t.view.getVersionID(e),a=(t.view.getSheetID(e),t.view.getSelectedSheets(e)),i=new ZSClass.ParamGenerator(a,s,n,!0).getRanges();UserAction.RemoveDataValidation(s,a,n,i[0])}}(this);
!function(t){if(!t.isCanvasGrid){var e=t.ZSClass,i=e.UILayer,o=sPlusPlus;s.prototype=new i,s.prototype.hide=function(){this.Dom.style.display="none"},s.prototype.show=function(){this.Dom.style.display=""},s.prototype.placeDVBtn=function(t,i,s,a,n,r,l,y){var p=o.data.getWorkBook(t,s),g=o.view.getActiveGridID(),h=p.getSheetObj(i);if(h.Merge.isIntersecting(new e.Range(a,n,a,n))){var u=h.Merge.isXists(a,n);a=u.root.endRow,n=u.root.endCol}var c=h.Row.auxiliaryAxis.getPos(a+1),d=h.Column.auxiliaryAxis.getPos(n+1)-17,f=o.view.getSheetState(g,i).getZoom();this.Dom.style.display="",this.Dom.style.top=c*f-17*f+"px",this.Dom.style.left=d*f-2*f+"px"},e.UIDataValidationLayer=s}function s(t,e,o){i.call(this,t,e)}}(this);
!function(t){var e=t.sPlusPlus,i=t.ZSClass,s=(e.data.Defaults.MAX_COL,t.ZSConstants.I18N),n=t.ZSEvents;n.topic,n.Groups,n.Names;function a(t,e){var i=document.createElement("div");i.className=e;var n=function(){var t=document.createElement("div");t.setAttribute("id","hintCallout");var e=document.createElement("span"),i=document.createElement("B");i.innerText=s["DataVal.DV"],e.appendChild(i);var n=document.createElement("div");n.setAttribute("id","eMsg"),n.className="erroeMsg",n.innerText=s["DataVal.InfoErrorMsg"],e.appendChild(n);var a=document.createElement("div");return a.setAttribute("id","hintText"),a.className="hintText",t.appendChild(e),t.appendChild(a),t}();return t.appendChild(i).appendChild(n),i}function r(t){this.Dom=a(t,"dvHintCont"),this.hide()}function o(t){this.parent=t}r.prototype={hide:function(){this.Dom.style.display="none"},show:function(){this.Dom.style.display=""},place:function(t,s,n,a,r,o,h,l){this.show();var u=this.Dom,p=u.style,c=e.data.getWorkBook(t,n).getSheetObj(s);if(c.Merge.isIntersecting(new i.Range(a,r,a,r))){var d=c.Merge.isXists(a,r);a=d.root.endRow,r=d.root.endCol}var g=c.Row.auxiliaryAxis.getPos(a),v=c.Column.auxiliaryAxis.getPos(r+1),D=e.view.getActiveGridID(),I=e.view.getSheetState(D,s).getZoom();p.top=g*I+"px",p.left=v*I+1+"px",u.querySelector("#hintText").innerText=o,u.querySelector("#eMsg").innerText=l;sPlusPlus.view.fetchRangeData(t,s,n,new i.Range(a,r,a,r),["IsContentValid"],!0,e.view.getActiveGridID(),function(t){var e=t[a][r].IsContentValid;u.querySelector("#eMsg").style.display=void 0==e||e?"none":"block"})}},o.prototype={placeDVHint:function(t,e,i,s,n,a,r,o){var h=this.getButton();h.place(t,e,i,s,n,a,r,o),h.show()},hideDVHint:function(){this.getButton().hide()},getButton:function(){return this.button||(this.button=new r(this.parent)),this.button}},i.UIDataValidationHintController=o}(this),function(t){var e=t.ZSClass,i=e.UILayerController,s=e.UIDataValidationLayer;function n(t,e){i.call(this,t,e,s),this.alive=[]}n.prototype=new i,n.prototype.hideDVBtn=function(t,e,i,s){this.isExist(s)||(this.alive[s]=new this.Layer(this.parent,this.properties)),this.alive[s].hide()},n.prototype.showDVBtn=function(t,e,i,s){this.isExist(s)||(this.alive[s]=new this.Layer(this.parent,this.properties)),this.alive[s].show()},n.prototype.placeDVBtn=function(t,e,i,s,n,a,r){this.isExist(s)||(this.alive[s]=new this.Layer(this.parent,this.properties)),this.alive[s].placeDVBtn(t,e,i,n,a,r)},e.UIDataValidationController=n}(this),function(t){var e,i=t.sPlusPlus,s=t.ZSEvents,n=s.topic,a=s.Groups,r=s.Names,o=t.ZSClass,h=t.UserAction;function l(t,e,i,s,n){this.rID=t,this.sheetID=e,this.version=i,this.row=s.startRow,this.col=s.startCol,this.totalParts=0,this.partNum=0,this.array=n.properties,this.getValueList()}l.prototype={getValueList:function(){-1!=this.partNum&&this.array.type&&"LIST"==this.array.type&&h.getListValues(this.rID,this.sheetID,this.version,this.row,this.col,this.totalParts,this.partNum,this.array.isListRange,this.array.range,this.array.sort_asc)},hiddenSheetRange:function(){var t=this.array.range;this.rngObj=JSUtil.Range.parseRange(this.rID,this.version,t);var e=i.data.getWorkBook(this.rID,this.version);if(!this.rngObj){var s=e.NamedRange.namedRangeMap.get(t);this.rangeInfo=JSUtil.Range.parseRange(this.rID,this.version,JSUtil.FormRange(s)),t=JSUtil.FormRange(s),this.rngObj=JSUtil.Range.parseRange(this.rID,this.version,t)}var n=e.SheetList.getIdByName(this.rngObj.sheetName);return e.SheetList.getById(n).getHidden()},listResponse:function(t){this.partNum=t.dataval.partnum,this.totalParts=t.dataval.tparts,n.publish(a.Listener,r.UserAction.DATA_VALIDATION.SHOW_LIST,{LIST_ARRAY:t.dataval.list})}},n.register(a.Listener,r.UserAction.DATA_VALIDATION.LIST_RESPONSE,function(t){e.listResponse(t)},"LIST_JSON"),n.register(a.Listener,r.UserAction.DATA_VALIDATION.GET_SCROLL_LIST,function(){e.getValueList()}),n.register(a.Selector.DomUpdate.CellEdit,r.Selection.BOUND_UPDATE.ADD,function(t,s,h,u){n.publish(a.Listener,r.UserAction.DATA_VALIDATION.HIDE_DV_HINT,{RID:t,SHEETID:s,VERSION:h});var p=function(t,e,s,n,a){var r=i.data.getWorkBook(t,s).getSheetObj(e).DataValidation.getIntersectedRanges(new o.Range(n,a,n,a));return r.length?r:""}(t,s,h,u.startRow,u.startCol)[0];p&&(e=new l(t,s,h,u,p))},"RID","SHEETID","VERSION","ActiveRange")}(this);
!function(e){var t=e.sPlusPlus,i=(t.view.measures,e.ZSEvents),o=i.topic,s=i.Groups,n=i.Names,l=e.ZSClass,a=l.Selector,u=a.Design||(a.Design={}),r=(document.body,{class:"dvListBtn",filler:{mousedown:function(i){var a=t.view.getActiveGridID(),u=t.view.getResourceID(a),r=t.view.getVersionID(a),c=t.data.getWorkBook(u,r),D=t.view.getSheetID(a),v=c.getSheetObj(D),S=t.view.getGridComponent(a).getRelativeCoordinates(i),d=v.Row.auxiliaryAxis.findAbs(S.y),g=v.Column.auxiliaryAxis.findAbs(S.x);t.view.getSheetState(a,D);setTimeout(function(){t.view.fetchCellData(u,D,r,d,g,["DisplayValue"],a,function(e){o.publish(s.Selector.BoundUpdate.CellEdit,n.Selection.BOUND_UPDATE.ADD,{RID:u,SHEETID:D,VERSION:r,RANGE:new l.Range(d,g,d,g),RANGEID:0}),o.publish(s.Listener,n.CellAction.VALUE.SET,{RID:u,SHEETID:D,VERSION:r,ROW:d,COL:g,VALUE:{DisplayValue:e[d][g].DisplayValue},FOCUS:!0})},function(t){e.ZSClass.Logger.log("Couldnt retrieve cell content",t)})},0)},mouseover:function(e){},mouseleave:function(e){}}});u.DataValidationList=r}(this);
!function(t){var e=t.sPlusPlus,I=t.ZSConstants.FeatureConstants,i=ZSConstants.wCC,n=t.UIUtil.Component,T=t.ZSEvents,a=T.topic,A=T.Groups,D=T.Names,s=t.UserAction,o=!1;e.view.Toolbar.Feature[I.HIGHLIGHT_DATA_VALIDATION].execute=function(){var t=e.view.getActiveGridID(),T=e.view.getResourceID(t),r=e.view.getSheetID(t),N=e.view.getVersionID(t);e.data.getWorkBook(T,N).getSheetObj(r).Prop.Name,(o=!o)?n.zmenu("#"+i.SUBMENUITEM+I.DATA_VALIDATION+i.IDENTITY,"setAttribute","contentType","icon-text"):n.zmenu("#"+i.SUBMENUITEM+I.DATA_VALIDATION+i.IDENTITY,"setAttribute","contentType","text"),s.updateIsContentValid(T,r,N,o),e.data.UserInfo.HighlightInvalidData=void 0==e.data.UserInfo.HighlightInvalidData||!e.data.UserInfo.HighlightInvalidData,a.publish(A.Listener,D.DocAction.DATAVALIDATION.HIGHLIGHT_INVALID_DATA,{RID:T,SHEETID:r,VERSION:N})},a.register(A.UI,D.Toolbar.INIT_MENU,function(t){"sidePanelViewSetting"!=t.id&&t.id!=i.SUBMENUITEM+I.DATA_VALIDATION+i.IDENTITY||(n.zmenu("#sidePanelViewSetting","setMenuItemsAttribute",["#"+i.MI+I.HIGHLIGHT_DATA_VALIDATION+i.IDENTITY],"checked",e.data.UserInfo.HighlightInvalidData),n.zmenu("#"+i.SUBMENUITEM+I.DATA_VALIDATION+i.IDENTITY,"setMenuItemsAttribute",["#"+i.MI+I.HIGHLIGHT_DATA_VALIDATION+i.IDENTITY],"checked",e.data.UserInfo.HighlightInvalidData))},"DOM")}(this);
!function(t){if(!t.isCanvasGrid){t.sPlusPlus;var i=t.ZSClass.UIPaneComponent.prototype;i.PlaceDVBtn=function(t,i,a,n,o,s){this.DataValidation&&this.DataValidation.placeDVBtn(t,i,a,1,n,o,s)},i.HideDVBtn=function(t,i,a){this.DataValidation&&this.DataValidation.hideDVBtn(t,i,a,1)},i.ShowDVBtn=function(t,i,a){this.DataValidation&&this.DataValidation.showDVBtn(t,i,a,1)},i.PlaceDVHint=function(t,i,a,n,o,s,D,V){this.DataValidationHint&&this.DataValidationHint.placeDVHint(t,i,a,n,o,s,D,V)},i.HideDVHint=function(t,i,a){this.DataValidationHint&&this.DataValidationHint.hideDVHint(t,i,a)},i.ShowDVHint=function(t,i,a){this.DataValidationHint&&this.DataValidationHint.showDVHint(t,i,a)}}}(this);
!function(e){var t,i=e.sPlusPlus,o=e.ZSConstants.FeatureConstants,r=e.document,I=(e.ZSConstants.I18N,e.ZSConstants.wCC),A=(i.view.Toolbar.Feature[o.DATA_VALIDATION],r.getElementById("popupmenu")),n=e.ZSEvents,s=n.topic,a=n.Groups,E=n.Names,D=e.UIUtil.Component,T=i.view.Toolbar.Feature[o.CREATE_DATA_VALIDATION],l=i.view.Toolbar.Feature[o.MANAGE_DATA_VALIDATION],c=i.view.Toolbar.Feature[o.HIGHLIGHT_DATA_VALIDATION];function p(e,t,o,r,I){var A=i.data.getWorkBook(e,o).getSheetObj(t).DataValidation.isXists(r,I);if(s.publish(a.Listener,E.UserAction.DATA_VALIDATION.HIDE_DV_HINT,{RID:e,SHEETID:t,VERSION:o}),(0==A||A&&A.root&&!A.root.properties.type)&&s.publish(a.Listener,E.UserAction.DATA_VALIDATION.HIDE_DV_BTN,{RID:e,SHEETID:t,VERSION:o}),0!=A){var n=!0;sPlusPlus.view.fetchCellData(e,t,o,r,I,["IsContentValid"],i.view.getActiveGridID(),function(e){n=e[r][I].IsContentValid}),(A&&A.root&&A.root.properties.helpMsg||0==n)&&s.publish(a.Listener,E.UserAction.DATA_VALIDATION.PLACE_DV_HINT,{RID:e,SHEETID:t,VERSION:o,ROW:r,COL:I,TEXT:A.root.properties.helpMsg,TYPE:A.root.properties.messageType,MESSAGE:A.root.properties.messageContent}),A&&A.root.properties.type&&"LIST"==A.root.properties.type&&s.publish(a.Listener,E.UserAction.DATA_VALIDATION.LIST_DECIDE,{RID:e,SHEETID:t,VERSION:o,ROW:r,COL:I,DV_RANGE:A})}}(t=r.createElement("ul")).setAttribute("data-ctype","zmenu"),t.setAttribute("data-content-type","text"),t.setAttribute("relativeto","parent"),t.id=I.SUBMENUITEM+o.DATA_VALIDATION+I.IDENTITY,T&&T.createElement(t),l&&l.createElement(t),c&&c.createMenuElement(t),A.appendChild(t),D.bind(t,"zmenuitemclick",function(e,t){var i=t.data.action;switch(i){case"createvalid":T.readDataValidation();break;case"managevalid":l.openDialog(!0);break;case"highlightinvalid":c.execute()}}),D.bind(t,"zmenubeforeshow",function(){s.publish(a.UI,E.Toolbar.INIT_MENU,{DOM:t})}),s.register(a.Listener,E.SheetAction.ACTIVE_CELL.INFO,p,"RID","SHEETID","VERSION","ROW","COLUMN","VALUE"),s.register(a.Listener,E.UserAction.DATA_VALIDATION.LIST_DECIDE,function(e,t,i,o,r,I,A){s.publish(a.Listener,E.UserAction.DATA_VALIDATION.PLACE_DV_BTN,{RID:e,SHEETID:t,VERSION:i,ROW:o,COL:r,ALIGN:A})},"RID","SHEETID","VERSION","ROW","COL","DV_RANGE","ALIGN"),s.register(a.Listener,E.SheetAction.COLUMN_HEADERS.RESIZE.ENUMERATE,function(e,t,o){var r=i.view.getActiveGridID(),I=i.view.getSheetState(r,t);p(e,t,o,I.getActiveRow(),I.getActiveCol())},"RID","SHEETID","VERSION")}(this);
!function(t){var i=t.ZSClass.AutoSuggest,e=i.Entry,s=i.Selector;function n(t){this.editor=t.editor,this.container=t.container,this.selector=new s(this.container,t.height),this.list={},this.limit=t.limit,this.scrollLimit=t.scrollLimit,this.count=0,this.onInsert=t.onInsert,this.onScroll=t.onScroll,this.onMouseInsert=t.onMouseInsert,function(){var t=this.editor,i={input:o.bind(this),focus:o.bind(this),blur:function(){this.selector.flush()}.bind(this),keydown:function(t){if("="!==this.editor.value.charAt(0)){var i=t.keyCode||t.which;if(this.selector.isEmpty())return;switch(i){case 40:case 39:t.preventDefault(),t.stopPropagation(),this.selector.increment();break;case 38:case 37:t.preventDefault(),t.stopPropagation(),this.selector.decrement();break;case 13:case 9:t.preventDefault(),t.stopPropagation(),this.selector.insert(i),this.selector.flush();break;case 27:t.preventDefault(),t.stopPropagation(),this.selector.flush()}}}.bind(this)};t.addListeners(i);var e=this;this.container.addEventListener("scroll",function(t){this.scrollHeight-this.scrollTop<e.selector.height.container+e.scrollLimit&&e.onScroll.call(e)})}.call(this)}function o(){"="!==this.editor.value.charAt(0)&&this.suggest(this.editor.value)}n.prototype={suggest:function(t){var i=document.createDocumentFragment();this.selector.flush();var e=this.list;this.count=0;var s=0;for(var n in e){var o=e[n];if(this.suggestEntry(n,o,i,t),++s>2e3)break}this.container.appendChild(i),JSON.stringify(e);var r=this.container.getBoundingClientRect(),a=r.height,c=r.width;UserAction.calcPosition(this.editor.SuggestContainer,this.editor,void 0,void 0,c,a),this.selector.reset()},suggestEntry:function(t,i,e,s){if(t.startsWith(s)||s&&t.toLowerCase().startsWith(s.toLowerCase())||t.contains(" "+s)||s&&t.toLowerCase().contains(" "+s.toLowerCase())){if(this.limit&&++this.count>this.limit)return;i.appendTo(e),i.decorate(s),this.selector.add(i)}},flush:function(){this.list={},this.selector.flush(),this.count=0},addEntry:function(t,i){var s=new e(t,t,[],this.onSelect,this.onInsert,function(t){var i=this;t.dom.addEventListener("mousedown",function(e){i.onMouseInsert(t)})}.bind(this));this.list[t]=s,this.suggestEntry(t,s,i||this.container)},addEntries:function(t){var i=document.createDocumentFragment(),e=0;for(var s in t){var n=t[s];this.editor.getValue()&&n==this.editor.getValue()&&(e=s),this.addEntry(n,i)}this.container.appendChild(i),this.container.style.display="block";var o=this;setTimeout(function(){o.selector.setActive(e)},10)}},i.DataValidation=n}(this);
!function(e){var t,s,l,i,r,n=e.sPlusPlus,a=e.ZSConstants.FeatureConstants,o=(e.ZSConstants.ActionConstants,e.document,e.ZSConstants.I18N),c=(e.ZSConstants.wCC,ZSClass.Editors.RangeEditor),h=e.ZSEvents,u=h.topic,d=h.Groups,y=h.Names,v=e.UIUtil.Component,g=e.UserAction,S=n.view.Toolbar.Feature[a.CREATE_LINK_EXTERNAL],m=n.view.Toolbar.Feature[a.LINK_EXTERNAL_DATA],p="periodic",f="daily",b="weekly",T="monthly",L={csv:"csvsave",rss:"rsssave",html:"htmlsave",schOnce:"onceNow",schPeriod:"onceRegular"},w=/^(http+[s]*?:\/\/)|(www.)/,D={buttons:[{text:o.OK,primary:!0}],title:o["Alert.Title.InvalidURL"]};function R(e,i){var r={width:570,title:o["LinkExternalData.Create"],dialogClass:"leTCls",close:function(){l.closeHandling()},open:function(){}};if(!t){(s=document.createElement("div")).id="DI_LINK_EXTERNAL_DATA";var n=g.getTemplate(["LINKEXTERNALDATA"]).LINKEXTERNALDATA;s.appendChild(n),t=new ZSClass.Dialog(s,r),l=new I}t.open(),function(e){l.addSheetNames(),e?(s.querySelector("#scheduleDiv").style.display="none",e&&l.loadRuleObj(e)):(s.querySelector("#"+L.csv).click(),s.querySelector("#onceNow").click())}(i)}function I(){this.wrapper=s,this.showIndex=0,this.schValue="",this.state="ADD",this.URLType=L.csv,this.schedulerType=L.schOnce,this.create()}I.prototype={create:function(){this.bindButtonActions(),this.bindRangeSelector(),this.nextButton.classList.remove("ZsRt")},bindButtonActions:function(){this.selectData=s.querySelector("#selectData"),this.schedulerTags=s.querySelector("#schedulerTags"),this.tabs=document.querySelector(".lnkUrl").children,this.nextButton=s.querySelector("#letNext");var e=this;s.querySelector("#letBack").addEventListener("click",function(){e.showIndex>=0&&e.goBack()}),s.querySelector("#letNext").addEventListener("click",function(){e.showIndex<=4&&e.goNext()}),s.querySelector("#letClose").addEventListener("click",function(){t.close()}),v.bind(s.querySelector("#repeatinterval"),"zselectboxchange",function(t,s){e.showSelectTag()}),s.querySelectorAll('input[type="radio"]').forEach(function(t,s){t.addEventListener("click",function(){e.changeRadioBtnAction(t)})})},bindRangeSelector:function(){i=new c(s.querySelector("#startCell"),!0),ZSClass.RangePicker.register(i,!0,!0)},goBack:function(){this.showIndex--,1==this.showIndex&&this.URLType!=L.html&&this.showIndex--,this.nextButton.classList.remove("ZsRt"),this.showContainer()},goNext:function(){if(this.nextButton.classList.remove("ZsRt"),0==this.showIndex&&!this.validateURL())return D.buttons[0].click=function(){s.querySelector("#webURL").focus()},void ZSClass.ZSAlert(o["Error.Hyperlink.Invalid.Url"],D);0==this.showIndex&&this.URLType!=L.html&&this.showIndex++,this.showIndex++,4==this.showIndex?this.sendReq():1==this.showIndex&&this.URLType==L.html?this.getTables():this.showContainer()},showContainer:function(){s.querySelector("#letBack").style.display=0==this.showIndex?"none":"block",s.querySelector("#letNext").querySelector("div").innerText=3==this.showIndex?"Done":o["Find.Next"]+" > ";for(var e=s.querySelector("#container"),t=0;t<e.children.length;t++)t!=this.showIndex?(this.tabs[t].className="",e.children[t].style.display="none"):(this.tabs[t].className="active",e.children[t].style.display="block")},loadRuleObj:function(e){this.state="EDIT",this.webDataId=e.wdCellId,this.loadObj=e,this.URLtext=e.fullURL,s.querySelector("#webURL").value=e.fullURL;var l=-1==this.URLtext.indexOf(".csv")&&-1!==this.URLtext.indexOf("feed")?L.rss:"null"!==e.htmlTblList&&-1==this.URLtext.indexOf(".csv")?L.html:L.csv;s.querySelector("#"+l).click();var r=JSUtil.Range.parseRange(t.rID,t.version,e.cellName).sheetID;if(v.zcombo(s.querySelector("#sheetNameTag"),"setValue",r),i.value=e.cellName,s.querySelector("#selectType").className="disableDiv","-"==e.schTime)s.querySelector("#onceNow").click();else{s.querySelector("#onceRegular").click();var n=this.getRepeat(e);v.zcombo("#repeatinterval","setValue",n),this.showSelectTag();e.schName.split("_")[1]}},getRepeat:function(e){return-1!==e.schName.indexOf("hr")||-1!==e.schName.indexOf("min")?"periodic":e.interval},selectHtmlEditTables:function(){for(var e=this.loadObj.htmlTblList.split("-"),t=0;t<e.length;t++){var l="scraptbl_"+t;s.querySelector("#"+l).checked=!0;for(var i=e[t].split(","),r=1;r<i.length;r++){var n=l+"_"+i[r];s.querySelector("#"+n)&&(s.querySelector("#"+n).checked=!0)}}},validateURL:function(){return this.URLtext=s.querySelector("#webURL").value,w.test(this.URLtext)},changeRadioBtnAction:function(e){var t=e.getAttribute("id");switch(t){case L.csv:case L.rss:case L.html:this.URLType=t,this.selectData.style.display=t==L.html?"inline-block":"none";break;case L.schOnce:this.schedulerType=t,this.schValue="",s.querySelector("#scheduleDiv").style.display="none";break;case L.schPeriod:this.schedulerType=t,s.querySelector("#scheduleDiv").style.display="",this.showSelectTag()}},showSelectTag:function(){var e=v.zcombo("#repeatinterval","getValue");(this.hideAllSchedular(),e!==f)&&(v.zcombo("#"+e,"getElement").style.display="");switch(e!==f&&(this.schValue=v.zcombo("#"+e,"getValue")),e){case p:break;case f:s.querySelector("#scPerform").style.display="none",s.querySelector("#daily").style.display="",this.schValue=s.querySelector("#daily input").value}},hideAllSchedular:function(){this.schedulerTags.querySelectorAll("select").forEach(function(e){v.zcombo(e,"getElement").style.display="none"}),s.querySelector("#scPerform").style.display="table-cell",s.querySelector("#daily").style.display="none"},addSheetNames:function(){var e=t.rID,l=t.version,r=n.data.getWorkBook(e,l).SheetList.getSheets(!0),a=s.querySelector("#sheetNameTag");a.innerHTML="";for(var o=0,c=r.length;o<c;o++){var h=r[o].Name,u=document.createElement("option");u.value=r[o].Id,u.innerText=h,a.appendChild(u)}v.zcombo(a,"refresh"),v.zcombo(a,"setValue",t.sheetID),i.value=n.view.getSheetState(t.gridID,t.sheetID).getActiveCellRange().getLabel()},getTables:function(){n.data.getWorkBook(t.rID,t.version);var e=this.URLtext;r!=this.URLtext&&g.ReadTables(t.rID,t.sheetID,t.version,"parseHtml",e,this.nextButton),r==this.URLtext&&this.showContainer()},sendReq:function(){var e=n.view.getActiveGridID(),s=n.view.getVersionID(e),l=n.view.getResourceID(e),r=n.view.getSelectedSheets(e),a=n.view.getSheetID(e),o=n.data.getWorkBook(l,s).getSheetObj(a).Prop.Name,c=v.zcombo("#sheetNameTag","getValue"),h=JSUtil.Range.parseRange(l,s,i.value.trim()),u=new ZSClass.Range(h.range.startRow,h.range.startCol).getLabel(),d=this.schedulerType==L.schOnce?"":this.getScheduleName(),y=this.URLType==L.html?this.getSelectedTabs():"";"EDIT"==this.state?g.refreshWebData(l,r,t.sheetID,o,t.version,"edit",c,this.webDataId,!0,u,void 0,this.URLtext,d,y):g.ApplyWebData(l,s,r,a,o,this.URLType,this.URLtext,c,u,d,y),t.close()},getTimeMinutes:function(e){var t=e.split(":");return parseInt(60*t[0])+parseInt(t[1])},getScheduleName:function(){var e=v.zcombo("#repeatinterval","getValue");if(e===p)return v.zcombo("#"+e,"getValue");if(e===f){s.querySelector("#timeVal").value;return"daily_0"}if(e===b){var t=v.zcombo("#weekly","getValue");s.querySelector("#timeVal","getValue");return"weekly_"+t+"_0"}if(e===T){var l=v.zcombo("#monthly","getValue");s.querySelector("#timeVal","getValue");return"monthly_"+l+"_0"}},handleHTML:function(){var e=this;this.result=s.querySelector("#htmlDiv").querySelectorAll("input"),this.result.forEach(function(t){t.addEventListener("change",function(){t.id.match(/scraptbl_[0-9]*\b/)?e.toggleExtDataFields(t,this.checked):e.deSelectExtDataTables(t,this.checked)})})},toggleExtDataFields:function(e,t){var l=e.getAttribute("id");s.querySelector("#htmlDiv").querySelectorAll("[id^="+l+"] input").forEach(function(e){e.checked=t})},deSelectExtDataTables:function(e,t){var l=e.getAttribute("id").substring(0,e.getAttribute("id").lastIndexOf("_")),i=s.querySelector("#htmlDiv").querySelectorAll("[id^="+l+"] input"),r=t;if(!t)for(var n=0;n<i.length;n++)if(i[n].checked){r=!0;break}s.querySelector("#htmlDiv").querySelector("#"+l).checked=r,this.getSelectedTabs()},getSelectedTabs:function(){var e="",t="{",s="",l=0,i=0,r=[],n=Array.prototype.filter.call(this.result,function(e){return e.id.match(/scraptbl_[0-9]*\b/)});for(l=0;l<n.length;l++){var a=document.getElementById("scraptbl_"+l);if(a&&a.checked){r[i]=l,i++;for(var o=[],c=0,h=0,u=0;document.getElementById("scraptbl_"+l+"_"+c);){var d=0;if(document.getElementById("scraptbl_"+l+"_"+c+"_colspan").colSpan&&(d=document.getElementById("scraptbl_"+l+"_"+c+"_colspan").colSpan),document.getElementById("scraptbl_"+l+"_"+c).checked){o[h]=u,h++;for(var y=1;y<d;y++)o[h]=u+1,h++,u++}else for(y=1;y<d;y++)u++;u++,c++}e=e+"&selectcols_"+l+"="+o,s+=l+':"'+o+'",'}}return""!==s&&(t+=s+"tblcnt:"+l),t+="}"},closeHandling:function(){this.showIndex=0,this.URLtext="",r="",this.showContainer(),s.querySelector("#webURL").value="",s.querySelector("#selectType").className="",s.querySelector("#onceNow").click(),"EDIT"==this.state&&u.publish(d.Listener,y.UserAction.WEB_DATA.MANAGE_DIALOG),this.state="ADD"}},S.openDialog=R,m.openDialog=R,u.register(d.Listener,y.UserAction.WEB_DATA.READ_TABLES,function(e){for(var t=(new DOMParser).parseFromString(e,"text/xml").firstChild.childNodes,i=0;i<t.length;i++){var n=t.item(i);if("sheet"===n.nodeName){n.attributes;var a=n.childNodes[0].nodeValue;s.querySelector("#htmlDiv").innerHTML="",s.querySelector("#htmlDiv").innerHTML=a,l.showContainer(),"EDIT"==l.state&&l.selectHtmlEditTables(),r=l.URLtext,l.handleHTML()}}},"TABLES"),u.register(d.Listener,y.UserAction.WEB_DATA.EDIT_DIALOG,R,"EV","EDIT_OBJ")}(this);
!function(e){var t,r=e.sPlusPlus,o=e.ZSConstants.FeatureConstants,n=e.document,i=e.ZSConstants.I18N,c=(e.ZSConstants.wCC,e.ZSEvents),s=c.topic,a=c.Groups,l=c.Names,u=e.UserAction,d=(n.getElementById("popupmenu"),e.UIUtil.Component),S=e.JSUtil,g=(e.ZSConstants.ActionConstants,ZSClass.Editors.RangeEditor,ZSClass.Editors.TextAreaEditor,ZSClass.Editors.Utility,r.data.AppRegistry.USER_PHOTO_SERVER_URL),v=r.view.Toolbar.Feature[o.LOCK_SHEET],h=r.view.Toolbar.Feature[o.LOCK],p=void 0,E=void 0;function y(){p.close()}function f(){for(var e=E.querySelector("#select12").checked,r=t.querySelectorAll('input[type="checkbox"]'),o=0;o<r.length;o++)r[o].checked=e;d.enable("#saveBtn")}function C(){var e=E.querySelector("#select12"),r=t.querySelectorAll('[type="checkbox"]:checked').length,o=Object.keys(D).length;o>r?e.checked=!1:o==r&&(e.checked=!0)}var w=new S.StringBuffer,k=new S.StringBuffer,L=new S.StringBuffer,I=new S.StringBuffer,D={};function T(){for(var o=r.view.getActiveGridID(),n=r.view.getResourceID(o),i=r.view.getVersionID(o),c=(r.data.getWorkBook(n,i),r.view.getSelectedSheets(o)),s=t.querySelectorAll('[type="checkbox"]'),a=[],l=[],u=[],d=[],S=[],g=[],v=0;v<s.length;v++){var h=s[v].value,p=s[v].getAttribute("utype"),E=s[v].checked;switch(p){case"coG":case"rwG":case"roG":case"rcG":E&&u.push(h),!E&&d.push(h);break;case"roO":case"rwO":case"rcO":E&&S.push(h),!E&&g.push(h);break;default:E&&a.push(h),!E&&l.push(h)}}w=a.join(","),k=l.join(","),I=g.join(","),L=d.join(","),0==a.length&&0==u.length&&0==S.length?e.UserAction.UnlockSheet(n,c,i):e.UserAction.LockSheet(n,c,i,k,w,L,I),y()}function b(e,t){this.parent=e,this.addCollaborators(t.pr)}function O(){var e=r.view.getActiveGridID(),t=r.view.getSheetID(e),o=(r.view.getSheetState(e,t),r.view.getResourceID(e)),n=r.view.getVersionID(e);return r.data.getWorkBook(o,n).ProtectedSheets.isSheetLocked(t)}function A(){var e=r.view.getViewMenu();O()?e.toolbar.container.classList.add("zsDisable"):e.toolbar.container.classList.remove("zsDisable")}b.prototype={createUser:function(e,t,o,n,i){var c=e.zuid,s=u.getTemplate(["LOCK_USERS_TEMPLATE"]).LOCK_USERS_TEMPLATE,a=document.createElement("div");a.className="dspTblRow",a.appendChild(s),a.querySelector("#profile").src=g+"/file?fs=thumb&ID="+c+i,a.querySelector("#name").textContent=e.name,a.querySelector("#name").title=e.email,a.querySelector("#userType").textContent=n;var l=a.querySelector('input[type="checkbox"]');l.setAttribute("utype",o),e.lock&&(l.checked=!0),c==r.data.UserInfo.zuid&&(a.querySelector("#me").style.display="block"),l.value=c,l.addEventListener("change",function(){d.enable("#saveBtn"),C()}),D[c]=c,this.parent.appendChild(a)},addCollaborators:function(e){var t=r.view.getActiveGridID(),o=(r.view.getResourceID(t),0);for(var n in e.owner&&this.createUser(e.owner,o,"owner",i["ProtectRange.UI.Owner"],h.userImgBasedOnType("owner")),e)for(var c=h.getUserTypeMsg(n),s=0;s<e[n].length;s++,o++)this.createUser(e[n][s],o,n,c,h.userImgBasedOnType(n));C()}},v.isLockedSheet=O,v.openDialog=function(){var o,n={modal:!1,width:500,title:i["Menu.ProtectRange.ProtectSheet"],close:function(){!function(){for(var e=t.querySelectorAll('input[type="checkbox"]'),r=0;r<e.length;r++)e[r].checked=!1;t.innerHTML=""}()},open:function(){var t,o,n,i,c,s;E.querySelector("#lockCellsLoader").style.display="block",d.disable("#saveBtn"),t=r.view.getActiveGridID(),o=r.view.getResourceID(t),n=r.view.getSheetID(t),i=r.view.getVersionID(t),c=r.data.getWorkBook(o,i).getSheetObj(n).Prop.getName(),(s=E.querySelector("#appliestofieldcs")).innerText=c,s.disabled=!0,function(){var t=r.view.getActiveGridID(),o=r.view.getResourceID(t),n=r.view.getVersionID(t),i=r.view.getSelectedSheets(t);e.UserAction.checkRangeLockInfo(o,i,n,!0,!1)}()}};p||(o=e.UserAction.getTemplate(["LOCKCELL"]).LOCKCELL,(E=document.createElement("div")).id="DI_LOCK_CELLS",E.appendChild(o),t=E.querySelector("#usersContainer"),E.querySelector("#saveBtn").addEventListener("click",T),E.querySelector("#cancelBtn").addEventListener("click",y),E.querySelector("#select12").addEventListener("change",f),p=new e.ZSClass.Dialog(E,n)),E.querySelector("#appliestorange").style.display="none",E.querySelector("#Note").innerText=i["ProtectedRange.UI.SheetLockCollaboratorsInfo"],p.open()},s.register(a.Listener,l.UserAction.SHOW_LOCK_INFO,function(e,r){if(r){for(;t.firstChild;)t.removeChild(t.firstChild);E.querySelector("#lockCellsLoader").style.display="none",new b(t,e)}},"lockInfo","isSheet"),s.register(a.Listener,l.DocMeta.PROTECTED_SHEETS,A),s.register(a.Listener,l.DocAction.PROTECTED_SHEETS.MODIFY,A),s.register(a.Listener,l.DocAction.PROTECTED_SHEETS.REMOVE,A),s.register(a.Listener,l.DocAction.WORKSHEETS.SWITCHSHEET,A,"RID","NEWSHEETID","VERSION")}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,s=n.topic,o=n.Groups,a=n.Names,r=(e.ZSConstants.I18N,e.ZSConstants.FeatureConstants),c=(e.JSUtil,t.view.Toolbar.Feature[r.MANAGE_LOCK_SETTINGS]);c.enableManageLocks=function(e){var t=e?"block":"none";c.manageDlgWrapper.querySelector("#saveBtn").style.display=t,c.manageDlgWrapper.querySelector("#manageLockInfo").style.display=t},s.register(o.Listener,a.UserAction.READ_LOCKS,function(e,t,n){t?c.SheetLocksContainer.construct(e):c.RangeLocksContainer.construct(e,n)},"lockInfo","isSheet","isWholeDocument")}(this);
!function(e){var t=e.sPlusPlus,s=e.document,o=e.ZSConstants.FeatureConstants,r=(e.ZSConstants.CommandConstants,e.ZSConstants.wCC,e.ZSClass),n=e.ZSEvents,i=(n.topic,n.Groups,n.Names,(o=e.ZSConstants).FeatureConstants),a=(o.wCC,r.Editors.RangeEditor,r.Editors.TextAreaEditor,r.Editors.Utility,e.ZSConstants.I18N),c=(t.data.AppRegistry.CSSPath,t.data.UserInfo.zuid,e.UIUtil.Component),l=e.JSUtil,h=t.data.AppRegistry.USER_PHOTO_SERVER_URL,d=t.view.Toolbar.Feature[i.MANAGE_LOCK_SETTINGS],g=t.view.Toolbar.Feature[i.LOCK];function u(e){this.container=e}function S(e,t){this.container=e,this.curSheetContainer=t,this.setAsActiveTab(),this.sheetHolders={}}d.IsRangeTab=!0,u.prototype={construct:function(e){this.lockInfo=e;d.manageDlgWrapper.querySelector("#lockOpts");this.addContainerEvents();for(var s=t.view.getActiveGridID(),o=(t.view.getResourceID(s),0);o<e.length;o++){var n=e[o].sn;d.sheetLocks[n]=new r.LockSheetSection(e[o],this.container,n)}d.sheetLocksConstructed=!0,this.show()},get:function(){d.sheetLocksConstructed||this.getLocksInfoAction()},show:function(){this.setAsActiveTab(),void 0==this.lockInfo?this.get():(d.manageDlgWrapper.querySelector("#sheetLocksLoader").style.display="none",this.lockInfo.length>0?this.showLocks():this.showNoSheetLocksAvailable())},getLocksInfoAction:function(){var s=t.view.getActiveGridID(),o=t.view.getResourceID(s),r=t.view.getVersionID(s),n=t.view.getSelectedSheets(s);d.manageDlgWrapper.querySelector("#noLocksMsg").style.display="none",d.manageDlgWrapper.querySelector("#lockOpts").style.display="block",d.manageDlgWrapper.querySelector("#sheetLocksLoader").style.display="block",e.UserAction.readProtectedSheets(o,n,r),d.sheetLocksConstructed=!0},setAsActiveTab:function(){d.IsRangeTab=!1,this.appliesToEditor=d.manageDlgWrapper.querySelector("#appliestofieldM"),d.manageDlgWrapper.querySelector("#appliesTo").innerText=a["ProtectedRange.UI.ViewProtectedSheets"],d.manageDlgWrapper.querySelector("#rangeOpt").classList.remove("active"),d.manageDlgWrapper.querySelector("#sheetOpt").classList.add("active"),this.container.style.display="block",d.RangeLocksContainer.container.style.display="none",c.zcombo(this.appliesToEditor,"setValue","All"),c.zcombo("#appliestofieldM","disable"),d.isSheetTabSelected=!0},showLocks:function(){this.container.style.display="block",d.manageDlgWrapper.querySelector("#noLocksMsg").style.display="none",d.manageDlgWrapper.querySelector("#lockOpts").style.display="block"},showNoSheetLocksAvailable:function(){this.container.style.display="none";var e=d.manageDlgWrapper.querySelector("#noLocksMsg");e.querySelector("#noLocksMsgSpan").innerText=a["ProtectRange.UI.NoProtectedSheet"],e.style.display="block",d.manageDlgWrapper.querySelector("#lockOpts").style.display="none"},addContainerEvents:function(){var e=d.manageDlgWrapper;d.manageDlgWrapper.querySelector("#lockOpts").style.display="block",e.querySelector("#expandAll").addEventListener("click",function(){if(d.isSheetTabSelected){for(var e=this.container.querySelectorAll("#usersContainer"),t=0;t<e.length;t++)e[t].style.display="table";var s=this.container.querySelectorAll("input[id^=rangeLbl_]");for(t=0;t<s.length;t++)s[t].checked=!0}}.bind(this)),e.querySelector("#collapseAll").addEventListener("click",function(){if(d.isSheetTabSelected){for(var e=this.container.querySelectorAll("#usersContainer"),t=0;t<e.length;t++)e[t].style.display="none";var s=this.container.querySelectorAll("input[id^=rangeLbl_]");for(t=0;t<s.length;t++)s[t].checked=!1}}.bind(this))}},r.SheetLocksContainer=u,S.prototype={construct:function(e,o){this.lockInfo=e;d.manageDlgWrapper.querySelector("#lockOpts");this.addContainerEvents(this.container),this.isWholeDocument&&(d.loadedSheets.All=1);for(var n=0;n<e.length;n++){var i=e[n].prArray,a=e[n].sn,c=t.view.getActiveGridID(),l=t.view.getResourceID(c),h=t.view.getVersionID(c),g=t.data.getWorkBook(l,h).SheetList.getIdByName(a);if(0==d.loadedSheets[g]){var u=s.createElement("div");u.id=a,u.className="wid wid100",this.container.appendChild(u),this.sheetHolders[a]=u;for(var S=0;S<i.length;S++){var p=i[S].pr;d.rangeLocks[p]=new r.LockRangeSection(i[S],u,p)}}else this.container.querySelector("#"+a).style.display="block";d.loadedSheets[g]=1}d.rangeLocksConstructed=!0,this.setAsActiveTab(),0==this.lockInfo.length?this.showNoRangeLocksAvailable():this.showLocks()},show:function(){this.setAsActiveTab();var e=t.view.getActiveGridID(),s=t.view.getResourceID(e),o=t.view.getVersionID(e),r=t.data.getWorkBook(s,o),n="";this.isWholeDocument?0==Object.keys(this.sheetHolders).length?this.showNoRangeLocksAvailable():this.showLocks():(n=r.getSheetObj(d.selectedSheetId).Prop.Name,this.sheetHolders[n]&&0!=this.sheetHolders[n].childElementCount?this.showLocks():this.showNoRangeLocksAvailable())},setAsActiveTab:function(){d.IsRangeTab=!0,this.appliesToEditor=d.manageDlgWrapper.querySelector("#appliestofieldM"),d.manageDlgWrapper.querySelector("#rangeOpt").classList.add("active"),d.manageDlgWrapper.querySelector("#sheetOpt").classList.remove("active"),c.zcombo(this.appliesToEditor,"setValue",d.selectedSheetId),d.manageDlgWrapper.querySelector("#appliesTo").innerText=a["ProtectedRange.UI.ViewProtectedRanges"],c.zcombo("#appliestofieldM","enable"),d.isSheetTabSelected=!1,d.SheetLocksContainer.container.style.display="none",this.container.style.display="block",d.manageDlgWrapper.querySelector("#rangeLocksLoader").style.display="block"},showLocks:function(){var e=t.view.getActiveGridID(),s=t.view.getResourceID(e),o=t.view.getVersionID(e),r=t.data.getWorkBook(s,o);if(this.isWholeDocument)this.showAllLocks();else{this.hideAllLocks();var n=r.getSheetObj(d.selectedSheetId).Prop.Name;this.sheetHolders[n]&&(this.sheetHolders[n].style.display="block")}this.container.style.display="block",d.manageDlgWrapper.querySelector("#noLocksMsg").style.display="none",d.manageDlgWrapper.querySelector("#rangeLocksLoader").style.display="none",d.manageDlgWrapper.querySelector("#lockOpts").style.display="block"},showAllLocks:function(){var e=t.view.getActiveGridID(),s=t.view.getResourceID(e),o=t.view.getVersionID(e);t.data.getWorkBook(s,o);for(var r in this.sheetHolders)this.sheetHolders[r].style.display="block"},hideAllLocks:function(){var e=t.view.getActiveGridID(),s=t.view.getResourceID(e),o=t.view.getVersionID(e);t.data.getWorkBook(s,o);for(var r in this.sheetHolders)this.sheetHolders[r].style.display="none"},showNoRangeLocksAvailable:function(){var e=d.manageDlgWrapper.querySelector("#noLocksMsg");e.querySelector("#noLocksMsgSpan").innerText=a["ProtectRange.UI.NoProtectedRange"],e.style.display="block",d.manageDlgWrapper.querySelector("#rangeLocksLoader").style.display="none",this.container.style.display="none",d.manageDlgWrapper.querySelector("#lockOpts").style.display="none"},addContainerEvents:function(){var e=d.manageDlgWrapper;e.querySelector("#lockOpts").style.display="block",e.querySelector("#expandAll").addEventListener("click",function(){if(!d.isSheetTabSelected){for(var e=this.container.querySelectorAll("#usersContainer"),t=0;t<e.length;t++)e[t].style.display="table";var s=this.container.querySelectorAll("input[id^=rangeLbl_]");for(t=0;t<s.length;t++)s[t].checked=!0}}.bind(this)),e.querySelector("#collapseAll").addEventListener("click",function(){if(!d.isSheetTabSelected){for(var e=this.container.querySelectorAll("#usersContainer"),t=0;t<e.length;t++)e[t].style.display="none";var s=this.container.querySelectorAll("input[id^=rangeLbl_]");for(t=0;t<s.length;t++)s[t].checked=!1}}.bind(this))}},r.RangeLocksContainer=S;var p=0;function k(e,t,s){this.LockedRange=e,this.sheetName=s,this.container=t,this.userStrand={},this.constructLock(),this.constructLockUserStand(),this.addLockSectionEvents()}k.prototype={constructLock:function(){var e=UserAction.getTemplate(["LOCK_CONTENTS_TEMPLATE"]).LOCK_CONTENTS_TEMPLATE;this.container.appendChild(e);var t="lockSection_"+p++;this.container.querySelector("#lockSection").id=t,this.lockSection=this.container.querySelector("#"+t),this.sectionlabelId="sheetLbl_"+p,this.lockSection.querySelector("#rangeLbl").id=this.sectionlabelId,this.lockSection.querySelector("label").setAttribute("for",this.sectionlabelId),this.lockSection.querySelector("label").querySelector("#label").textContent=this.sheetName},constructLockUserStand:function(){for(var e in this.usersContainer=this.lockSection.querySelector("#usersContainer"),delete this.LockedRange.sn,this.LockedRange.owner&&(this.userStrand[this.LockedRange.owner.zuid]=new r.LockUserStrand(this.LockedRange.owner,"owner",a["ProtectRange.UI.Owner"],this.usersContainer,this.sheetName)),this.LockedRange)for(var t=b(e),s=0;s<this.LockedRange[e].length;s++)this.userStrand[this.LockedRange[e][s].zuid]=new r.LockUserStrand(this.LockedRange[e][s],e,t,this.usersContainer,this.sheetName)},addLockSectionEvents:function(){var s=this.sectionlabelId;this.lockSection.querySelector("#"+s).addEventListener("change",function(){this.lockSection.querySelector("#"+s).checked?this.lockSection.querySelector("#usersContainer").style.display="table":this.lockSection.querySelector("#usersContainer").style.display="none"}.bind(this)),this.lockSection.querySelector("#trashLock").addEventListener("click",function(){delete d.sheetLocks[this.sheetName];var s=t.view.getActiveGridID(),o=t.view.getResourceID(s),r=t.view.getVersionID(s),n=t.data.getWorkBook(o,r).SheetList.getIdByName(this.sheetName);e.UserAction.UnlockSheet(o,[n],r),this.showNoSheetLocksAvailable(this.container),this.lockSection.remove()}.bind(this))},showNoSheetLocksAvailable:function(e){if(0==Object.keys(d.sheetLocks).length){var t=d.manageDlgWrapper.querySelector("#noLocksMsg");t.querySelector("#noLocksMsgSpan").innerText=a["ProtectRange.UI.NoProtectedSheet"],t.style.display="block",e.style.display="none",d.manageDlgWrapper.querySelector("#lockOpts").style.display="none"}else d.manageDlgWrapper.querySelector("#lockOpts").style.display="block"}},r.LockSheetSection=k;var y=0;function L(e,t,s){this.LockedRange=e,this.container=t,this.range=s,this.userStrand={},this.constructLock(),this.constructLockUserStand(),this.addLockSectionEvents()}L.prototype={constructLock:function(){var e=UserAction.getTemplate(["LOCK_CONTENTS_TEMPLATE"]).LOCK_CONTENTS_TEMPLATE;this.container.appendChild(e);var t="lockSection_"+y++;this.container.querySelector("#lockSection").id=t,this.lockSection=this.container.querySelector("#"+t),this.sectionlabelId="rangeLbl_"+y,this.lockSection.querySelector("#rangeLbl").id=this.sectionlabelId,this.lockSection.querySelector("label").setAttribute("for",this.sectionlabelId),this.lockSection.querySelector("label").querySelector("#label").textContent=this.range},constructLockUserStand:function(){for(var e in this.usersContainer=this.lockSection.querySelector("#usersContainer"),delete this.LockedRange.pr,this.LockedRange.owner&&(this.userStrand[this.LockedRange.owner.zuid]=new r.LockUserStrand(this.LockedRange.owner,"owner",a["ProtectRange.UI.Owner"],this.usersContainer,this.range)),this.LockedRange)for(var t=b(e),s=0;s<this.LockedRange[e].length;s++)this.userStrand[this.LockedRange[e][s].zuid]=new r.LockUserStrand(this.LockedRange[e][s],e,t,this.usersContainer,this.range)},addLockSectionEvents:function(){var s=this.sectionlabelId;this.lockSection.querySelector("#"+s).addEventListener("change",function(){this.lockSection.querySelector("#"+s).checked?this.lockSection.querySelector("#usersContainer").style.display="table":this.lockSection.querySelector("#usersContainer").style.display="none"}.bind(this)),this.lockSection.querySelector("#trashLock").addEventListener("click",function(){delete d.rangeLocks[this.range];var s=t.view.getActiveGridID(),o=t.view.getResourceID(s),r=t.view.getVersionID(s),n=JSUtil.Range.parseRange(o,r,this.range),i=(n.sheetName,n.range),a=t.data.getWorkBook(o,r).SheetList.getIdByName(n.sheetName);e.UserAction.RemoveLockRange(o,[a],[i],r),this.checkLocksAvalability(this.container),this.lockSection.remove()}.bind(this))},checkLocksAvalability:function(e){if(0==Object.keys(d.rangeLocks).length){this.container.style.display="none";var t=d.manageDlgWrapper.querySelector("#noLocksMsg");t.querySelector("#noLocksMsgSpan").innerText=a["ProtectRange.UI.NoProtectedRange"],t.style.display="block",d.manageDlgWrapper.querySelector("#lockOpts").style.display="none",d.RangeLocksContainer.container.style.display="none"}else d.manageDlgWrapper.querySelector("#lockOpts").style.display="block"}},r.LockRangeSection=L;var v=0;function f(e,t,s,o,r){this.user=e,this.userType=t,this.userTypeMsg=s,this.usersContainer=o,this.range=r,this.name=e.name,this.email=e.email,this.zuid=e.zuid,this.locked=this.user.lock,this.checked=this.user.lock,this.constructUser()}function b(e){var t="";switch(e){case"coU":case"coG":case"roM":t=a["ProtectRange.UI.CoOwner"];break;case"rwU":case"rwG":case"rwO":case"woM":t=a["ProtectRange.UI.ReadWrite"];break;case"roU":case"roG":case"roO":t=a["ProtectRange.UI.ReadOnly"];break;case"rcU":case"rcG":case"rcO":t=a["ProtectRange.UI.ReadComment"];break;case"orgzs":t=a["ProtectRange.UI.Organizer"];break;case"admin":t=a["ProtectRange.UI.Admin"];break;default:t=a["ProtectRange.UI.Users"]}return t}function m(e){var t;switch(e){case"coG":case"rwG":case"roG":case"rcG":t="&t=group";break;case"coO":case"rwO":case"roO":case"rcO":t="&t=org";break;default:t=""}return t}f.prototype={constructUser:function(){var e=UserAction.getTemplate(["MANAGE_LOCK_USERS_TEMPLATE"]).MANAGE_LOCK_USERS_TEMPLATE;this.usersContainer.appendChild(e),this.userStrand=this.usersContainer.querySelector("#userStrand"),this.userStrand.querySelector("#profile").src=h+"/file?fs=thumb&ID="+this.zuid+m(this.userType),this.userStrand.querySelector("#name").textContent=this.name,this.userStrand.querySelector("#name").title=this.email,this.userStrand.querySelector("#userType").textContent=this.userTypeMsg,this.userStrand.id="";var s="ZSLR_"+v++,o=this.userCheck=this.userStrand.querySelector("#lockCell1");o.id=s,this.userStrand.querySelector("label").setAttribute("for",s),o.checked=this.locked;var r=this.range;this.zuid==t.data.UserInfo.zuid&&(this.userStrand.querySelector("#me").style.display=""),this.userCheck.addEventListener("change",function(){this.checked=o.checked,this.toggleChangeManageProtect(r,this)}.bind(this))},toggleChangeManageProtect:function(e){d.enableManageLocks(!0);var t=new l.StringBuffer,s=new l.StringBuffer,o=new l.StringBuffer,r=new l.StringBuffer,n=!0,i=d.isSheetTabSelected?d.sheetLocks[e].userStrand:d.rangeLocks[e].userStrand;for(var a in i){var c=i[a].userType,h=i[a].checked;switch(c){case"coG":case"rwG":case"roG":case"rcG":!h&&o.append(a);break;case"roO":case"rwO":case"rcO":!h&&r.append(a);break;default:h&&s.append(a),!h&&t.append(a)}h&&(n=!1)}!function(e,t,s,o,r,n,i){for(var a=!1,c=0;c<d.modifiedRanges.length;c++)if(d.modifiedRanges[c].pr===e){a=!0,d.modifiedRanges[c].isAllUnlocked=i,d.modifiedRanges[c].au=t,d.modifiedRanges[c].uau=s,d.modifiedRanges[c].ag=o||d.modifiedRanges[c].ag,d.modifiedRanges[c].ao=r||d.modifiedRanges[c].ao,d.modifiedRanges[c].isPubA=n||d.modifiedRanges[c].isPubA;break}a||(i?d.modifiedRanges.push({pr:e,isAllUnlocked:i}):d.modifiedRanges.push({pr:e,au:t.toString(),uau:s.toString(),ag:o,ao:r,isPubA:n}))}(e,t.toString(",",!0),s.toString(",",!0),o.toString(",",!0),r.toString(",",!0),null,n)}},r.LockUserStrand=f,g.getUserTypeMsg=b,g.userImgBasedOnType=m}(this);
!function(e){var t=e.sPlusPlus,I=e.ZSConstants.FeatureConstants,n=(e.document,e.ZSConstants.I18N,e.ZSConstants.wCC),i=e.ZSEvents,E=i.topic,o=i.Groups,T=i.Names,s=e.UIUtil.Component,S=!1;t.view.Toolbar.Feature[I.HIGHLIGHT_LOCKS].execute=function(){var e=t.view.getActiveGridID(),i=t.view.getResourceID(e),r=t.view.getVersionID(e),L=t.data.getWorkBook(i,r),c=t.view.getSheetID(e);L.highlightLocks=S=!S,S?s.zmenu("#"+n.SUBMENUITEM+I.LOCK_CELLS+n.IDENTITY,"setAttribute","contentType","icon-text"):s.zmenu("#"+n.SUBMENUITEM+I.LOCK_CELLS+n.IDENTITY,"setAttribute","contentType","text"),function(e,I,n){var i=t.data.getWorkBook(e,n),s=i.getSheetObj(I).ProtectedRanges.getAllRanges(),r=i.ProtectedSheets;S?function(e,t,I,n,i){E.publish(o.Listener,T.UserAction.HIGHLIGHT_LOCKS,{RID:e,SHEETID:t,VERSION:I,RANGELIST:n,SHEETLIST:i})}(e,I,n,s,r):function(e,t,I,n,i){E.publish(o.Listener,T.UserAction.REMOVE_HIGHLIGHT_LOCKS,{RID:e,SHEETID:t,VERSION:I,RANGELIST:n,SHEETLIST:i})}(e,I,n,s,r)}(i,c,r)},E.register(o.Listener,T.DocAction.WORKSHEETS.SWITCHSHEET,function(){var e=t.view.getActiveGridID(),i=t.view.getResourceID(e),E=t.view.getVersionID(e);t.data.getWorkBook(i,E),t.view.getSheetID(e),S&&s.zmenu("#"+n.SUBMENUITEM+I.LOCK_CELLS+n.IDENTITY,"setAttribute","contentType","icon-text")},"RID","NEWSHEETID","VERSION"),E.register(o.UI,T.Toolbar.INIT_MENU,function(e){"sidePanelViewSetting"!=e.id&&e.id!=n.SUBMENUITEM+I.LOCK_CELLS+n.IDENTITY||(s.zmenu("#sidePanelViewSetting","setMenuItemsAttribute",["#"+n.SUBMENUITEM+I.HIGHLIGHT_LOCKS+n.IDENTITY],"checked",S),s.zmenu("#"+n.SUBMENUITEM+I.LOCK_CELLS+n.IDENTITY,"setMenuItemsAttribute",["#"+n.SUBMENUITEM+I.HIGHLIGHT_LOCKS+n.IDENTITY],"checked",S))},"DOM")}(this);
!function(t){var e=t.sPlusPlus,i=t.ZSConstants.FeatureConstants,s=e.view.Toolbar.Feature[i.LOCK_CELLS];function o(t,e,i){this.domRef=i?function(t){return t.className="pR",t}(t):function(t){return t.className="",t}(t),this.range=e,this.locked=i}o.prototype={paint:function(t,e,i,s){var o=this.domRef.style;o.top=t-0+"px",o.left=e-0+"px",o.height=i+0+"px",o.width=s+0+"px"},addHighlight:function(){this.domRef.classList.add("highlightLocks");var t=document.createElement("span"),e=this.range;t.className="curPtr",this.domRef.appendChild(t),t.addEventListener("mousedown",function(t){t.stopPropagation()}),t.addEventListener("click",function(t){s.showDialog(!1,e),t.stopPropagation()})},removeHighlight:function(){this.domRef.classList.remove("highlightLocks"),this.domRef&&this.domRef.firstChild&&this.domRef.removeChild(this.domRef.firstChild)},remove:function(){this.domRef.style.display="none",this.domRef.parentNode.removeChild(this.domRef)},hide:function(){this.domRef.style.display="none"},revoke:function(){this.domRef.style.display=""}},t.ZSClass.UIProtectRangeCue=o}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSConstants.FeatureConstants,i=(e.document,e.ZSConstants.I18N,e.ZSConstants.wCC,e.ZSEvents),n=i.topic,o=i.Groups,r=i.Names,u=(e.UIUtil.Component,!0);t.view.Toolbar.Feature[s.HIGHLIGHT_LOCKS].togglePattern=function(){var e=t.view.getActiveGridID(),s=t.view.getResourceID(e),i=t.view.getVersionID(e),a=t.view.getSheetID(e);(u=!u)?document.querySelector("#MainGrid").classList.remove("hideLockCue"):document.querySelector("#MainGrid").classList.add("hideLockCue"),n.publish(o.Listener,r.SheetAction.LOCK_PATTERN,{RID:s,SHEETID:a,VERSION:i,SHOW:u})}}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSConstants,n=e.ZSClass,r=e.window,o=e.document,a=i.FeatureConstants,s=t.view.Toolbar.Feature[a.PRINT],d=t.view.Toolbar.Feature[a.PRINT_SETTINGS],c=t.view.Toolbar.Feature[a.PRINT+"_from_Preview"],l=t.view.measures,u=t.view.Events.Key,v=e.UIUtil.Component,p=e.ZSEvents,g=p.topic,w=p.Groups,f=p.Names,P=e.ZSConstants.I18N,h=new n.TBNotification(P["Print.ProgressMessage1"],{type:"info",mode:"STD"}),T=new n.TBNotification(P["Print.ProgressMessage"],{type:"info",mode:"STD"}),I=new n.TBNotification(P["LP.LODING"],{type:"info",mode:"STD"});c.notif=h;var y,m,C=t.view.Toolbar.Feature[a.BACK_TO_EDITOR],S=(s=t.view.Toolbar.Feature[a.PRINT],t.data.AppRegistry.ctxpath);s.printPreviewObj=void 0;var E,O,b,B,R,N=1,D=o.querySelector("#PrintContainer"),G=o.querySelector("#printBtnCont");(R=o.createElement("iframe")).id="printFrame",R.src=S+"appsheet/html/dummy.html",R.style.visibility="hidden",o.body.appendChild(R);var L,M=30;function A(){var i=d.Options,n=t.view.getActiveGridID(),r=t.view.getResourceID(n),o=t.view.getSheetID(n),a=t.view.getVersionID(n),s=t.view.getSheetState(n,o).getActiveRange(),l=t.data.getWorkBook(r,a).getSheetObj(o),u=!1,v=l.Merge.isXists(s.startRow,s.startCol),p=l.Merge.isXists(s.endRow,s.endCol);v&&p&&(u=v.root.equals(p.root));var g="SHEET";u||s.isSingle()||(g="RANGE"),c.notif.show(),UserAction.PrintPreview(r,o,a,i.addGridLines,i.addChart,i.addImage,i.addButton,g,e.isCanvasGrid,q)}function q(i){if(e.isCanvasGrid)!function(i){var r=t.view.getActiveGridID(),o=t.view.getResourceID(r),a=t.view.getSheetID(r),s=t.view.getVersionID(r),l=new n.Range(i.startRow,i.startCol,i.endRow,i.endCol);L=new e.ZSGrid.Print.Preview(r,o,a,s,d.Options,l,i.endRow,i.endCol),e.CPP=L,"PRINT"==E?L.print(function(){c.notif.isShown&&c.notif.remove()}):L.showPreview(0,2,function(){c.notif.isShown&&c.notif.remove()}),x(L.getTotalPageCount())}(i);else{var r=t.view.getActiveGridID(),a=t.view.getResourceID(r),l=t.view.getSheetID(r),v=t.view.getVersionID(r);UserAction.GetListForPreview(a,l,v,function(e){var t=d.Options.Orientation,r=k(d.Options.PageWidth),a=k(d.Options.PageHeight),c={PaperWidth:"0"==t?r:a,PaperHeight:"0"==t?a:r,TopMargin:k(d.Options.MarginTop),BottomMargin:k(d.Options.MarginBottom),LeftMargin:k(d.Options.MarginLeft),RightMargin:k(d.Options.MarginRight),isFitToWidth:d.Options.FitToWidth,showGridLines:d.Options.addGridLines,showButtons:d.Options.addButton,showCharts:d.Options.addChart,showImage:d.Options.addImage},l=o.getElementById("previewContainer");!s.printPreviewObj&&(s.printPreviewObj=new n.PrintPreview(i,l,c,e)),x(s.printPreviewObj.getPageCount()),"PRINT"==E&&s.printPreviewObj.getAllPageFragment(),_(),H(u.Entry.Print.Context)})}}function x(e){G.querySelector("#totPages").innerText=e,G.querySelector("#currPageIdx").value=1,y=e,F(),PrintContainer.scrollTop=0}function k(e){return Math.round(96*e)}function H(e){u.focusContext(e)}function _(){return u.Stack[u.Stack.length-1]}function F(){var e=r.innerHeight-(l.Top.topBand+l.Top.menuBar.toolBar+l.Bottom.bottomBand+l.Bottom.chatBar);D.style.height=e+"px",D.style.width=r.innerWidth+"px";o.getElementById("previewContainer").offsetLeft}function j(t){var i=1;switch(t.id){case"fImg":i=1;break;case"pImg":i=N-1;break;case"nImg":i=N+1;break;case"lImg":i=y;break;default:i=(i=isNaN(t.value)?N:parseInt(t.value))>y?y:i,t.value=i}if(i<=y&&i>0){if(e.isCanvasGrid)return I.show(),void L.goToPage(i,function(){var e="pg"+(i-1),t=o.getElementById(e);if(t){var n=t.offsetTop;D.scrollTop=n,I.remove(),N=i,U()}});var n=o.getElementById("previewContainer").children[i-1].offsetTop;D.scrollTop=n,s.printPreviewObj.unloadPages(),s.printPreviewObj.loadPages(i-1,i+1)}}function U(){N<=y&&N>0&&(G.querySelector("#currPageIdx").value=N)}s.execute=function(t){if(E=t,!O){var i=new n.PrintToolbar;O=new n.UIView("Print",i)}B=l.Top.menuBar.Tab,l.Top.menuBar.Tab=0,O.show(),o.querySelector(".mainGrid").style.display="none",o.querySelector("#TB_SHEET_CONTAINER").style.display="none",o.getElementById("SHEET_SB_CONTAINER").style.display="none",D.style.display="block",F(),A(),m||(!G&&(G=o.querySelector("#printBtnCont")),D.addEventListener("scroll",JSUtil.fn.debounce(function(t){var i,n,r,o;i=this,n=k("0"==d.Options.Orientation?d.Options.PageHeight:d.Options.PageWidth)+(isCanvasGrid?M:0),r=i.scrollTop,o=Math.ceil(r/n),N!=(o=o||1)&&(e.isCanvasGrid?L&&L.showPreview(o-2,o+2):(s.printPreviewObj.unloadPages(),s.printPreviewObj.loadPages(o-1,o+1)),N=o,U())},200)),G.querySelector("#currPageIdx").addEventListener("focus",function(e){_(),H(u.Entry.Print.Context)}),G.querySelector("#currPageIdx").addEventListener("change",function(e){j(this)}),G.querySelector("#fImg").addEventListener("click",function(e){j(this)}),G.querySelector("#pImg").addEventListener("click",function(e){j(this)}),G.querySelector("#nImg").addEventListener("click",function(e){j(this)}),G.querySelector("#lImg").addEventListener("click",function(e){j(this)}),m=!0)},c.execute=function(){e.isCanvasGrid?L.print():(E="PRINT",c.notif=T,A())},s.refreshPreview=function(){e.isCanvasGrid&&L&&L.refresh()},C.execute=function(){e.isCanvasGrid&&(L&&L.flushPrinter(),L=void 0,e.CPP=void 0),s.printPreviewObj=void 0,c.notif.isShown&&c.notif.remove(),R&&(R.contentDocument.body.innerHTML=""),l.Top.menuBar.Tab=B,o.querySelector(".mainGrid").style.display="",o.querySelector("#TB_SHEET_CONTAINER").style.display="",PrintContainer.style.display="none",o.getElementById("previewContainer").innerHTML="",o.getElementById("SHEET_SB_CONTAINER").style.display="",O.hide(),H(u.Entry.CellEditor.Context);var i=t.view.getActiveGridID(),n=t.view.getResourceID(i),r=t.view.getSheetID(i),a=t.view.getVersionID(i);UserAction.UpdateViewport(n,r,a),g.publish(w.Listener,f.Browser.RESIZE)},-1!=i.Meta.DisableFeaturesList.indexOf(a.PRINT)&&(v.disable(s.printBtn),v.disable(s.printMenu)),g.register(w.Listener,f.DocAction.PRINT.TRIGGER_PRINT,function(e){b=0;var i=R.contentDocument.body;!function(e,i){e.innerHTML="";for(var n=t.data.AppRegistry.CSSPath,r=(d.Options.Orientation,["common.css","GridContainer.css","SheetPane.css","fontcustom.css","defer/print.css"]),a=r.length,s=function(){b++,i(a)},c=0;c<a;c++){var l=o.createElement("link");l.rel="stylesheet",l.type="text/css",l.href=n+r[c],l.onload=s,e.appendChild(l)}}(i,function(t){if(b==t){var n=o.createElement("div");n.id="printDataContainer",n.innerHTML=e.outerHTML,i.appendChild(n),setTimeout(function(){R.contentWindow.print(),c.notif=h},500)}})},"CONTENT")}(window);
!function(e){var t,i,a=e.sPlusPlus,n=e.ZSClass,r=e.JSUtil,s=e.ZSEvents,o=s.topic,l=s.Groups,g=s.Names,d=n.Padding,p=e.ZSConstants.FeatureConstants,h=a.view.Toolbar.Feature[p.PRINT+"_from_Preview"],c=""===document.createElement("detect").style.zoom,f=[],u=!1;function v(e,t,i,a){this.data=e,this.container=t,this.options=i,this.metaList=a,this.pageCount=1,this.pageDetails={},this.pageFragments={},this.activeBuffer=[],this.inActiveBuffer=[],this.init()}function m(e,t){var i=e/t,a=Math.floor(100*i)/100;return a>1&&(a=1),a}function x(e,t,i){if(t){var a=t.META;if(a[i]){var n=a[i].cs,r=n.indexOf(e);if(-1!=r)return n.substring(r+e.length+1,n.indexOf(";",r)+1)}}return""}function y(e){var t=e.cn,i=e.cs,a=e.cv,n=e.height,r=e.width,s=e.iconHtml,o="";e.chbox&&(o=function(e){var t="<input type=checkbox >";e&&(t="<input type=checkbox checked >");return t}("TRUE"==a),t+=" fac");var l=document.createElement("div");l.className=t,l.setAttribute("style",i),l.style.width=r+"px",l.style.height=n+"px",l.style.overflow="hidden";if(/( (fa|ta)[rc])(\b)/i.test(t)){var g=document.createElement("div");g.className="w100",g.innerHTML=o||a+s,l.appendChild(g)}else l.innerHTML=o||a+s;return l}function P(e,t){return 256*e+t}function w(e,t,i){for(var a=0,n=e;n<=t;n++)a+=i.getDim(n);return a}function C(e,t,i){for(var a=0,n=e;n<=t;n++)a+=i.getDim(n);return a}function R(e,t,i,a,n){for(var r=e.length,s=0;s<r;s++){var o=e[s];if(t>=o.sr&&t<=o.er&&i>=o.sc&&i<=o.ec)return{cellid:P(o.sr,o.sc),cellHeight:parseInt(a)*(o.er-o.sr+1)+"px",cellWidth:parseInt(n)*(o.ec-o.sc+1)+"px"}}return null}function I(e,t,i,s,o,l,g,p,h,c,f,u,v,m,x,y,P){var w,C=m.sparklineProperties,I=r.SparklinePool.getDataRange(s,g,m,c,f),E=x,D=R(y,c,f,u,v),b=l.Row.Visibility.getOnCount(p,c),T=l.Column.hidden.getOnCount(h,f);if(D){var A=D.cellid;u=D.cellHeight,v=D.cellWidth,w=E.querySelector("#mer_"+A)}else{var M=E.querySelectorAll(".pRow")[c-b-p].children;w=M[f-T-h]}var L=e,k=t;L.pageDetails[k].sparkLineReqCount++,a.view.fetchRangeDataFromWorker(s,o,g,I.range,["ActualValue"],!C.hidden,i,function(e){var t=new n.Sparkline(c,f,u,v,C,I,e);if(!t.undefined){var i=new Image;i.src=t.toDataURL(),i.style.height=parseInt(u)-d.getRowPadding()+"px",i.style.width=parseInt(v)-d.getColPadding()+"px",w.appendChild(i)}if(L.pageDetails[k].sparkLineReqCount--,0==L.pageDetails[k].sparkLineReqCount){var a=document.createDocumentFragment();a.appendChild(E),L.renderPage(k-1,k,a,P)}},function(){})}function E(e,t,i){var a=e.metaList.sparklineMeta;for(var n in a){var r=a[n];if(t>=r.startRow&&t<=r.endRow&&i>=r.startCol&&i<=r.endCol)return r}return!1}function D(){var e=document.createElement("div");return e.className="pRow",e}v.prototype={init:function(){!t&&(t=document.body.querySelector("#MainGrid")),i=t.getElementsByTagName("img"),this.unloadPages(),this.generateRange(null,null,!0),this.loadPages(1,3),this.container.style.width=this.options.PaperWidth+"px"},generateRange:function(e,t,i){if(this.data&&this.data.SHEET_META){var a,n,r=1,s=this.options.PaperHeight-(this.options.BottomMargin+this.options.TopMargin),o=this.options.PaperWidth-(this.options.LeftMargin+this.options.RightMargin),l=this.options.isFitToWidth,g=this.data.SHEET_META,p=Object.keys(g),h=p.length,c=0,f=e=e||0,u=t=t||0;for(a=e;a<h;a++){var v=g[parseInt(p[a])],x=v.HEIGHT+d.getRowPadding();if(c+x>=s){if(a!=e)break;r=s/x}var y=v.META,P=Object.keys(y),w=P.length;if(a==e){var C=0;for(n=t;n<w;n++){var R=y[parseInt(P[n])].width+d.getColPadding();if(C+R>=o&&!l){if(n!=t)break;r>o/R&&(r=o/R)}C+=R,u=n}if(l){var I=100*(r=m(o,C))/100*s;s+=s*((s-I)/I)}}c+=x,f=a}var E=(D=this.options.PaperHeight,b=this.options.PaperWidth,(T=document.createElement("div")).style.height=D+"px",T.style.width=b+"px",T.className="paperDom",T);i&&(this.container.innerHTML=""),this.container.appendChild(E),this.pageDetails[this.pageCount]={startRow:e,endRow:f,startCol:t,endCol:u,zoom:r,sparkLineReqCount:0,mergeCellDetails:{}},a<h?(this.pageCount++,this.generateRange(a,t)):n<w&&(this.pageCount++,this.generateRange(0,n))}var D,b,T},loadPages:function(e,t){var i=a.data.Defaults.VIEW;this.container.classList.remove("classic"),this.container.classList.remove("cozy"),this.container.classList.remove("comfort"),this.container.classList.add(i);for(var n=e;n<=t;n++)this.pageDetails[n]&&this.getPageFragment(n)},renderPage:function(e,t,i,a){!this.pageFragments[t]&&(this.pageFragments[t]=i.cloneNode(!0)),a?(a.children[e].appendChild(this.pageFragments[t].cloneNode(!0)),f[e]=!0,function(e){if(u)return;for(var t=!0,i=0;i<f.length;i++)if(!f[i]){t=!1;break}t&&(u=!0,o.publish(l.Listener,g.DocAction.PRINT.TRIGGER_PRINT,{CONTENT:e}))}(a)):this.container.children[e].appendChild(this.pageFragments[t].cloneNode(!0)),this.activeBuffer.push(this.container.children[e]),h.notif.isShown&&h.notif.remove()},getPageFragment:function(e,t){this.pageFragments[e]?this.renderPage(e-1,e,this.pageFragments[e],t):this.createPreviewPage(e,t)},getAllPageFragment:function(){!function(e){f=[],u=!1;for(var t=0;t<e;t++)f.push(!1)}(this.pageCount);var e=document.getElementById("previewContainer").cloneNode(!0);e.style.top="0px",e.className="prevContainer";var t=a.data.Defaults.VIEW;e.classList.add(t);for(var i=1;i<=this.pageCount;i++)this.getPageFragment(i,e)},unloadPages:function(){for(var e=this.activeBuffer.length,t=0;t<e;t++)this.activeBuffer[t].innerHTML=""},createPreviewPage:function(e,t){var n=this.pageDetails[e];if(n){for(var r,s=n.startRow,o=n.startCol,l=n.endRow,g=n.endCol,p=n.zoom,h=this.data.SHEET_META,f=Object.keys(h),u=document.createDocumentFragment(),v=function(e){var t=document.createElement("div");return t.style.marginLeft=e.LeftMargin+"px",t.style.marginRight=e.RightMargin+"px",t.style.marginTop=e.TopMargin+"px",t.style.marginBottom=e.BottomMargin+"px",t.className="pageDom",t}(this.options),m=0,b=0,T=s;T<=l;T++){var A=parseInt(f[T]),M=h[A],L=M.HEIGHT+d.getRowPadding(),k=M.META;r=Object.keys(k);var H=D();H.style.height=L+"px",H.style.top=m+"px",m+=L,b=0;for(var N=o;N<=g;N++){var F=parseInt(r[N]),S=k[F];if(S.height=L,S){var O=S.width+d.getColPadding();S.width=O;var B=S.cs;if(T==s){var W=x("border-bottom",h[A-1],F);W&&-1==W.indexOf("transparent")?B+="border-top:"+W:this.options.showGridLines&&-1==B.indexOf("border-top")&&(B+="border-top:1px solid #ccc;")}if(N==o){var G=x("border-right",h[A],F-1);G&&-1==G.indexOf("transparent")?B+="border-left:"+G:this.options.showGridLines&&-1==B.indexOf("border-left")&&(B+="border-left:1px solid #ccc;")}S.cs=B;var _=y(S);_.style.left=b+"px",H.appendChild(_),b+=O}}H.style.width=b+"px",v.appendChild(H)}var z=a.view.getActiveGridID(),q=a.view.getResourceID(z),j=a.view.getSheetID(z),U=a.view.getVersionID(z),V=a.data.getWorkBook(q,U).getSheetObj(j);V.Merge.RangeList;if(this.data.MERGE_META.length&&function(e,t,i,a,n,r,s,o,l,g){for(var d=i.length,p=l.getPos(n),h=g.getPos(r),c=(l.getPos(s),g.getPos(o),0);c<d;c++){var f,u,v=i[c],m=v.sr,x=v.sc,R=v.er,I=v.ec,E=l.getPos(m),D=g.getPos(x),b=(l.getPos(R),g.getPos(I),E-p),T=D-h,A=P(m,x),M=!1;if(m>=n&&m<=s&&x>=r&&x<=o?(f=b+"px",u=T+"px",M=!0):m>=n&&m<=s&&x<=r?(f=b+"px",u=-(h-D)+"px",M=!0):m<n&&x>=r&&x<=o?(f=-(p-E)+"px",u=T+"px",M=!0):m<n&&x<r&&R>=n&&I>=r&&(f=-(p-E)+"px",u=-(h-D)+"px",M=!0),M){v.sr!=v.er?v.height=w(v.sr,v.er,l):v.height=l.getDim(v.sr),v.sc!=v.ec?v.width=C(v.sc,v.ec,g):v.width=g.getDim(v.sc);var L=y(v);L.id="mer_"+A,L.style.top=f,L.style.left=u,L.style.height=parseInt(L.style.height)+"px",L.style.zIndex="260",a.appendChild(L),e.pageDetails[t].mergeCellDetails[A]={startRow:m,startCol:x,endRow:R,endCol:I}}}}(this,e,this.data.MERGE_META,v,parseInt(f[s]),parseInt(r[o]),parseInt(f[l]),parseInt(r[g]),V.Row.auxiliaryAxis,V.Column.auxiliaryAxis),this.options.showCharts)!function(e,t,i,a,n,r,s,o){for(var l=r.length,g=s.getPos(t),d=o.getPos(i),p=s.getPos(a),h=o.getPos(n),c=0;c<l;c++){var f=r[c],u=f.getTop(),v=f.getLeft(),m=f.getWidth(),x=f.getHeight(),h=v+m,p=u+x,y=s.find(u),P=o.find(v),w=y.idx,C=P.idx,R=s.find(p).idx,I=o.find(h).idx,E=s.getPos(w),D=o.getPos(C),b=E-g,T=D-d,A=y.rsdue,M=P.rsdue,L=!1;if(w>=t&&w<=a&&C>=i&&C<=n?(u=b+A+"px",v=T+M+"px",L=!0):w>=t&&w<a&&C<=i?(u=b+A+"px",v=-(d-(D+M))+"px",L=!0):w<t&&C>=i&&C<=n?(u=-(g-(E+A))+"px",v=T+M+"px",L=!0):w<t&&C<i&&R>=t&&I>=i&&(u=-(g-(E+A))+"px",v=-(d-(D+M))+"px",L=!0),L&&f.chartInstance[0]){var k=f.chartInstance[0].renderTo.id,H=document.getElementById(k).cloneNode(!0);H.removeAttribute("id"),H.style.position="absolute",H.style.zIndex="261",H.style.top=u,H.style.left=v,e.appendChild(H)}}}(v,s,o,l,g,(new ZSChart.Utility.ChartAgent).getAllMetaOfSheet(q,j,U),V.Row.auxiliaryAxis,V.Column.auxiliaryAxis);if(this.options.showImage)!function(e,t,a,n,r,s,o,l){var g=o.getPos(t),d=o.getPos(n),p=l.getPos(a),h=l.getPos(r);for(var c in s){var f=s[c],u=f.getRow(),v=f.getCol(),m=f.getRowDiff(),x=f.getColDiff(),y=o.getPos(u)+m,P=l.getPos(v)+x,w=f.getHeight(),C=f.getWidth(),d=y+w,h=P+C,R=o.find(d).idx,I=l.find(h).idx,E=o.getPos(u),D=l.getPos(v),b=E-g,T=D-p,A=!1;if(u>=t&&u<=n&&v>=a&&v<=r?(y=b+m+"px",P=T+x+"px",A=!0):u>=t&&u<n&&v<=a?(y=b+m+"px",P=-(p-(D+x))+"px",A=!0):u<t&&v>=a&&v<=r?(y=-(g-(E+m))+"px",P=T+x+"px",A=!0):u<t&&v<a&&R>=t&&I>=a&&(y=-(g-(E+m))+"px",P=-(p-(D+x))+"px",A=!0),A){for(var M,L=i.length,c=0;c<L;c++)if(i[c].src.contains(f.URL)){M=i[c];break}var k=document.createElement("canvas");k.height=w,k.width=C;var H=k.getContext("2d");H.drawImage(M,0,0,k.width,k.height);var N=k.toDataURL("image/svg"),F=document.createElement("img");F.src=N,F.style.position="absolute",F.style.top=y,F.style.left=P,F.height=w,F.width=C,F.style.zIndex="261",e.appendChild(F)}}}(v,s,o,l,g,V.Images.map,V.Row.auxiliaryAxis,V.Column.auxiliaryAxis);if(this.options.showButtons)!function(e,t,i,a,n,r,s,o){var l=s.getPos(t),g=s.getPos(a),d=o.getPos(i),p=o.getPos(n);for(var h in r){var c=r[h],f=c.getY(),u=c.getX(),v=c.getWidth(),m=c.getHeight(),p=u+v,g=f+m,x=s.find(f),y=o.find(u),P=x.idx,w=y.idx,C=s.find(g).idx,R=o.find(p).idx,I=s.getPos(P),E=o.getPos(w),D=I-l,b=E-d,T=x.rsdue,A=y.rsdue,M=!1;if(P>=t&&P<=a&&w>=i&&w<=n?(f=D+T+"px",u=b+A+"px",M=!0):P>=t&&P<a&&w<=i?(f=D+T+"px",u=-(d-(E+A))+"px",M=!0):P<t&&w>=i&&w<=n?(f=-(l-(I+T))+"px",u=b+A+"px",M=!0):P<t&&w<i&&C>=t&&R>=i&&(f=-(l-(I+T))+"px",u=-(d-(E+A))+"px",M=!0),M){var L=document.createElement("div");L.style.zIndex="261",L.style.position="absolute",L.style.top=f,L.style.left=u,L.style.height=m+"px",L.style.width=v+"px",L.style.textAlign="center",L.innerText=c.label,L.className="ZSOLEBtn",e.appendChild(L)}}}(v,s,o,l,g,V.Buttons.map,V.Row.auxiliaryAxis,V.Column.auxiliaryAxis);v.style.width=b+"px",v.style.height=m+"px",c?v.style.zoom=p:v.style.transform="scale("+p+")";var Z=this.metaList.sparklineMeta;if(Object.keys(Z).length&&function(e,t,i,a,n){for(var r in e){var s=e[r],o=s.startRow<t&&s.endRow<t,l=s.startCol<i&&s.endCol<i,g=s.startRow>a&&s.endRow>a,d=s.startCol>n&&s.endCol>n;if(!(o||l||g||d))return!0}return!1}(Z,parseInt(f[s]),parseInt(r[o]),parseInt(f[l]),parseInt(r[g])))!function(e,t,i,a,n,r,s,o,l,g,d,p,h,c,f,u,v){for(var m in h){for(var x=h[m],y=x.startRow,P=x.startCol,w=x.endRow,C=x.endCol,D=x.properties,m=(f.getPos(l),u.getPos(g),y);m<=w;m++)for(var b=P;b<=C;b++){var T=f.getDim(m)+"px",A=u.getDim(b)+"px",M=(f.getPos(m),u.getPos(b),!1);-1==R(c,m,b,T,A)?M=!1:m>=l&&m<=d&&b>=g&&b<=p&&(M=!0),(r.Row.Visibility.isHidden(m)||r.Column.hidden.isHidden(b))&&(M=!1),M&&I(e,t,i,a,n,r,s,l,g,m,b,T,A,D,o,c,v)}var L=e.pageDetails[t].mergeCellDetails;r.sparklines;for(var m in L){var k=L[m].startRow,H=L[m].startCol,N=E(e,k,H);if(N){var F=N.properties,T=f.getDim(k)+"px",A=u.getDim(H)+"px";I(e,t,i,a,n,r,s,l,g,k,H,T,A,F,o,c,v)}}}}(this,e,z,q,j,V,U,v,parseInt(f[s]),parseInt(r[o]),parseInt(f[l]),parseInt(r[g]),Z,this.data.MERGE_META,V.Row.auxiliaryAxis,V.Column.auxiliaryAxis,t);else(u=document.createDocumentFragment()).appendChild(v),this.renderPage(e-1,e,u,t)}},getPageCount:function(){return this.pageCount}},n.PrintPreview=v}(window);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents;n.topic,n.Names,n.Groups;t.view.Events.Key.Entry.Print.Context.keyDown[e.ZSConstants.JSKeyCode.ESC]=function(e){e.preventDefault(),document.querySelector("#currPageIdx").blur()}}(this);
!function(e){var t=e.sPlusPlus,r=e.ZSEvents,n=r.topic,i=r.Groups,a=r.Names,o=e.ZSConstants.FeatureConstants,s=e.document,c=e.UserAction,u=(e.ZSConstants.wCC,e.UIUtil.Component,e.ZSConstants.I18N),l=t.view.Toolbar.Feature[o.PROPERTIES];function p(){var e=t.view.getActiveGridID(),r=t.view.getResourceID(e),n=t.view.getVersionID(e);c.GetDocumentProperties(r,n,E)}function E(e){var r=s.querySelector("#tbSheetProperties");r.querySelector("#sp_dname").innerText=e.DOCUMENT_NAME,r.querySelector("#sp_owner").innerText=e.OWNER_NAME,r.querySelector("#sp_ctime").innerText=e.CREATED_TIME,r.querySelector("#sp_lmtime").innerText=e.LAST_MODIFIED_TIME,r.querySelector("#sp_permalink").innerText=e.PERMA_LINK,r.querySelector("#sp_atype").innerText=function(e){var r=t.view.getActiveGridID(),n=t.view.getResourceID(r),i="-";if(t.data.getSharePublishMeta(n)){var a=t.data.getSharePublishMeta(n).getShareMeta(),o=a.getSharedUserInfo(),s=t.data.UserInfo.zuid;a.OWNER_ID==s?i=u["ProtectRange.UI.Owner"]:void 0!=o.getRoleByID(s)&&(c=o.getRoleByID(s),l=e.ISWORKDRIVE,p=c?c.toLowerCase():"",i=l?c:JSUtil.fn.replaceParams(u["MenuItem.Properties.accessType"],new Array(p)))}var c,l,p;return i}(e),r.querySelector("#sp_permalink").addEventListener("click",function(){var e,t;e=r.querySelector("#sp_permalink"),t=s.createElement("input"),s.body.appendChild(t),t.value=e.innerText,t.select(),s.execCommand("copy",!1),t.remove(),new ZSClass.TBNotification(u["Statusbar.PermalinkCopy"]).show()})}l.doGetDocumentPropertiesAction=p,n.register(i.UI,a.Layout.TEMPLATE_LOADED_DEFER,function(){var e=c.getTemplate(["PROPERTIES_USER_PROFILE"]).PROPERTIES_USER_PROFILE;!function(e){var r=t.view.getActiveGridID(),n=t.view.getResourceID(r),i=t.data.getSharePublishMeta(n);if(i){var a=i.getShareMeta(),o=a.OWNER_ID,s=a.OWNER;t.data.AppRegistry.USER_PHOTO_SERVER_URL,e.querySelector("#popup_profilePic").src=t.data.AppRegistry.USER_PHOTO_SERVER_URL+"/file?fs=thumb&ID="+o,e.querySelector("#profileName").innerText=s}}(e),l.elem&&l.elem.appendChild(e)})}(this);
!function(e){var t=e.UserAction;function i(){this.isLocked=!1,this.removeUserProfile=!1}i.prototype={pauseCollaboration:function(e,t,i){this.isLocked=e,this.lockedBy=t,this.lockedByZuid=i},isSpreadsheetLocked:function(){return this.isLocked},getLockedBy:function(){return this.lockedBy},getLockedByZuid:function(){return this.lockedByZuid},setRemoveUserProfile:function(e){this.removeUserProfile=e},getRemoveUserProfile:function(){return this.removeUserProfile}},t.CollaborationNotifier=new i}(this),function(e){var t,i,n=e.sPlusPlus,o=e.ZSConstants.FeatureConstants,r=n.view.Toolbar.Feature[o.CHECKIN_CHECKOUT],s=UserAction.CollaborationNotifier,c=e.UIUtil.Component,a=e.ZSEvents,u=e.ZSClass,l=a.topic,d=a.Groups,C=a.Names,h=e.ZSConstants.ActionConstants,f=e.ZSConstants.I18N,S=document.querySelector("#TB_SHARE_BTN"),k=e.ZSConstants.wCC;function U(){return UserAction.CollaborationNotifier.isSpreadsheetLocked()&&n.data.UserInfo.zuid==UserAction.CollaborationNotifier.getLockedByZuid()}function E(e,t){var i=n.view.getActiveGridID(),o=n.view.getResourceID(i),r=n.view.getVersionID(i),c=s.isSpreadsheetLocked()?h.CHECKIN_SPREADSHEET:h.CHECKOUT_SPREADSHEET;UserAction.checkinCheckoutSpreadsheet(o,r,c,e,t)}function I(e,t){t.disabled=!1,t.classList.remove("ZsRt"),c.zpopover(S,"close")}function m(e,t,n){i&&"STD"===i.mode&&i.remove();var o={mode:t,type:n,showCloseBtn:!0};(i=new u.TBNotification(e,o)).show()}-1==ZSConstants.Meta.HideFeaturesList.indexOf(o.CHECKIN_CHECKOUT)&&(l.register(d.Listener,C.DocMeta.LOCKED_INFO,function(e,t,i,o){s.pauseCollaboration(e,t,i),function(e,t,i,o){if("RESOURCE_LOCKED"==e)if(t==n.data.UserInfo.zuid)m(c=f["Checkin.CheckoutBanner"],"STD","success");else if(o)m(c=JSUtil.fn.replaceParams(f["Checkin.CheckoutBannerForSharedUser"],[i]),"STD","warning");else{var r={countDown:15,buttons:[{text:f["Checkin.reloadButton"],primary:!0,click:function(){document.location.reload(!0)}}],title:f["Alert.Title.FileLocked"]},c=JSUtil.fn.replaceParams(f["Checkin.dialog.CheckOut"],[i]);s.setRemoveUserProfile(!0),u.ZSAlert(c,r)}else t==n.data.UserInfo.zuid?m(c=f["Checkin.CheckinBanner"],"DYN","success"):(r={countDown:15,buttons:[{text:f["Checkin.reloadButton"],primary:!0,click:function(){document.location.reload(!0)}}],title:f["Alert.Title.FileUnlocked"]},c=JSUtil.fn.replaceParams(f["Checkin.dialog.CheckIn"],[i]),s.setRemoveUserProfile(!0),u.ZSAlert(c,r))}(e?"RESOURCE_LOCKED":"RESOURCE_UNLOCKED",i,t,o)},"isLocked","lockedBy","lockedByZuid","isInitialFetch"),l.register(d.UI,C.Menu.SHARE_POPUP_OPEN,function(e,i){var o=n.data.getSharePublishMeta(e).isPublished(),r=n.data.getSharePublishMeta(e).isShared();t||(t=i.querySelector("#pop_checkinOutBox")),t.style.display=o||r||U()?"":"none",(o||r||U())&&(i.querySelector("#header").innerText=f["Checkout.LiveSheet"],s.isSpreadsheetLocked()?(i.querySelector("#action").innerText=f["Checkout.On"],i.querySelector("#content").innerText=f["Checkout.TurnOff"]):(i.querySelector("#action").innerText=f["Checkout.Off"],i.querySelector("#content").innerText=f["Checkout.TurnOn"]))},"RID","DOM"),l.register(d.UI,C.Toolbar.INIT_MENU,function(e){if(r.parent==e){var t=n.view.getActiveGridID(),i=n.view.getResourceID(t);if(function(e){return n.data.getSharePublishMeta(e).isShared()}(i)||function(e){return n.data.getSharePublishMeta(e).isPublished()}(i)||U()){c.zmenu("#"+r.parent.id,"setMenuItemsAttribute",["#"+k.MI+o.CHECKIN_CHECKOUT+k.MENU],"hidden",!1);var a=s.isSpreadsheetLocked()?f["MenuItem.FileTab.CheckIn"]:f["MenuItem.FileTab.CheckOut"];c.zmenu("#"+r.parent.id,"setMenuItemsAttribute",["#"+k.MI+o.CHECKIN_CHECKOUT+k.MENU],"label",a)}else c.zmenu("#"+r.parent.id,"setMenuItemsAttribute",["#"+k.MI+o.CHECKIN_CHECKOUT+k.MENU],"hidden",!0)}},"DOM"),r.execute=function(e){e.disabled=!0,e.classList.add("ZsRt");var t=document.createElement("span");t.id="loader",e.appendChild(t),E(I,e)},r.executeAction=E)}(this);
!function(e){var t,n,i,r,o,a=e.sPlusPlus,s=e.ZSConstants,c=e.UIUtil,l=s.wCC,u=s.FeatureConstants,d=s.I18N,E=(s.CommandConstants,e.UserAction),p=e.ZSEvents,I=p.topic,S=p.Groups,v=p.Names,A=c.Component,T=(a.data.UserInfo.Permission,a.view.Toolbar.Feature[u.SHARE]),_=a.view.Toolbar.Feature[u.PUBLISH],g=a.view.Toolbar.Feature[u.CHECKIN_CHECKOUT],m=a.view.Toolbar.Feature[u.NOTIFY_COLLABORATOR],U=a.view.Toolbar.Feature[u.COLLAB_CHAT],y=(document.querySelector("#TB_SHARE_BTN"),document.getElementById("popupmenu")),R=!1;function O(e){return a.data.getSharePublishMeta(e).isShared()}(r=document.createElement("ul")).id=l.SUBMENUITEM+u.SHARE+l.IDENTITY,r.setAttribute("data-ctype","zmenu"),R||(function(e){var t=document.createElement("li");t.setAttribute("id","invite"),t.setAttribute("data",'{"label":"'+d.Invite+'"}'),t.addEventListener("click",function(){T.openDialog()}),e.appendChild(t),m.createMenuElement(e),U.createMenuElement(e)}(r),y.appendChild(r),A.bind(r,"zmenubeforeshow",function(){!function(){var e=a.view.getActiveGridID(),t=a.view.getResourceID(e);document.getElementById(l.MI+u.NOTIFY_COLLABORATOR+l.MENU).style.display=O(t)?"block":"none",document.getElementById(l.MI+s.COLLAB_CHAT+l.MENU).style.display=O(t)?"block":"none";var n=a.data.UserInfo.Permission.isSharable;document.getElementById("invite").style.display=n?"block":"none"}()}),R=!0);var P="TB_SHARE_ICON",C="TB_SHARED_ICON",D="TB_INTPUB_ICON",N="TB_EXTPUB_ICON",h="TB_SHARE_INTPUB_ICON",M="TB_SHARE_EXTPUB_ICON";function f(e){var t=a.view.getActiveGridID(),n=a.view.getResourceID(t),i=a.data.getSharePublishMeta(n);if(i){var r,o=document.querySelector("#PUBLISH_SHARE_ICON"),s=i.getShareMeta(),l=i.getPublishMeta(),u=s.getType(),d=l.getType();(r="personal"===u?"external"==d?M:"org"==d?h:C:"external"===d?N:"org"===d?D:P)&&(o.innerHTML="",c.fn.addIcon(o,r),o.style.display="")}}function b(){var e=a.view.getActiveGridID(),t=a.view.getResourceID(e),n=a.data.PageRegistry.wmsOptions.langCode;A.getDocsCompI18N(n,t)}I.register(S.Listener,v.Browser.RESIZE,function(){A.zpopover(n,"close")}),I.register(S.Listener,v.WMSAction.ON_SHARE,f,"ISSHARED"),I.register(S.Listener,v.ShareMeta.PUBLISH_UPDATE,f,"ISSHARED"),I.register(S.Listener,v.DocAction.Collaborators.UPDATE,function(e){var t=e.RESOURCE_ID,n=a.data.getSharePublishMeta(t);if(n){var i=e.ACTION,r=JSON.parse(e.ACTION_INFO).SHARED_TO,o=n.getShareMeta().getSharedUserInfo().get();switch(i){case"RESOURCE_SHARED":var s=a.view.getActiveGridID(),c=a.view.getVersionID(s);E.getNewlyAddedUserDetails(t,c,r);break;case"RESOURCE_UNSHARED":for(var l in o)if(o[l].id==r){o.splice(l,1);break}I.publish(S.Listener,v.DocAction.COLLAB_LIST.REMOVE,{ID:r})}}},"MSG"),I.register(S.UI,v.Layout.TEMPLATE_LOADED,function(){f(),b()}),I.register(S.UI,v.Toolbar.INIT_MENU,function(e){if("TB_FILE_POPUP_CONTAINER"==e.id){var t=a.view.getActiveGridID();O(a.view.getResourceID(t))?(document.querySelector("#"+l.MI+u.SHARE+l.MENU).style.display="none",document.querySelector("#"+l.MI+u.SHARE+"_SUBMENU"+l.MENU).style.display="flex"):(document.querySelector("#"+l.MI+u.SHARE+l.MENU).style.display="flex",document.querySelector("#"+l.MI+u.SHARE+"_SUBMENU"+l.MENU).style.display="none"),b()}},"DOM"),T.execute=function(){if(!t){var e=document.getElementById("popupmenu"),r=document.createElement("ul");r.id="sharePublishMenu",r.className="sharePub wid",function(e){ZSConstants.Meta.HideFeaturesList;var t=UserAction.getTemplate(["SHARE_POPUP_TEMPLATE"]).SHARE_POPUP_TEMPLATE,r=t.querySelector("#zspopup_shareMsg");a.data.UserInfo.Permission.isSharable||(r.innerText=d["TopBar.Shared"]),function(e){var t=ZSConstants.Meta.HideFeaturesList;o=e.querySelector("#pop_invite");var i=e.querySelector("#pop_notify"),r=e.querySelector("#pop_chat");-1!=t.indexOf(u.SHARE)?o.remove():o.addEventListener("click",function(){var e,t,i,r;e=a.view.getActiveGridID(),t=a.view.getResourceID(e),i=a.view.getVersionID(e),(r=a.data.DocRegistry[t].isNewDoc)?UserAction.changeDocStatus(t,i,r,T.openDialog):T.openDialog(),A.zpopover(n,"close")}),i.addEventListener("click",function(){m.execute(),A.zpopover(n,"close")}),r.addEventListener("click",function(){I.publish(S.UI,v.SidePanel.Chat.open),A.zpopover(n,"close")})}(t),e.appendChild(t),i=e.querySelector("#popup_shareOptions")}(r),_&&_.createElement(r),g&&g.createElement(r),(t=document.createElement("div")).id="sharePublishPopOver",t.appendChild(r),e.appendChild(t),(n=document.querySelector("#TB_SHARE_BTN")).setAttribute("data-content","#sharePublishPopOver"),n.setAttribute("data-is-content-html-encoded",!0),A.zpopover(n,{open:function(){var e=a.view.getActiveGridID(),n=a.view.getResourceID(e);!function(e){if(i){var t=O(e);i.style.display=t?"":"none",o.style.display=a.data.UserInfo.Permission.isSharable?"":"none"}}(n),I.publish(S.UI,v.Menu.SHARE_POPUP_OPEN,{RID:n,DOM:t})}})}b()}}(this);
!function(e){var t,a,n,i=e.sPlusPlus,s=e.ZSEvents,r=s.topic,o=s.Groups,d=s.Names,c=e.ZSConstants.I18N,l=e.JSUtil,S=e.ZSConstants.FeatureConstants,u=i.view.Toolbar.Feature[S.SAVE_MESSAGE];document.querySelector("#TB_SAVE_MSG");function p(){e.clearTimeout(n),n=void 0,u.updateDisplay(!0),a.style.display="none"}!function(){var e=document.querySelector(".fB");(a=document.createElement("div")).setAttribute("class","gridActionLoader"),a.setAttribute("style","display:none");var t=document.createElement("span");a.innerText=c["loader.working"],a.appendChild(t),e.appendChild(a)}(),r.register(o.Listener,d.ServerAction.REQ_QSTATUS,function(e){t=e,i.SML.Client.Interface.isReqPending=e},"IsReqPending"),r.register(o.Listener,d.DocAction.SAVE_MSG.UPDATE,function(t,i){var s="";if("disable"==t)if(i){var r=l.Date.fmtTime(i);s=l.Date.isCurDay(i)?l.fn.replaceParams(c["Topband.Load.Message.LastmodifiedAt"],[r.time]):l.fn.replaceParams(c["Topband.Load.Message.LastmodifiedOn"],[r.time])}else r=l.Date.fmtTime(),s=c["Topband.Save.Message.SavedAt"].replace(/{[0-9]}/,r.time),p();else"enable"==t&&(s=c["Topband.Save.Message.Saving"]+"...",!n&&(n=e.setTimeout(function(){a.style.display="block",u.updateDisplay(!1)},2e3)));u.changeMessage(s)},"STATE","LASTMODIFIED"),r.register(o.Listener,d.ServerAction.GET_STATUS_RESPONSE,function(e,a){!t&&e>=a&&n&&p()},"SERVER_XAID","CLIENT_XAID")}(this);
!function(e){var t,o=e.sPlusPlus,r=e.ZSEvents,n=(e.ZSClass,r.topic),i=r.Groups,s=r.Names,a=e.UserAction,c=o.data.AppRegistry,u=e.document,l=e.UIUtil.Component,p=o.data.AppRegistry.IMAGEPath,d=e.ZSConstants.FeatureConstants,m=o.view.Toolbar.Feature[d.USER_PROFILE],h=o.view.Toolbar.Feature.SWITCH_TO_OLD,y=o.view.Toolbar.Feature.FEEDBACK,S=m.topbarPhoto,f=m.topbarProfile,v=ZSConstants.Meta.HideFeaturesList;function g(){l.zpopover(f,"close")}n.register(i.UI,s.Layout.TEMPLATE_LOADED,function(){var e=u.getElementById("popupmenu");if(e){var r=a.getTemplate(["USER_PROFILE"]).USER_PROFILE,n=r.querySelector("#usrProfMnu");if(h){var i=h.createMenuElement();n.insertBefore(i,n.childNodes[0])}var s=u.createElement("div");s.id="tbUserProfile",s.appendChild(r),e.appendChild(s),f.setAttribute("data-content","#tbUserProfile"),f.setAttribute("data-is-content-html-encoded",!0),f.setAttribute("data-width",260),f.setAttribute("data-class-name","shShareMenu");var m=o.data.UserInfo.isLoggedIn;f.style.display=m?"":"none",function(e){e.querySelector("#feedback").addEventListener("click",function(){y.showFeedBackDialog(),l.zpopover(f,"close")});var t=h&&e.querySelector("#switchOld");h&&t.addEventListener("click",function(){h.showQuickFeedBack(),l.zpopover(f,"close")}),function(e){var t,r,n,i=(t=o.data.PageRegistry.wmsOptions,r={},n=o.data.UserInfo.zuid,-1!=parseInt(n)&&(r={Name:o.data.UserInfo.loginName,Email:o.data.UserInfo.loginEmailId,PhotoUrl:t.photoServerURL+"/file?fs=thumb&ID="+n,MyAccountUrl:t.photoServerURL,MyAppsUrl:"home.zoho.com",Zuid:n,signOutURL:function(){}}),r);S.src=i.PhotoUrl,e.querySelector("#popup_profilePic").src=i.PhotoUrl;var s=e.querySelector("#profileName"),a=e.querySelector("#mailId"),l=e.querySelector("#userid");s.innerText=i.Name,a.innerText=i.Email,l.innerText=i.Zuid,e.querySelector("#myAccounts").href=c.ZOHO_ACCOUNTS_URL,e.querySelector("#signOutBtn").addEventListener("click",function(){u.location.href=c.ctxpath+"logout.do"})}(e)}(s),q=s,-1!=v.indexOf(d.USER_PROFILE)?(q.querySelector("#whatsNew").remove(),q.querySelector("#pageTour").remove(),q.querySelector("#help").remove(),q.querySelector("#upTipsTricks").remove(),q.querySelector("#about").remove(),q.querySelector("#forums").remove(),q.querySelector("#blogs").remove(),q.querySelector("#dwnladApps").remove(),h&&q.querySelector("#switchOld").classList.remove("slLineSep"),q.querySelector("#feedback").classList.remove("slLineSep")):function(e){e.querySelector("#whatsNew").addEventListener("click",function(){a.showWalkthrough(!0),g()});var r=e.querySelector("#pageTour");r.style.display=o.data.AppRegistry.allowTourRipple?"":"none",r.addEventListener("click",function(){a.showTour(!0),g()}),e.querySelector("#sheetBlogsTag").href=c.BlogsURL;var n=e.querySelector("#iphoneBadge"),i=e.querySelector("#androidBadge");n.href=c.APPSTORE_URL,i.href=c.PLAYSTORE_URL,function(e){var o,r,n,i,s,a;e.querySelector("#upBack").addEventListener("click",function(){t.removeClass("upFlip")}),e.querySelector("#upTipsTricks").addEventListener("click",function(){t.addClass("upFlip"),setTimeout(function(){u.querySelector(".tipsTricksHd");for(var e=0;e<3;e++)o=u.querySelector("#tip"+[e]),(r=o.querySelector(".tipHd")).innerText.length>47&&(r.innerText=r.innerText.substring(0,43)+"..."),(n=o.querySelector(".tipCont")).innerText.length>145&&(n.innerText=n.innerText.substring(0,145)+"...")},100)}),(i=u.querySelector("#tip0")).querySelector(".tipImg").src=p+"announcement/tips1.jpg",i.addEventListener("mousedown",function(e){0==e.button&&window.open("https://help.zoho.com/portal/community/topic/what-are-aggregated-charts-how-do-they-improve-visualizations-28-8-2019")}),(s=u.querySelector("#tip1")).querySelector(".tipImg").src=p+"announcement/tips2.png",s.addEventListener("mousedown",function(e){0==e.button&&window.open("https://help.zoho.com/portal/community/topic/tip-5-how-naming-ranges-constants-and-formulas-can-simplify-things-for-you")}),(a=u.querySelector("#tip2")).querySelector(".tipImg").src=p+"announcement/tips3.jpg",a.addEventListener("mousedown",function(e){0==e.button&&window.open("https://help.zoho.com/portal/community/topic/tip-4-five-important-statistical-functions-and-when-to-use-them-4-4-2019")})}(e)}(q),o.data.UserInfo.Permission.isEditable||q.querySelector("#pageTour")&&q.querySelector("#pageTour").remove(),l.zpopover(f,{close:function(e,o){t.removeClass("upFlip")},open:function(e,o){t=this}})}var q}),n.register(i.Listener,s.Browser.RESIZE,g)}(this);
!function(e){var t,r,a,s=e.sPlusPlus,o=e.ZSConstants.FeatureConstants,P=e.ZSEvents,n=P.topic,i=P.Groups,A=P.Names,u=e.UserAction,L=s.data.AppRegistry,S=s.view.Toolbar.Feature[o.DOWNLOAD_APPS];n.register(i.UI,A.Layout.TEMPLATE_LOADED,function(){t=S.dom,r=u.getTemplate(["PUBLISHED_VIEW_DOWNLOADAPPS"]);var e=(a=r.PUBLISHED_VIEW_DOWNLOADAPPS).querySelector("#iphoneBadge"),s=a.querySelector("#androidBadge");e.href=L.APPSTORE_URL,s.href=L.PLAYSTORE_URL,t&&t.appendChild(a)})}(this);
!function(e){var t,c,a,d=e.sPlusPlus,i=e.ZSClass,n=e.UserAction,s=e.document,o=e.UIUtil.Component,r=e.ZSConstants.I18N,l=d.view.Toolbar.Feature.SWITCH_TO_OLD,v=new function(){i.KeyMapping.call(this)},u=d.view.Events.Key;u.Entry.Dialog.Node.addChildNode(v);var k=0;function p(){c.classList.remove("rPtM");var e=t.querySelector("#zsFeedbackMsg");e.value="",t.style.display="none",o.zcombo("#feedbackOptions","setValue","Need help"),e.placeholder=r["Feedback.TextArea.Needhelp"];for(var d=0;d<a.length;d++)a[d].classList.remove("checked");u.focusContext(u.Entry.CellEditor.Context)}function b(e,t){if(k=parseInt(this.id),t[e].classList.contains("checked"))for(var c=e+1;c<5;c++)void 0!=t[c]&&t[c].classList.remove("checked");else for(c=e;c>=0;c--)void 0!=t[c]&&t[c].classList.add("checked")}function h(){var e=d.view.getActiveGridID(),t=d.view.getResourceID(e),c=d.view.getVersionID(e);n.doRedirect(t,c),p()}function f(){var e=d.view.getActiveGridID(),c=d.view.getResourceID(e),a=d.view.getVersionID(e),i=t.querySelector("#zsFeedbackMsg").value,s=t.querySelector("#feedbackOptions").value,o=k;""!=i||"Need help"!=s||0!=o?n.SendFeedback(c,a,i,"switchBackFeedback",s,o,void 0,void 0,h):h(),p()}l.showQuickFeedBack=function(e){if(u.focusContext(u.Entry.Dialog.Context),t)u.focusContext(u.Entry.Dialog.Context),k=0,c.classList.add("rPtM"),t.style.display="";else{var d=n.getTemplate(["FEEDBACK_BACK_TO_OLD_VERSION"]).FEEDBACK_BACK_TO_OLD_VERSION;(t=s.createElement("div")).id="feedbackCntr",t.className="sHBcToOld",t.appendChild(d),(c=s.createElement("div")).id="scrnOverlay",c.className="rPtM",s.body.appendChild(c),s.body.appendChild(t),t.querySelector("#feedbackOptions").selectedIndex="1";var i=t.querySelector("#zsFeedbackMsg");i.placeholder=r["Feedback.TextArea.Needhelp"];var l=[r["Feedback.TextArea.Love"],r["Feedback.TextArea.Needhelp"],r["Feedback.TextArea.FoundBug"]];o.bind("#feedbackOptions","zselectboxchange",function(e,t){i.placeholder=l[t.selectedIndex]}),o.initComponent("#feedbackCntr"),function(){t.querySelector("#zsFeedbackSkipBtn").addEventListener("click",h),t.querySelector("#zsFeedbackSubmitBtn").addEventListener("click",f),t.querySelector("#zsFeedbackTopClsBtn").addEventListener("click",p),a=t.querySelectorAll(".shRateStar");for(var e=0;e<a.length;e++){var c=a[e];c.addEventListener("click",b.bind(c,e,a))}}()}}}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSConstants.FeatureConstants,i=(e.document,e.ZSConstants.I18N,e.ZSConstants.wCC),n=e.ZSEvents,r=n.topic,o=n.Groups,E=n.Names,u=e.UIUtil.Component,I=t.view.Toolbar.Feature[s.USER_PRESENCE];I.execute=function(e){var s=t.view.getActiveGridID(),i=t.view.getResourceID(s),n=t.view.getSheetID(s),u=t.view.getVersionID(s),I=t.data.getWorkBook(i,u);e?(I.showUserPresence=!0,r.publish(o.Listener,E.DocAction.COLLAB_LIST.SHOW,{RID:i,SHEETID:n,VERSION:u})):(I.showUserPresence=!1,r.publish(o.Listener,E.DocAction.COLLAB_LIST.HIDE,{RID:i,SHEETID:n,VERSION:u}))},r.register(o.UI,E.Toolbar.INIT_MENU,function(e){var n=t.view.getActiveGridID(),r=t.view.getResourceID(n),o=t.view.getVersionID(n),E=t.data.getWorkBook(r,o);I.parent==e&&(function(e){return t.data.getSharePublishMeta(e).isShared()}(r)?u.zmenu("#"+e.id,"setMenuItemsAttribute",["#"+i.MI+s.USER_PRESENCE+i.MENU],"hidden",!1):u.zmenu("#"+e.id,"setMenuItemsAttribute",["#"+i.MI+s.USER_PRESENCE+i.MENU],"hidden",!0)),u.zmenu("#"+e.id,"setMenuItemsAttribute",["#"+i.MI+s.USER_PRESENCE+i.MENU],"checked",E.showUserPresence)},"DOM")}(this);
!function(e){var t,n=e.sPlusPlus,i=e.ZSConstants,a=e.ZSEvents,o=e.document,r=(e.UserAction,e.UIUtil.Component),l=a.topic,s=a.Groups,u=a.Names,c=i.FeatureConstants,E=i.wCC,I=i.I18N,d=o.getElementById("popupmenu"),p=n.view.Toolbar.Feature[c.EMBED];function b(){if(!t){var e=o.getElementById(E.MI+c.EMBED+E.IDENTITY);t=e.parentElement}return t}l.register(s.UI,u.Toolbar.INIT_TOOLBAR,function(e){var t=b();if(e==t.id){var i=n.data.UserInfo.orgName,a=t.id,l=t.querySelector("#"+E.MI+c.EMBED+E.IDENTITY),s=t.querySelector("#"+E.MI+c.EMBED+"_POP_"+E.IDENTITY);if(i){r.zbutton("#"+a,"show",s),r.zbutton("#"+a,"hide",l);var u=o.createElement("ul");u.id=E.SUBMENUITEM+c.EMBED+E.IDENTITY,u.setAttribute("ctype","zmenu"),function(e,t){var n=o.createElement("li");n.setAttribute("data",'{"icon": "zsicon zsicon-intranet-site", "label":"'+I["Share.Public.PublishRangeInIntranetBlog"]+'"}'),n.addEventListener("click",function(){p.openDialog("org")}),e.appendChild(n);var i=o.createElement("li");i.setAttribute("data",'{"icon": "zsicon zsicon-external-site", "label":"'+I["Share.Public.PublishRangeInExternalBlog"]+'"}'),i.addEventListener("click",function(){p.openDialog("external")}),e.appendChild(i)}(u),d.appendChild(u)}else r.zbutton("#"+a,"hide",s),r.zbutton("#"+a,"show",l)}},"DOM")}(this);
!function(e){var n,t=e.sPlusPlus,a=e.document,u=e.ZSConstants,l=u.FeatureConstants,s=(u.I18N,u.wCC),i=t.view.Toolbar.Feature[l.PUBLISH_RANGE],E=t.view.Toolbar.Feature[l.MANAGE_PUBLISH_RANGE],d=a.getElementById("popupmenu");(n=a.createElement("ul")).id=s.SUBMENUITEM+l.PUBLISH_RANGE+s.IDENTITY,n.appendChild(i.createRangePublishMenuElement()),n.appendChild(E.createManagePublishedRangeMenuElement()),d.appendChild(n)}(this);
!function(e){var t,i,o=e.sPlusPlus,s=e.ZSConstants.FeatureConstants,l=e.UIUtil.Component,n=e.ZSConstants.wCC,a=e.ZSEvents,u=a.topic,r=a.Groups,c=a.Names,d=o.view.Toolbar.Feature[s.PUBLISH],p=o.view.Toolbar.Feature[s.PUBLISH+"_ViewPublish"],P=o.view.Toolbar.Feature[s.PUBLISH+"_RemovePublish"],S=document.querySelector("#TB_SHARE_BTN"),I=(e.ZSConstants.CommandConstants,e.ZSConstants.I18N),U=document.getElementById("popupmenu"),b=!1;t={id:n.SUBMENUITEM+s.PUBLISH+n.IDENTITY,"data-ctype":"zmenu"},i=[{id:"viewPublish",data:'{"label":"'+I["Share.Public.ViewPublishedURL"]+'"}'},{id:"removePublish",data:'{"label":"'+I["Share.Public.RemovePublic"]+'"}'}],b||(o.view.Menu.create(i,t,U).then(function(){l.bind("#"+n.SUBMENUITEM+s.PUBLISH+n.IDENTITY,"zmenuitemclick",function(e,t){!function(e){var t=e.id;"removePublish"==t?P.openDialog():"viewPublish"==t&&p.openDialog()}(t.data)})}),b=!0),u.register(r.UI,c.Menu.SHARE_POPUP_OPEN,function(e,t){var i=o.data.getSharePublishMeta(e).isPublished(),s=t.querySelector("#pop_publish"),l=t.querySelector("#popup_publishOptions");s&&l&&(i?(l.style.display="",s.style.display="none"):(s.style.display="",l.style.display="none"))},"RID","DOM"),u.register(r.UI,c.Toolbar.INIT_MENU,function(e){var t,i=document.querySelector("#"+n.MI+s.PUBLISH+n.MENU);if(i&&"TB_FILE_POPUP_CONTAINER"==e.id){t=i,-1!=ZSConstants.Meta.DisableFeaturesList.indexOf(s.PUBLISH)?t.classList.add("disabled"):t.classList.remove("disabled");var l=o.view.getActiveGridID();!function(e){return o.data.getSharePublishMeta(e).isPublished()}(o.view.getResourceID(l))?(i.style.display="flex",document.querySelector("#"+n.MI+s.PUBLISH+"_SUBMENU"+n.MENU).style.display="none"):(i.style.display="none",document.querySelector("#"+n.MI+s.PUBLISH+"_SUBMENU"+n.MENU).style.display="flex")}},"DOM"),d.execute=function(){d.openDialog("external"),l.zpopover(S,"close")},d.viewPublishUrl=function(){p.openDialog(),l.zpopover(S,"close")},d.removePublic=function(){P.openDialog(),l.zpopover(S,"close")}}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSConstants.FeatureConstants,r=ZSConstants.I18N,n=e.ZSEvents,i=n.topic,a=n.Groups,o=n.Names,l=t.view.Toolbar.Feature[s.SAVEAS];i.register(a.Listener,o.UserAction.SheetCopyResponse,function(e,s,n){l.closeDialog();var i=UserAction.getTemplate(["STATUS_ALERT"]).STATUS_ALERT;i.querySelector("#msg").innerText=r["SaveAsNewSpreadsheet.SuccessMsg"];var a=i.querySelector("#fileLink");a.href=t.data.AppRegistry.ctxpath+t.data.AppRegistry.ClientURI+s,a.innerText=e,a.title=e;var o=[{text:r["MenuItem.FileTab.Open"],primary:!0,click:function(){window.open(a.href,"_blank")}},{text:r.Close}];ZSClass.ZSAlert(i,{type:"success",title:r["Alert.Title.SpreadsheetSaved"],isHtml:!0,buttons:o})},"COPIEDSPREADSHEETNAME","RID")}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSConstants.FeatureConstants,a=ZSConstants.I18N,r=e.ZSEvents,i=r.topic,n=r.Groups,l=r.Names,o=t.view.Toolbar.Feature[s.SAVE_AS_TEMPLATE];i.register(n.Listener,l.UserAction.SaveAsTemplateResponse,function(e,s,r){o.closeDialog();var i=UserAction.getTemplate(["STATUS_ALERT"]).STATUS_ALERT;i.querySelector("#msg").innerText=a["SaveAsTemplate.SuccessMsg"];var n=i.querySelector("#fileLink");n.href=t.data.AppRegistry.ctxpath+t.data.AppRegistry.ClientURI+s,n.innerText=e,n.title=e,ZSClass.ZSAlert(i,{type:"success",title:a["Alert.Title.TemplateSaved"],isHtml:!0,buttons:[{text:a.Close}]})},"NEWDOCNAME","NEWDOCRID")}(this);
!function(e){var t=e.sPlusPlus,r=e.ZSConstants.FeatureConstants,s=ZSConstants.I18N,n=e.ZSEvents,i=n.topic,o=n.Groups,l=n.Names,a=t.data.AppRegistry.FORM_SERVER_URL,c="&type=builder",u=t.view.Toolbar.Feature[r.CREATE_FORM];i.register(o.Listener,l.UserAction.CREATE_FORM_RESPONSE,function(e,t){u.closeDialog();var r=UserAction.getTemplate(["STATUS_ALERT"]).STATUS_ALERT;r.querySelector("#msg").innerText=s["CreateForm.SuccessMsg"];var n=r.querySelector("#fileLink");n.href=a+"/ropen.do?rid="+e+c,n.target="_blank",n.innerText=t,n.onclick=function(){i.publish(o.Listener,l.DocAction.AlertMsg.TRIGGER_CLOSE)};var R=[{text:s["MenuItem.FileTab.Open"],primary:!0,click:function(){window.open(n.href,"_blank")}},{text:s.Close}];ZSClass.ZSAlert(r,{type:"success",title:s["Alert.Title.FormCreated"],isHtml:!0,buttons:R})},"FORM_RID","FORM_NAME")}(this);
!function(e){var t,n,a,u=e.sPlusPlus,o=e.ZSConstants.FeatureConstants,r=e.ZSConstants.wCC,l=e.UIUtil.Component,i=u.view.Toolbar.Feature[o.EDIT_FORM],m=u.view.Toolbar.Feature[o.DELETE_FORM],s=u.view.Toolbar.Feature[o.LIVE_FORM],E=u.view.Toolbar.Feature[o.PUBLISH_FORM];n=document.getElementById("popupmenu"),(a=document.createElement("ul")).id=r.SUBMENUITEM+o.MANAGE_FORM+r.IDENTITY,a.setAttribute("data-ctype","zmenu"),i.createMenuElement(a),s.createMenuElement(a),E.createMenuElement(a),a.appendChild(((t=document.createElement("li")).setAttribute("data-item-type","separator"),t)),m.createMenuElement(a),n.appendChild(a),l.bind(a,"zmenubeforeshow",function(e,t){E.updateMenuItemState()})}(this);
!function(e){var t,o=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,s=ZSConstants.CommandConstants,i=o.data.AppRegistry.FORM_SERVER_URL,a="&type=builder";o.view.Toolbar.Feature[n.EDIT_FORM].execute=function(){var n=o.view.getActiveGridID(),r=o.view.getResourceID(n),u=o.view.getSheetID(n),R=o.view.getVersionID(n),d=o.data.getWorkBook(r,R).FormSheets[u][s.FORM_RID];t=i+"/ropen.do?rid="+d+a,e.window.open(t,"_blank")}}(this);
!function(e){var t,o=e.ZSClass,i=e.ZSConstants.I18N,n=e.sPlusPlus,a=e.ZSEvents,r=a.topic,s=a.Groups,c=a.Names,d=e.ZSDevTools.Logger;function l(){this.actionLogDom=function(){if(!t){var e=UserAction.getTemplate(["AUDIT_TRAIL_ACTION_LOG"]);t=e.AUDIT_TRAIL_ACTION_LOG}return t.cloneNode(!0)}(),this.colorCodeDom=this.actionLogDom.querySelector("#colorCodeAndName"),this.Name=this.actionLogDom.querySelector("#colorCodeAndName"),this.Time=this.actionLogDom.querySelector("#time"),this.MessageContainer=this.actionLogDom.querySelector("#msgContainer")}l.prototype={setColorCode:function(e){this.colorCodeDom.style.color="#"+e},setName:function(e){this.Name.dataset.actname=this.Name.title=e},setTime:function(e){this.Time.dataset.acttime=e+" ("+n.view.actionListManager.timeZone+")"},setMessage:function(e){this.MessageContainer.appendChild(e)},append:function(e){e.appendChild(this.actionLogDom)},setAsRollBackAction:function(){this.Time.classList.add("aDrollBack")},createLink:function(e,t){var o=document.createElement("a");o.classList.add("aDlnk");var a=[e,t],d=t?i["AT.GotoCell"]:i["AT.GotoCellCurrentVersion"],l=0;return d=d.replace(/{\d}/gi,function(e){return a[l++]}),o.title=d,o.text=e,o.addEventListener("click",function(o){var i=n.view.getActiveGridID(),a=n.view.getResourceID(i),d=n.view.getVersionID(i);d===n.data.Defaults.version&&(d=""),d!=t?r.publish(s.UI,c.SidePanel.VersionHistory.OPEN,{RID:a,VERSION:t,RANGE:e}):UserAction.Goto(e)}),o},processMessage:function(e){var t,o,a,r,s=e.undid,c=e.redid;s||c?(t=s?i["AT.Undid"]+"-"+i[s.msg]:i["AT.Redid"]+"-"+i[c.msg],o=s?s.lp:c.lp,a=s?s.nlp:c.nlp):(t=i[e.msg],o=e.lp,a=e.nlp,r=e.sdp),e.d_msg&&(t+=e.d_msg);var l=document.createDocumentFragment();if(!t)return d.log("No Message availble for the key :: ",e),l;var p=(t=t.replace(/({\d})|#L\{\d\}#CL/gi,function(e,t){return(t=t&&t.replace(/[{}]/gi,""))?decodeURIComponent(a[t]):e})).split(/#L{\d\}#CL/g);t=p[0],l.appendChild(document.createTextNode(t));for(var m=1;m<p.length;m++){this.anchor=this.createLink(o[m-1],e.ver);var u=o[m-1];if(u){u=u.split(/;/g);for(var h=0;h<u.length;h++)this.anchor=this.createLink(u[h],e.ver),h>0&&l.appendChild(document.createTextNode(", ")),l.appendChild(this.anchor)}l.appendChild(document.createTextNode(p[m]))}if(r){var g=window.location.origin+n.data.AppRegistry.ctxpath+n.data.AppRegistry.ClientURI+r.srid,C=document.createElement("a");C.href=g,C.target="_blank",C.appendChild(document.createTextNode(r.sdn)),l.appendChild(C)}return l}},o.UIActionLog=l}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSConstants.FeatureConstants,i=e.ZSEvents,o=i.topic,I=i.Groups,r=i.Names,n=t.view.Toolbar.Feature[s.BACK_TO_EDITOR_VERSION],E=sPlusPlus.data.Defaults.version;function O(){o.publish(I.UI,r.Toolbar.VERSION_HISTORY.HIDE),o.publish(I.UI,r.SidePanel.VersionHistory.CLOSE),o.publish(I.UI,r.SidePanel.VersionHistory.HIDE_ICON);var e=t.view.getActiveGridID(),s=t.view.getResourceID(e),i=t.view.getSheetID(e),n=t.view.getVersionID(e);t.view.getVersionState(e).setIsCloseButton(!0),o.publish(I.Listener,r.DocAction.WORKSHEETS.REMOVE_NO_OF_EDITS,{RID:s,VERSION:n}),t.data.getWorkBook(s,E).setIsEditable(!0),E==n&&o.publish(I.Listener,r.SheetAction.VERSION_HISTORY.BACK_TO_EDITOR,{RID:s,SHEETID:i,VERSION:E}),UserAction.LoadVersion(s,i,E,!0)}n.execute=O,o.register(I.UI,r.Toolbar.VERSION_HISTORY.BACK_TO_EDITOR.CLICK,O)}(this);
!function(e){var o,t=e.ZSClass;function r(){this.userInfoDom=function(){if(!o){var e=UserAction.getTemplate(["SP_VERSION_USERINFO"]),t=e.SP_VERSION_USERINFO;o=t.querySelector("#userInfo")}return o.cloneNode(!0)}(),this.userName=this.userInfoDom.querySelector("#colorCodeAndName"),this.colorCode=this.userInfoDom.querySelector("#colorCodeAndName")}r.prototype={setColorCode:function(e){this.colorCode.style.color=e},setName:function(e){this.userName.title=this.userName.dataset.actname=e},append:function(e){e.appendChild(this.userInfoDom)}},t.UIVersionUserInfo=r}(this);
!function(e){var o,t=e.ZSClass,i=t.UIVersionUserInfo,n=e.ZSEvents,r=(n.topic,n.Groups,n.Names,e.sPlusPlus);function s(){this.versionLogDom=function(){if(!o){var e=UserAction.getTemplate(["VERSION_LOG"]);o=e.VERSION_LOG}return o.cloneNode(!0)}(),this.dom=this.versionLogDom.querySelector("div"),this.versionInfoDom=this.dom.querySelector("#versionInfoHolder"),this.timeStamp=this.versionLogDom.querySelector("#timeStamp"),this.versionNumberDom=this.versionLogDom.querySelector("#versionNumber"),this.description=this.versionLogDom.querySelector("#description"),this.versionName="",this.revertVersion=this.versionLogDom.querySelector("#revertVersion"),this.userInfoHolder=this.versionLogDom.querySelector("#userInfoHolder"),this.userList=[],this.versionNumber,this.userInfoContainer=this.versionLogDom.querySelector("#userInfoContainer"),this.changeLog=this.versionLogDom.querySelector("#changeLog")}function h(e,o){for(var t in o)e.addEventListener(t,o[t].bind(this))}s.prototype={setTime:function(e){this.timeStamp.textContent=e+" ("+r.view.actionListManager.timeZone+")"},setVersionNumber:function(e){this.versionNumberDom.textContent="#"+parseFloat(e),this.versionNumber=e},setUserNameAndColor:function(e){this.userInfoContainer.innerHTML="";for(var o=e?e.length:0,t=0;t<o;t++){var n=new i;n.setName(e[t].name),n.setColorCode(e[t].colorCode),n.append(this.userInfoContainer)}},getVersionName:function(){return this.versionName},setDescription:function(e){this.versionName=e,this.description.textContent="Description : "+this.versionName,this.userInfoHolder.prepend(this.description)},append:function(e){e.appendChild(this.dom)},getDom:function(){return this.dom},getVersionNumber:function(){return this.versionNumber},addEventListener:function(e){e.changeLog&&h.call(this,this.changeLog,e.changeLog),e.dom&&h.call(this,this.dom,e.dom)},addRevertVersion:function(e,o){this.revertVersion.title=o+" #"+e,this.versionInfoDom.insertBefore(this.revertVersion,this.versionNumberDom)},remove:function(){this.dom.remove()}},t.UIVersionLog=s}(this);
!function(e){var n,t=e.ZSClass;e.sPlusPlus;function o(){this.currentVersionLogDom=function(){if(!n){var e=UserAction.getTemplate(["CURRENT_VERSION_LOG"]);n=e.CURRENT_VERSION_LOG}return n.cloneNode(!0)}(),this.dom=this.currentVersionLogDom.querySelector("div"),this.changeLog=this.currentVersionLogDom.querySelector("#changeLog"),this.versionNumber}function i(e,n){for(var t in n)e.addEventListener(t,n[t].bind(this))}o.prototype={setVersionNumber:function(e){this.versionNumber=e},getVersionNumber:function(){return this.versionNumber},addEventListener:function(e){e.dom&&i.call(this,this.dom,e.dom),e.changeLog&&i.call(this,this.changeLog,e.changeLog)},append:function(e){e.appendChild(this.dom)}},t.UICurrentVersionLog=o}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSEvents,s=i.topic,n=i.Groups,o=i.Names,r=e.ZSConstants.I18N,a=e.ZSConstants.wCC,c=e.ZSConstants.FeatureConstants,l=ZSClass.UIActionLog,g={dom:{click:function(e){var i=e.data,r=this.versionNumber,a=t.view.getActiveGridID(),c=t.view.getSheetID(a),l=t.view.getVersionState(a),g=l.getActiveVersionLog();if(g){var v=g.getVersionNumber();if(v===r)return;g.dom.classList.remove("active")}var S=t.view.getResourceID(a);this.dom.appendChild(I),this.dom.appendChild(D),UserAction.LoadVersion(S,c,r,!1,function(){var e=i?i.range:void 0;!function(e,i){var r=t.view.actionListManager.getByVersion(e),a=t.view.getActiveGridID(),c=t.view.getResourceID(a),l=t.view.getSheetID(a),g=t.view.getVersionID(a),v=t.view.getVersionState(a);if(s.publish(n.UI,o.SidePanel.VersionHistory.UNHIGHLIGHT_CHANGES),s.publish(n.Listener,o.DocAction.WORKSHEETS.REMOVE_NO_OF_EDITS),v.setVersionNumber(e),v.setGoToRange(i),v.setIsCloseButton(!1),r)v.setVersionActionList(r),A(c,g,l);else{var c=t.view.getResourceID(a),g=t.view.getVersionID(a);UserAction.getActionListBasedOnVersion(c,g,e,function(t){v.setVersionActionList(t),A(c,e,l)},!0)}s.publish(n.Listener,o.UserAction.VERSION_HISTORY.UPDATE_BUTTON_STATE,{versionNumber:e}),s.publish(n.UI,o.SidePanel.VersionHistory.UPDATE_TITLE,{VERSION_NUMBER:e})}(r,e),D.remove(),I.remove()}),this.dom.classList.add("active"),l.getIsDialogOpen()&&this.changeLog.click(),l.setActiveVersionLog(this),function(){if(!h){var e=new ZSClass.VersionHistoryToolbar;h=new ZSClass.UIView("VERSION",e),s.publish(n.UI,o.Toolbar.VERSION_HISTORY.SHOW)}h.show()}()}}},v={changeLog:{click:function(e){var i=t.view.actionListManager.getByVersion(this.versionNumber),s=t.view.getActiveGridID(),n=this.versionNumber?r["AT.ChangeLog"]+" - "+r.version+" #"+this.versionNumber:r["AT.ChangeLog"];if(i)E(n,i);else{var o=t.view.getResourceID(s),a=t.view.getVersionID(s);UserAction.getActionListBasedOnVersion(o,a,this.versionNumber,function(e){E(n,e)},!0)}e.stopPropagation()}}},I=document.createElement("span");I.className="ZsMask";var S,u,d,D=e.document.createElement("span");function A(e,i,r){var a=t.view.getActiveGridID(),c=(t.data.getWorkBook(e,i),t.view.getVersionState(a));setTimeout(function(){s.publish(n.UI,o.SidePanel.VersionHistory.HIGHLIGHT_CHANGES)},0);var l=c.getVersionActionList();s.publish(n.Listener,o.DocAction.WORKSHEETS.ADD_NO_OF_EDITS,{RID:e,VERSION:i,DATA:l});var g=c.getGoToRange();g&&function(e,i,r,a){var c,l,g=JSUtil.Range.parseRange(e,r,a);if(g)c=g.sheetID,l=g.range;else{var v=t.data.getWorkBook(e,r),I=v.SheetList;if(!I.isNameExists(a))return;c=I.getIdByName(a),l=new ZSClass.Range(0,0,0,0)}i!=c?UserAction.SwitchSheet(e,i,r,c,l):function(e,t,i,r,a,c){s.publish(n.Selector.BoundUpdate.Range,o.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,RANGE:r});var l=new ZSClass.Range(a,c,a,c);s.publish(n.Selector.BoundUpdate.Cell,o.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,ActiveCellRange:l,ROW:a,COL:c}),UserAction.ScrollCellIntoView(e,t,i,a,c)}(e,i,r,l,l.startRow,l.startCol)}(e,r,i,g)}function E(i,s){var n=t.view.getActiveGridID(),o=t.view.getVersionState(n);S=o.getChangeLogDialog();var r,l={width:500,title:i,close:function(){o.setIsDialogOpen(!1)},open:function(){o.setIsDialogOpen(!0),function(e){var t=Object.keys(e),i=t.length;i?(d.innerHTML="",u.style.position="relative"):(u.style.position="static",d.innerHTML="",d.appendChild(V));for(var s=i-1;s>=0;s--)N(e[t[s]],d)}(s)}};r=e.UserAction.getTemplate(["VERSION_HISTORY_AUDIT"]).VERSION_HISTORY_AUDIT,d=r.querySelector("#actionLogContainer"),(u=document.createElement("div")).id=a.DI+c.VIEW_VERSION+a.IDENTITY,u.appendChild(r),S&&S.close(),(S=new e.ZSClass.Dialog(u,l)).open(),o.setChangeLogDialog(S)}D.className="ZsLoader ZsLoaderSmall";var h,V=document.createElement("span");function N(e,t){var i=new l;return i.setColorCode(e.cc),i.setName(e.un),i.setTime(e.ts),e.irb&&i.setAsRollBackAction(),i.setMessage(i.processMessage(e)),i.append(t),i}V.textContent=r["AT.NoEdits.Version"],V.className="ZsNoMsg",s.register(n.UI,o.Toolbar.VERSION_HISTORY.HIDE,function(){h&&h.hide()}),s.register(n.UI,o.SidePanel.VersionHistory.CLOSE,function(){var e=t.view.getActiveGridID(),i=t.view.getVersionState(e);s.publish(n.UI,o.SidePanel.VersionHistory.UNHIGHLIGHT_CHANGES),(S=i.getChangeLogDialog())&&S.close()}),e.ZSClass.VersionLogBinds=g,e.ZSClass.ChangeLogBinds=v}(this);
!function(e){var t,i,s,n=e.sPlusPlus,o=e.ZSEvents,r=o.topic,a=o.Groups,c=o.Names,g=ZSClass.UIActionLog,v=e.ZSConstants.I18N,l=e.ZSConstants.wCC,u=e.ZSConstants.FeatureConstants,I={dom:{click:function(e){var t=e.data,i=this.versionNumber,s=n.view.getActiveGridID(),o=n.view.getSheetID(s),g=n.view.getVersionState(s),v=g.getActiveVersionLog();if(v){var l=v.getVersionNumber();if(l===i)return;v.dom.classList.remove("active")}var u=n.view.getResourceID(s);UserAction.LoadVersion(u,o,i,!1,function(){var e=t?t.range:void 0;!function(e,t){var i=n.view.getActiveGridID(),s=n.view.getResourceID(i),o=n.view.getSheetID(i),g=(n.view.getVersionID(i),n.view.getVersionState(i));r.publish(a.UI,c.SidePanel.VersionHistory.UNHIGHLIGHT_CHANGES),g.setVersionNumber(e),r.publish(a.UI,c.Toolbar.VERSION_HISTORY.HIDE),r.publish(a.UI,c.SidePanel.VersionHistory.UPDATE_TITLE),r.publish(a.Listener,c.DocAction.WORKSHEETS.REMOVE_NO_OF_EDITS),r.publish(a.Listener,c.UserAction.VERSION_HISTORY.UPDATE_BUTTON_STATE,{versionNumber:e}),t&&goTo(s,o,e,t)}(i,e)}),this.dom.classList.add("active"),g.getIsDialogOpen()&&this.changeLog.click(),g.setActiveVersionLog(this)}}},S={changeLog:{click:function(o){var r=n.view.getActiveGridID(),a=this.versionNumber?v["AT.ChangeLog"]+" - "+v.version+" #"+this.versionNumber:v["AT.ChangeLog"],c=n.view.getResourceID(r),g=n.view.getVersionID(r);UserAction.getActionListBasedOnVersion(c,g,this.versionNumber,function(o){!function(o,r){var a=n.view.getActiveGridID(),c=n.view.getVersionState(a);t=c.getChangeLogDialog();var g={width:500,title:o,close:function(){c.setIsDialogOpen(!1)},open:function(){c.setIsDialogOpen(!0),function(e){var t=Object.keys(e),n=t.length;n?(s.innerHTML="",i.style.position="relative"):(i.style.position="static",s.innerHTML="",s.appendChild(d));for(var o=n-1;o>=0;o--)T(e[t[o]],s)}(r)}};v=e.UserAction.getTemplate(["VERSION_HISTORY_AUDIT"]).VERSION_HISTORY_AUDIT,s=v.querySelector("#actionLogContainer"),(i=document.createElement("div")).id=l.DI+u.VIEW_VERSION+l.IDENTITY,i.appendChild(v),t&&t.close(),(t=new e.ZSClass.Dialog(i,g)).open(),c.setChangeLogDialog(t);var v}(a,o)},!1)}}};var d=document.createElement("span");function T(e,t){var i=new g;return i.setColorCode(e.cc),i.setName(e.un),i.setTime(e.ts),i.setMessage(i.processMessage(e)),i.append(t),i}d.textContent=v["AT.NoEdits.Version"],d.className="ZsNoMsg",ZSClass.CurrentVersionLogBinds=I,ZSClass.CurrentVersionChangeLogBinds=S}(this);
!function(s){s.sPlusPlus;var e=s.ZSClass.Selector;(e.Design||(e.Design={})).VersionCue={class:"versionCue",edges:{top:!0}}}(this);
!function(e){var t=e.sPlusPlus,o=e.ZSConstants.FeatureConstants,a=(e.ZSConstants.I18N,e.document,t.data.AppRegistry),s=e.ZSEvents,i=(s.topic,s.Groups,s.Names,e.ZSConstants.wCC,e.UIUtil.Component,t.view.Toolbar.Feature[o.VERSION_SAVE_AS]),n=t.view.Toolbar.Feature[o.SAVEAS],r=t.view.Toolbar.Feature[o.SAVE_AS_TEMPLATE],S=t.view.Toolbar.Feature[o.EXPORT_TO_CLOUD_DRIVES];i.execute=function(e,o){var s=t.view.getActiveGridID(),i=t.view.getResourceID(s),u=t.view.getVersionID(s),v=t.view.getSheetID(s);t.data.getWorkBook(i,u).getSheetObj(v).Prop.getName(),t.data.Defaults.version;a.DOCS_SERVER_URL,"SaveAsSpreadsheet"==o?n.openDialog(e):"SaveAsTemplate"==o?r.openDialog():"SaveToCloud"==o&&S.openDialog()}}(this);
!function(e){var t,o=e.sPlusPlus,i=e.ZSConstants.FeatureConstants,n=e.ZSConstants.I18N,s=e.document,a=o.data.AppRegistry,r=e.ZSEvents,d=r.topic,c=r.Groups,v=r.Names,l=e.ZSConstants.wCC,u=e.UIUtil.Component,I=o.view.Toolbar.Feature[i.EXPORT];d.register(c.UI,v.Toolbar.INIT_MENU,function(e){if(e.id==l.TB+"FILE"+l.POPUP+l.CONTAINER){var t=o.view.getActiveGridID(),n=o.view.getResourceID(t),s=o.view.getVersionID(t),a=(o.view.getSheetID(t),o.data.getWorkBook(n,s).allowExport),r=ZSConstants.Meta.DisableFeaturesList;a&&-1==r.indexOf(i.EXPORT)||u.disable(I.menuElem)}},"DOM"),I.execute=function(i){var r,d;t||(r=n["MenuItem.FileTab.Downloading"],d={mode:"STD",type:"info",showCloseBtn:!1},t=new ZSClass.TBNotification(r,d));var c=o.view.getActiveGridID(),v=o.view.getResourceID(c),l=o.view.getVersionID(c),u=o.view.getSheetID(c),I=o.data.getWorkBook(v,l).getSheetObj(u).Prop.getName(),w=o.data.Defaults.version===l?"":"&version="+l,D="https://"+a.DOCS_SERVER_URL+"/downloaddoc.do?docId="+v+"&docExtn="+i+w,E=o.data.DocRegistry[v],g=E&&E.RemoteViewInfo,C=g&&g.REMOTE_ENC_DOC_ID;if("csv"==i||"tsv"==i||C)D+="&skipL7Check=true",e.UserAction.downloadAs(v,l,I,"."+i,D);else{var f=s.createElement("iframe");f.src=D,f.addEventListener("load",function(e){}),f.addEventListener("error",function(e){}),s.body.appendChild(f)}}}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSConstants.FeatureConstants,o=(e.document,t.view.Toolbar.Feature[s.MACRO]),A=(e.UIUtil.Component,e.ZSEvents),a=A.topic,n=A.Groups,i=A.Names,c=(o=t.data.AppRegistry.MACRO,t.view.Toolbar.Feature[s.MACRO]);c.execute=function(e,t){switch(t.action){case c.ACTION_VIEW_MACRO:a.publish(n.UserAction,i.UserAction.MACRO.VIEW_MACRO);break;case c.ACTION_VBA_EDITOR:a.publish(n.UserAction,i.UserAction.MACRO.OPEN_MACRO_EDITOR,{modName:"Macros"});break;case c.ACTION_MACRO_HELP:window.open(o.VBA_PROGRAMMING)}}}(this);
!function(i){if(!i.isCanvasGrid){var t=i.sPlusPlus,e=i.ZSClass.UIPaneComponent.prototype,o=t.data.Defaults.MAX_COL;e.PlaceHighlightVersion=function(i,e,o,n,h,a){for(var l=t.data.getWorkBook(i,o).getSheetObj(e),r=l.Row,g=l.Column,d=n.startRow;d<=n.endRow;d=r.Visibility.nextNonHidden(d))for(var u=n.startCol;u<=n.endCol;u=g.hidden.nextNonHidden(u))s.call(this,i,e,o,d,u,h,a)},e.RemoveHighlightVersion=function(i,e,s,n){for(var h=t.data.getWorkBook(i,s).getSheetObj(e),a=h.Row,l=h.Column,r=(n=ZSClass.Range.prototype.getIntersectingRange.call(this.props,n)).startRow;r<=n.endRow;r=a.Visibility.nextNonHidden(r))for(var g=n.startCol;g<=n.endCol;g=l.hidden.nextNonHidden(g)){var d=JSUtil.Math.hash(r,g,o);this.HighlightVersion&&this.HighlightVersion.remove(d)}},e.RemoveAllHighlightVersion=function(i,t,e){this.HighlightVersion&&this.HighlightVersion.removeAll()}}function s(i,e,s,n,h,a,l){var r=t.data.getWorkBook(i,s).getSheetObj(e),g=r.Row.auxiliaryAxis.getPos(n),d=r.Column.auxiliaryAxis.getPos(h),u=r.Row.auxiliaryAxis.getPos(n+1),H=r.Column.auxiliaryAxis.getPos(h+1),C=JSUtil.Math.hash(n,h,o),v=t.view.getSheetState(this.gridID,e).getZoom();this.HighlightVersion&&(this.HighlightVersion.place(C,g*v,d*v,(u-g)*v,(H-d)*v),this.HighlightVersion.setColor(C,"#"+a),this.HighlightVersion.setName(C,l))}}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSEvents,n=s.topic,u=s.Groups,o=s.Names,i=t.ZSConstants.FeatureConstants;e.view.Toolbar.Feature[i.INSERT_FUNCTION].execute=function(){n.publish(u.UI,o.SidePanel.Function.open)}}(this);
!function(e){if(!e.isCanvasGrid){var i=e.sPlusPlus,o=e.ZSClass.UIPaneComponent.prototype;o.PlacePrecedance=function(e,o,t,a,s,l){var r=i.data.getWorkBook(e,t).getSheetObj(o),n=r.Row.auxiliaryAxis.getPos(s.startRow),u=r.Column.auxiliaryAxis.getPos(s.startCol),x=r.Row.auxiliaryAxis.getPos(s.endRow+1),P=r.Column.auxiliaryAxis.getPos(s.endCol+1),c=i.view.getSheetState(this.gridID,o).getZoom(),g=(r.Column.auxiliaryAxis.getPos(l.startCol)+r.Column.auxiliaryAxis.getPos(l.endCol+1))/2,d=(r.Row.auxiliaryAxis.getPos(l.startRow)+r.Row.auxiliaryAxis.getPos(l.endRow+1))/2;this.Precedance.place(a,u*c,n*c,(P-u)*c,(x-n)*c,g*c,d*c)},o.RemoveAllPrecedances=function(e,i,o){this.Precedance.hideAll()}}}(this);
!function(e){var t,i=e.sPlusPlus,n=e.ZSClass,s=e.ZSEvents,l=s.topic,r=s.Groups,c=s.Names;l.create(r.Listener,"InsertFunction"),l.register(r.Listener,"InsertFunction",function(e,n,s,o,u){var a=i.view.getActiveGridID(),E=i.view.getSheetState(a,n);i.view.CellEditor.getEditStatus()||(l.publish(r.Selector.BoundUpdate.CellEdit,c.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:n,VERSION:s,RANGE:E.getActiveCellRange(),RANGEID:0,TYPE:void 0}),l.publish(r.Listener,c.CellAction.VALUE.SET,{RID:e,SHEETID:n,VERSION:s,ROW:E.getActiveRow(),COL:E.getActiveCol(),VALUE:{DisplayValue:"="},FOCUS:!0}));(function(e,i){var n=t.value,s="",l="=";if(i=i||"","="===n.charAt(0)){var r=t.selectionStart,c=t.selectionEnd;l=n.substring(0,r),!/.*[;(;,=+\-/*<>&^]$/g.test(l)&&(l+=","),s=n.substring(c,n.length)}var o=l+e+"("+i+")"+s,u=(l+e+"("+i).length;t.value=o,t.valueChanged(),t.setSelectionRange(u,u),t.selectionChanged()})(o,u),UserAction.suggestHelp(o)},"RID","SHEETID","VERSION","FUNCTION","ARGS"),n.InsertFunction={register:function(e){e.addListeners({focus:function(){t=this}.bind(e)})}}}(this);
!function(t){t.sPlusPlus;var e=t.ZSClass,i=(t.UserAction,e.Editors.BasicEditor,e.Range,"Precedance"),r="http://www.w3.org/2000/svg";function s(t){this.Dom=function(t,e){var i=document.createElement("div");return e&&(i.className=e),t.appendChild(i),i}(t,i),this.line=function(t){var e=document.createElementNS(r,"svg");e.setAttribute("class","PrecedanceLine");var i=document.createElementNS(r,"defs"),s=document.createElementNS(r,"marker");s.setAttribute("id","arrow"),s.setAttribute("markerWidth","10"),s.setAttribute("markerHeight","10"),s.setAttribute("refX","9"),s.setAttribute("refY","3"),s.setAttribute("orient","auto"),s.setAttribute("markerUnits","strokeWidth");var n=document.createElementNS(r,"path");n.setAttribute("d","M0,0 L0,6 L9,3 z"),s.appendChild(n),i.appendChild(s),e.appendChild(i);var a=document.createElementNS(r,"line");return a.setAttribute("x1",0),a.setAttribute("y1",0),a.setAttribute("marker-end","url(#arrow)"),e.appendChild(a),t.appendChild(e),a}(this.Dom),this.setLineCoordinates(0,0),this.hide()}s.prototype={hide:function(){this.Dom.style.display="none"},show:function(){this.Dom.style.display=""},place:function(t,e,i,r){var s=this.Dom.style;this.x=t,this.y=e,s.left=t+"px",s.top=e+"px",s.width=i+"px",s.height=r+"px"},setLineCoordinates:function(t,e){this.line.setAttribute("x2",t),this.line.setAttribute("y2",e)}},e.UIPrecedance=s}(this);
!function(i){i.sPlusPlus;var t=i.ZSClass,e=t.UIPrecedance,s=i.ZSEvents;s.topic,s.Groups,s.Names;function n(i){this.parent=i,this.Alive={},this.inActive=[]}n.prototype={place:function(i,t,e,s,n,h,l){var c=this.get(i);c.place(t,e,s,n),c.setLineCoordinates(h-t,l-e),c.show()},get:function(i){return this.Alive[i]||(this.inActive.length?this.Alive[i]=this.inActive.pop():this.Alive[i]=new e(this.parent)),this.Alive[i]},hide:function(i){this.Alive[i]&&(this.Alive[i].hide(),this.inActive.push(this.Alive[i]),delete this.Alive[i])},hideAll:function(){for(var i in this.Alive)this.hide(i)}},t.UIPrecedanceController=n}(this);
!function(t){var n=t.sPlusPlus,e=t.ZSConstants.FeatureConstants,u=t.ZSEvents,o=(u.topic,u.Groups,u.Names,n.view.Toolbar.Feature[e.AUTOSUM]);function s(e,u,o,s,i,c,a){var S=n.view.getActiveGridID(),r=(n.view.getSheetState(S,o),n.view.getSelectedSheets(S));t.UserAction.aggregateFunctions(u,r,s,i,c,a)}o.executeSum=function(t,n,e,u){if(!t.repeat){var o=ZSConstants.Function.functions;s(0,n,e,u,o.SUM[0],o.SUBTOTAL[0],"109,")}},o.executeAverage=function(t,n,e,u){var o=ZSConstants.Function.functions;s(0,n,e,u,o.AVERAGE[0],o.SUBTOTAL[0],"101,")},o.executeCount=function(t,n,e,u){var o=ZSConstants.Function.functions;s(0,n,e,u,o.COUNTA[0],o.SUBTOTAL[0],"102,")},o.executeCountNumber=function(t,n,e,u){var o=ZSConstants.Function.functions;s(0,n,e,u,o.COUNT[0],o.SUBTOTAL[0],"103,")},o.executeMax=function(t,n,e,u){var o=ZSConstants.Function.functions;s(0,n,e,u,o.MAX[0],o.SUBTOTAL[0],"104,")},o.executeMin=function(t,n,e,u){var o=ZSConstants.Function.functions;s(0,n,e,u,o.MIN[0],o.SUBTOTAL[0],"105,")}}(this);
!function(e){var t,o=e.sPlusPlus,s=e.ZSConstants.FeatureConstants,n=ZSConstants.CommandConstants,a=o.data.AppRegistry.FORM_SERVER_URL,i="&type=showform";o.view.Toolbar.Feature[s.LIVE_FORM].execute=function(){var s=o.view.getActiveGridID(),r=o.view.getResourceID(s),u=o.view.getSheetID(s),R=o.view.getVersionID(s),v=o.data.getWorkBook(r,R).FormSheets[u][n.FORM_RID];t=a+"/ropen.do?rid="+v+i,e.window.open(t,"_blank")}}(this);
!function(t){var e=t.sPlusPlus,i=t.ZSClass;function s(t,e){for(var i in t)e.call(this,i,t[i])}function r(t,i,s){var r=e.data.getWorkBook(t,i).SheetList.getIdByName(s);return r?{sheetID:r,range:void 0,sheetName:s}:void 0}function n(){this.actionList={},this.byUser={},this.byDate={},this.byVersion={},this.partialVersion=[],this.alreadyParsed={},this.timeZone}n.prototype={isEmpty:function(){var t=!0;for(var e in this.actionList){t=!1;break}return t},setTimeZone:function(t){this.timeZone=t},addAction:function(t){var i;this.actionList=t;for(var r=Object.keys(t),n=r.length-1;n>=0;n--)i=t[r[n]].ver;e.view.actionListManager.byVersion[i]||this.partialVersion.push(i),s.call(this,this.actionList,this.splitByUser)},appendAction:function(t){var i,s,r=Object.keys(t);if(r.length){var n=t[r[0]].ver;e.view.actionListManager.byVersion[n]||this.partialVersion.push(n)}for(var a=Object.keys(this.alreadyParsed),h=r.length-1;h>=0;h--){i=r[h],s=t[r[h]],this.actionList[i]=s;for(var o=0;o<a.length;o++){this.alreadyParsed[a[o]].call(this,i,s)}}},getActionList:function(){return this.actionList},getByUser:function(t){return 0===Object.keys(this.byUser).length&&this.byUser.constructor===Object&&s.call(this,this.actionList,this.splitByUser),this.byUser[t]},splitByUser:function(t,e){var i=e.un;this.alreadyParsed.splitByUser=this.splitByUser,!this.byUser[i]&&(this.byUser[i]={}),this.byUser[i][t]=e},getBySheet:function(t){return this.bySheet[t]},splitBySheet:function(t,i){var s=i.lp,n=i.undid,a=i.redo,h=i;(n||a)&&(s=n?n.lp:a.lp,h=n||a),h.parsedRange=[];for(var o=e.view.getActiveGridID(),y=e.view.getResourceID(o),c=e.view.getVersionID(o),l=0;l<s.length;l++){var u=JSUtil.Range.parseRange(y,c,s[l])||r(y,c,s[l]);u&&(!this.bySheet[u.sheetID]&&(this.bySheet[u.sheetID]=[]),this.bySheet[u.sheetID].push(i),h.parsedRange.push(u))}},splitByDate:function(t,e){e.ts;var i=new Date(e.ts).valueOf();this.alreadyParsed.splitByDate=this.splitByDate,!this.byDate[i]&&(this.byDate[i]={}),this.byDate[i][t]=e},getByDate:function(t,e,i){0===Object.keys(this.byDate).length&&this.byDate.constructor===Object&&s.call(this,this.actionList,this.splitByDate);for(var r={},n={},a=Object.keys(this.byDate),h=0,o=0,y=0;h<a.length;h++)if(a[h]>=t&&a[h]<=e){var c=this.byDate[a[h]];for(var l in c)r[o]=c[l],o++}else{c=this.byDate[a[h]];for(var u in c)n[y]=c[u],y++}return i?r:n},getByRange:function(t,e,i){var s=JSUtil.Range.parseRange(t,e,i)||r(t,e,i);if(s){var n=this.getBySheet(s.sheetID),a=s.range;if(!a)return n;for(var h=[],o=0;o<n.length;o++){var y=n[o],c=y.undid,l=y.redo;(c||l)&&(y=c||l);for(var u=0;u<y.parsedRange.length;u++){var v=y.parsedRange[u].range;a.intersects(v)&&h.push(y)}}return h}},splitByVersion:function(t,e){var i=e.ver;this.alreadyParsed.splitByVersion=this.splitByVersion,i&&(!this.byVersion[i]&&(this.byVersion[i]={}),this.byVersion[i][t]=e)},getByVersion:function(t){0===Object.keys(this.byVersion).length&&this.byVersion.constructor===Object&&s.call(this,this.actionList,this.splitByVersion);var e=this.partialVersion.indexOf(t);if(-1==e)return this.byVersion[t];this.partialVersion.splice(e,1)}},e.view.actionListManager=new n,i.ActionListManager=n}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,a=(n.topic,n.Groups,n.Names,e.ZSConstants.FeatureConstants),i=e.document,s=(e.UserAction,e.ZSConstants.wCC),o=e.UIUtil.Component,u=i.getElementById("popupmenu"),c=t.view.Toolbar.Feature[a.DELUGE_EDITOR],l=t.view.Toolbar.Feature[a.CREATE_MACRO],r={id:s.SUBMENUITEM+a.CREATE_MACRO+s.IDENTITY,ctype:"zmenu",data:'{"componentOptions":{"type":"text_only"}}'};t.view.Menu.create([{data:'{"label": "Using VBA"}'},{mtype:"separator"},{data:'{"label": "Using Deluge"}'}],r,u).then(function(){o.bind("#"+s.SUBMENUITEM+a.CREATE_MACRO+s.IDENTITY,"menuitemclicked",function(e,n){var a=n.menuitem.metadata(),i=t.view.getActiveGridID();t.view.getSelectedSheets(i),t.view.getResourceID(i),t.view.getSheetID(i),t.view.getVersionID(i);switch(a.label){case"Using VBA":l.openDialog();break;case"Using Deluge":c.createInsertDialog()}})})}(this);
!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){e.defineMode("vbscript",function(e,t){var n="error";function r(e){return new RegExp("^(("+e.join(")|(")+"))\\b","i")}var a=new RegExp("^[\\+\\-\\*/&\\\\\\^<>=]"),i=new RegExp("^((<>)|(<=)|(>=))"),o=new RegExp("^[\\.,]"),c=new RegExp("^[\\(\\)]"),b=new RegExp("^[A-Za-z][_A-Za-z0-9]*"),s=r(["and","or","not","xor","is","mod","eqv","imp"]),l=["WScript","err","debug","RegExp"],u=["clear","execute","raise","replace","test","write","writeline","close","open","state","eof","update","addnew","end","createobject","quit"].concat(["description","firstindex","global","helpcontext","helpfile","ignorecase","length","number","pattern","source","value","count"]);l=l.concat(["vbBlack","vbRed","vbGreen","vbYellow","vbBlue","vbMagenta","vbCyan","vbWhite","vbBinaryCompare","vbTextCompare","vbSunday","vbMonday","vbTuesday","vbWednesday","vbThursday","vbFriday","vbSaturday","vbUseSystemDayOfWeek","vbFirstJan1","vbFirstFourDays","vbFirstFullWeek","vbGeneralDate","vbLongDate","vbShortDate","vbLongTime","vbShortTime","vbObjectError","vbOKOnly","vbOKCancel","vbAbortRetryIgnore","vbYesNoCancel","vbYesNo","vbRetryCancel","vbCritical","vbQuestion","vbExclamation","vbInformation","vbDefaultButton1","vbDefaultButton2","vbDefaultButton3","vbDefaultButton4","vbApplicationModal","vbSystemModal","vbOK","vbCancel","vbAbort","vbRetry","vbIgnore","vbYes","vbNo","vbCr","VbCrLf","vbFormFeed","vbLf","vbNewLine","vbNullChar","vbNullString","vbTab","vbVerticalTab","vbUseDefault","vbTrue","vbFalse","vbEmpty","vbNull","vbInteger","vbLong","vbSingle","vbDouble","vbCurrency","vbDate","vbString","vbObject","vbError","vbBoolean","vbVariant","vbDataObject","vbDecimal","vbByte","vbArray"]),e.isASP&&(l=l.concat(["server","response","request","session","application"]),u=u.concat(["addheader","appendtolog","binarywrite","end","flush","redirect","binaryread","remove","removeall","lock","unlock","abandon","getlasterror","htmlencode","mappath","transfer","urlencode"],["buffer","cachecontrol","charset","contenttype","expires","expiresabsolute","isclientconnected","pics","status","clientcertificate","cookies","form","querystring","servervariables","totalbytes","contents","staticobjects","codepage","lcid","sessionid","timeout","scripttimeout"]));var d=r(["dim","redim","then","until","randomize","byval","b2yref","new","property","exit","in","const","private","public","get","set","let","stop","on error resume next","on error goto 0","option explicit","call","me"]),v=r(["true","false","nothing","empty","null"]),m=r(["abs","array","asc","atn","cbool","cbyte","ccur","cdate","cdbl","chr","cint","clng","cos","csng","cstr","date","dateadd","datediff","datepart","dateserial","datevalue","day","escape","eval","execute","exp","filter","formatcurrency","formatdatetime","formatnumber","formatpercent","getlocale","getobject","getref","hex","hour","inputbox","instr","instrrev","int","fix","isarray","isdate","isempty","isnull","isnumeric","isobject","join","lbound","lcase","left","len","loadpicture","log","ltrim","rtrim","trim","maths","mid","minute","month","monthname","msgbox","now","oct","replace","rgb","right","rnd","round","scriptengine","scriptenginebuildversion","scriptenginemajorversion","scriptengineminorversion","second","setlocale","sgn","sin","space","split","sqr","strcomp","string","strreverse","tan","time","timer","timeserial","timevalue","typename","ubound","ucase","unescape","vartype","weekday","weekdayname","year"]),p=r(l),f=r(u),h='"',y=r(["class","sub","select","while","if","function","property","with","for"]),g=r(["else","elseif","case"]),x=r(["next","loop","wend","end"]),k=r(["end"]),w=r(["do"]),I=r(["on error resume next","exit"]),C=r(["rem"]);function L(e,t){t.currentIndent++}function E(e,t){t.currentIndent--}function D(e,r){if(e.eatSpace())return"space";var l,u;if("'"===e.peek())return e.skipToEnd(),"comment";if(e.match(C))return e.skipToEnd(),"comment";if(e.match(/^((&H)|(&O))?[0-9\.]/i,!1)&&!e.match(/^((&H)|(&O))?[0-9\.]+[a-z_]/i,!1)){var S=!1;if(e.match(/^\d*\.\d+/i)?S=!0:e.match(/^\d+\.\d*/)?S=!0:e.match(/^\.\d+/)&&(S=!0),S)return e.eat(/J/i),"number";var T=!1;if(e.match(/^&H[0-9a-f]+/i)?T=!0:e.match(/^&O[0-7]+/i)?T=!0:e.match(/^[1-9]\d*F?/)?(e.eat(/J/i),T=!0):e.match(/^0(?![\dx])/i)&&(T=!0),T)return e.eat(/L/i),"number"}return e.match(h)?(r.tokenize=(l=e.current(),u=1==l.length,function(e,r){for(;!e.eol();){if(e.eatWhile(/[^'"]/),e.match(l))return r.tokenize=D,"string";e.eat(/['"]/)}if(u){if(t.singleLineStringErrors)return n;r.tokenize=D}return"string"}),r.tokenize(e,r)):e.match(i)||e.match(a)||e.match(s)?"operator":e.match(o)?null:e.match(c)?"bracket":e.match(I)?(r.doInCurrentLine=!0,"keyword"):e.match(w)?(L(0,r),r.doInCurrentLine=!0,"keyword"):e.match(y)?(r.doInCurrentLine?r.doInCurrentLine=!1:L(0,r),"keyword"):e.match(g)?"keyword":e.match(k)?(E(0,r),E(0,r),"keyword"):e.match(x)?(r.doInCurrentLine?r.doInCurrentLine=!1:E(0,r),"keyword"):e.match(d)?"keyword":e.match(v)?"atom":e.match(f)?"variable-2":e.match(m)?"builtin":e.match(p)?"variable-2":e.match(b)?"variable":(e.next(),n)}return{electricChars:"dDpPtTfFeE ",startState:function(){return{tokenize:D,lastToken:null,currentIndent:0,nextLineIndent:0,doInCurrentLine:!1,ignoreKeyword:!1}},token:function(e,t){e.sol()&&(t.currentIndent+=t.nextLineIndent,t.nextLineIndent=0,t.doInCurrentLine=0);var n=function(e,t){var n=t.tokenize(e,t);return e.current(),n}(e,t);return t.lastToken={style:n,content:e.current()},"space"===n&&(n=null),n},indent:function(t,n){var r=n.replace(/^\s+|\s+$/g,"");return r.match(x)||r.match(k)||r.match(g)?e.indentUnit*(t.currentIndent-1):t.currentIndent<0?0:t.currentIndent*e.indentUnit}}}),e.defineMIME("text/vbscript","vbscript")});
!function(e){var t,r=e.ZSConstants.MacroKeyWords.keyWordJson,n=e.ZSConstants.MacroKeyWords.parentChildJson;t=function(e){var t=e.Pos;function i(e,t,i,o,s,a){var l=[],f=e.string,u=o&&o.globalScope||r;function g(e){var t=e.text,r=f;0!=t.toLowerCase().lastIndexOf(r.toLowerCase(),0)||function(e,t){if(!Array.prototype.indexOf){for(var r=e.length;r--;)if(e[r]===t)return!0;return!1}return-1!=e.indexOf(t)}(l,e.text)||l.push(e)}function c(e,t){var r=new RegExp(e+"[ \t]*=[ \t]*");if((t=s.getSearchCursor(r,t.to())).findPrevious()){var n=t.to(),i=s.getLineHandle(n.line);if("comment"!=i.stateAfter.lastToken.style){var o=(i=(i=i.text).substr(i.indexOf("=")+1)).split(".");if(e=o[o.length-1].trim(),o.length>1)return e;void 0==u[e]&&(e=c(e,t))}}return e}function d(e,t){if(-1!=e){var r=s.getLineHandle(e).text.split(" ");return keyword=r[r.length-1].trim(),r=keyword.split("."),keyword=r[r.length-1].trim(),t?n[keyword]:keyword}}function p(e,t,r){!function(e,t){for(var r=0;r<e.length;r++)t(e[r])}(t?function(e,t){for(var r=[],n=e,i=0;i<n.length;i++){var o=n[i],s=o.name,a="",l=o.args;if(l)for(var f=0;f<Object.keys(l).length;f++){var u=l[f];u&&(a+='"'+u+'"')}var g=t.string;(""==g||s.toLowerCase().indexOf(g.toLowerCase())>-1)&&r.push({type:o.type,text:s,displayText:s,arguments:a})}return r}(e,r):a?function(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n].name;(""==t.string||i.indexOf(t.string)>-1)&&r.push({text:i,displayText:i})}return r}(e,r):function(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n],o=i.name,s="",a=i.args;if(a)for(var l=0;l<Object.keys(a).length;l++){var f=a[l];f&&(s+='"'+f+'"')}var u=t.string,g=o;(""==t.string||g.toLowerCase().indexOf(u.toLowerCase())>-1)&&r.push({type:i.type,text:o,displayText:o,arguments:s})}return r}(e,r),g)}if(t&&t.length){var v,y=t.pop();if(y.type&&0===y.type.indexOf("variable")){if(o&&o.additionalContext&&(v=o.additionalContext[y.string]),o&&!1===o.useGlobalScope||(v=v||u[y.string]),void 0==v){var h=function(e){for(var t=s.getSearchCursor(e,s.getCursor());t.findPrevious();){var r=t.to(),n=s.getLineHandle(r.line);if("comment"!=n.stateAfter.lastToken.style){var i,o=new RegExp(e+"[ \t]+As","i"),a=s.getSearchCursor(o,r);a.findPrevious()?"comment"!=(n=s.getLineHandle(a.pos.to.line)).stateAfter.lastToken.style?i=a.pos.to:l={line:-1}:i={line:-1},o=new RegExp(e+"[ \t]*=[ \t]*");var l,f,u=s.getSearchCursor(o,r);return l=u.findPrevious()&&"comment"!=(n=s.getLineHandle(u.pos.to.line)).stateAfter.lastToken.style?u.pos.to:{line:-1},o=new RegExp(e+"[ \t]+In","i"),cursor_forEach=s.getSearchCursor(o,r),f=cursor_forEach.findPrevious()&&"comment"!=(n=s.getLineHandle(u.pos.to.line)).stateAfter.lastToken.style?cursor_forEach.pos.to:{line:-1},i.line>l.line&&i.line>f.line?d(i.line,!1):l.line>i.line&&l.line>f.line?c(e,u):d(f.line,!0)}}}(y.string);v=u[h],(e=s.getTokenAt(s.getCursor())).string=""}}else if("string"==y.type)v="";else if("atom"==y.type)v=1;else if("function"==y.type)null==u.jQuery||"$"!=y.string&&"jQuery"!=y.string||"function"!=typeof u.jQuery?null!=u._&&"_"==y.string&&"function"==typeof u._&&(v=u._()):v=u.jQuery();else if("bracket"==y.type){var m={line:s.getCursor().line,ch:y.start,sticky:null},x=s.findMatchingBracket(m);if(null!=x){var C=s.getTokenAt(x.to);v=u[C.string],y=C}}null!=v&&t.length&&(v=v[t.pop().string]),null!=v&&p(v,y,e)}else p(u.Global,y,e);return l}e.registerHelper("hint","vision",function n(o,s){return function(n,o,s,a){var l=n.getCursor(),f=s(n,l);if(!/\b(?:string|comment)\b/.test(f.type)){f.state=e.innerMode(n.getMode(),f.state).state,/^[\w$_]*$/.test(f.string)?f.end>l.ch&&(f.end=l.ch,f.string=f.string.slice(0,l.ch-f.start)):f={start:l.ch,end:l.ch,string:"",state:f.state,type:"."==f.string?"property":null};var u=f;u=s(n,t(l.line,u.start));var g=s(n,t(l.line,u.start)),c=!1;if("As"==g.string&&(c=!0),"."==u.string){if(u=s(n,t(l.line,u.start)),!d)var d=[];if(d.push(u),u=s(n,t(l.line,u.start)),"As"==(g=s(n,t(l.line,u.start))).string)return}var p=[];if(void 0==d)for(var v=e.hint.anyword(n).list,y=0;y<v.length;y++)if(void 0==r[v[y]]){var h={type:void 0,text:v[y],displayText:v[y],arguments:""};p.push(h)}return{list:v=0==p.length?i(f,d,o,a,n,c):i(f,d,o,a,n,c).concat(p),from:t(l.line,f.start),to:t(l.line,f.end)}}}(o,n,function(e,t){return e.getTokenAt(t)},s)})},"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(this);
!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){var r=/[\w$]+/;e.registerHelper("hint","anyword",function(o,t){for(var i=t&&t.word||r,n=t&&t.range||500,a=o.getCursor(),s=o.getLine(a.line),f=a.ch,c=f;c&&i.test(s.charAt(c-1));)--c;for(var l=c!=f&&s.slice(c,f),d=t&&t.list||[],u={},p=new RegExp(i.source,"g"),g=-1;g<=1;g+=2)for(var h=a.line,m=Math.min(Math.max(h+g*n,o.firstLine()),o.lastLine())+g;h!=m;h+=g)for(var w,v=o.getLine(h);w=p.exec(v);){var y=w[0],L=l;h==a.line&&w[0]===l||(l&&0!=y.toLowerCase().lastIndexOf(L.toLowerCase(),0)||Object.prototype.hasOwnProperty.call(u,w[0])||(u[w[0]]=!0,d.push(w[0])))}return{list:d,from:e.Pos(a.line,c),to:e.Pos(a.line,f)}})});
!function(e){var t=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,a=t.view.Toolbar.Feature[n.MACRO_HELP],o=e.ZSEvents,i=(o.topic,o.Groups,o.Names,e.document),s=(e.UserAction,e.ZSConstants.wCC),r=e.UIUtil.Component,u=t.data.AppRegistry.MACRO,c=i.getElementById("popupmenu"),l=t.view.Toolbar.Feature[n.DELUGE_EDITOR],p={id:s.SUBMENUITEM+n.MACRO_HELP+s.IDENTITY,ctype:"zmenu",data:'{"componentOptions":{"type":"text_only"}}'};function E(e){window.open(u.VBA_PROGRAMMING)}t.view.Menu.create([{data:'{"label": "For VBA"}'},{mtype:"separator"},{data:'{"label": "For Deluge"}'}],p,c).then(function(){r.bind("#"+s.SUBMENUITEM+n.MACRO_HELP+s.IDENTITY,"menuitemclicked",function(e,n){var a=n.menuitem.metadata(),o=t.view.getActiveGridID();t.view.getSelectedSheets(o),t.view.getResourceID(o),t.view.getSheetID(o),t.view.getVersionID(o);switch(a.label){case"For VBA":E();break;case"For Deluge":l.openHelpPage()}})}),a.execute=E}(this);
!function(e){var t,n,r,o=e.sPlusPlus,i=e.ZSConstants,a=i.wCC,l=e.ZSClass,s=i.FeatureConstants,u=e.UIUtil.Component,c=e.ZSEvents,d=c.topic,p=c.Groups,S=c.Names,E=e.UserAction,v=e.document,f=i.I18N,m=o.view.measures,y=o.view.Toolbar.Feature[s.FULLSCREEN],T=new l.SBFeature("FULLSCREEN"),w=T.div,C=!1;v.querySelector("#"+a.MI+s.FULLSCREEN+a.MENU);function L(){(C=!C)?(v.querySelector("#fullScreenBanner").style.display="block",n=setTimeout(N,3e3)):(window.clearTimeout(n),N()),function(){!function(){var e="sbFsrn";C&&(e+=" sbFsrnClicked");!function(e){w.className="flt_right "+e}(e)}();var e=o.view.getActiveGridID(),t=o.view.getResourceID(e),n=o.view.getSheetID(e),r=o.view.getVersionID(e);m.Top.menuBar.Tab=C?0:14,m.Top.menuBar.toolBar=C?0:44,m.Top.topBand=C?0:30;var i=v.querySelector(".shTopMenu");(function(e){var t="flex";m.Top.menuBar.Tab=e?0:14,m.Top.topBand=e?0:30,e&&(t="none");var n=v.querySelector(".shMenuBar");n&&(n.style.display=t)})(C),function(e){var t="flex";m.Top.menuBar.toolBar=e?0:44,e&&(t="none");var n=v.querySelector("#quickToolBar");n&&(n.style.display=t)}(C),i.style.display=C?"none":"",E.UpdateViewport(t,n,r)}(),d.publish(p.UI,S.Toolbar.FULLSCREEN_TOGGLE)}function N(){v.querySelector("#fullScreenBanner").style.display="none",window.clearTimeout(n)}y.execute=L,window.onkeydown=function(e){27==(e=e||window.event).keyCode&&C&&L()},function(){w.className="flt_right sbFsrn",T.add(),(t=v.createElement("input")).setAttribute("type","button"),t.id=a.SB+s.FULLSCREEN+a.MENU;var e=v.createElement("label");e.title=f["Bottomband.FullScreen"],e.className="shIcon sTFullScrn",e.setAttribute("for",a.SB+s.FULLSCREEN+a.MENU),w.appendChild(t),w.appendChild(e),t.addEventListener("click",function(){L()})}(),(r=v.createElement("div")).addEventListener("click",N),r.id="fullScreenBanner",r.classList.add("fullScreenDOM"),r.innerText=f["Screen.hiddenMsg"],v.body.appendChild(r),d.register(p.UI,S.Toolbar.INIT_MENU,function(){u.zmenu("#sidePanelViewSetting","setMenuItemsAttribute",["#"+a.MI+s.FULLSCREEN+a.MENU],"checked",C)})}(this);
!function(e){var t,n,i,o,s=e.sPlusPlus,a=e.document,r=e.ZSClass,u=e.UserAction,c=e.ZSEvents,l=c.topic,d=c.Groups,m=c.Names,v=a.getElementById("popupmenu"),f=e.UIUtil.Component,p=(s.view.measures,s.view.Events.Key),S=e.ZSConstants.FeatureConstants,g=e.ZSConstants.FeatureConstants,h=e.ZSConstants.wCC,I=e.ZSConstants.I18N,O=(r.ZSAlert,I["Zoom.NotSupported"],50),z=400,A=null,D=(a.querySelector("#"+h.MI+g.ZOOM+h.MENU),[(I=e.ZSConstants.I18N)["Zoom.Default"],"50%","75%","100%","125%","150%","200%","250%","300%","400%"]),E=s.view.Toolbar.Feature[S.ZOOM],Z=JSUtil.fn.debounce(function(e,t,n,i,o,a,r,c,l,d,m){s.data.getWorkBook(e,i).isEditable()&&u.setZoom(e,t,n,i,o,a,r,c,l,d,m)},1e3);function b(e,n){if(t.value=parseInt(e)+"%",n&&A&&D.indexOf(e+"%")>=0){var i="#zoom_"+e;f.zmenu("#zoomOptions","setMenuItemsAttribute",[A],"checked",!1),A=i,f.zmenu("#zoomOptions","setMenuItemsAttribute",[i],"checked",!0)}}function w(){if(t){var e=t.value;return e=e.slice(0,e.length-1),parseInt(e)}}function L(e){for(var t=D.length-1;t>1;t--){var n=D[t],i=D[t-1],o=parseInt(n.slice(0,n.length-1));if(parseInt(i.slice(0,i.length-1))<e&&e<o)return t}}function C(e,t){e.preventDefault();var n,i=w();if("DEFAULT"===t)n=100;else{var o=D.indexOf(i+"%");n=(n=-1!=o?"PLUS"===t?o==D.length-1?D[o]:D[o+1]:1==o?D[o]:D[o-1]:"PLUS"===t?D[L(i)]:D[L(i)-1]).slice(0,n.length-1)}b(n,!0),y(e)}function M(e){C(e,"PLUS")}function k(e){C(e,"MINUS")}function y(e){var t=s.view.getActiveGridID(),n=s.view.getResourceID(t),i=s.view.getSheetID(t),o=s.view.getVersionID(t),a=s.view.getSheetState(t,i);!function(e,t,n,i,o){var a=o.getActiveRange(),r=o.getActiveCellRange(),c=s.view.getActiveGridID(),l=s.view.getSelectedSheets(c),d=(t=s.view.getSheetID(c),s.view.getSheetState(c,t).getZoom());d!=i&&(u.Zoom(e,t,n,d,i,o.sLefts[0],o.sTops[0],o.sLefts[1],o.sTops[1],a,r),Z(e,t,l,n,i,o.sLefts[0],o.sTops[0],o.sLefts[1],o.sTops[1],a,r))}(n,i,o,w()/100,a)}function T(){(i=a.createElement("ul")).id="zoomOptions",i.setAttribute("data-ctype","zmenu"),i.setAttribute("data-min-width",120),i.setAttribute("data-content-type","icon-text");for(var e=D.length-1;e>=0;e--){var t=D[e],n=a.createElement("li");if(n.id="zoom_"+t.slice(0,t.length-1),0==e){n.id="default";var o=a.createElement("li");o.setAttribute("mtype","separator"),i.appendChild(o)}else n.setAttribute("data-item-type","checkbox");n.textContent=t,i.appendChild(n)}v.appendChild(i),f.bind(i,"zmenushow",function(e,t){var n=w();A?-1==D.indexOf(n+"%")&&f.zmenu("#zoomOptions","setMenuItemsAttribute",[A],"checked",!1):(A="#zoom_"+n,D.indexOf(n+"%")>=0&&f.zmenu("#zoomOptions","setMenuItemsAttribute",[A],"checked",!0))}),f.bind(i,"zmenuitemclick",function(e,t){!function(e,t){var n,i;"default"==t.data.id?(n="#zoom_100",i=100):(n=t.data.id,i=t.data.label.slice(0,t.data.label.length-1)),f.zmenu("#zoomOptions","setMenuItemsAttribute",[A],"checked",!1),A=n,f.zmenu("#zoomOptions","setMenuItemsAttribute",[n],"checked",!0),b(i,!0),y()}(0,t)})}function U(e){p.focusContext(e)}function N(){o=p.Stack[p.Stack.length-1],U(p.Entry.Zoom.Context),t.select()}function x(){U(o)}E.Increment=M,E.Decrement=k,E.setDefault=function(e){C(e,"DEFAULT")};l.register(d.UI,m.Layout.TEMPLATE_LOADED,function(){var e=new r.SBFeature("GRIDZOOM"),i=e.div;i.className="zoomGrid",function(e){var i=s.view.getActiveGridID(),o=s.view.getSheetID(i),a=s.view.getSheetState(i,o),r=u.getTemplate(["ZOOM_SLIDER"]).ZOOM_SLIDER;e.appendChild(r),t=e.querySelector(".zoomInput").firstElementChild,b(100*a.getZoom(),!1),t.addEventListener("focus",N),t.addEventListener("blur",x),e.querySelector(".zoomInc").addEventListener("click",M),e.querySelector(".zoomDec").addEventListener("click",k),n=e.querySelector(".zoomMoreOpt"),T(),n.setAttribute("data-menu-id","zoomOptions")}(i),e.add()}),l.register(d.Listener,m.SheetAction.ZOOM.OnCustomInput,function(e){var n=s.view.getActiveGridID(),i=s.view.getSheetID(n),o=s.view.getSheetState(n,i),a=t.value;a.endsWith("%")&&(a=w()),isNaN(a)&&b(a=100*o.getZoom()),a<O?a=O:a>z&&(a=z),b(a,!0),y(),t.blur()}),l.register(d.Listener,m.SheetAction.ZOOM.On,function(e,t,n,i,o,s,a,r){var u=w()/100;u&&i!=u&&b(100*i,!0)},"RID","SHEETID","VERSION","ZOOM","sTop","sLeft","fsTop","fsLeft")}(this);
!function(s){s.sPlusPlus;var t=s.sPlusPlus.view.Events.Key.Entry.Zoom.Context.keyDown,n=s.ZSConstants.JSKeyCode,e=s.ZSEvents,o=e.topic,u=e.Names,i=e.Groups;function l(){o.publish(i.Listener,u.SheetAction.ZOOM.OnCustomInput)}t[n.ENTER]=l,t[n.TAB]=l}(this);
!function(e){var t,a=e.sPlusPlus,r=e.document,i=e.ZSEvents,n=(i.topic,i.Groups,i.Names,e.ZSConstants),o=n.FeatureConstants,l=(n.I18N,n.wCC),u=e.UserAction,p=a.view.Toolbar.Feature[o.CLEAR_ALL],v=a.view.Toolbar.Feature[o.CLEAR_ALL+"_Formats"],c=a.view.Toolbar.Feature[o.CLEAR_ALL+"_Contents"],C=a.view.Toolbar.Feature[o.CLEAR_NOTE],E=a.view.Toolbar.Feature[o.CLEAR_HYPERLINK],d=a.view.Toolbar.Feature[o.INPUT_CONTROLS],s=a.view.Toolbar.Feature[o.CLEAR_DATA_VALIDATION],L=a.view.Toolbar.Feature[o.CONDITIONAL_FORMAT_CLEAR_RULE],A=r.getElementById("popupmenu");function w(){var e=r.createElement("li");return e.setAttribute("data-item-type","separator"),e}p&&(p.execute=function(e){if(!e.repeat){var t=a.view.getActiveGridID(),r=a.view.getResourceID(t),i=(a.view.getSheetID(t),a.view.getVersionID(t)),n=a.view.getSelectedSheets(t);u.CLEARALL(r,n,i),e.preventDefault(),e.stopPropagation()}}),v&&(v.execute=function(e){if(!e.repeat){var t=a.view.getActiveGridID(),r=a.view.getResourceID(t),i=(a.view.getSheetID(t),a.view.getVersionID(t)),n=a.view.getSelectedSheets(t);u.CLEARSTYLES(r,n,i),e.preventDefault(),e.stopPropagation()}}),c&&(c.execute=function(e){if(!e.repeat){var t=a.view.getActiveGridID(),r=a.view.getResourceID(t),i=(a.view.getSheetID(t),a.view.getVersionID(t)),n=a.view.getSelectedSheets(t);u.CLEARCONTENTS(r,n,i),e.preventDefault(),e.stopPropagation()}}),C&&(C.execute=function(){a.view.Toolbar.Feature[o.NOTE].Clear()}),E&&(E.execute=function(){a.view.Toolbar.Feature[o.HYPERLINK].Clear()}),d&&(d.execute=function(){a.view.Toolbar.Feature[o.INPUT_CONTROLS].Clear(ev)}),(t=r.createElement("ul")).id=l.SUBMENUITEM+o.CLEAR_ALL+l.IDENTITY,p&&t.appendChild(p.createClearAllMenuElement()),v&&t.appendChild(v.createMenuElement()),c&&t.appendChild(c.createMenuElement()),(p||v||c)&&t.appendChild(w()),C&&t.appendChild(C.createMenuElement()),E&&t.appendChild(E.createMenuElement()),d&&t.appendChild(d.createClearMenuElement()),(C||E||d)&&t.appendChild(w()),s&&t.appendChild(s.createElement()),L&&t.appendChild(L.createElement()),A.appendChild(t)}(this);
!function(e){var t=e.sPlusPlus,o=e.ZSConstants,n=e.ZSEvents,i=n.topic,r=n.Groups,a=n.Names,s=e.document,c=(t.data.Defaults.MAX_COL,e.UserAction,o.FeatureConstants),I=o.I18N,E=o.wCC,l=o.JSKeyCode,R=(t.view.Toolbar.transient,s.getElementById("popupmenu")),u=(t.SML.Client,e.UIUtil.Component),T=t.data.UserInfo,S=t.view.Toolbar.Feature[c.INSERT_ROW_OPTIONS];function w(e){for(var o=t.data.Defaults,n=[],i=0;i<e.length;i++){var r=e[i],a=r.endRow-r.startRow+1;r.endRow==o.MAX_ROW-1&&0==r.startRow||(r.endRow=r.endRow+a,r.startRow=r.startRow+a),n.push(r)}return n}function O(o){var n=t.view.getActiveGridID(),s=t.view.getResourceID(n),E=t.view.getSheetID(n),l=t.view.getVersionID(n),R=t.view.getSheetState(n,E),u=t.view.getSelectedSheets(n),S=R.getRanges(),O=t.data.getWorkBook(s,l),d=R.getActiveRange(),_=O.getSheetObj(E),N=d.startRow,v=d.endRow-N+1,A=t.view.CellEditor.getEditStatus();if(function(e,o,n){var i=t.data.Defaults.MAX_ROW;if(e.MaxUsedRow+n>=i||o===i||o+n>i)return!1;return!0}(_,N,v)){if(A&&i.publish(r.Gesture.Selector.CellEdit,a.GESTURE.ACTION.ENUMERATE,{RID:s,SHEETID:E,VERSION:l,isSubmittable:1}),T.activeInfo.getCopyState()&&(o==c.INSERT_COPY_ROW_ABOVE||o==c.INSERT_COPY_ROW_BELOW)){var b=T.activeInfo.copyRanges.Ranges;if(b&&b.length>1)return void ZSClass.ZSAlert(I["action.not.support.multiselection"],{title:I["Alert.Title.InvalidSelection"]})}switch(o){case c.INSERT_ROW:case c.INSERT_ROW_ABOVE:case c.INSERT_ROW_OPTIONS:e.UserAction.InsertRow(s,u,l,S,!0);break;case c.INSERT_ROW_BELOW:S=w(S),e.UserAction.InsertRow(s,u,l,S,!1);break;case c.INSERT_CUT_ROW_ABOVE:e.UserAction.InsertCutRow(s,u,l,S);break;case c.INSERT_CUT_ROW_BELOW:S=w(S),e.UserAction.InsertCutRow(s,u,l,S);break;case c.INSERT_COPY_ROW_ABOVE:e.UserAction.InsertCopyRow(s,u,l,S);break;case c.INSERT_COPY_ROW_BELOW:S=w(S),e.UserAction.InsertCopyRow(s,u,l,S)}}else ZSClass.ZSAlert(I["InsertRow.Alert.InsertingNotPossibleBeyondMaxRow"],{title:I["Alert.Title.RowLimitExceeded"]})}S.constructMenuItemLayout=function(){var e=s.createElement("li");return e.id=E.SUBMENUITEM+c.INSERT_ROW+E.IDENTITY,e.setAttribute("data",'{"icon": "zicon zicon-insert-row-above","label": "'+I["HomeTab.Row.Insert"]+'"}'),e.addEventListener("click",function(){O(c.INSERT_ROW)}),e},S.constructRowAboveMenuItem=function(){var e=s.createElement("li");return e.id=E.SUBMENUITEM+c.INSERT_ROW_ABOVE+E.IDENTITY,e.setAttribute("data",'{"icon": "zicon zicon-insert-row-above","label": "'+I.RowAbove+'"}'),e.addEventListener("click",function(){O(c.INSERT_ROW_ABOVE)}),e},S.constructRowBelowMenuItem=function(){var e=s.createElement("li");return e.id=E.SUBMENUITEM+c.INSERT_ROW_BELOW+E.IDENTITY,e.setAttribute("data",'{"icon": "zicon zicon-insert-row-below","label": "'+I.RowBelow+'"}'),e.addEventListener("click",function(){O(c.INSERT_ROW_BELOW)}),e},S.constructCopyRowAboveMenuItem=function(){var e=s.createElement("li");return e.id=E.SUBMENUITEM+c.INSERT_COPY_ROW_ABOVE+E.IDENTITY,e.setAttribute("data",'{"icon": "zicon zicon-insert-row-above","label": "'+I["Insert.Copied.Rows.Above"]+'"}'),e.addEventListener("click",function(){O(c.INSERT_COPY_ROW_ABOVE)}),e},S.constructCopyRowBelowMenuItem=function(){var e=s.createElement("li");return e.id=E.SUBMENUITEM+c.INSERT_COPY_ROW_BELOW+E.IDENTITY,e.setAttribute("data",'{"icon": "zicon zicon-insert-row-below","label": "'+I["Insert.Copied.Rows.Below"]+'"}'),e.addEventListener("click",function(){O(c.INSERT_COPY_ROW_BELOW)}),e},S.constructCutRowAboveMenuItem=function(){var e=s.createElement("li");return e.id=E.SUBMENUITEM+c.INSERT_CUT_ROW_ABOVE+E.IDENTITY,e.setAttribute("data",'{"icon": "zicon zicon-insert-row-above","label": "'+I["Insert.Cut.Rows.Above"]+'"}'),e.addEventListener("click",function(){O(c.INSERT_CUT_ROW_ABOVE)}),e},S.constructCutRowBelowMenuItem=function(){var e=s.createElement("li");return e.id=E.SUBMENUITEM+c.INSERT_CUT_ROW_BELOW+E.IDENTITY,e.setAttribute("data",'{"icon": "zicon zicon-insert-row-below","label": "'+I["Insert.Cut.Rows.Below"]+'"}'),e.addEventListener("click",function(){O(c.INSERT_CUT_ROW_BELOW)}),e},S.execute=O;var d;JSUtil.fn.debounce(function(){_()},500);function _(e){if("TB_INSERT_POPUP_CONTAINER"==e.id){var o=t.view.getActiveGridID(),n=t.view.getSheetID(o),i=t.view.getSheetState(o,n),r=t.view.getResourceID(o),a=t.data.Defaults,s=i.getActiveRange(),I=t.view.getVersionID(o),l=t.data.getWorkBook(r,I);!(s.endRow+1!==a.MAX_ROW&&!l.ProtectedSheets.isSheetLocked(n))?u.disable("#"+E.MI+c.INSERT_ROW_OPTIONS+E.MENU):u.enable("#"+E.MI+c.INSERT_ROW_OPTIONS+E.MENU)}}function N(e){var o=e.id,n=t.view.getActiveGridID(),i=t.view.getResourceID(n),r=t.view.getSheetID(n),a=t.view.getSheetState(n,r),s=t.view.getVersionID(n),l=t.data.getWorkBook(i,s).getSheetObj(r),R=(t.data.Defaults,a.getActiveRange()),T=t.data.UserInfo,S=new ZSClass.Range(R.startRow,R.startCol,R.endRow,R.endCol),w=T.activeInfo.getVisualCueStatus(),O=t.data.UserInfo.activeInfo.isCopy;if(function(e){for(var t=e.querySelectorAll("li"),o=0;o<t.length;o++)t[o].style.display="none"}(e),w&&S.isRow()&&void 0!=O)0==O?(e.querySelector("#"+E.SUBMENUITEM+c.INSERT_CUT_ROW_ABOVE+E.IDENTITY).style.display="block",e.querySelector("#"+E.SUBMENUITEM+c.INSERT_CUT_ROW_BELOW+E.IDENTITY).style.display="block"):(e.querySelector("#"+E.SUBMENUITEM+c.INSERT_COPY_ROW_ABOVE+E.IDENTITY).style.display="block",e.querySelector("#"+E.SUBMENUITEM+c.INSERT_COPY_ROW_BELOW+E.IDENTITY).style.display="block");else{var d,_,N=R.endRow-R.startRow+1;(N-=l.Row.Visibility.getOnCount(R.startRow,R.endRow))>1?(d=JSUtil.fn.replaceParams(I.NoofRowsAbove,new Array(N+"")),_=JSUtil.fn.replaceParams(I.NoofRowsBelow,new Array(N+""))):(d=I.RowAbove,_=I.RowBelow),u.zmenu("#"+o,"setMenuItemsAttribute",["#"+E.SUBMENUITEM+c.INSERT_ROW_ABOVE+E.IDENTITY],"label",d),u.zmenu("#"+o,"setMenuItemsAttribute",["#"+E.SUBMENUITEM+c.INSERT_ROW_BELOW+E.IDENTITY],"label",_),e.querySelector("#"+E.SUBMENUITEM+c.INSERT_ROW_ABOVE+E.IDENTITY).style.display="block",e.querySelector("#"+E.SUBMENUITEM+c.INSERT_ROW_BELOW+E.IDENTITY).style.display="block"}}e.sPlusPlus.view.Events.Key.Entry.ShortCut.Context.keyDown[l.CTRL+"+"+l.ALT+"+"+l.EQUAL]=function(e,t,o,n){O(c.INSERT_ROW_ABOVE),e.preventDefault()},(d=document.createElement("ul")).id=E.SUBMENUITEM+c.INSERT_ROW_OPTIONS+E.IDENTITY,d.setAttribute("ctype","zmenu"),d.setAttribute("relativeto","parent"),d.appendChild(S.constructRowAboveMenuItem()),d.appendChild(S.constructRowBelowMenuItem()),d.appendChild(S.constructCopyRowAboveMenuItem()),d.appendChild(S.constructCopyRowBelowMenuItem()),d.appendChild(S.constructCutRowAboveMenuItem()),d.appendChild(S.constructCutRowBelowMenuItem()),R.appendChild(d),u.bind(d,"zmenubeforeshow",function(){N(d)}),S.execute=O,S.changeRowOptions=N,i.register(r.UI,a.Toolbar.INIT_MENU,_,"DOM")}(this);
!function(e){var t=e.sPlusPlus,n=e.document,o=e.ZSConstants,r=o.FeatureConstants,i=o.I18N,l=o.wCC,a=o.JSKeyCode,E=e.ZSEvents,s=E.topic,c=E.Groups,C=E.Names,I=(t.view.Toolbar.transient,n.getElementById("popupmenu")),u=(t.SML.Client,e.UIUtil.Component),T=t.data.UserInfo,N=t.view.Toolbar.Feature[r.INSERT_COLUMN_OPTIONS];function S(e){for(var n=t.data.Defaults,o=[],r=0;r<e.length;r++){var i=e[r],l=i.endCol-i.startCol+1;i.endCol==n.MAX_COL-1&&0==i.startCol||(i.endCol=i.endCol+l,i.startCol=i.startCol+l),o.push(i)}return o}function d(n){var o=t.view.getActiveGridID(),l=t.view.getResourceID(o),a=t.view.getSheetID(o),E=t.view.getVersionID(o),I=t.view.getSelectedSheets(o),u=t.view.getSheetState(o,a),N=u.getRanges(),d=t.view.CellEditor.getEditStatus(),U=t.data.getWorkBook(l,E),_=u.getActiveRange(),M=U.getSheetObj(a),R=_.startCol;if(function(e,n,o){var r=t.data.Defaults.MAX_COL;if(e.MaxUsedCol+o>=r||n===r||n+o>r)return!1;return!0}(M,R,_.endCol-R+1)){if(d&&s.publish(c.Gesture.Selector.CellEdit,C.GESTURE.ACTION.ENUMERATE,{RID:l,SHEETID:a,VERSION:E,isSubmittable:1}),T.activeInfo.getCopyState()&&(n==r.INSERT_COPY_COLUMN_AFTER||n==r.INSERT_COPY_COLUMN_BEFORE)){var O=T.activeInfo.copyRanges.Ranges;if(O&&O.length>1)return void ZSClass.ZSAlert(i["action.not.support.multiselection"],{title:i["Alert.Title.InvalidSelection"]})}switch(n){case r.INSERT_COL:case r.INSERT_COLUMN_BEFORE:case r.INSERT_COLUMN_OPTIONS:e.UserAction.InsertCol(l,I,E,N,!0);break;case r.INSERT_COLUMN_AFTER:N=S(N),e.UserAction.InsertCol(l,I,E,N,!1);break;case r.INSERT_CUT_COLUMN_BEFORE:e.UserAction.InsertCutCol(l,I,E,N);break;case r.INSERT_CUT_COLUMN_AFTER:N=S(N),e.UserAction.InsertCutCol(l,I,E,N);break;case r.INSERT_COPY_COLUMN_BEFORE:e.UserAction.InsertCopyCol(l,I,E,N);break;case r.INSERT_COPY_COLUMN_AFTER:N=S(N),e.UserAction.InsertCopyCol(l,I,E,N)}}else ZSClass.ZSAlert(i["InsertCol.Alert.InsertingNotPossibleBeyondMaxCol"],{title:i["Alert.Title.ColumnLimitExceeded"]})}N.constructMenuItemLayout=function(e){var t=n.createElement("li");return t.id=l.SUBMENUITEM+r.INSERT_COL+l.IDENTITY,t.setAttribute("data",'{"icon": "zicon zicon-insert-column-before","label": "'+i["HomeTab.Column.Insert"]+'"}'),t.addEventListener("click",function(){d(r.INSERT_COL)}),t},N.constructColBeforeMenuItem=function(e){var t=n.createElement("li");return t.id=l.SUBMENUITEM+r.INSERT_COLUMN_BEFORE+l.IDENTITY,t.setAttribute("data",'{"icon": "zicon zicon-insert-column-before","label": "'+i.ColumnBefore+'"}'),t.addEventListener("click",function(){d(r.INSERT_COLUMN_BEFORE)}),t},N.constructColAfterMenuItem=function(e){var t=n.createElement("li");return t.id=l.SUBMENUITEM+r.INSERT_COLUMN_AFTER+l.IDENTITY,t.setAttribute("data",'{"icon": "zicon zicon-insert-column-after","label": "'+i.ColumnAfter+'"}'),t.addEventListener("click",function(){d(r.INSERT_COLUMN_AFTER)}),t},N.constructCopyColBeforeMenuItem=function(e){var t=n.createElement("li");return t.id=l.SUBMENUITEM+r.INSERT_COPY_COLUMN_BEFORE+l.IDENTITY,t.setAttribute("data",'{"icon": "zicon zicon-insert-column-before","label": "'+i["Insert.Copied.Columns.Before"]+'"}'),t.addEventListener("click",function(){d(r.INSERT_COPY_COLUMN_BEFORE)}),t},N.constructCopyColAfterMenuItem=function(e){var t=n.createElement("li");return t.id=l.SUBMENUITEM+r.INSERT_COPY_COLUMN_AFTER+l.IDENTITY,t.setAttribute("data",'{"icon": "zicon zicon-insert-column-after","label": "'+i["Insert.Copied.Columns.After"]+'"}'),t.addEventListener("click",function(){d(r.INSERT_COPY_COLUMN_AFTER)}),t},N.constructCutColBeforeMenuItem=function(e){var t=n.createElement("li");return t.id=l.SUBMENUITEM+r.INSERT_CUT_COLUMN_BEFORE+l.IDENTITY,t.setAttribute("data",'{"icon": "zicon zicon-insert-column-before","label": "'+i["Insert.Cut.Columns.Before"]+'"}'),t.addEventListener("click",function(){d(r.INSERT_CUT_COLUMN_BEFORE)}),t},N.constructCutColAfterMenuItem=function(e){var t=n.createElement("li");return t.id=l.SUBMENUITEM+r.INSERT_CUT_COLUMN_AFTER+l.IDENTITY,t.setAttribute("data",'{"icon": "zicon zicon-insert-column-after","label": "'+i["Insert.Cut.Columns.After"]+'"}'),t.addEventListener("click",function(){d(r.INSERT_CUT_COLUMN_AFTER)}),t};var U;JSUtil.fn.debounce(function(){_()},500);function _(e){if("TB_INSERT_POPUP_CONTAINER"==e.id){var n=t.data.Defaults,o=t.view.getActiveGridID(),i=t.view.getResourceID(o),a=t.view.getSheetID(o),E=t.view.getSheetState(o,a).getActiveRange(),s=t.view.getVersionID(o),c=t.data.getWorkBook(i,s);!(E.endCol+1!==n.MAX_COL&&!c.ProtectedSheets.isSheetLocked(a))?u.disable("#"+l.MI+r.INSERT_COLUMN_OPTIONS+l.MENU):u.enable("#"+l.MI+r.INSERT_COLUMN_OPTIONS+l.MENU)}}e.sPlusPlus.view.Events.Key.Entry.ShortCut.Context.keyDown[a.CTRL+"+"+a.SHIFT+"+"+a.EQUAL]=function(e){e.preventDefault(),d(r.INSERT_COLUMN_BEFORE)},(U=document.createElement("ul")).id=l.SUBMENUITEM+r.INSERT_COLUMN_OPTIONS+l.IDENTITY,U.setAttribute("ctype","zmenu"),U.setAttribute("relativeto","parent"),U.appendChild(N.constructColBeforeMenuItem(U)),U.appendChild(N.constructColAfterMenuItem(U)),U.appendChild(N.constructCopyColBeforeMenuItem(U)),U.appendChild(N.constructCopyColAfterMenuItem(U)),U.appendChild(N.constructCutColBeforeMenuItem(U)),U.appendChild(N.constructCutColAfterMenuItem(U)),I.appendChild(U),u.bind(U,"zmenubeforeshow",function(){!function(e){var n,o,a=e.id,E=(t.data.Defaults,t.view.getActiveGridID()),s=t.view.getResourceID(E),c=t.view.getSheetID(E),C=t.view.getVersionID(E),I=t.data.getWorkBook(s,C).getSheetObj(c),T=t.view.getSheetState(E,c).getActiveRange(),N=t.data.UserInfo,S=new ZSClass.Range(T.startRow,T.startCol,T.endRow,T.endCol),d=N.activeInfo.getVisualCueStatus(),U=t.data.UserInfo.activeInfo.isCopy;if(function(e){for(var t=e.querySelectorAll("li"),n=0;n<t.length;n++)t[n].style.display="none"}(e),d&&S.isCol()&&void 0!=U)0==U?(e.querySelector("#"+l.SUBMENUITEM+r.INSERT_CUT_COLUMN_BEFORE+l.IDENTITY).style.display="block",e.querySelector("#"+l.SUBMENUITEM+r.INSERT_CUT_COLUMN_AFTER+l.IDENTITY).style.display="block"):(e.querySelector("#"+l.SUBMENUITEM+r.INSERT_COPY_COLUMN_BEFORE+l.IDENTITY).style.display="block",e.querySelector("#"+l.SUBMENUITEM+r.INSERT_COPY_COLUMN_AFTER+l.IDENTITY).style.display="block");else{var _=T.endCol-T.startCol+1;(_-=I.Column.hidden.getOnCount(T.startCol,T.endCol))>1?(n=JSUtil.fn.replaceParams(i.NoofColumnsBefore,new Array(_+"")),o=JSUtil.fn.replaceParams(i.NoofColumnsAfter,new Array(_+""))):(n=i.ColumnBefore,o=i.ColumnAfter),u.zmenu("#"+a,"setMenuItemsAttribute",["#"+l.SUBMENUITEM+r.INSERT_COLUMN_BEFORE+l.IDENTITY],"label",n),u.zmenu("#"+a,"setMenuItemsAttribute",["#"+l.SUBMENUITEM+r.INSERT_COLUMN_AFTER+l.IDENTITY],"label",o),e.querySelector("#"+l.SUBMENUITEM+r.INSERT_COLUMN_BEFORE+l.IDENTITY).style.display="block",e.querySelector("#"+l.SUBMENUITEM+r.INSERT_COLUMN_AFTER+l.IDENTITY).style.display="block"}}(U)}),N.execute=d,s.register(c.UI,C.Toolbar.INIT_MENU,_,"DOM")}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSConstants.FeatureConstants,n=e.ZSEvents,s=n.topic,o=n.Groups,l=n.Names,r=e.ZSConstants.I18N,I=e.document,E=e.ZSConstants.wCC,c=(t.view.Toolbar.transient,I.getElementById("popupmenu")),a=e.UIUtil.Component,S=t.view.Toolbar.Feature[i.INSERT_CELL_OPTIONS];S.constructCellsToRightMenuItem=function(e){var t=I.createElement("li");return t.id=E.SUBMENUITEM+i.SHIFT_CELLS_RIGHT+E.IDENTITY,t.setAttribute("data",'{"icon": "zsicon zsicon-shift-cells-right","label": "'+r["Shift.Cells.To.The.Right"]+'"}'),t.addEventListener("click",d),t},S.constructCellsDownMenuItem=function(e){var t=I.createElement("li");return t.id=E.SUBMENUITEM+i.SHIFT_CELLS_DOWN+E.IDENTITY,t.setAttribute("data",'{"icon": "zsicon zsicon-shift-cells-down","label": "'+r["Shift.Cells.Down"]+'"}'),t.addEventListener("click",v),t};var u;JSUtil.fn.debounce(function(){buttonState&&T()},500);function T(e){if("TB_INSERT_POPUP_CONTAINER"==e.id){var n=t.view.getActiveGridID(),s=t.view.getSheetID(n),o=t.view.getResourceID(n),l=t.view.getVersionID(n),r=t.data.getWorkBook(o,l),I=t.view.getSheetState(n,s).getActiveRange(),c=t.data.Defaults;!(I.endRow+1!==c.MAX_ROW&&!r.ProtectedSheets.isSheetLocked(s))?a.disable("#"+E.MI+i.INSERT_CELL_OPTIONS+E.MENU):a.enable("#"+E.MI+i.INSERT_CELL_OPTIONS+E.MENU)}}function d(){var i=t.view.getActiveGridID(),n=t.view.getResourceID(i),r=t.view.getSheetID(i),I=t.view.getSelectedSheets(i),E=t.view.getVersionID(i);t.view.CellEditor.getEditStatus()&&s.publish(o.Gesture.Selector.CellEdit,l.GESTURE.ACTION.ENUMERATE,{RID:n,SHEETID:r,VERSION:E,isSubmittable:1}),e.UserAction.InsertCellLeft(n,I,E)}function v(){var i=t.view.getActiveGridID(),n=t.view.getResourceID(i),r=t.view.getSheetID(i),I=t.view.getVersionID(i),E=t.view.getSelectedSheets(i);t.view.CellEditor.getEditStatus()&&s.publish(o.Gesture.Selector.CellEdit,l.GESTURE.ACTION.ENUMERATE,{RID:n,SHEETID:r,VERSION:I,isSubmittable:1}),e.UserAction.InsertCellTop(n,E,I)}(u=document.createElement("ul")).setAttribute("ctype","zmenu"),u.setAttribute("relativeto","parent"),u.id=E.SUBMENUITEM+i.INSERT_CELL_OPTIONS+E.IDENTITY,u.appendChild(S.constructCellsDownMenuItem()),u.appendChild(S.constructCellsToRightMenuItem()),c.appendChild(u),S.doShiftRight=d,s.register(o.UI,l.Toolbar.INIT_MENU,T,"DOM")}(this);
!function(e){var t,i=e.sPlusPlus,l=e.document,n=l.getElementById("popupmenu"),s=e.ZSConstants.FeatureConstants,r=e.ZSConstants.wCC,E=e.ZSConstants.I18N,o=(i.view.Toolbar.transient,e.UIUtil.Component),u=e.ZSEvents,I=u.topic,a=u.Groups,c=u.Names,S=i.view.Toolbar.Feature[s.CELL_OPTIONS],T=i.view.Toolbar.Feature[s.INSERT_CELL_OPTIONS];function d(e){var t=l.createElement("li");return t.setAttribute("mtype","group"),t.setAttribute("relativeto","parent"),t.setAttribute("data",'{"label": "'+e+'"}'),t}function C(){var t=i.view.getActiveGridID(),l=i.view.getResourceID(t),n=i.view.getSheetID(t),s=i.view.getVersionID(t),r=i.view.getSelectedSheets(t);i.view.CellEditor.getEditStatus()&&I.publish(a.Gesture.Selector.CellEdit,c.GESTURE.ACTION.ENUMERATE,{RID:l,SHEETID:n,VERSION:s,isSubmittable:1}),e.UserAction.DeleteCellRight(l,r,s)}function v(){var t=i.view.getActiveGridID(),l=i.view.getResourceID(t),n=i.view.getSheetID(t),s=i.view.getVersionID(t),r=i.view.getSelectedSheets(t);i.view.CellEditor.getEditStatus()&&I.publish(a.Gesture.Selector.CellEdit,c.GESTURE.ACTION.ENUMERATE,{RID:l,SHEETID:n,VERSION:s,isSubmittable:1}),e.UserAction.DeleteCellBottom(l,r,s)}S.constructCellsLeftMenuItem=function(e){var t=l.createElement("li");return t.id=r.SUBMENUITEM+s.SHIFT_CELLS_LEFT+r.IDENTITY,t.setAttribute("data",'{"icon": "zsicon zsicon-shift-cells-left","label": "'+E["Shift.Cells.To.The.Left"]+'"}'),t.addEventListener("click",C),t},S.constructCellsUpMenuItem=function(e){var t=l.createElement("li");return t.id=r.SUBMENUITEM+s.SHIFT_CELLS_UP+r.IDENTITY,t.setAttribute("data",'{"icon": "zsicon zsicon-shift-cells-up","label": "'+E["Shift.Cells.Up"]+'"}'),t.addEventListener("click",v),t},(t=document.createElement("ul")).id=r.SUBMENUITEM+s.CELL_OPTIONS+r.IDENTITY,t.setAttribute("ctype","zmenu"),t.appendChild(d(E["MenuTab.Tab.Insert"])),t.appendChild(T.constructCellsToRightMenuItem()),t.appendChild(T.constructCellsDownMenuItem()),t.appendChild(d(E.Delete)),t.appendChild(S.constructCellsLeftMenuItem()),t.appendChild(S.constructCellsUpMenuItem()),n.appendChild(t),o.bind(t,"menubeforeshow",function(){var e,l,n,E,u,I,a,c,S,T,d,C,v;l=(e=t).querySelector("#"+r.SUBMENUITEM+s.SHIFT_CELLS_DOWN+r.IDENTITY),n=e.querySelector("#"+r.SUBMENUITEM+s.SHIFT_CELLS_UP+r.IDENTITY),E=e.querySelector("#"+r.SUBMENUITEM+s.SHIFT_CELLS_RIGHT+r.IDENTITY),u=e.querySelector("#"+r.SUBMENUITEM+s.SHIFT_CELLS_LEFT+r.IDENTITY),I=i.view.getActiveGridID(),a=i.view.getSheetID(I),c=i.view.getSheetState(I,a).getActiveRange(),S=i.data.Defaults,T=c.endRow+1===S.MAX_ROW,d=c.endCol+1===S.MAX_COL,C=T?"disable":"enable",v=d?"disable":"enable",o[C](l),o[C](n),o[v](E),o[v](u)})}(this);
!function(e){var t,n=e.sPlusPlus,i=e.document,a=i.getElementById("popupmenu"),o=e.ZSConstants.FeatureConstants,l=e.ZSConstants.I18N,u=e.ZSConstants.wCC,r=(n.view.Toolbar.transient,n.SML.Client,e.UIUtil.Component),E=(n.data.Defaults.MAX_ROW,e.ZSEvents),s=E.topic,I=E.Groups,c=E.Names,T=n.view.Toolbar.Feature[o.INSERT_COLUMN_OPTIONS],C=n.view.Toolbar.Feature[o.COL_OPTIONS];function d(e){var t=i.createElement("li");return t.id=u.SUBMENUITEM+o.COLUMN_WIDTH+u.IDENTITY,t.setAttribute("data",'{"icon": "custFitCol","label": "'+l["HomeTab.Column.CustomFit"]+'"}'),t.addEventListener("click",function(){C.showDialog()}),t}function m(e){var t=i.createElement("li");return t.id=u.SUBMENUITEM+o.COLUMN_FIT+u.IDENTITY,t.setAttribute("data",'{"icon": "autoFitCol","label": "'+l["HomeTab.Column.AutoFit"]+'"}'),t.addEventListener("click",v),t}function S(e){var t=i.createElement("li");return t.setAttribute("mtype","group"),t.setAttribute("relativeto","parent"),t.setAttribute("data",'{"label": "'+e+'"}'),t}function N(){var t=n.view.getActiveGridID(),i=n.view.getResourceID(t),a=n.view.getSheetID(t),o=n.view.getVersionID(t),l=n.view.getSheetState(t,a),u=n.view.getSelectedSheets(t),r=n.view.CellEditor.getEditStatus(),E=l.getRanges();r&&s.publish(I.Gesture.Selector.CellEdit,c.GESTURE.ACTION.ENUMERATE,{RID:i,SHEETID:a,VERSION:o,isSubmittable:1}),e.UserAction.DeleteCol(i,u,o,E)}function v(){var t=n.view.getActiveGridID(),i=n.view.getResourceID(t),a=n.view.getSheetID(t),o=n.view.getVersionID(t),l=n.data.getWorkBook(i,o).getSheetObj(a),u=n.view.getSheetState(t,a).getActiveRange(),r=u.endCol,E=u.startCol,s=r-E+1,I=l.Column.auxiliaryAxis.getDim(E),c=n.view.getSelectedSheets(t);e.UserAction.ResizeCol(i,c,o,I,E,s,!0)}C.constructMenuItemLayout=function(e){var t=i.createElement("li");return t.id=u.SUBMENUITEM+o.DELETE_COLUMN+u.IDENTITY,t.setAttribute("data",'{"icon": "zicon zicon-delete-column","label": "'+l["HomeTab.Column.Delete"]+'"}'),t.addEventListener("click",N),t},C.constructCustomFitMenuItemLayout=d,C.constructAutoFitMenuItemLayout=m,(t=document.createElement("ul")).id=u.SUBMENUITEM+o.COL_OPTIONS+u.IDENTITY,t.setAttribute("ctype","zmenu"),t.appendChild(S(l["MenuItem.InsertTab.Column"])),T&&t.appendChild(T.constructMenuItemLayout(t)),t.appendChild(C.constructMenuItemLayout(t)),t.appendChild(S(l["HomeTab.Column.ColumnWidth"])),t.appendChild(m()),t.appendChild(d()),a.appendChild(t),r.bind(t,"menubeforeshow",function(){var e,i,a,E,s,I,c,T,C,d,m,S;i=(e=t).id,a=n.view.getActiveGridID(),E=n.view.getSheetID(a),s=n.view.getSheetState(a,E),I=n.data.Defaults,c=s.getActiveRange(),T=c.endCol+1===I.MAX_COL,C=T?"disable":"enable",d=e.querySelector("#"+u.SUBMENUITEM+o.INSERT_COL+u.IDENTITY),m=e.querySelector("#"+u.SUBMENUITEM+o.DELETE_COLUMN+u.IDENTITY),S=c.endCol-c.startCol+1,r[C](d),r[C](m),S>1&&!T?(r.zmenu("#"+i,"changeLabel",u.SUBMENUITEM+o.INSERT_COL+u.IDENTITY,JSUtil.fn.replaceParams(l["HomeTab.Column.InsertNoofCols"],new Array(S+""))),r.zmenu("#"+i,"changeLabel",u.SUBMENUITEM+o.DELETE_COLUMN+u.IDENTITY,JSUtil.fn.replaceParams(l["HomeTab.Column.DeleteNoofCols"],new Array(S+"")))):(r.zmenu("#"+i,"changeLabel",u.SUBMENUITEM+o.INSERT_COL+u.IDENTITY,l["HomeTab.Column.Insert"]),r.zmenu("#"+i,"changeLabel",u.SUBMENUITEM+o.DELETE_COLUMN+u.IDENTITY,l["HomeTab.Column.Delete"]))}),C.deleteCol=N}(this);
!function(e){var t,n=e.sPlusPlus,i=e.document,o=i.getElementById("popupmenu"),a=e.ZSConstants.FeatureConstants,r=e.ZSConstants.I18N,u=e.ZSConstants.wCC,l=(n.view.Toolbar.transient,n.SML.Client,e.UIUtil.Component),E=(n.data.Defaults.MAX_COL,e.ZSEvents),s=E.topic,I=E.Groups,c=E.Names,T=n.view.Toolbar.Feature[a.INSERT_ROW_OPTIONS],d=n.view.Toolbar.Feature[a.ROW_OPTIONS];function R(e){var t=i.createElement("li");return t.id=u.SUBMENUITEM+a.ROW_FIT+u.IDENTITY,t.setAttribute("data",'{"icon": "autoFitRow","label": "'+r["HomeTab.Row.AutoFit"]+'"}'),t.addEventListener("click",v),t}function w(e){var t=document.createElement("li");return t.id=u.SUBMENUITEM+a.ROW_HEIGHT+u.IDENTITY,t.setAttribute("data",'{"icon": "custFitRow","label": "'+r["HomeTab.Row.CustomFit"]+'"}'),t.addEventListener("click",function(){d.showDialog()}),t}function S(e){var t=i.createElement("li");return t.setAttribute("mtype","group"),t.setAttribute("relativeto","parent"),t.setAttribute("data",'{"label": "'+e+'"}'),t}function m(){var t=n.view.getActiveGridID(),i=n.view.getResourceID(t),o=n.view.getSheetID(t),a=n.view.getVersionID(t),r=n.view.getSheetState(t,o).getRanges(),u=n.view.getSelectedSheets(t);n.view.CellEditor.getEditStatus()&&s.publish(I.Gesture.Selector.CellEdit,c.GESTURE.ACTION.ENUMERATE,{RID:i,SHEETID:o,VERSION:a,isSubmittable:1}),e.UserAction.DeleteRow(i,u,a,r)}function v(){var t=n.view.getActiveGridID(),i=n.view.getResourceID(t),o=n.view.getSheetID(t),a=n.view.getVersionID(t),r=n.data.getWorkBook(i,a).getSheetObj(o),u=n.view.getSheetState(t,o).getActiveRange(),l=u.endRow,E=u.startRow,s=l-E+1,I=r.Row.auxiliaryAxis.getDim(E),c=n.view.getSelectedSheets(t);e.UserAction.ResizeRow(i,c,a,I,E,s,!0)}d.constructMenuItemLayout=function(e){var t=i.createElement("li");return t.id=u.SUBMENUITEM+a.DELETE_ROW+u.IDENTITY,t.setAttribute("data",'{"icon": "zicon zicon zicon-deleterow","label": "'+r["HomeTab.Row.Delete"]+'"}'),t.addEventListener("click",m),t},d.constructAutoFitMenuItemLayout=R,d.constructCustomFitMenuItemLayout=w,(t=document.createElement("ul")).id=u.SUBMENUITEM+a.ROW_OPTIONS+u.IDENTITY,t.setAttribute("ctype","zmenu"),t.appendChild(S(r["MenuItem.InsertTab.Row"])),T&&t.appendChild(T.constructRowAboveMenuItem(t)),t.appendChild(d.constructMenuItemLayout(t)),t.appendChild(S(r["HomeTab.Row.RowHeight"])),t.appendChild(R()),t.appendChild(w()),o.appendChild(t),l.bind(t,"menubeforeshow",function(){var e,i,o,E,s,I,c,T,d,R,w,S;i=(e=t).id,o=n.view.getActiveGridID(),E=n.view.getSheetID(o),s=n.view.getSheetState(o,E),I=n.data.Defaults,c=s.getActiveRange(),T=c.endRow+1===I.MAX_ROW,d=T?"disable":"enable",R=c.endRow-c.startRow+1,w=e.querySelector("#"+u.SUBMENUITEM+a.INSERT_ROW+u.IDENTITY),S=e.querySelector("#"+u.SUBMENUITEM+a.DELETE_ROW+u.IDENTITY),l[d](w),l[d](S),R>1&&!T?(l.zmenu("#"+i,"changeLabel",u.SUBMENUITEM+a.INSERT_ROW+u.IDENTITY,JSUtil.fn.replaceParams(r["HomeTab.Row.InsertNoofRows"],new Array(R+""))),l.zmenu("#"+i,"changeLabel",u.SUBMENUITEM+a.DELETE_ROW+u.IDENTITY,JSUtil.fn.replaceParams(r["HomeTab.Row.DeleteNoofRows"],new Array(R+"")))):(l.zmenu("#"+i,"changeLabel",u.SUBMENUITEM+a.INSERT_ROW+u.IDENTITY,r["HomeTab.Row.Insert"]),l.zmenu("#"+i,"changeLabel",u.SUBMENUITEM+a.DELETE_ROW+u.IDENTITY,r["HomeTab.Row.Delete"]))}),d.deleteRow=m}(this);
!function(e){var t=e.sPlusPlus,o=e.ZSConstants.FeatureConstants,l=e.ZSEvents,n=l.topic,I=l.Groups,r=l.Names,a=e.document,s=e.ZSConstants.I18N,E=e.ZSConstants.wCC,i=(t.view.SubMenu.transient,a.getElementById("popupmenu")),T=!1,u=e.UIUtil.Component,d=t.view.Toolbar.Feature[o.INSERT_CELL_OPTIONS],c=t.view.Toolbar.Feature[o.INSERT_ROW_OPTIONS],S=t.view.Toolbar.Feature[o.INSERT_COLUMN_OPTIONS];var N,C=((N=a.createElement("li")).setAttribute("mtype","separator"),N);!function(){if(!T){var e=document.createElement("ul");e.id=E.SUBMENUITEM+o.INSERT+E.IDENTITY,e.setAttribute("ctype","zmenu"),e.setAttribute("data",'{"componentOptions":{"type":"text_only"}}'),e.appendChild(c.constructRowAboveMenuItem(e)),e.appendChild(c.constructRowBelowMenuItem(e)),e.appendChild(c.constructCopyRowAboveMenuItem(e)),e.appendChild(c.constructCopyRowBelowMenuItem(e)),e.appendChild(c.constructCutRowAboveMenuItem(e)),e.appendChild(c.constructCutRowBelowMenuItem(e));var l=C.cloneNode(!0);l.setAttribute("id",E.SP+o.INSERT+E.IDENTITY),e.appendChild(l),e.appendChild(S.constructColBeforeMenuItem(e)),e.appendChild(S.constructColAfterMenuItem(e)),e.appendChild(S.constructCopyColBeforeMenuItem(e)),e.appendChild(S.constructCopyColAfterMenuItem(e)),e.appendChild(S.constructCutColBeforeMenuItem(e)),e.appendChild(S.constructCutColAfterMenuItem(e));var n=C.cloneNode(!0);n.setAttribute("id",E.SP+o.SHIFT_CELLS_DOWN+E.IDENTITY),e.appendChild(n),e.appendChild(d.constructCellsToRightMenuItem()),e.appendChild(d.constructCellsDownMenuItem()),i.appendChild(e),T=!0,u.bind(e,"zmenubeforeshow",function(){!function(e){e.querySelectorAll("li");var l=t.view.getActiveGridID(),n=t.view.getResourceID(l),I=t.view.getSheetID(l),r=t.view.getSheetState(l,I),a=t.view.getVersionID(l),i=t.data.getWorkBook(n,a).getSheetObj(I),T=t.data.Defaults,d=r.getActiveRange(),c=t.data.UserInfo.activeInfo.getVisualCueStatus(),S=t.data.UserInfo.activeInfo.isCopy,N=t.data.UserInfo.activeInfo.copyRanges;if(function(e){for(var t=e.querySelectorAll("li"),o=0;o<t.length;o++)t[o].style.display="none"}(e),function(e,t,l,n){e.id==E.SUBMENUITEM+o.INSERT+E.IDENTITY&&t.endCol+1!=l.MAX_COL&&t.endRow+1!=l.MAX_ROW&&(e.querySelector("#"+E.SUBMENUITEM+o.SHIFT_CELLS_RIGHT+E.IDENTITY).style.display="block",e.querySelector("#"+E.SUBMENUITEM+o.SHIFT_CELLS_DOWN+E.IDENTITY).style.display="block",e.querySelector("#"+E.SP+o.SHIFT_CELLS_DOWN+E.IDENTITY).style.display="block")}(e,d,T),d.endRow+1!=T.MAX_ROW){var C=i.Row.Visibility.getOnCount(d.startRow,d.endRow);!function(e,t,l,n,I,r,a){var i=0==t.startCol&&t.endCol==r.MAX_COL-1,T=I.Ranges?I.Ranges[0].startCol:void 0,d=I.Ranges?I.Ranges[0].endCol:void 0;if(i&&l&&0==T&&d+1==r.MAX_COL&&void 0!=n)0==n?(e.querySelector("#"+E.SUBMENUITEM+o.INSERT_CUT_ROW_ABOVE+E.IDENTITY).style.display="block",e.querySelector("#"+E.SUBMENUITEM+o.INSERT_CUT_ROW_BELOW+E.IDENTITY).style.display="block"):(e.querySelector("#"+E.SUBMENUITEM+o.INSERT_COPY_ROW_ABOVE+E.IDENTITY).style.display="block",e.querySelector("#"+E.SUBMENUITEM+o.INSERT_COPY_ROW_BELOW+E.IDENTITY).style.display="block");else{var c,S,N=t.endRow-t.startRow+1;(N-=a)>1?(c=JSUtil.fn.replaceParams(s.NoofRowsAbove,new Array(N+"")),S=JSUtil.fn.replaceParams(s.NoofRowsBelow,new Array(N+""))):(c=s.RowAbove,S=s.RowBelow),u.zmenu("#"+e.id,"setMenuItemsAttribute",["#"+E.SUBMENUITEM+o.INSERT_ROW_ABOVE+E.IDENTITY],"label",c),u.zmenu("#"+e.id,"setMenuItemsAttribute",["#"+E.SUBMENUITEM+o.INSERT_ROW_BELOW+E.IDENTITY],"label",S),e.querySelector("#"+E.SUBMENUITEM+o.INSERT_ROW_ABOVE+E.IDENTITY).style.display="block",e.querySelector("#"+E.SUBMENUITEM+o.INSERT_ROW_BELOW+E.IDENTITY).style.display="block"}}(e,d,c,S,N,T,C)}if(d.endCol+1!=T.MAX_COL){var R=i.Column.hidden.getOnCount(d.startCol,d.endCol);!function(e,t,l,n,I,r,a){var i=0==t.startRow&&t.endRow==r.MAX_ROW-1,T=I.Ranges?I.Ranges[0].startRow:void 0,d=I.Ranges?I.Ranges[0].endRow:void 0;if(i&&l&&0==T&&d+1==r.MAX_ROW&&void 0!=n)0==n?(e.querySelector("#"+E.SUBMENUITEM+o.INSERT_CUT_COLUMN_BEFORE+E.IDENTITY).style.display="block",e.querySelector("#"+E.SUBMENUITEM+o.INSERT_CUT_COLUMN_AFTER+E.IDENTITY).style.display="block"):(e.querySelector("#"+E.SUBMENUITEM+o.INSERT_COPY_COLUMN_BEFORE+E.IDENTITY).style.display="block",e.querySelector("#"+E.SUBMENUITEM+o.INSERT_COPY_COLUMN_AFTER+E.IDENTITY).style.display="block");else{var c,S,N=t.endCol-t.startCol+1;(N-=a)>1?(c=JSUtil.fn.replaceParams(s.NoofColumnsBefore,new Array(N+"")),S=JSUtil.fn.replaceParams(s.NoofColumnsAfter,new Array(N+""))):(c=s.ColumnBefore,S=s.ColumnAfter),u.zmenu("#"+e.id,"setMenuItemsAttribute",["#"+E.SUBMENUITEM+o.INSERT_COLUMN_BEFORE+E.IDENTITY],"label",c),u.zmenu("#"+e.id,"setMenuItemsAttribute",["#"+E.SUBMENUITEM+o.INSERT_COLUMN_AFTER+E.IDENTITY],"label",S),e.querySelector("#"+E.SUBMENUITEM+o.INSERT_COLUMN_BEFORE+E.IDENTITY).style.display="block",e.querySelector("#"+E.SUBMENUITEM+o.INSERT_COLUMN_AFTER+E.IDENTITY).style.display="block"}}(e,d,c,S,N,T,R)}d.endCol+1!=T.MAX_COL&&d.endRow+1!=T.MAX_ROW&&(e.querySelector("#"+E.SP+o.INSERT+E.IDENTITY).style.display="block")}(e)})}}(),n.register(I.UI,r.Menu.CONTEXT_BEFORE_SHOW,function(e){var l=e.id;if(l===E.MI+"GRID_CONTEXT"||l===E.MI+"ROWHEAD_CONTEXT"||l===E.MI+"COLHEAD_CONTEXT"){var n=t.view.getActiveGridID(),I=t.view.getResourceID(n),r=t.view.getSheetID(n),a=t.view.getSheetState(n,r),s=t.data.Defaults,i=a.getActiveRange(),T=t.view.getVersionID(n),u=t.data.getWorkBook(I,T).ProtectedSheets.isSheetLocked(r),d=e.querySelector("#"+E.MI+o.INSERT+E.IDENTITY);i.endCol+1==s.MAX_COL&&i.endRow+1==s.MAX_ROW||u?d&&(d.style.display="none"):d&&(d.style.display="flex")}},"UI")}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,o=n.topic,l=n.Groups,i=n.Names,a=e.ZSConstants.FeatureConstants,s=e.document,r=e.ZSConstants.I18N,E=e.ZSConstants.wCC,u=(t.view.SubMenu.transient,s.getElementById("popupmenu")),I=!1,T=(t.SML.Client,e.UIUtil.Component),d=t.view.Toolbar.Feature[a.CELL_OPTIONS],S=t.view.Toolbar.Feature[a.ROW_OPTIONS],c=t.view.Toolbar.Feature[a.COL_OPTIONS],C=t.data.Defaults;var M,p=((M=s.createElement("li")).setAttribute("mtype","separator"),M);!function(e,n){if(!I){var o=document.createElement("ul");o.id=E.SUBMENUITEM+a.DELETE+E.IDENTITY,o.setAttribute("ctype","zmenu"),o.setAttribute("data",'{"componentOptions":{"type":"text_only"}}'),o.appendChild(S.constructMenuItemLayout()),o.appendChild(c.constructMenuItemLayout());var l=p.cloneNode(!0);l.setAttribute("id",E.SP+a.SHIFT_CELLS_UP+E.IDENTITY),o.appendChild(l),o.appendChild(d.constructCellsUpMenuItem()),o.appendChild(d.constructCellsLeftMenuItem()),u.appendChild(o),I=!0,T.bind(o,"zmenubeforeshow",function(e,n){!function(e){e.id;for(var n=t.view.getActiveGridID(),o=t.view.getSheetID(n),l=t.view.getResourceID(n),i=t.view.getVersionID(n),s=t.view.getSheetState(n,o).getRanges(),u=t.data.getWorkBook(l,i).getSheetObj(o),I=0,d=0;d<s.length;d++)I+=s[d].endRow-s[d].startRow+1,I-=u.Row.Visibility.getOnCount(s[d].startRow,s[d].endRow);for(var S=0,d=0;d<s.length;d++)S+=S=s[d].endCol-s[d].startCol+1,S-=u.Column.hidden.getOnCount(s[d].startCol,s[d].endCol);(function(e){for(var t=e.querySelectorAll("li"),n=0;n<t.length;n++)t[n].style.display="block"})(e),function(e,t){var n=e.querySelector("#"+E.SUBMENUITEM+a.DELETE_ROW+E.IDENTITY);if(n&&(n.style.display="block"),t>=C.MAX_ROW)n&&(n.style.display="none");else if(t>1){var o=JSUtil.fn.replaceParams(r["HomeTab.Row.DeleteNoofRows"],new Array(t+""));T.zmenu("#"+e.id,"setMenuItemsAttribute",["#"+E.SUBMENUITEM+a.DELETE_ROW+E.IDENTITY],"label",o)}else T.zmenu("#"+e.id,"setMenuItemsAttribute",["#"+E.SUBMENUITEM+a.DELETE_ROW+E.IDENTITY],"label",r["HomeTab.Row.Delete"])}(e,I),function(e,t){var n=e.querySelector("#"+E.SUBMENUITEM+a.DELETE_COLUMN+E.IDENTITY);if(n&&(n.style.display="block"),t>=C.MAX_COL)n&&(n.style.display="none");else if(t>1){var o=JSUtil.fn.replaceParams(r["HomeTab.Column.DeleteNoofCols"],new Array(t+""));T.zmenu("#"+e.id,"setMenuItemsAttribute",["#"+E.SUBMENUITEM+a.DELETE_COLUMN+E.IDENTITY],"label",o)}else T.zmenu("#"+e.id,"setMenuItemsAttribute",["#"+E.SUBMENUITEM+a.DELETE_COLUMN+E.IDENTITY],"label",r["HomeTab.Column.Delete"])}(e,S),function(e,t,n){t!==C.MAX_COL&&n!==C.MAX_ROW||(e.querySelector("#"+E.SUBMENUITEM+a.SHIFT_CELLS_LEFT+E.IDENTITY).style.display="none",e.querySelector("#"+E.SUBMENUITEM+a.SHIFT_CELLS_UP+E.IDENTITY).style.display="none",e.querySelector("#"+E.SP+a.SHIFT_CELLS_UP+E.IDENTITY).style.display="none")}(e,S,I)}(o)})}}(),o.register(l.UI,i.Menu.CONTEXT_BEFORE_SHOW,function(e){var n=e.id;if(n===E.MI+"GRID_CONTEXT"||n===E.MI+"ROWHEAD_CONTEXT"||n===E.MI+"COLHEAD_CONTEXT"){var o=t.view.getActiveGridID(),l=t.view.getResourceID(o),i=t.view.getSheetID(o),s=t.view.getSheetState(o,i).getActiveRange(),r=t.view.getVersionID(o),u=t.data.getWorkBook(l,r).ProtectedSheets.isSheetLocked(i),I=e.querySelector("#"+E.MI+a.DELETE+E.IDENTITY);s.endCol+1==C.MAX_COL&&s.endRow+1==C.MAX_ROW||u?I&&(I.style.display="none"):I&&(I.style.display="flex")}},"UI")}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,u=t.ZSEvents,o=(u.topic,u.Groups,u.Names,t.document),s=(t.ZSConstants.I18N,t.ZSConstants.wCC),a=(e.view.SubMenu.transient,o.getElementById("popupmenu")),i=!1,p=(t.UIUtil.Component,e.view.Toolbar.Feature[n.ROW_OPTIONS]);!function(){if(!i){var t=document.createElement("ul");t.id=s.SUBMENUITEM+n.ROW_HEIGHT_OPTIONS+s.IDENTITY,t.setAttribute("ctype","zmenu"),t.setAttribute("data",'{"componentOptions":{"type":"text_only"}}'),t.setAttribute("relativeto","parent"),t.appendChild(p.constructAutoFitMenuItemLayout()),t.appendChild(p.constructCustomFitMenuItemLayout()),a.appendChild(t),i=!0}}()}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,u=t.ZSEvents,o=(u.topic,u.Groups,u.Names,t.document),s=(t.ZSConstants.I18N,t.ZSConstants.wCC),a=(e.view.SubMenu.transient,o.getElementById("popupmenu")),i=!1,p=(t.UIUtil.Component,e.view.Toolbar.Feature[n.COL_OPTIONS]);!function(){if(!i){var t=document.createElement("ul");t.id=s.SUBMENUITEM+n.COLUMN_WIDTH_OPTIONS+s.IDENTITY,t.setAttribute("ctype","zmenu"),t.setAttribute("data",'{"componentOptions":{"type":"text_only"}}'),t.setAttribute("relativeto","parent"),t.appendChild(p.constructAutoFitMenuItemLayout()),t.appendChild(p.constructCustomFitMenuItemLayout()),a.appendChild(t),i=!0}}()}(this);
!function(e){var t,i=e.sPlusPlus,r=e.ZSEvents,n=r.topic,o=r.Groups,s=r.Names,a=e.ZSConstants.FeatureConstants,c=e.document,u=!1,E=!0,I=(e.ZSConstants.I18N,e.ZSConstants.wCC),S=(e.UserAction,i.data.UserInfo),T=c.querySelector("#"+I.MI+a.FORMAT_PAINTER+I.IDENTITY),l=i.view.Toolbar.Feature[a.FORMAT_PAINTER];function v(e){var t=e.isProtected?"disable":"enable";$(u.parentNode).zbutton(t,"#"+I.MI+C.FORMAT_PAINTER+I.IDENTITY)}function d(){var e=i.view.getActiveGridID(),t=i.view.getResourceID(e),r=i.view.getSelectedSheets(e),a=i.view.getVersionID(e);if(UserAction.PasteFromSheet(t,r,a,void 0,!1),E){u=!u;var c=i.view.getSheetID(e);n.publish(o.Gesture.Selector.FormatPainter,s.GESTURE.ACTION.ENUMERATE,{RID:t,SHEETID:c,VERSION:a})}A(),m()}function m(){var t;u?(t=e.document.querySelector(".fpCur")).addEventListener("mouseup",d):"mainGrid fpCur"!=(t=e.document.querySelector(".mainGrid")).className&&t.removeEventListener("mouseup",d)}function A(){var t;u?"mainGrid fpCur"!=(t=e.document.querySelector(".mainGrid")).className&&(t.classList.add("fpCur"),T.parentNode.classList.add("shIconActive")):E&&((t=e.document.querySelector(".fpCur")).className="mainGrid",T.parentNode.classList.remove("shIconActive"))}function R(){var e=i.view.getActiveGridID(),t=i.view.getResourceID(e),r=i.view.getSheetID(e),a=i.view.getVersionID(e);S.activeInfo.setCopyState(0),u=!u,n.publish(o.Listener,s.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:t,SHEETID:r,VERSION:a}),u?n.publish(o.Gesture.Selector.FormatPainter,s.GESTURE.ACTION.ACTUATE,{RID:t,SHEETID:r,VERSION:a,isSingleTap:E}):(n.publish(o.Gesture.Selector.FormatPainter,s.GESTURE.ACTION.ENUMERATE,{RID:t,SHEETID:r,VERSION:a,isSingleTap:E}),E||(E=!0)),A(),m()}l.singleClick=function(e){t&&clearTimeout(t),t=setTimeout(function(){E=!0},500),R()},l.doubleClick=function(e){clearTimeout(t),E=!1,R()},n.register(o.Listener,s.ContextMenu.UPDATE,v,"CELL_VALUE"),l.negateFormatPainter=function(){if(u){var e=i.view.getActiveGridID(),t=i.view.getResourceID(e),r=i.view.getSheetID(e),a=i.view.getVersionID(e);u=!1,E=!0,A(),m(),n.publish(o.Gesture.Selector.FormatPainter,s.GESTURE.ACTION.ENUMERATE,{RID:t,SHEETID:r,VERSION:a})}}}(this);
!function(e){var t=e.ZSEvents,E=t.topic,S=t.Groups,r=t.Names,i=e.sPlusPlus,o=function(e,t,o,s){var I=i.view.getActiveGridID(),a=i.view.getSheetState(I,t),n=i.view.getSelectedSheets(I),R=a.getRanges();E.publish(S.Selector.BoundUpdate.FormatPainter,r.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:o,RANGES:R,SHEETS:n,IS_SERVER_CLIP:!1,IS_COPY:!0,Category:s})},s=function(e,t,i){E.publish(S.Selector.BoundUpdate.FormatPainter,r.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:t,VERSION:i})};E.register(S.Gesture.Selector.FormatPainter,r.GESTURE.ACTION.ACTUATE,o,"RID","SHEETID","VERSION","isSingleTap"),E.register(S.Gesture.Selector.FormatPainter,r.GESTURE.ACTION.ENUMERATE,s,"RID","SHEETID","VERSION")}(this);
!function(e){var t=e.sPlusPlus,a=e.ZSEvents,r=a.topic,i=a.Groups,o=a.Names,n=new ZSClass.IDGenerator,D={add:function(e,a,r,i,o,n,E,v){var S=t.data.getWorkBook(e,r).getSheetObj(a).Pivot;for(var d in i){var c=i[d];if(S.isIntersecting(c)&&!E)return}D.addData(e,o,r,i,n,E,v),D.addDOM(e,a,r)},addData:function(e,t,a,r,i,o,D){n.flush();var v=[];for(var S in r){var d=r[S],c=n.get();d.id=c,v.push(d)}E.addDetails(e,t,a,v,i,o,D)},addDOM:function(e,t,a){var n={RID:e,SHEETID:t,VERSION:a},D=E.ranges();for(var v in D){var S=D[v];n.ActiveRange=S,n.RANGEID=S.id,r.publish(i.Selector.DomUpdate.Copy,o.Selection.BOUND_UPDATE.ADD,n)}},remove:function(e,t,a){D.removeDOM(e,t,a),D.removeData(e,t,a)},removeData:function(e,t,a){E.clearDetails()},removeDOM:function(e,t,a){var n=E.ranges();for(var D in n){var v=n[D];r.publish(i.Selector.DomUpdate.Copy,o.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:t,VERSION:a,RANGEID:v.id})}}},E={ranges:function(){var e=t.view.getActiveGridID();return t.view.getActiveState(e).getFormatPainterRange().Ranges},addDetails:function(e,a,r,i,o,n,D){var E=t.view.getActiveGridID();t.view.getActiveState(E).addFormatPainterRange(e,a,r,i,o,n,D)},clearDetails:function(){var e=t.view.getActiveGridID();t.view.getActiveState(e).clearFormatPainter()}};r.register(i.Selector.BoundUpdate.FormatPainter,o.Selection.BOUND_UPDATE.ADD,D.add,"RID","SHEETID","VERSION","RANGES","SHEETS","IS_SERVER_CLIP","IS_COPY","Category"),r.register(i.Selector.BoundUpdate.FormatPainter,o.Selection.BOUND_UPDATE.REMOVE,D.remove,"RID","SHEETID","VERSION"),r.register(i.Selector.BoundUpdate.FormatPainter,o.Selection.BOUND_UPDATE.REMOVEDOM,D.removeDOM,"RID","SHEETID","VERSION"),r.register(i.Selector.BoundUpdate.FormatPainter,o.Selection.BOUND_UPDATE.ADDDOM,D.addDOM,"RID","SHEETID","VERSION","TYPE","IS_SERVER_CLIP","RANGE")}(this);
!function(e){var t,n=e.sPlusPlus,o=e.ZSConstants,i=o.FeatureConstants,a=o.wCC,s=(n.data.AppRegistry,e.document),r=e.ZSEvents,c=(r.topic,r.Groups,r.Names,e.ZSConstants.I18N),u=n.view.Toolbar.Feature[i.NEW_FILE],l=n.view.Toolbar.Feature[i.NEW_TEMPLATE];u.createNewDocument=function(){var o,i,a,s=null;t||(o=c["Import.ProgressMsg.CreateNewSpreadsheet"],a={mode:"STD",type:"info",showCloseBtn:i},t=new ZSClass.TBNotification(o,a)),t.show();var r=n.view.getActiveGridID(),u=n.view.getResourceID(r),l=n.view.getVersionID(r),d=n.view.getSelectedSheets(r);UserAction.createNewSpreadsheet(u,d,l,function(n){t.remove(),s="https://"+e.window.location.hostname+n.url,e.window.open(s,"_blank")})},function(){var e=document.getElementById("popupmenu"),t=s.createElement("ul");t.id=a.SPLIT+i.NEW_FILE+a.MENU,t.setAttribute("mtype","submenu");var n=document.createElement("li");n.id=a.MI+i.NEW_FILE+a.IDENTITY,n.setAttribute("data",'{"icon":"zicon zicon-newdocument", "label":"'+c["MenuItem.FileTab.NewSpreadsheet"]+'"}'),n.addEventListener("click",function(e){u.createNewDocument(e)}),t.appendChild(n),l.createMenuElement(t),e.appendChild(t)}()}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,o=(t.ZSConstants.wCC,e.data.AppRegistry);e.view.Toolbar.Feature[n.NEW_TEMPLATE].createNewTemplate=function(){var e=null;e=o.DOCS_SERVER_URL&&o.DOCS_SERVER_URL===t.window.location.hostname?"https://"+o.DOCS_SERVER_URL+"/createnew.do?service=zohosheet&parentid=-1&type=template":"https://"+t.window.location.hostname+"/sheet/new?doctype=template",t.window.open(e)}}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants,o=n.FeatureConstants,i=n.CommandConstants,s=(t.document,t.ZSConstants.I18N,t.ZSConstants.wCC),a=t.ZSEvents,r=a.topic,u=a.Groups,c=a.Names,l=t.UIUtil.Component,C=!1,d=e.view.Toolbar.Feature[o.NOTIFY_COLLABORATOR];var I=new function(){ZSClass.KeyMapping.call(this)},v=e.view.Events.Key;v.Entry.Dialog.Node.addChildNode(I);var E,f=!1;d.execute=function(){l.initFcomponents(),v.focusContext(v.Entry.Dialog.Context),f||(l.bind("#znotifycollaborator","zdialogclose",function(t,e){v.focusContext(v.Entry.CellEditor.Context)}),f=!0);var t=e.view.getActiveGridID(),n=e.view.getResourceID(t);l.notifyCollaborator(n)},E=e.view.getActiveGridID(),e.view.getResourceID(E),r.register(u.Listener,c.ShareMeta.UPDATE,function(t,e){if(e){var n=e[i.SHARE_INFO];C=n.isShared}},"RID","META"),r.register(u.UI,c.Toolbar.INIT_MENU,function(t){l.zmenu(t,"setMenuItemsAttribute",["#"+s.MI+o.NOTIFY_COLLABORATOR+s.MENU],"disabled",!C)},"DOM"),r.register(u.UI,c.Layout.DEFER_JS_LOADED,function(){l.addFComponentsFiles()})}(this);
!function(e){var t,i,a=e.sPlusPlus,s=e.ZSConstants.FeatureConstants,n=e.document,o=e.ZSConstants.I18N,r=e.ZSConstants.wCC,d=e.ZSEvents,c=(d.topic,d.Groups,d.Names,e.UIUtil);function l(e){var s=a.view.getActiveGridID(),n=a.view.getResourceID(s),o=a.view.getVersionID(s),r=a.data.getWorkBook(n,o).Name;t.disabled=!0,i.classList.add("ZsIconLoader"),UserAction.useTemplate(n,o,r,function(e){if(i.classList.remove("ZsIconLoader"),e&&e.di){var s=window.location.origin+a.data.AppRegistry.ctxpath+a.data.AppRegistry.ClientURI+e.di;t.disabled=!1,window.location.href=s}})}!function(){var e=a.view.getActiveGridID(),d=a.view.getResourceID(e),p=a.view.getVersionID(e);if(a.data.getWorkBook(d,p).isTemplate){var v=n.querySelector("#TB_SHARE_BTN");t=n.createElement("button");var I=n.createElement("div");i=n.createElement("div"),c.fn.addIcon(i,"TB_TEMPLATE_ICON"),t.id=r.MI+s.MY_TEMPLATES+r.IDENTITY,t.className="Zsbtn ZsShare ZsNoDropDown",I.innerText=o["Topbar.UsethisTemplate"],t.title=o["Topbar.UsethisTemplate"],t.addEventListener("click",l),t.appendChild(i),t.appendChild(I),v.appendChild(t)}}()}(this);
!function(e){var t,n,i,s,a=e.sPlusPlus,o=e.document,l=e.ZSConstants.FeatureConstants,m=a.data.AppRegistry.JSPath,d=e.ZSConstants.wCC,r=(e.ZSClass,e.ZSEvents),u=r.topic,I=r.Groups,E=r.Names,h=e.ZSConstants.I18N,M=e.UIUtil.Component,c=(ZSConstants.CommandConstants,a.data.Defaults.MAX_COL,a.data.Defaults.MAX_ROW,a.view.Toolbar.Feature[l.COMMENTS]),T=!1;function C(){u.publish(I.UI,E.SidePanel.Comments.TOGGLE)}function S(e,t,n,i,s){var a=o.createElement("li");s&&(a.id=s),a.setAttribute(t,n),e.appendChild(a)}function A(e){u.publish(I.UI,E.SidePanel.Comments.OPEN),u.publish(I.UI,E.SidePanel.Comments.FOCUS),u.publish(I.Listener,E.UserAction.REVIEW_COMMENTS.TRIGGER_ADD),e&&e.preventDefault()}c.toggleCmtPanel=C,c.openDialog=function(e){u.publish(I.Listener,E.ERROR.SHOW,{ERRORMSG:"ErrorMsg.YetToImplement"})},c.openAndAddComment=A,i=o.getElementById("popupmenu"),(s=o.createElement("ul")).id=d.SUBMENUITEM+l.COMMENTS+d.IDENTITY,s.setAttribute("data-ctype","zmenu"),s.setAttribute("relativeto","parent"),s.setAttribute("data-content-type","text"),S(s,"data",'{"label":"'+h["MenuItem.InsertTab.Comments.AddComment"]+'", "action":"add"}'),t=s,(n=o.createElement("li")).id="showAllComments",n.setAttribute("data-value","showAll"),n.setAttribute("data",'{"action":"showAll", "itemType": "checkbox", "label":"'+h["MenuItem.InsertTab.Comments.ShowComment"]+'"}'),t.appendChild(n),function(e){var t=o.createElement("li");t.id="hideAllComments",t.setAttribute("data-value","hideAll"),t.setAttribute("data",'{"action":"hideAll", "itemType": "checkbox", "label":"'+h["Discussion.HideComments"]+'"}'),e.appendChild(t)}(s),S(s,"data-item-type","separator"),S(s,"data",'{"label":"'+h["MenuItem.InsertTab.Comments.NotificationSettings"]+'", "action": "notify"}'),S(s,"data-item-type","separator"),c.createHighlightMenuElement(s),i.appendChild(s),M.bind(s,"zmenuitemclick",function(e,t){switch(t.data.action){case"add":A(e);break;case"showAll":case"hideAll":C();break;case"notify":c.openNotificationSetingsDialog();break;case"highlight":c.triggerHighlightAllComments()}}),M.bind(s,"zmenubeforeshow",function(){!function(e){if(e.id==d.SUBMENUITEM+l.COMMENTS+d.IDENTITY){var t=a.view.getActiveGridID(),n=a.view.getResourceID(t),i=a.view.getVersionID(t),s=a.data.getWorkBook(n,i);M.zmenu("#"+d.SUBMENUITEM+l.COMMENTS+d.IDENTITY,"setMenuItemsAttribute",["#showAllComments"],"hidden",T),M.zmenu("#"+d.SUBMENUITEM+l.COMMENTS+d.IDENTITY,"setMenuItemsAttribute",["#hideAllComments"],"hidden",!T),M.zmenu("#"+d.SUBMENUITEM+l.COMMENTS+d.IDENTITY,"setMenuItemsAttribute",["#highlightAllComments"],"checked",s.highlightComments)}}(s)}),u.register(I.UI,E.Toolbar.INIT_MENU,function(e){if(e.id==d.SUBMENUITEM+l.COMMENTS+d.IDENTITY||"sidePanelViewSetting"==e.id){var t=a.view.getActiveGridID(),n=a.view.getResourceID(t),i=a.view.getVersionID(t),s=a.data.getWorkBook(n,i);e.id==d.SUBMENUITEM+l.COMMENTS+d.IDENTITY?(M.zmenu("#"+d.SUBMENUITEM+l.COMMENTS+d.IDENTITY,"setMenuItemsAttribute",["#showAllComments"],"hidden",T),M.zmenu("#"+d.SUBMENUITEM+l.COMMENTS+d.IDENTITY,"setMenuItemsAttribute",["#hideAllComments"],"hidden",!T),M.zmenu("#"+d.SUBMENUITEM+l.COMMENTS+d.IDENTITY,"setMenuItemsAttribute",["#highlightAllComments"],"checked",s.highlightComments)):"sidePanelViewSetting"==e.id&&M.zmenu("#sidePanelViewSetting","setMenuItemsAttribute",["#highlightAllComments"],"checked",s.highlightComments)}},"DOM"),u.register(I.UI,E.SidePanel.Comments.PANELSTATUS,function(e){T=e},"isShown"),u.register(I.UI,E.Layout.DEFER_JS_LOADED,function(){var e=[m+"../compressedJS/connect_compressed.js"];UserAction.loadDependency(e)})}(this);
!function(e){var t=sPlusPlus,n=e.document,r=e.ZSConstants.FeatureConstants,o=t.view.Toolbar.Feature[r.COMMENTS],i=t.data.AppRegistry.CSSPath,l=n.createElement("iframe");function s(){l.contentWindow.print();var e=l.contentDocument.body,t=e.firstElementChild;e.removeChild(t)}l.style.display="none",n.body.appendChild(l),o.print=function(e){n.querySelector("#sPCmtHolder").querySelectorAll("#sPSeeMore").forEach(function(e){e.click()});var t=n.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=i+"defer/sidepanel/ReviewComments.css",t.addEventListener("load",s);var r=n.createElement("link");r.type="text/css",r.rel="stylesheet",r.href=i+"common.css";var a=n.createElement("div");a.id="commentContainer",a.innerHTML=e.innerHTML,l.contentDocument.head.appendChild(t),l.contentDocument.head.appendChild(r),l.contentDocument.body.appendChild(a),o.triggerFilter()}}(this);
!function(e){var t=e.sPlusPlus,i=e.document,s=e.ZSConstants.FeatureConstants,n=e.ZSConstants.CommandConstants,o=e.ZSConstants.wCC,r=e.ZSClass,l=e.ZSEvents,c=l.topic,a=l.Groups,m=l.Names,h=(s=e.ZSConstants).FeatureConstants,d=(o=s.wCC,r.Editors.RangeEditor),v=(r.Editors.TextAreaEditor,r.Editors.Utility,e.ZSConstants.I18N),u=(t.data.AppRegistry.CSSPath,t.data.UserInfo),p=e.UIUtil.Component,S=(t.view.Events.Key,t.view.Toolbar.Feature[h.COMMENTS]);S.Notifier=[],S.currentCards=[],S.dltDivStack=[];var D=t.data.AppRegistry.USER_PHOTO_SERVER_URL;function y(e,t,s,n,o,r,l,c,a,m,h,d,v,u,p){this.parent=i.querySelector("#sPCmtHolder"),this.commentID=t,this.content=s,this.likes=n,this.ownerID=o,this.ownerName=r,this.range=l,this.sheetID=c,this.state=a,this.time=m,this.type=h,this.unRead=d,this.newComment=v,this.replies=new Array,this.repliesCnt=u,this.liked=!1,this.iswms=p,this.isReply=!1,this.contentClassName="sPCmtLess",this.allowedHgt=57,this.constructComment(),this.updateCount(),this.constructNotification(),this.bindShowLikedList()}function C(e,t,i,s,n,o,r,l,c,a,m,h){this.parent=e,this.parentID=t,this.commentID=i,this.content=s,this.likes=n,this.ownerID=o,this.ownerName=r,this.time=l,this.type=c,this.unRead=a,this.liked=!1,this.newReply=m,this.iswms=h,this.isReply=!0,this.contentClassName="sPCmtLesser",this.allowedHgt=38,this.constructReply(),this.constructNotification(),this.bindShowLikedList()}function E(e,t,i,s,n,o,r,l,c){this.parent=e,this.parentID=t,this.commentID=i,this.content=s,this.ownerID=n,this.ownerName=o,this.time=r,this.type=l,this.iswms=c,this.contentClassName="sPCmtLesser",this.allowedHgt=38,this.isNotification=!0,this.construct()}function k(e,i){var s=t.view.getActiveGridID(),n=t.view.getResourceID(s),o=t.view.getVersionID(s),r=t.data.getWorkBook(n,o).getSheetObj(e).Prop.getName()+"."+JSUtil.Cell.getReference(i.sr,i.sc);return i.sr==i.er&&i.sc==i.ec||(r=r+":"+JSUtil.Cell.getReference(i.er,i.ec)),r}function g(e,t,i,s){var n=e.querySelector("#replyCard"),o=e.querySelector("#replyBtn"),r=e.querySelector("#cancelBtn"),l=e.querySelector("#editableContent"),c=e.querySelector(".sPCmtSmiley");c.setAttribute("data-content","#smileySuggestions"),c.setAttribute("data-is-content-html-encoded",!0),c.setAttribute("data-class-name","sPSmiley shRenameAni"),c.addEventListener("click",function(t){S.divToAddSmiley=e,t.stopPropagation()}),p.zpopover(c),l.addEventListener("keydown",function(r){!function(e,t,i,s,n,o,r,l){var c=e.keyCode||e.which;27==c&&(n.style.display="block",r.removeChild(l));if(!S.validateContent(s))return;(e.metaKey||e.ctrlKey)&&13==c&&R(t,i,s,n,o,r,l)}(r,i,s,l,t,o,e,n)}),l.addEventListener("keyup",function(){S.commentContentValidation(l,o)}),l.addEventListener("input",function(){l.textContent&&n.classList.remove("sPPlaceHolder")}),o.disabled=!0,o.addEventListener("click",function(r){R(i,s,l,t,o,e,n),r.stopPropagation()}),r.addEventListener("click",function(){t.style.display="block",e.removeChild(r.parentNode),event.stopPropagation()})}function R(e,t,s,n,o,r,l){var h=i.getElementById("commentsLoader").cloneNode(!0);r.appendChild(h);var d=JSUtil.RCMentionDataShim.getRichTextContent(s);c.publish(a.Listener,m.UserAction.REVIEW_COMMENTS.TRIGGER_REPLY,{content:d,commentID:e,range:t})}function f(s,n,o,r){var l=i.getElementById("commentsLoader").cloneNode(!0);r.appendChild(l);var c=t.view.getActiveGridID(),a=t.view.getResourceID(c),m=t.view.getSheetID(c),h=t.view.getVersionID(c),d=(t.data.getWorkBook(a,h).getSheetObj(m),u.loginName,t.view.getSelectedSheets(c)),v=t.view.getSheetID(c),p=t.view.getSheetState(c,v).getActiveRange(),S=s.querySelector("#editableContent"),D=JSUtil.RCMentionDataShim.getRichTextContent(S);e.UserAction.updateReviewCommentReply(a,h,d,n,o,D,p)}function P(s,n,o,r,l){var c=i.getElementById("commentsLoader").cloneNode(!0);r.appendChild(c);var a=t.view.getActiveGridID(),m=t.view.getResourceID(a),h=t.view.getSheetID(a),d=t.view.getVersionID(a),v=(t.data.getWorkBook(m,d).getSheetObj(h),u.loginName,t.view.getSelectedSheets(a)),p=JSUtil.Range.parseRange(m,d,n.value).range,S=JSUtil.RCMentionDataShim.getRichTextContent(o);e.UserAction.updateReviewComment(m,d,v,s,S,p)}function L(e,t,i){return e=JSUtil.RCMentionDataShim.convertRichTextContent(e),e=JSUtil.LinkMaker.convert(e,t,!0).msg}function I(e){var t=UserAction.getTemplate(["SP_LIKED_USER_PROFILE"]).SP_LIKED_USER_PROFILE,s=i.getElementById("popupmenu").querySelector("#sPLikeList");!s&&(s=i.getElementById("sPLikeList")),s.innerHTML="";for(var o=0;o<e.length;o++){var r=i.createElement("li"),l=t.cloneNode(!0);l.querySelector("#sPLikedPhoto").src=D+"/file?fs=thumb&ID="+e[o][n.USER_ID],l.querySelector("#sPLikedUsrName").innerText=e[o][n.USER_NAME],r.appendChild(l),s.appendChild(r)}}y.prototype={commentDiv:null,commentHldrDiv:null,commentMenuDiv:null,profileDiv:null,contentDiv:null,dateDiv:null,replyDiv:null,constructComment:function(){var e=t.view.getActiveGridID(),i=t.view.getResourceID(e),s=(t.view.getSheetID(e),t.view.getVersionID(e)),n=t.data.getWorkBook(i,s).highlightComments;this.createCommentTemplate(),this.createProfileTemplate(),this.content&&this.createContentTemplate(),this.createDateTemplate(),this.createReplyTemplate(),this.createCommentMenu(),this.createResolvedState(),n&&this.highlight(n)},createCommentTemplate:function(){var e=UserAction.getTemplate(["SP_COMMENTS_THREAD"]).SP_COMMENTS_THREAD;this.commentDiv=i.createElement("div"),this.commentDiv.id="sPCmtCard_"+this.commentID,this.commentDiv.className="sPCmtCard wid wid100 mb20",this.commentDiv.appendChild(e),this.newComment?this.parent.prepend(this.commentDiv):this.parent.appendChild(this.commentDiv),this.commentHldrDiv=this.commentDiv.querySelector("#sPCmtCardHldr"),this.commentMenuDiv=this.commentDiv.querySelector(".sPCmtMenu"),this.unRead&&this.ownerID!=u.zuid&&this.commentHldrDiv.classList.add("sPCmtUnread"),this.commentDiv.addEventListener("click",function(){S.updatePanelHighlights([this.commentID]),this.commentHldrDiv.classList.remove("sPCmtUnread"),S.triggerHighlight(this.range,this.sheetID,this.commentID)}.bind(this))},createProfileTemplate:function(){var e=UserAction.getTemplate(["SP_COMMENTS_PROFILE"]).SP_COMMENTS_PROFILE;this.commentHldrDiv.appendChild(e),this.profileDiv=this.commentDiv.querySelector("#sPCmtPrf"),this.setPhoto(),this.setName(),this.setRange()},createContentTemplate:function(){var e=UserAction.getTemplate(["SP_COMMENTS_CONTENT"]).SP_COMMENTS_CONTENT;this.commentHldrDiv.appendChild(e),this.contentDiv=this.commentDiv.querySelector("#content"),this.setContent()},createDateTemplate:function(){var e=UserAction.getTemplate(["SP_COMMENTS_DATE"]).SP_COMMENTS_DATE;this.commentHldrDiv.appendChild(e),this.dateDiv=this.commentDiv.querySelector("#sPCmtDate"),this.setTime(),this.setLikes(),this.showRepliesOption()},createCommentMenu:function(){var e=o.SUBMENUITEM+h.COMMENTS+o.IDENTITY,t="active"==this.state?e+"_collabActiveCmtMenu":e+"_collabResolvedCmtMenu";this.ownerID==u.zuid?t="active"==this.state?e+"_activeCmtMenu":e+"_resolvedCmtMenu":u.Permission.isSharable&&(t="active"==this.state?e+"_docOwnerActiveCmtMenu":e+"_resolvedCmtMenu"),this.commentDiv.querySelector("#"+t),this.commentMenuDiv.setAttribute("data-menu-id",t),this.commentMenuDiv.setAttribute("data-uid",this.commentID)},createReplyTemplate:function(){var e=UserAction.getTemplate(["SP_COMMENTS_REPLY"]).SP_COMMENTS_REPLY;this.commentDiv.appendChild(e),this.replyDiv=this.commentDiv.querySelector("#sPCmtRplyCard");var t=this.replyDiv.querySelector("#sPCmtRplyTxt");t.addEventListener("click",function(e){this.commentDiv.querySelector("#cnlBtn")&&this.commentDiv.querySelector("#cnlBtn").click();var i=t.parentNode;t.style.display="none";var s=UserAction.getTemplate(["SP_REPLY_CARD"]).SP_REPLY_CARD;i.appendChild(s);var n=i.querySelector("#editableContent");n.focus(),g(i,t,this.commentID,this.range),this.replyBtn=t,this.addReplyBtn=this.replyDiv.querySelector("#replyBtn"),JSUtil.RCMentionDataShim.connectProcessMention(n),this.unreadReplies(),e.stopPropagation()}.bind(this))},createResolvedState:function(){if("active"!=this.state){var e=UserAction.getTemplate(["SP_RESOLVE_STATE"]).SP_RESOLVE_STATE;this.commentDiv.querySelector("#sPCmtCardHldr").appendChild(e)}},setPhoto:function(){this.profileDiv.querySelector("#sPCmtPhoto").src=D+"/file?fs=thumb&ID="+this.ownerID},setName:function(){this.profileDiv.querySelector("#sPCmtUsrName").innerText=this.ownerName},setRange:function(){this.profileDiv.querySelector("#sPCmtRng").innerText=k(this.sheetID,this.range)},setContent:function(){var e=L(this.content,this.sheetName,this.iswms);this.contentDiv.innerHTML=e,this.iswms?this.contentDiv.classList.remove(this.contentClassName):JSUtil.RCMentionDataShim.checkEllipse(this.contentDiv,e,this.allowedHgt,this.contentClassName)},setLikes:function(){var i=this.commentDiv.querySelector("#splike");1!=this.type&&2!=this.type||i&&i.remove();var s=this.likes;this.likeCount=s.length,this.updateLikeCnt();for(var o=0;o<this.likeCount;o++){var r=s[o][n.USER_ID];s[o][n.USER_NAME];r==u.zuid&&(this.liked=!0)}this.updateLikeCntTitle(),this.liked&&this.updateLikeElStyle(this.liked),this.updateLikeTitle(this.liked);var l=this.commentID,c=this.commentHldrDiv;i.addEventListener("click",function(i){var s=t.view.getActiveGridID(),n=t.view.getResourceID(s),o=t.view.getSheetID(s),r=t.view.getVersionID(s),a=(t.data.getWorkBook(n,r).getSheetObj(o),u.loginName,t.view.getSelectedSheets(s)),m=t.view.getSheetID(s),h=t.view.getSheetState(s,m).getActiveRange();this.classList.contains("shLikeActive")?e.UserAction.unlikeReviewComment(n,r,a,l,h):e.UserAction.likeReviewComment(n,r,a,l,h),c.classList.remove("sPCmtUnread"),i.stopPropagation()})},updateLikeCnt:function(){var e=this.commentDiv.querySelector("#likeCnt");this.likeCount>0?(e.innerText=this.likeCount,e.style.display=""):e.style.display="none"},updateLikeElStyle:function(e,t){var i=this.commentDiv.querySelector("#splike");e?(i.classList.add("shLikeActive"),t&&i.classList.add("shLikeAlive")):(i.classList.remove("shLikeActive"),t&&i.classList.remove("shLikeAlive"))},updateLikeTitle:function(e){this.commentDiv.querySelector("#splike").title=e?v["Discussion.Liked"]:v["Discussion.Like"]},updateLikeCntTitle:function(){var e=this.commentDiv.querySelector("#likeCnt"),t=[];switch(this.likeCount){case 0:e.title="";break;case 1:var i=this.liked?v["Discussion.You"]:this.likes[0][n.USER_NAME];e.title=JSUtil.fn.replaceParams(v["Discussion.LikedBy"],new Array(i));break;case 2:if(this.liked){var s=this.likes[0][n.USER_ID]==u.zuid?1:0;t.push(v["Discussion.You"],this.likes[s][n.USER_NAME])}else t.push(this.likes[0][n.USER_NAME],this.likes[1][n.USER_NAME]);e.title=JSUtil.fn.replaceParams(v["Discussion.LikedByAnd"],t);break;default:if(this.liked){s=this.likes[0][n.USER_ID]==u.zuid?1:0;t.push(v["Discussion.You"],this.likes[s][n.USER_NAME],this.likeCount-2)}else t.push(this.likes[0][n.USER_NAME],this.likes[1][n.USER_NAME],this.likeCount-2);e.title=JSUtil.fn.replaceParams(v["Discussion.LikedByAndMore"],t)}},updateLikes:function(e){var t=e[n.USER_ID],i=e[n.USER_NAME],s=e[n.STATE];if(s){var o={};o[n.USER_ID]=t,o[n.USER_NAME]=i,this.likes.push(o)}else for(var r=0;r<this.likes.length;r++)if(this.likes[r][n.USER_ID]==t){this.likes.splice(r,1);break}t==u.zuid&&(this.liked=s,this.updateLikeElStyle(s,!0),this.updateLikeTitle(s)),s?this.likeCount++:this.likeCount--,this.updateLikeCnt(),this.updateLikeCntTitle()},setTime:function(){var e=this.dateDiv;e.innerText=this.time,e.href=S.getLink(this.commentID,null,!1),e.addEventListener("click",function(e){e.stopPropagation()})},setState:function(e){"active"===(e=1==e?"resolved":"active")?this.commentDiv.querySelector("#spCmtRslvd")&&this.commentDiv.querySelector("#spCmtRslvd").remove():this.createResolvedState(),"all"!=S.currentFilter&&S.currentFilter!=e&&this.commentDiv.remove(),this.removeCommentMenu(),this.state=e,this.createCommentMenu()},updateCount:function(){},constructNotification:function(){this.unRead&&this.ownerID!=u.zuid&&(S.Notifier[this.commentID]=new E(this.commentDiv,this.commentID,this.commentID,this.content,this.ownerID,this.ownerName,this.time,3,this.iswms))},updateContent:function(e,t){var i=L(e,this.sheetName,!0);this.contentDiv.innerHTML=i,this.content=e,t==u.zuid&&this.commentDiv.querySelector("#editCmtCard")&&(this.commentDiv.querySelector("#sPCmtCardHldr").style.display="block",this.commentDiv.querySelector("#editCmtCard").remove(),this.commentDiv.querySelector(".sPCmtMenu").style.display="block")},updateRange:function(e,t){this.sheetID=e,this.range=t,this.profileDiv.querySelector("#sPCmtRng").innerText=k(e,t),S.triggerHighlight(t,e,this.commentID)},updateRangeOnRCDeleteInsert:function(e){this.range=e,this.profileDiv.querySelector("#sPCmtRng").innerText=k(this.sheetID,e)},updateState:function(e){},showRepliesOption:function(){var e=this.repliesCnt,t=this.commentID,i=this.commentDiv;if(e>2){var s=JSUtil.fn.replaceParams(v["Discussion.ViewOlderReplies"],new Array(e-2+"")),n=i.querySelector("#sPCmt_viewOlderReplies");n.innerText=s,n.style.display=""}else e<=2&&e>0&&(i.querySelector("#spCmt_hideReplies").style.display="");this.commentDiv.querySelector("#sPCmt_viewOlderReplies").addEventListener("click",function(){this.remove(),i.querySelector("#spCmt_hideReplies").style.display="",c.publish(a.Listener,m.UserAction.REVIEW_COMMENTS.FETCH,{disId:t,action:0})}),this.commentDiv.querySelector("#sPCmt_viewAllReplies").addEventListener("click",function(){for(var e=i.querySelector("#sPRepCardHldr").children,t=0;t<e.length;t++)e[t].style.display="block";this.style.display="none",i.querySelector("#spCmt_hideReplies").style.display=""}),this.commentDiv.querySelector("#spCmt_hideReplies").addEventListener("click",function(){for(var e=i.querySelector("#sPRepCardHldr").children,t=0;t<e.length;t++)e[t].style.display="none";this.style.display="none",i.querySelector("#sPCmt_viewAllReplies").style.display=""})},viewReplies:function(e){for(var t=this.repliesCnt-2;t>=1;t--)this.addReply(e[t].parentID,e[t].commentID,e[t].content,e[t].likes,e[t].ownerID,e[t].ownerName,e[t].time,e[t].type,e[t].unRead,!1)},updateRepliesOptionOnDelete:function(){this.repliesCnt=this.repliesCnt-1,0==this.repliesCnt&&(this.commentDiv.querySelector("#sPCmt_viewOlderReplies").style.display="none",this.commentDiv.querySelector("#spCmt_hideReplies").style.display="none")},updateRepliesOptionOnAdd:function(){this.commentDiv.querySelector("#sPCmt_viewOlderReplies")&&"none"==this.commentDiv.querySelector("#sPCmt_viewOlderReplies").style.display&&"none"==this.commentDiv.querySelector("#spCmt_hideReplies").style.display&&"none"==this.commentDiv.querySelector("#sPCmt_viewAllReplies").style.display&&(this.commentDiv.querySelector("#spCmt_hideReplies").style.display=""),this.replyBtn&&(this.replyBtn.style.display="block",this.replyDiv.querySelector("#replyCard")&&this.replyDiv.querySelector("#replyCard").remove(),this.replyDiv.querySelector("#commentsLoader")&&this.replyDiv.querySelector("#commentsLoader").remove())},remove:function(i){var s=UserAction.getTemplate(["SP_DELETE"]).SP_DELETE;this.commentDiv.appendChild(s);var n=this.commentDiv.querySelector("#dltDiv"),o=this.commentDiv.querySelector("#cnlBtn"),l=this.commentDiv.querySelector("#dltBtn"),c=this.commentDiv,a=this.range,m=new r.Range(a.sr,a.sc,a.er,a.ec);this.commentDiv.style.overflow="hidden",S.dltDivStack.push({del:n,cmt:c}),l.addEventListener("click",function(s){S.hideHighlightComment(!0);var n=t.view.getActiveGridID(),o=t.view.getResourceID(n),r=t.view.getSheetID(n),l=t.view.getVersionID(n),a=(t.data.getWorkBook(o,l).getSheetObj(r),u.loginName,t.view.getSelectedSheets(n));e.UserAction.deleteReviewComment(o,l,a,i,m),c.style.overflow="",s.stopPropagation()}),o.addEventListener("click",function(){n.remove(),c.style.overflow=""})},deleteThread:function(){this.commentDiv.remove()},resolve:function(i){var s=t.view.getActiveGridID(),n=t.view.getResourceID(s),o=t.view.getSheetID(s),l=t.view.getVersionID(s),c=(t.data.getWorkBook(n,l).getSheetObj(o),u.loginName,t.view.getSelectedSheets(s)),a=this.range,m=new r.Range(a.sr,a.sc,a.er,a.ec);e.UserAction.resolveReviewComment(n,l,c,i,m)},reopen:function(i){var s=t.view.getActiveGridID(),n=t.view.getResourceID(s),o=t.view.getSheetID(s),l=t.view.getVersionID(s),c=(t.data.getWorkBook(n,l).getSheetObj(o),u.loginName,t.view.getSelectedSheets(s)),a=this.range,m=new r.Range(a.sr,a.sc,a.er,a.ec);e.UserAction.reopenReviewComment(n,l,c,i,m)},edit:function(e){var t=this.commentDiv;t.querySelector("#sPCmtCardHldr").style.display="none",t.querySelector(".sPCmtMenu").style.display="none";var i=JSUtil.RCMentionDataShim.convertRichTextContent(this.content);t.querySelector("#cnlBtn")&&this.commentDiv.querySelector("#cnlBtn").click(),t.querySelector("#cancelBtn")&&this.commentDiv.querySelector("#cancelBtn").click();var s=UserAction.getTemplate(["SP_EDIT_COMMENT"]).SP_EDIT_COMMENT;t.prepend(s);var n=t.querySelector("#editCmtCard");n.querySelector("#sPCmtUsrName").innerText=this.ownerName,n.querySelector("#sPCmtPhoto").src=D+"/file?fs=thumb&ID="+this.ownerID;var o=n.querySelector("#submitBtn"),l=n.querySelector(".sPCmtSmiley");l.addEventListener("click",function(e){S.divToAddSmiley=n,e.stopPropagation()}),p.zpopover(l,{content:"#smileySuggestions",isContentHTMLEncoded:!0,className:"sPSmiley shRenameAni"});var c=new d(n.querySelector("#rng"),!0);r.RangePicker.register(c,!0,!1);var a=n.querySelector("#editableContent"),m=n.querySelector("#rngSelector"),h=n.querySelector("#rng");m.addEventListener("mousedown",function(){var e=new Event("mousedown");h.dispatchEvent(e)}),JSUtil.RCMentionDataShim.connectProcessMention(a),a.addEventListener("click",function(e){e.stopPropagation()}),a.addEventListener("keydown",function(i){!function(e,t,i,s,n,o){var r=e.keyCode||e.which;27==r&&(o.querySelector(".sPCmtMenu").style.display="block",o.querySelector("#sPCmtCardHldr").style.display="block",n.remove());if(!S.validateContent(s))return;(e.metaKey||e.ctrlKey)&&13==r&&P(t,i,s,n,o)}(i,e,c,a,n,t)}),a.addEventListener("keyup",function(){S.commentContentValidation(a,o)}),o.addEventListener("click",function(i){P(e,c,a,n,t),i.stopPropagation()}),n.querySelector("#cnlBtn").addEventListener("click",function(e){t.querySelector(".sPCmtMenu").style.display="block",t.querySelector("#sPCmtCardHldr").style.display="block",n.remove(),e.stopPropagation()});var v=k(this.sheetID,this.range),u=n.querySelector("#editableContent");t.querySelector("#rng").innerText=v,u.innerHTML=i,u.focus()},addReply:function(e,t,i,s,n,o,r,l,c,a,m){var h=new C(this.commentDiv,e,t,i,s,n,o,r,l,c,a,m);this.replies[t]=h},removeCommentMenu:function(){var e=o.SUBMENUITEM+h.COMMENTS+o.IDENTITY,t="active"==this.state?e+"_activeCmtMenu":e+"_resolvedCmtMenu";void 0!=this.commentDiv.querySelector("#"+t)&&this.commentDiv.querySelector("#"+t).remove()},print:function(){S.print(this.commentDiv)},highlight:function(e){var i=t.view.getActiveGridID(),s=t.view.getResourceID(i),n=t.view.getVersionID(i),o=t.data.getWorkBook(s,n),r=t.view.getSheetID(i),l=this.sheetID;o.highlightComments;if(r===l){var c=this.range;S.highlightEvent(s,l,n,c,this.commentID,e?m.UserAction.REVIEW_COMMENTS.PLACE_HIGHLIGHT:m.UserAction.REVIEW_COMMENTS.REMOVE_HIGHLIGHT)}},highlightComment:function(){this.commentDiv.classList.add("sPCurCard")},removeHighlightComment:function(){this.commentDiv.classList.remove("sPCurCard")},scrollIntoPanelView:function(){this.commentDiv.scrollIntoView(!1)},bindShowLikedList:function(){var e=this.commentDiv.querySelector("#likeCnt"),t=this.likes;e.addEventListener("click",function(e){I(t),e.stopPropagation()}),p.zpopover(e,{content:"#sPLikeList",isContentHTMLEncoded:!0,className:"shRenameAni",title:v["Discussion.LikeListTitle"]})},unreadReplies:function(){for(var e=this.commentDiv.querySelector("#sPRepCardHldr").children,t=0;t<e.length;t++)e[t].classList.remove("sPCmtUnread");this.commentHldrDiv.classList.remove("sPCmtUnread")}},C.prototype={commentDiv:null,commentHldrDiv:null,profileDiv:null,contentDiv:null,dateDiv:null,replyDiv:null,constructReply:function(){this.createCommentTemplate(),this.createProfileTemplate(),this.createContentTemplate(),this.createDateTemplate()},createCommentTemplate:function(){this.commentDiv=i.createElement("div"),this.commentDiv.id="sPRepCard_"+this.commentID,this.unRead&&this.ownerID!=u.zuid?this.commentDiv.className="wid wid100 p10 sPCmtUnread":this.commentDiv.className="wid wid100 p10",this.commentDiv.addEventListener("click",function(){this.classList.remove("sPCmtUnread")}),this.commentDiv.style="border-bottom: 1px dashed #dfdfdf",this.newReply?this.parent.querySelector("#sPRepCardHldr").appendChild(this.commentDiv):this.parent.querySelector("#sPRepCardHldr").prepend(this.commentDiv),this.commentHldrDiv=this.parent.querySelector("#sPRepCardHldr")},createProfileTemplate:function(){var e=UserAction.getTemplate(["SP_REPLIES_PROFILE"]).SP_REPLIES_PROFILE;this.commentDiv.appendChild(e),this.profileDiv=this.commentDiv.querySelector("#sPCmtPrf"),this.setPhoto(),this.setName();var t=this,i=this.commentDiv;this.ownerID!=u.zuid&&u.Permission.isSharable?this.commentDiv.querySelector("#sPRpEdit")&&this.commentDiv.querySelector("#sPRpEdit").remove():this.ownerID!=u.zuid&&(this.commentDiv.querySelector("#sPRpEdit")&&this.commentDiv.querySelector("#sPRpEdit").remove(),this.commentDiv.querySelector("#sPRpDlt")&&this.commentDiv.querySelector("#sPRpDlt").remove()),this.commentDiv.querySelector("#sPRpEdit")&&this.commentDiv.querySelector("#sPRpEdit").addEventListener("click",function(e){i.querySelector("#sPRplyCmtEdit").style.display="none",t.edit(),e.stopPropagation()}),this.commentDiv.querySelector("#sPRpDlt")&&this.commentDiv.querySelector("#sPRpDlt").addEventListener("click",function(e){t.remove(),e.stopPropagation()})},createContentTemplate:function(){var e=UserAction.getTemplate(["SP_REPLY_CONTENT"]).SP_REPLY_CONTENT;this.commentDiv.appendChild(e),this.contentDiv=this.commentDiv.querySelector("#content"),this.setContent()},createDateTemplate:function(){var e=UserAction.getTemplate(["SP_REPLY_DATE"]).SP_REPLY_DATE;this.commentDiv.appendChild(e),this.dateDiv=this.commentDiv.querySelector("#sPCmtDate"),this.setTime(),this.setLikes()},setLikes:function(){var i=this.commentDiv.querySelector("#splike");if(1!=this.type&&2!=this.type){var s=this.likes;this.likeCount=s.length,this.updateLikeCnt();for(var o=0;o<this.likeCount;o++){var r=s[o][n.USER_ID];s[o][n.USER_NAME];r==u.zuid&&(this.liked=!0)}this.updateLikeCntTitle(),this.liked&&this.updateLikeElStyle(this.liked),this.updateLikeTitle(this.liked);var l=this.commentID,c=this.parentID,a=this.commentDiv;i.addEventListener("click",function(i){var s=t.view.getActiveGridID(),n=t.view.getResourceID(s),o=t.view.getSheetID(s),r=t.view.getVersionID(s),m=(t.data.getWorkBook(n,r).getSheetObj(o),u.loginName,t.view.getSelectedSheets(s)),h=t.view.getSheetID(s),d=t.view.getSheetState(s,h).getActiveRange();this.classList.contains("shLikeActive")?e.UserAction.unlikeReviewCommentReply(n,r,m,c,l,d):e.UserAction.likeReviewCommentReply(n,r,m,c,l,d),a.classList.remove("sPCmtUnread"),i.stopPropagation()})}else i&&i.remove()},updateLikeTitle:function(e){this.commentDiv.querySelector("#splike").title=e?v["Discussion.Liked"]:v["Discussion.Like"]},updateLikeCnt:function(){var e=this.commentDiv.querySelector("#likeCnt");this.likeCount>0?(e.innerText=this.likeCount,e.style.display=""):e.style.display="none"},updateLikeElStyle:function(e,t){var i=this.commentDiv.querySelector("#splike");e?(i.classList.add("shLikeActive"),t&&i.classList.add("shLikeAlive")):(i.classList.remove("shLikeActive"),t&&i.classList.remove("shLikeAlive"))},updateLikeCntTitle:function(){var e=this.commentDiv.querySelector("#likeCnt"),t=[];switch(this.likeCount){case 0:e.title="";break;case 1:var i=this.liked?v["Discussion.You"]:this.likes[0][n.USER_NAME];e.title=JSUtil.fn.replaceParams(v["Discussion.LikedBy"],new Array(i));break;case 2:if(this.liked){var s=this.likes[0][n.USER_ID]==u.zuid?1:0;t.push(v["Discussion.You"],this.likes[s][n.USER_NAME])}else t.push(this.likes[0][n.USER_NAME],this.likes[1][n.USER_NAME]);e.title=JSUtil.fn.replaceParams(v["Discussion.LikedByAnd"],t);break;default:if(this.liked){s=this.likes[0][n.USER_ID]==u.zuid?1:0;t.push(v["Discussion.You"],this.likes[s][n.USER_NAME],this.likeCount-2)}else t.push(this.likes[0][n.USER_NAME],this.likes[1][n.USER_NAME],this.likeCount-2);e.title=JSUtil.fn.replaceParams(v["Discussion.LikedByAndMore"],t)}},updateLikes:function(e){var t=e[n.USER_ID],i=e[n.USER_NAME],s=e[n.STATE];if(s){var o={};o[n.USER_ID]=t,o[n.USER_NAME]=i,this.likes.push(o)}else for(var r=0;r<this.likes.length;r++)if(this.likes[r][n.USER_ID]==t){this.likes.splice(r,1);break}t==u.zuid&&(this.liked=s,this.updateLikeElStyle(s,!0),this.updateLikeTitle(s)),s?this.likeCount++:this.likeCount--,this.updateLikeCnt(),this.updateLikeCntTitle()},setContent:function(){if(this.content){var e=L(this.content,this.sheetName,this.iswms);this.contentDiv.innerHTML=e,this.iswms?this.contentDiv.classList.remove(this.contentClassName):JSUtil.RCMentionDataShim.checkEllipse(this.contentDiv,e,this.allowedHgt,this.contentClassName)}else this.contentDiv.classList.remove(this.contentClassName)},setPhoto:function(){this.profileDiv.querySelector("#sPCmtPhoto").src=D+"/file?fs=thumb&ID="+this.ownerID},setName:function(){var e=this.ownerName,t=i.createElement("span");t.classList.add("dspVerMid"),1==this.type?(this.commentDiv.querySelector("#sPRplyCmtEdit").remove(),t.classList.add("sPCmtRslvdWrd"),t.innerText=v["Discussion.MarkedAsResolved"],this.commentDiv.classList.add("sPCmtRslvdCtn")):2==this.type&&(this.commentDiv.querySelector("#sPRplyCmtEdit").remove(),t.classList.add("sPCmtROpen"),t.innerText=v["Discussion.Reopened"],this.commentDiv.classList.add("sPCmtROpenCtn")),this.profileDiv.querySelector("#sPCmtUsrName").innerText=e,this.profileDiv.querySelector(".sPCmtUsrName").appendChild(t)},setTime:function(){var e=this.dateDiv;e.innerText=this.time,e.href=S.getLink(this.parentID,this.commentID,!0),e.addEventListener("click",function(){event.stopPropagation()})},updateContent:function(e,t){this.content=e,this.contentDiv.innerHTML=L(e,this.sheetName,!0),t==u.zuid&&this.commentDiv.querySelector("#commentsLoader")&&(this.commentDiv.querySelector("#sPCmtDateHlr").style.display="block",this.commentDiv.querySelector("#content").style.display="block",this.commentDiv.querySelector("#sPRplyCmtEdit").style.display="",this.commentDiv.querySelector("#sPCmtRply").remove(),this.commentDiv.querySelector("#commentsLoader").remove())},remove:function(){var i=UserAction.getTemplate(["SP_DELETE"]).SP_DELETE;this.commentDiv.appendChild(i);var s=this.commentDiv.querySelector("#dltDiv"),n=this.commentDiv.querySelector("#cnlBtn"),o=this.commentDiv.querySelector("#dltBtn"),r=(this.commentDiv,this.commentID),l=this.parentID;S.dltDivStack.push({del:s}),o.addEventListener("click",function(){var i=t.view.getActiveGridID(),s=t.view.getResourceID(i),n=t.view.getSheetID(i),o=t.view.getVersionID(i),c=(t.data.getWorkBook(s,o).getSheetObj(n),u.loginName,t.view.getSelectedSheets(i)),a=t.view.getSheetID(i),m=t.view.getSheetState(i,a).getActiveRange();e.UserAction.deleteReviewCommentReply(s,o,c,l,r,m)}),n.addEventListener("click",function(){s.remove()})},deleteReply:function(){this.commentDiv.remove()},edit:function(){var e=this.commentDiv;e.querySelector("#sPCmtDateHlr").style.display="none",e.querySelector("#content").style.display="none";var t=JSUtil.RCMentionDataShim.convertRichTextContent(this.content);this.parent.querySelector("#cnlBtn")&&this.parent.querySelector("#cnlBtn").click(),this.parent.querySelector("#cancelBtn")&&this.parent.querySelector("#cancelBtn").click();var i=UserAction.getTemplate(["SP_EDIT_REPLY"]).SP_EDIT_REPLY;e.appendChild(i);var s=e.querySelector("#sPCmtRply"),n=s.querySelector("#editableContent"),o=s.querySelector("#submitBtn"),r=this.commentID,l=this.parentID,c=s.querySelector(".sPCmtSmiley");c.addEventListener("click",function(e){S.divToAddSmiley=s,e.stopPropagation()}),p.zpopover(c,{content:"#smileySuggestions",isContentHTMLEncoded:!0,className:"sPSmiley shRenameAni"}),JSUtil.RCMentionDataShim.connectProcessMention(n),n.addEventListener("click",function(e){e.stopPropagation()}),n.addEventListener("keydown",function(t){!function(e,t,i,s,n,o){var r=e.keyCode||e.which;27==r&&(n.querySelector("#sPRplyCmtEdit").style.display="",n.querySelector("#sPCmtDateHlr").style.display="block",n.querySelector("#content").style.display="block",t.remove());if(!S.validateContent(o))return;(e.metaKey||e.ctrlKey)&&13==r&&f(t,i,s,n)}(t,s,l,r,e,this)}),n.addEventListener("keyup",function(){S.commentContentValidation(n,o)}),o.disabled=!0,o.addEventListener("click",function(t){f(s,l,r,e),t.stopPropagation()}),s.querySelector("#cnlBtn").addEventListener("click",function(t){e.querySelector("#sPRplyCmtEdit").style.display="",e.querySelector("#sPCmtDateHlr").style.display="block",e.querySelector("#content").style.display="block",s.remove(),t.stopPropagation()});var a=s.querySelector("#editableContent");a.innerHTML=t,a.focus()},delete:function(){},constructNotification:function(){this.unRead&&this.ownerID!=u.zuid&&(S.Notifier[this.commentID]=new E(this.commentDiv,this.parentID,this.commentID,this.content,this.ownerID,this.ownerName,this.time,this.type,this.iswms))},bindShowLikedList:function(){var e=this.commentDiv.querySelector("#likeCnt"),t=this.likes;e.setAttribute("data-content","#sPLikeList"),e.setAttribute("data-is-content-html-encoded",!0),e.setAttribute("data-class-name","shRenameAni"),e.addEventListener("click",function(){I(t)}),p.zpopover(e,{title:v["Discussion.LikeListTitle"]})}},E.prototype={notifyDiv:null,construct:function(){this.constructNotifiyTemplate(),this.setTime(),this.setContent(),this.setName(),this.setPhoto()},constructNotifiyTemplate:function(){var e=this.parentID,t=this.getNotifyTemplate(),i=this.getParent();this.iswms?i.prepend(t):i.appendChild(t),(this.notifyDiv=i.querySelector("#sPCmtNtyCard")).id="sPCmtNtyCard_"+this.commentID,this.notifyDiv.addEventListener("click",function(){S.goToComment(),S.Comment.Thread[e].scrollIntoPanelView()})},getNotifyTemplate:function(){var e=null;switch(this.type){case 3:e=UserAction.getTemplate(["SP_COMMENT_NOTIFICATION"]).SP_COMMENT_NOTIFICATION;break;case 0:e=UserAction.getTemplate(["SP_REPLIED_COMMENT_NOTIFICATION"]).SP_REPLIED_COMMENT_NOTIFICATION;break;case 1:e=UserAction.getTemplate(["SP_RESOLVE_COMMENT_NOTIFICATION"]).SP_RESOLVE_COMMENT_NOTIFICATION;break;case 2:e=UserAction.getTemplate(["SP_REOPEN_COMMENT_NOTIFICATION"]).SP_REOPEN_COMMENT_NOTIFICATION}return e},setName:function(){this.notifyDiv.querySelector("#sPCmtUsrName").innerText=this.ownerName},setPhoto:function(){this.notifyDiv.querySelector("#sPCmtPhoto").src=D+"/file?fs=thumb&ID="+this.ownerID},setTime:function(){this.notifyDiv.querySelector("#sPCmtDate").innerText=this.time},setContent:function(){if(this.content){var e=L(this.content);this.notifyDiv.querySelector("#content").innerHTML=e,JSUtil.RCMentionDataShim.checkEllipse(this.notifyDiv.querySelector("#content"),e,this.allowedHgt,this.contentClassName,this.isNotification)}},getParent:function(){return i.querySelector("#sPCmtNtfyHldr")}},S.getLink=function(e,i,s){var n,o=t.view.getActiveGridID(),r=t.view.getResourceID(o);return n=s?"/comments/"+e+"/replies/"+i:"/comments/"+e,t.data.AppRegistry.ctxpath+t.data.AppRegistry.ClientURI+r+n},e.ZSClass.UIComment=y}(this);
!function(e){var t=e.sPlusPlus,n=e.document,r=e.ZSConstants.FeatureConstants,i=(e.ZSConstants.wCC,e.ZSClass),o=e.ZSEvents,a=o.topic,s=o.Groups,c=o.Names,E=i.Editors.RangeEditor,d=(i.Editors.TextAreaEditor,i.Editors.Utility,i.Range,e.ZSConstants.ActionConstants),C=e.ZSConstants.CommandConstants,S=(e.ZSConstants.JSKeyCode,t.data.AppRegistry.USER_PHOTO_SERVER_URL),m=e.UIUtil.Component,I=(t.data.Defaults.MAX_COL,t.data.Defaults.MAX_ROW,0),l=2,D=t.view.Toolbar.Feature[r.COMMENTS];function R(n,r,i,o,a,s,c,E,d,C){var S=t.view.getActiveGridID(),m=t.view.getResourceID(S),I=(t.view.getSheetID(S),t.view.getVersionID(S)),l=t.data.getWorkBook(m,I),D=r?[l.SheetList.getIdByName(r[0])]:u(l.SheetList.getAllSheetNames());e.UserAction.fetchReviewComments(m,I,D,i,{sr:s,sc:c,er:E,ec:d},n,M,o,a,C)}function u(e){for(var n=[],r=t.view.getActiveGridID(),i=t.view.getResourceID(r),o=(t.view.getSheetID(r),t.view.getVersionID(r)),a=t.data.getWorkBook(i,o),s=0;s<e.length;s++)n.push(a.SheetList.getIdByName(e[s]));return n}function T(){if(!v().querySelector("#addCmtCard")){f(),D.goToComment();var e=t.view.getActiveGridID(),n=t.view.getResourceID(e),r=t.view.getSheetID(e),o=t.view.getVersionID(e),a=t.data.getWorkBook(n,o).getSheetObj(r).Prop.getName(),s=sPlusPlus.data.UserInfo.loginName;!function(e,n,r,o,a){var s=v(),c=UserAction.getTemplate(["SP_ADD_COMMENT"]).SP_ADD_COMMENT;s.prepend(c);var d=s.querySelector("#addCmtCard");d.querySelector("#sPCmtUsrName").innerText=o;var C=d.querySelector("#submitBtn"),I=d.querySelector(".sPCmtSmiley");I.setAttribute("data-content","#smileySuggestions"),I.setAttribute("data-is-content-html-encoded",!0),I.setAttribute("data-class-name","sPSmiley shRenameAni"),I.addEventListener("click",function(){D.divToAddSmiley=d}),m.zpopover(I),d.querySelector("#sPCmtPhoto").src=S+"/file?fs=thumb&ID="+t.data.UserInfo.zuid;var l=new E(d.querySelector("#rng"),!0);i.RangePicker.register(l,!0,!1),l.value=a;var R=d.querySelector("#rngSelector"),u=d.querySelector("#rng");R.addEventListener("mousedown",function(){var e=new Event("mousedown");u.dispatchEvent(e)});var T=s.querySelector("#editableContent"),N=s.querySelector("#sPCmtRply");T.addEventListener("keydown",function(t){!function(e,t,n,r,i,o,a){var s=e.keyCode||e.which;27==s&&(a.remove(),_());if(!D.validateContent(o))return;(e.metaKey||e.ctrlKey)&&13==s&&g(t,n,r,i,o,a)}(t,e,n,r,l,T,d)}),T.addEventListener("keyup",function(){D.commentContentValidation(T,C)}),T.addEventListener("input",function(){T.textContent&&N.classList.remove("sPPlaceHolder")}),C.disabled=!0,C.addEventListener("click",function(){g(e,n,r,l,T,d)}),d.querySelector("#cnlBtn").addEventListener("click",function(){s.querySelector("#addCmtCard").remove(),_()}),d.querySelector("#editableContent").focus(),JSUtil.RCMentionDataShim.connectProcessMention(d.querySelector("#editableContent"))}(n,o,t.view.getSelectedSheets(e),s,function(e,t){var n=e+"."+JSUtil.Cell.getReference(t.startRow,t.startCol);t.startRow==t.endRow&&t.startCol==t.endCol||(n=n+":"+JSUtil.Cell.getReference(t.endRow,t.endCol));return n}(a,t.view.getSheetState(e,r).getActiveRange()))}}function g(r,i,o,a,s,c){var E=n.getElementById("commentsLoader").cloneNode(!0);c.appendChild(E);var d=t.view.getActiveGridID(),C=(o=t.view.getSelectedSheets(d),JSUtil.Range.parseRange(r,i,a.value).range),S=JSUtil.RCMentionDataShim.getRichTextContent(s);e.UserAction.addReviewComment(r,i,o,S,C)}function N(){v()&&v().querySelector("#addCmtCard")&&v().querySelector("#addCmtCard").remove()}function v(){return n.querySelector("#sPCmtHolder")}D.getSheetListByName=u,D.commentContentValidation=function(e,t){D.validateContent(e)?t.disabled=!1:t.disabled=!0},D.validateContent=function(e){return JSUtil.RCMentionDataShim.getActualContent(e).trim().length>0},D.Comment={Thread:[],Notification:[]},D.init=function(){D.clearHighlights(),D.Comment.Thread=[]};var h=0,O=3;function A(e,n,r,i,o,a,s,c){if(function(e,n){n==t.data.UserInfo.zuid||e!=C.ADD&&e!=C.ADD_REPLY||D.updateNotificationCount(D.NotificationCnt+1)}(r,a),v()&&D.initialLoad)switch(R("active",void 0,i,!0,r,void 0,void 0,void 0,void 0,c),r){case C.ADD:N();break;case C.ADD_REPLY:D.Comment.Thread[o].updateRepliesOptionOnAdd(),s&&D.Comment.Thread[o].setState(s);break;case C.DELETE:"all"==i?D.triggerFilter():D.Comment.Thread[i].deleteThread();break;case C.DELETE_REPLY:D.Comment.Thread[o].replies[i].deleteReply(),D.Comment.Thread[o].updateRepliesOptionOnDelete();break;case C.RESOLVE:}}function L(e,t,n,r,i,o){if(v())switch(n){case C.DISCUSSION_LIKE:case C.DISCUSSION_UNLIKE:D.Comment.Thread[r].updateLikes(o);break;case C.DISCUSSION_LIKE_REPLY:case C.DISCUSSION_UNLIKE_REPLY:D.Comment.Thread[r].replies[i].updateLikes(o)}}function M(n,r,o,a){if(U(!1),v()){var s=t.view.getActiveGridID(),c=t.view.getResourceID(s),E=(t.view.getSheetID(s),t.view.getVersionID(s)),d=t.view.State[s][c][E],C=t.data.getWorkBook(c,E);if(0!=n.length){var S=0;!C.highlightComments&&D.hideHighlightComment(),D.currentThread=n[0].commentID;for(var m=0;m<n.length;m++){var I=n[m].commentID;if(void 0==n[m].parentID){S=o&&o.replyCount[I];var l=new e.ZSClass.UIComment(n[m].parentID,I,n[m].content,n[m].likes,n[m].ownerID,n[m].ownerName,n[m].range,n[m].sheetID,n[m].state,n[m].time,n[m].type,n[m].unRead,r,S,a);D.Comment.Thread[I]=l,d.setCommentState(I,new i.CommentState(I))}else D.Comment.Thread[n[m].parentID].addReply(n[m].parentID,I,n[m].content,n[m].likes,n[m].ownerID,n[m].ownerName,n[m].time,n[m].type,n[m].unRead,!0,a)}r&&n[0].range&&D.Comment.Thread[n[0].commentID].highlight(!0)}else _()}}function _(){if(!(D.displayCnt>0||v()&&void 0!=v().querySelector("#addCmtCard"))){f();var e=n.querySelector("#sPCmtHolder"),t=UserAction.getTemplate(["SP_NO_COMMENT"]).SP_NO_COMMENT;e&&e.prepend(t),e&&e.querySelector("#addCmtLnk").addEventListener("click",function(){f(),T()})}}function f(){var e,t=n.querySelector("#comments");t&&(e=t.querySelector("#sPNoCmt")),e&&e.remove()}function U(e){n.querySelector("#comments")&&(n.querySelector("#comments").querySelector("#ZsLoader").style.display=e?"":"none")}function w(e){var n=t.view.getActiveGridID(),r=t.view.getResourceID(n),i=(t.view.getSheetID(n),t.view.getVersionID(n)),o=t.data.getWorkBook(r,i);if(D.currentThread&&(e||!o.highlightComments)){var a=D.Comment.Thread[D.currentThread];if(!a)return;a.highlight(!1),D.currentThread=void 0}}D.togglePanelLoader=U,D.addNoCommentTemplate=_,D.hideHighlightComment=w;var p={};function y(e){for(var t=0;t<e.length;t++){var n=e[t].commentID;p[n]=e[t]}for(var n in D.Comment.Thread){var r=D.Comment.Thread[n].range,i=p[n].range;r.sr==i.sr&&r.er==i.er&&r.sc==i.sc&&r.ec==i.ec||D.Comment.Thread[n].updateRangeOnRCDeleteInsert(i)}}function P(e,n,r,o){o=o?"RCINSERT":"RCDELETE";var a=new i.Range(0,0,t.data.Defaults.MAX_ROW-1,t.data.Defaults.MAX_COL-1);D.showMycomments([a],n,o)}a.register(s.Listener,c.UserAction.REVIEW_COMMENTS.TRIGGER_ADD,T,"response"),a.register(s.Listener,c.UserAction.REVIEW_COMMENTS.TRIGGER_REPLY,function(n,r,o){var a=t.view.getActiveGridID(),s=t.view.getResourceID(a),c=t.view.getSheetID(a),E=t.view.getVersionID(a),d=(t.data.getWorkBook(s,E).getSheetObj(c),sPlusPlus.data.UserInfo.loginName,t.view.getSelectedSheets(a)),C=new i.Range(o.sr,o.sc,o.er,o.ec);e.UserAction.addReviewCommentReply(s,E,d,r,n,C)},"content","commentID","range"),a.register(s.Listener,c.UserAction.REVIEW_COMMENTS.EXECUTE_ACTION,function(e,t,n){switch(t){case d.DISCUSSION_UPDATE_RANGE_CONTENT:D.Comment.Thread[e].edit(e);break;case d.DISCUSSION_RESOLVE:D.Comment.Thread[e].resolve(e);break;case d.DISCUSSION_REOPEN:D.Comment.Thread[e].reopen(e);break;case d.DISCUSSION_DELETE:D.Comment.Thread[e].remove(e);break;case I:D.Comment.Thread[e].print(e)}},"uid","action"),a.register(s.Listener,c.UserAction.REVIEW_COMMENTS.FETCH,R,"status","sheets","disId","newComment","action","SR","SC","ER","EC"),a.register(s.Listener,c.UserAction.REVIEW_COMMENTS.LOAD,function(e,t,n,r,i,o){switch(e.length<1?_():f(),r){case C.MODIFY:var a=e[0].content,s=e[0].range,c=e[0].sheetID,E=e[0].ownerID;e[0].parentID?D.Comment.Thread[e[0].parentID].replies[e[0].commentID].updateContent(a,E):(D.Comment.Thread[e[0].commentID].updateContent(a,E),D.Comment.Thread[e[0].commentID].updateRange(c,s));break;case C.RESOLVE:D.Comment.Thread[e[0].commentID].setState("resolved");break;case C.REOPEN:D.Comment.Thread[e[0].commentID].setState("active");break;case C.DISCUSSION:t&&t(e,n,i);break;case C.ADD:D.currentFilter!=D.FilterValues.resolved&&t&&t(e,n,null,!0);break;case C.ADD_REPLY:o&&(M([{commentID:o,parentID:e[0].parentID,ownerID:e[0].ownerID,ownerName:e[0].ownerName,time:e[0].time,content:void 0,likes:[],unRead:!0,type:2}],!0,null,!0),D.Comment.Thread[e[0].parentID].setState(2)),t&&t(e,n,null,!0);break;case h:D.Comment.Thread[e[0].commentID].viewReplies(e);break;case O:D.highlightAllComments(e);break;case l:D.showNotificationPanel();break;case"INIT_NOTIFICATION":D.NotificationCnt=i.unReadCount,D.updateNotificationCount(i.unReadCount);break;case"HIGHLIGHT_MY_COMMENTS":D.highlightMyRangeComments(e);break;case"RCINSERT":y(e);break;case"RCDELETE":y(e),function(e){for(var t in D.Comment.Thread)void 0==p[t]&&D.Comment.Thread[t].deleteThread()}()}},"response","callback","newComment","action","COUNTOBJ","REOPENID"),a.register(s.Listener,c.UserAction.REVIEW_COMMENTS.ADD_SUCCESS,A,"RID","VERSION","ACTION","COMMENTID","PARENTID","OWNERID"),a.register(s.Listener,c.UserAction.REVIEW_COMMENTS.UPDATE_SUCCESS,A,"RID","VERSION","ACTION","COMMENTID"),a.register(s.Listener,c.UserAction.REVIEW_COMMENTS.DELETE_SUCCESS,A,"RID","VERSION","ACTION","COMMENTID"),a.register(s.Listener,c.UserAction.REVIEW_COMMENTS.RESOLVE_SUCCESS,A,"RID","VERSION","ACTION","COMMENTID"),a.register(s.Listener,c.UserAction.REVIEW_COMMENTS.ADD_REPLY_SUCCESS,A,"RID","VERSION","ACTION","COMMENTID","PARENTID","OWNERID","STATE","R_ID"),a.register(s.Listener,c.UserAction.REVIEW_COMMENTS.DELETE_REPLY_SUCCESS,A,"RID","VERSION","ACTION","COMMENTID","PARENTID"),a.register(s.Listener,c.UserAction.REVIEW_COMMENTS.LIKE_SUCCESS,L,"RID","VERSION","ACTION","PARENTID","COMMENTID","LIKES"),a.register(s.Listener,c.UserAction.REVIEW_COMMENTS.UNLIKE_SUCCESS,L,"RID","VERSION","ACTION","PARENTID","COMMENTID","LIKES"),a.register(s.Listener,c.UserAction.REVIEW_COMMENTS.LIKE_REPLY_SUCCESS,L,"RID","VERSION","ACTION","PARENTID","COMMENTID","LIKES"),a.register(s.Listener,c.UserAction.REVIEW_COMMENTS.UNLIKE_REPLY_SUCCESS,L,"RID","VERSION","ACTION","PARENTID","COMMENTID","LIKES"),a.register(s.Listener,c.UserAction.REVIEW_COMMENTS.CURRENT_THREAD,function(e){w(),D.currentThread=e},"commentID"),a.register(s.Selector.DomUpdate.Cell,c.Selection.BOUND_UPDATE.ADD,w),a.register(s.Listener,c.SheetAction.ROW_HEADERS.INSERT,P,"RID","SHEETID","VERSION",!0),a.register(s.Listener,c.SheetAction.ROW_HEADERS.DELETE,P,"RID","SHEETID","VERSION",!1),a.register(s.Listener,c.SheetAction.COLUMN_HEADERS.INSERT,P,"RID","SHEETID","VERSION",!0),a.register(s.Listener,c.SheetAction.COLUMN_HEADERS.DELETE,P,"RID","SHEETID","VERSION",!1)}(this);
!function(e){var t=e.sPlusPlus,n=e.document,i=e.ZSConstants.FeatureConstants,r=e.ZSConstants.wCC,o=e.ZSClass,s=e.ZSEvents,a=s.topic,g=s.Groups,c=s.Names,h=e.ZSConstants.I18N,l=e.UIUtil.Component,m=(ZSConstants.CommandConstants,t.view.Toolbar.Feature[i.COMMENTS]),I=3,u=!1;function v(e){var n=t.view.getActiveGridID(),i=t.view.getActiveState(n);i.setActive(i.getSheetState(e)),a.unregister(g.Selector.BoundUpdate.Range,c.Selection.BOUND_UPDATE.ADD,v)}var E=JSUtil.fn.debounce(function(e,t,n,i,r,o,s,a){D(r,t,"HIGHLIGHT_MY_COMMENTS")},200);function D(e,n,i){var r=t.view.getActiveGridID(),o=t.view.getResourceID(r),s=t.view.getVersionID(r),h=t.data.getWorkBook(o,s).getSheetObj(n).Prop.getName();m.Comment.Thread&&Object.keys(m.Comment.Thread).length>0&&function(e,t,n){a.publish(g.Listener,c.UserAction.REVIEW_COMMENTS.FETCH,{status:m.currentFilter,sheets:t,disId:void 0,newComment:!1,action:n,SR:e.startRow,SC:e.startCol,ER:e.endRow,EC:e.endCol})}(e[0],[h],i)}function C(){var e=t.view.getActiveGridID(),n=t.view.getResourceID(e),i=t.view.getVersionID(e),r=t.data.getWorkBook(n,i),o=t.view.getSheetID(e),s=r.getSheetObj(o).Prop.getName();a.publish(g.Listener,c.UserAction.REVIEW_COMMENTS.FETCH,{status:m.currentFilter,sheets:[s],disId:void 0,newComment:!1,action:I,SR:0,SC:0,ER:t.data.Defaults.MAX_ROW-1,EC:t.data.Defaults.MAX_COL-1})}function S(){m.Comment.Thread;for(var e=0;e<m.currentCards.length;e++)m.Comment.Thread[m.currentCards[e]].removeHighlightComment();m.currentCards=[]}function T(e,t,n,i,r){new o.Range(i.sr,i.sc,i.er,i.ec);UserAction.ScrollCellIntoView(e,t,n,i.sr,i.sc),a.publish(g.Listener,c.UserAction.REVIEW_COMMENTS.CURRENT_THREAD,{commentID:r}),m.Comment.Thread[r].highlight(!0)}var d=JSUtil.fn.debounce(function(e,t,n,i,r,o){!function(e,t,n,i,r,o){u=!0,UserAction.SwitchSheet(e,t,n,r,i,!1,function(){T(e,r,n,i,o)})}(e,t,n,i,r,o)},500);m.updatePanelHighlights=function(e){S();for(var t=0;t<e.length;t++){var n=e[t];m.Comment.Thread[n].highlightComment(),m.currentCards.push(n)}},m.highlightEvent=function(e,t,n,i,r,s){var c=new o.Range(i.sr,i.sc,i.er,i.ec);a.publish(g.Listener,s,{RID:e,SHEETID:t,VERSION:n,RANGE:c,RANGEID:r})},m.getDisplayComment=C,m.highlightAllComments=function(e){if(0!=e.length)for(var n=t.view.getActiveGridID(),i=t.view.getResourceID(n),r=t.view.getVersionID(n),o=t.data.getWorkBook(i,r).highlightComments,s=t.view.getSheetID(n),a=0;a<e.length;a++)void 0==e[a].parentID&&m.highlightEvent(i,s,r,e[a].range,e[a].commentID,o?c.UserAction.REVIEW_COMMENTS.PLACE_HIGHLIGHT:c.UserAction.REVIEW_COMMENTS.REMOVE_HIGHLIGHT)},m.highlightMyRangeComments=function(e){if(u)u=!1;else{var t=[];for(var i in e)void 0==e[i].parentID&&t.push(e[i].commentID);m.updatePanelHighlights(t);var r=t.length;r>0&&m.Comment.Thread[t[0]].scrollIntoPanelView(),r>1&&new o.TBNotification(JSUtil.fn.replaceParams(h["Discussion.Highlighted"],new Array(r+"")),{type:"info",parent:n.querySelector("#sPCmtTop")}).show()}},m.triggerHighlightAllComments=function(){var e=t.view.getActiveGridID(),n=t.view.getResourceID(e),o=(t.view.getSheetID(e),t.view.getVersionID(e)),s=t.data.getWorkBook(n,o),a=s.highlightComments;s.highlightComments=!a,C(),a?(l.zmenu("#"+r.SUBMENUITEM+i.COMMENTS+r.IDENTITY,"setAttribute","contentType","text"),l.zmenu("#commentPanelMenu","setAttribute","contentType","text")):(l.zmenu("#"+r.SUBMENUITEM+i.COMMENTS+r.IDENTITY,"setAttribute","contentType","icon-text"),l.zmenu("#commentPanelMenu","setAttribute","contentType","icon-text"))},m.clearHighlights=S,m.triggerHighlight=function(e,n,i){var r=t.view.getActiveGridID(),s=t.view.getResourceID(r),a=t.view.getVersionID(r),g=(t.data.getWorkBook(s,a),t.view.getSheetID(r));if(g!=n){var c=new o.Range(e.sr,e.sc,e.er,e.ec);d(s,g,a,c,n,i)}else T(s,n,a,e,i)},m.showMycomments=D,a.register(g.Listener,c.SheetAction.HIGHLIGHT_COMMENTS.REPAINT,function(e,n,i){var r=t.data.getWorkBook(e,i).getSheetObj(n).Prop.getName();m.currentSheetFilter!=m.FilterValues.all&&m.currentSheetFilter!=r||m.getDisplayComment()},"RID","SHEETID","VERSION"),a.register(g.Listener,c.SheetAction.ZOOM.On,function(e,n,i){var r=t.data.getWorkBook(e,i).highlightComments;if(r){var o=[],s=m.Comment.Thread;for(var a in s)void 0===s[a].parentID&&o.push(s[a].commentID);if(0!=o.length)for(var g=0;g<o.length;g++)m.Comment.Thread[o[g]].highlight(r)}},"RID","SHEETID","VERSION"),a.register(g.Listener,c.UserAction.REVIEW_COMMENTS.CURRENT_THREAD,function(e){var n=t.view.getActiveGridID(),i=t.view.getResourceID(n),r=(t.view.getSheetID(n),t.view.getVersionID(n)),o=t.view.State[n][i][r];o.setActive(o.getCommentState(e)),a.register(g.Selector.BoundUpdate.Range,c.Selection.BOUND_UPDATE.ADD,v,"SHEETID")},"commentID"),a.register(g.Selector.DomUpdate.Range,c.Selection.BOUND_UPDATE.ADD,E,"RID","SHEETID","VERSION","ActiveRange","RANGES","RANGEID","TYPE","isSingleCell")}(this);
!function(e){var t,r,i,l=e.sPlusPlus,a=e.ZSEvents,n=a.topic,s=a.Groups,o=a.Names,u=(e.UserAction,e.ZSClass),c=(l.view.measures,u.KeyMapping,(u=e.ZSClass).SidePanel,e.document),v=e.UIUtil.Component,d=e.ZSConstants,m=d.FeatureConstants,S=d.I18N,F=!1,h={active:S["Discussion.PanelHeader.Active"],resolved:S["Discussion.PanelHeader.Resolved"],all:S["Discussion.PanelHeader.All"]},g={active:0,resolved:0,all:0},p=l.view.Toolbar.Feature[m.COMMENTS];function A(e){var t=h[e],r=g[e]?g[e]:0,i=c.querySelector("#cmtStatusFilter");i&&(i.querySelector("#stFilterLbl").innerText=t);var l="("+r+")",a=parseInt(r)>0?l:"";i&&(i.querySelector("#stFilterCount").innerText=a),p.displayCnt=r,p.addNoCommentTemplate()}function C(e){return e>0?"  ("+e+")":""}function b(e){var t=l.view.getActiveGridID(),i=l.view.getResourceID(t),a=l.view.getVersionID(t),n=l.data.getWorkBook(i,a),s=r[e]?r[e]:0,o=c.querySelector("#cmtSheetFilter"),u="all"==e?S["Discussion.AllSheet"]:e;o&&(o.querySelector("#shtFilterLbl").innerText=u);var v="("+s+")";o&&(o.querySelector("#shtFilterCnt").innerText=v),F=e!=p.FilterValues.all&&n.SheetList.getIdByName(e),p.displayCnt=s}function f(){r={all:0}}function D(){var e=p.currentFilter,t=p.currentSheetFilter;A(e),b(t),p.ClearPanel(),"all"==t?p.loadComments(e):p.loadComments(e,[t]),p.markCommentAsRead()}p.currentFilter="active",p.currentSheetFilter="all",p.FilterValues={all:"all",resolved:"resolved",active:"active"},p.createFilterMenuLayout=function(e){(t=c.createElement("ul")).id="reviewCommentFilterMenu",t.setAttribute("data",'{"componentOptions":{"type":"text_only"}}'),t.setAttribute("ctype","zmenu"),function(){for(var e in h){var r=c.createElement("li");r.id=e,r.setAttribute("data",'{"label":"'+h[e]+'"}'),r.addEventListener("click",function(){p.currentFilter=this.id,p.triggerFilter()}),t.appendChild(r)}}(),e.appendChild(t),v.bind(t,"zmenubeforeshow",function(){!function(e){var t=e.id,r={active:S["Discussion.PanelHeader.Active"]+"  ("+g.active+")",resolved:S["Discussion.PanelHeader.Resolved"]+"  ("+g.resolved+")",all:S["Discussion.PanelHeader.All"]+"  ("+g.all+")"};for(var i in h)v.zmenu("#"+t,"setMenuItemsAttribute",["#"+i],"label",r[i])}(t)})},p.initSheetFilter=function(e){c.querySelector("#cmtSheetFilter").addEventListener("mousedown",function(){!function(e){c.querySelector("#sheetFilterMenu")&&c.querySelector("#sheetFilterMenu").remove(),(i=c.createElement("div")).id="sheetFilterMenu",i.setAttribute("data",'{"componentOptions":{"type":"text_only"}}'),i.setAttribute("data-ctype","zmenu"),function(){var e=l.view.getActiveGridID(),t=l.view.getResourceID(e),a=l.view.getVersionID(e),n=l.data.getWorkBook(t,a).SheetList.getSheets(),s=c.createElement("ul"),o=c.createElement("li");o.setAttribute("data",'{"label":"'+S["Discussion.AllSheet"]+C(r.all)+'"}'),o.setAttribute("data-item-value",p.FilterValues.all),s.appendChild(o);for(var u=0;u<n.length;u++){var v=c.createElement("li");v.setAttribute("data",'{"label": "'+n[u].Name+C(r[n[u].Name])+'"}'),v.setAttribute("data-item-value",n[u].Id),s.appendChild(v)}i.appendChild(s)}(),e.appendChild(i),v.bind(i,"zmenuitemclick",function(e,t){var r=l.view.getActiveGridID(),i=l.view.getResourceID(r),a=l.view.getVersionID(r),n=l.data.getWorkBook(i,a),s=t.menuitem[0].dataset.itemValue;p.currentSheetFilter=s!=p.FilterValues.all?n.getSheetObj(s).Prop.getName():s,D()})}(e)})},p.updateFilterDOM=A,p.updateSheetFilterDOM=b,p.resetSheetFilterCount=f,p.triggerFilter=D,n.register(s.UI,o.SidePanel.Comments.UPDATE_COUNT,function(e){var t=0,i=0,a=0;f(),e.unReadCount>0&&!p.initialLoad&&(p.currentFilter=p.FilterValues.all);var n=l.view.getActiveGridID(),s=l.view.getResourceID(n),o=l.view.getVersionID(n),u=l.data.getWorkBook(s,o),c=p.getSheetListByName(u.SheetList.getAllSheetNames()),v=p.currentFilter;if("all"==p.currentSheetFilter){for(var d in e.active)t+=e.active[d]?e.active[d]:0;for(var m in e.resolved)i+=e.resolved[m]?e.resolved[m]:0}else{var S=u.SheetList.getIdByName(p.currentSheetFilter);t=e.active[S]?e.active[S]:0,i=e.resolved[S]?e.resolved[S]:0}var F=0;for(d=0;d<c.length;d++){var h=0;v==p.FilterValues.all?(e.active&&e.active[c[d]]&&(h+=e.active[c[d]]),e.resolved&&e.resolved[c[d]]&&(h+=e.resolved[c[d]])):e[v]&&e[v][c[d]]&&(h+=e[v][c[d]]);var C=u.getSheetObj(c[d]).Prop.getName();r[C]=h,F+=h}switch(r.all=F,v){case p.FilterValues.all:a=t+i;break;case p.FilterValues.resolved:a=i;break;case p.FilterValues.active:a=t}g.active=t,g.resolved=i,g.all=t+i,r[p.currentSheetFilter]=a,A(v),b(p.currentSheetFilter)},"COUNTOBJ"),n.register(s.Listener,o.DocAction.WORKSHEETS.RENAME,function(e,t,r){r[0][0]==F&&c.querySelector("#shtFilterLbl")&&(c.querySelector("#shtFilterLbl").innerText=r[0][1])},"RID","VERSION","RENAME")}(this);
!function(t){if(!t.isCanvasGrid){var i=t.sPlusPlus,e=t.ZSClass.UIPaneComponent.prototype;e.PlaceCommentsHighlight=function(t,e,s,g,o){var h=i.data.getWorkBook(t,s).getSheetObj(e),n=g.clone();if(h.Merge.isIntersecting(g))for(var a=h.Merge.getIntersectedRanges(g),m=0;m<a.length;m++)n=n.union(a[m]);var l=h.Row.auxiliaryAxis.getPos(n.startRow),r=h.Column.auxiliaryAxis.getPos(n.startCol),C=h.Row.auxiliaryAxis.getPos(n.endRow+1),u=h.Column.auxiliaryAxis.getPos(n.endCol+1),x=i.view.getActiveGridID(),H=i.view.getSheetState(x,e).getZoom();this.CommentsHighlight.ranges[o]=g,this.CommentsHighlight&&this.CommentsHighlight.hightLightComments(o),this.CommentsHighlight&&this.CommentsHighlight.place(o,l*H,r*H,(C-l)*H,(u-r)*H)},e.RepaintCommentsHighlight=function(t,e,s){for(var g in this.CommentsHighlight.ranges){var o=i.data.getWorkBook(t,s).getSheetObj(e),h=this.CommentsHighlight.ranges[g],n=h.clone();if(o.Merge.isIntersecting(h))for(var a=o.Merge.getIntersectedRanges(h),m=0;m<a.length;m++)n=n.union(a[m]);var l=(o=i.data.getWorkBook(t,s).getSheetObj(e)).Row.auxiliaryAxis.getPos(n.startRow),r=o.Column.auxiliaryAxis.getPos(n.startCol),C=o.Row.auxiliaryAxis.getPos(n.endRow+1),u=o.Column.auxiliaryAxis.getPos(n.endCol+1),x=i.view.getSheetState(this.gridID,e).getZoom();this.CommentsHighlight&&this.CommentsHighlight.hightLightComments(g),this.CommentsHighlight&&this.CommentsHighlight.place(g,l*x,r*x,(C-l)*x,(u-r)*x)}},e.RemoveCommentsHighlight=function(t,i,e,s,g){this.CommentsHighlight&&this.CommentsHighlight.hide(g)}}}(this);
!function(t){if(!t.isCanvasGrid){var i=t.ZSClass,s=i.UILayer;h.prototype=new s,h.prototype.hightLightComments=function(){this.Dom.classList.remove("highlightCmt");var t=this.Dom;setTimeout(function(){t.classList.add("highlightCmt")},10)},i.UICommentsHighlightLayer=h}function h(t,i,h){s.call(this,t,i)}}(this);
!function(t){var i=t.ZSClass,s=i.UILayerController,h=i.UICommentsHighlightLayer;function e(t,i){s.call(this,t,i,h),this.alive=[],this.ranges={}}e.prototype=new s,e.prototype.hightLightComments=function(t){this.isExist(t)&&this.alive[t].hightLightComments()},i.UICommentsHighlightController=e}(this);
!function(s){s.sPlusPlus;var t=s.ZSClass.Selector;(t.Design||(t.Design={})).CommentsHighlight={class:"highlightCmt glowUser",filler:!0,edges:{top:!0,left:!0,bottom:!0,right:!0}}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,s=e.sPlusPlus.view.Events.Key.Entry.QuickFind.Context.keyDown,i=e.ZSConstants.JSKeyCode,o=e.ZSEvents,u=o.topic,l=o.Names,r=o.Groups,E=t.view.Toolbar.Feature[n.FIND];function a(e){e.preventDefault(),u.publish(r.Listener,l.CellAction.VALUE.FIND.BLURQUICKFIND)}s[i.ENTER]=function(e){u.publish(r.Listener,l.CellAction.VALUE.FIND.QUICKFIND,{ev:e,isNext:!0})},s[i.SHIFT+"+"+i.ENTER]=function(e){u.publish(r.Listener,l.CellAction.VALUE.FIND.QUICKFIND,{ev:e,isNext:!1})},s[i.ESC]=a,s[i.TAB]=a,s[i.SUPER+"+"+i.H]=function(e){e.preventDefault(),a(e),E.openDialog()},s[i.SUPER+"+"+i.F]=function(e){return e.preventDefault(),!1}}(this);
!function(e){var o=e.sPlusPlus,t=e.ZSClass,n=e.ZSEvents,i=(n.topic,n.Groups,n.Names,e.ZSDevTools.Logger,e.ZSConstants.wCC,e.ZSConstants.I18N),s=e.ZSConstants.FeatureConstants,a=e.UIUtil.Component;function c(){var e=o.view.Events.Key;e.focusContext(e.Entry.CellEditor.Context)}o.view.Toolbar.Feature[s.MOVE_TO_FOLDER].openDialog=function(){var e=o.view.getActiveGridID(),n=o.view.getResourceID(e),s=o.view.getVersionID(e),l=o.data.getWorkBook(n,s),r=new function(){t.KeyMapping.call(this)},u=o.view.Events.Key;if(u.Entry.Dialog.Node.addChildNode(r),u.focusContext(u.Entry.Dialog.Context),"undefined"!=typeof ZD_IS_NEW_UI_ENABLED&&ZD_IS_NEW_UI_ENABLED&&"false"!==ZD_IS_NEW_UI_ENABLED){var v={serviceName:"ST",resId:n,handback_obj:{},okButtonName:i.MoveTo,createFolderEnable:!0,showFileNameInHeader:!1,notifySuccessMessage:!0};ZDocsMoveTo.openSheetTDMove(v)}else ZDocsMoveTo.open({allowDuplicateName:!1,extension:void 0,fileExtension:void 0,fileName:l.Name,fileId:n,dialogTitle:i.MoveTo});setTimeout(function(){var e=document.querySelector("#ui-zmoveto-dialog");e&&(a.bind(e,"dialogclose",function(){c()}),document.querySelector("#ui-zmoveto-movebutton").addEventListener("click",function(){c()}),document.querySelector("#btn-cancel").addEventListener("click",function(){c()}))},1e3)}}(this);
!function(e){var t,s=e.sPlusPlus,i=e.ZSClass,a=e.ZSEvents,n=a.topic,o=a.Groups,v=a.Names,r=(e.ZSDevTools.Logger,e.ZSConstants.wCC,e.ZSConstants.I18N,e.ZSConstants.FeatureConstants);i.Editors,e.UIUtil.Component;var c=!1;function l(){t.classList.toggle("sheetListFavActive"),c||(t.classList.add("sheetListFavAnimate"),setTimeout(function(){t.classList.remove("sheetListFavAnimate")},500));var e=s.view.getActiveGridID(),i=s.view.getResourceID(e),a=s.view.getVersionID(e);UserAction.MakeFavorate(i,a,c,d)}function d(e){var i=s.view.getActiveGridID(),a=s.view.getResourceID(i),n=s.view.getVersionID(i),o=s.data.getWorkBook(a,n);c=o.isFavorite(),void 0!==e&&(c=e),c?t.classList.add("sheetListFavActive"):t.classList.remove("sheetListFavActive")}-1==ZSConstants.Meta.HideFeaturesList.indexOf(r.FAVORITE)&&(function(){if(!t){var e=document.querySelector("#TB_CENTER_CONTAINER");(t=document.createElement("div")).className="slFavIcon",t.addEventListener("click",l),e.appendChild(t)}}(),d()),n.register(o.UI,v.Layout.TEMPLATE_LOADED,function(){var e=UserAction.getTemplate(["FavTemplate"]);t&&t.appendChild(e.FavTemplate)})}(this);
!function(e){var t,i,o,s,a,n,r=e.sPlusPlus,d=e.ZSClass,E=e.ZSEvents,c=E.topic,m=E.Groups,u=E.Names,N=(e.ZSDevTools.Logger,e.ZSConstants.wCC),l=e.ZSConstants.I18N,R=e.ZSConstants.FeatureConstants;d.Editors,e.UIUtil.Component,r.view.Toolbar.Feature[R.RENAME];function D(e){if(-1==ZSConstants.Meta.HideFeaturesList.indexOf(R.DOC_NAME)){if(t)return;var i=document.querySelector("#TB_CENTER_CONTAINER");(t=document.createElement("div")).id=N.MI+"DOCNAME"+N.HOLDER,t.className="ZsbtnArr ZsNameField",t.innerText=e,i.appendChild(t),c.register(m.Listener,u.DocAction.DOCUMENT.RENAME,C,"NEW_NAME","RESOURCE_ID","VERSION")}}function C(e,i){t&&(t.innerText=e,t.title=e,function(e,t){var i=e+" - "+l.ZohoSheet;r.data.DocRegistry[t].RemoteViewInfo&&r.data.DocRegistry[t].RemoteViewInfo.isCustomDomain&&(i=e);document.title=i}(e,i))}o=r.view.getActiveGridID(),s=r.view.getResourceID(o),a=r.view.getVersionID(o),n=r.data.getWorkBook(s,a),i=n.Name?n.Name:"Untitled Spreadsheet",r.data.DocRegistry[s].RemoteViewInfo&&r.data.DocRegistry[s].RemoteViewInfo.fileFormat&&(i+="."+r.data.DocRegistry[s].RemoteViewInfo.fileFormat),D(i),C(i,s),c.register(m.UI,u.Layout.TEMPLATE_LOADED,function(){(-1!=ZSConstants.Meta.HideFeaturesList.indexOf(R.RENAME)||!r.data.UserInfo.Permission.isSharable&&t)&&(t.className="ZsbtnArr ZsNameField ZsNameDisabled")})}(this);
!function(e){var t,n,s=e.sPlusPlus,o=e.ZSClass,a=e.ZSEvents,r=a.topic,i=a.Groups,c=a.Names,l=(e.ZSDevTools.Logger,e.ZSConstants.wCC),d=e.ZSConstants.I18N,u=e.ZSConstants.FeatureConstants,S=(o.Editors,e.UIUtil);function p(){var e=document.querySelector("#TB_SHARE_BTN");if(!(n=S.fn.getMenuElement("mACBtn"))){(n=document.createElement("button")).className="Zsbtn ZsShare ZsNoDropDown",n.title=d["Topband.MarkAsComplete"],n.id="mACBtn",n.style.display="none";var t=document.createElement("div");t.innerText=d["Topband.MarkAsComplete"],n.appendChild(t),e.appendChild(n)}n.addEventListener("click",function(){!function(){n.classList.add("ZsRt");var e=document.createElement("span");n.appendChild(e);var t=s.view.getActiveGridID(),o=s.view.getResourceID(t),a=s.view.getVersionID(t);UserAction.MarkAsComplete(o,a,D)}()})}function D(){t.remove(),n.remove(),ZSConstants.Meta.DisableFeaturesList.pop(ZSConstants.FeatureConstants.PUBLISH),document.querySelector("#"+l.MI+u.SHARE+l.IDENTITY)&&(document.querySelector("#"+l.MI+u.SHARE+l.IDENTITY).style.display="block"),new o.TBNotification(JSUtil.fn.replaceParams(d["Topband.MarkAsCompleteInfo"]),{type:"info"}).show()}var T=!1;function E(){var e=s.view.getActiveGridID(),n=s.view.getResourceID(e);T&&!s.data.DocRegistry[n].isNewDoc&&(t.style.display="block",document.querySelector("#mACBtn").style.display="block"),r.unregister(i.Listener,c.DocMeta.ENABLE_DRIVE_STATUS)}-1==ZSConstants.Meta.HideFeaturesList.indexOf(u.DRIVE_STATUS)&&(T=!0,function(){if(!t){var e=document.querySelector("#TB_CENTER_CONTAINER");(t=document.createElement("div")).className="shDrft",t.title=d["Topband.DraftInfo"],t.innerText=d["Topband.Draft"],t.style.display="none",e.appendChild(t)}}(),p(),ZSConstants.Meta.DisableFeaturesList.push(ZSConstants.FeatureConstants.PUBLISH),document.querySelector("#"+l.MI+u.SHARE+l.IDENTITY)&&(document.querySelector("#"+l.MI+u.SHARE+l.IDENTITY).style.display="none")),r.register(i.UI,c.Layout.TEMPLATE_LOADED,E),r.register(i.Listener,c.DocMeta.DRIVE_STATUS,D),r.register(i.Listener,c.DocMeta.ENABLE_DRIVE_STATUS,function(){var e=s.view.getActiveGridID(),t=s.view.getResourceID(e);s.data.DocRegistry[t].isNewDoc=!1,E()})}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSConstants.FeatureConstants,s=e.ZSEvents,n=s.topic,o=s.Groups,r=s.Names,a=(e.ZSConstants.CommandConstants,t.view.Toolbar.Feature[i.HYPERLINK]),g=e.ZSConstants.wCC,I=e.UIUtil.Component;a.isSingleCell=function(){var e=t.view.getActiveGridID(),i=t.view.getResourceID(e),s=t.view.getSheetID(e),n=t.view.getSheetState(e,s).getRanges()[0],o=t.view.getVersionID(e),r=t.data.getWorkBook(i,o).getSheetObj(s).Merge.getInfo(n.startRow,n.startCol);return!!(n.isSingle()||r&&r.equals(n))},n.register(o.UI,r.Toolbar.INIT_MENU,function(e){if(e.id==g.TB+"INSERT"+g.POPUP+g.CONTAINER){var s=t.view.getActiveGridID(),n=t.view.getSheetID(s),o=t.view.getSheetState(s,n),r=t.view.getResourceID(s),v=o.getActiveRange(),l=t.view.getVersionID(s),S=t.data.getWorkBook(r,l);S.getSheetObj(n).ProtectedRanges.isIntersecting(v)||S.ProtectedSheets.isSheetLocked(n)||!a.isSingleCell()?I.disable("#"+g.MI+i.HYPERLINK+g.IDENTITY):I.enable("#"+g.MI+i.HYPERLINK+g.IDENTITY)}},"DOM"),a.Clear=function(e){var i=t.view.getActiveGridID(),s=t.view.getResourceID(i),n=t.view.getVersionID(i),o=t.view.getSelectedSheets(i);UserAction.HyperLink(s,o,n,"remove",null,null)}}(this);
!function(e){var t,n,i=e.sPlusPlus,o=e.document,a=(e.UserAction,o.getElementById("popupmenu")),I=e.ZSConstants.FeatureConstants,S=e.ZSConstants.I18N,c=e.ZSConstants.wCC,s=e.UIUtil.Component,T=e.ZSEvents,r=T.topic,d=T.Groups,g=T.Names,E=0,u=1,D=2,U=!1;t={id:c.SUBMENUITEM+I.SORT+c.IDENTITY,"data-type":"list","data-content-type":"icon-text"},n=[{id:c.SUBMENUITEM+I.SORT+c.IDENTITY+"_ASC",data:'{"SVGIconId" : "#ascendingIco svgWidHgt", "label":"'+S["MenuItem.DataTab.Sort.SortAscending"]+'", "action": '+E+"}"},{id:c.SUBMENUITEM+I.SORT+c.IDENTITY+"_DSC",data:'{"SVGIconId" : "#descendingIco svgWidHgt", "label":"'+S["MenuItem.DataTab.Sort.SortDescending"]+'", "action": '+u+"}"},{id:c.SUBMENUITEM+I.SORT+c.IDENTITY+"_CUSTOM",data:'{"SVGIconId" : "#customSortIco svgWidHgt", "label":"'+S["MenuItem.DataTab.Sort.CustomSort"]+'", "action": '+D+"}"}],U||(i.view.Menu.create(n,t,a).then(function(){s.bind("#"+c.SUBMENUITEM+I.SORT+c.IDENTITY,"zmenuitemclick",function(t,n){!function(t,n){var o=n.action,a=i.view.getActiveGridID(),I=i.view.getResourceID(a),S=(i.view.getSheetID(a),i.view.getVersionID(a)),c=i.view.getSelectedSheets(a),s=i.view.getSheetState(a,c[0]).getActiveRange(),T=0;switch(s.isCol()&&(T=s.startCol),o){case E:!function(t,n,i,o){e.UserAction.Sort(t,n,i,["ASC"],!1,!1,o)}(I,c,S,T);break;case u:!function(t,n,i,o){e.UserAction.Sort(t,n,i,["DESC"],!1,!1,o)}(I,c,S,T);break;case D:!function(t,n,i){e.UserAction.Sort(t,n,i,[],!1,!0)}(I,c,S)}}(0,n.data)}),s.bind("#"+c.SUBMENUITEM+I.SORT+c.IDENTITY,"zmenubeforeshow",function(e,t){!function(){for(var e=i.view.getActiveGridID(),t=i.view.getSheetID(e),n=i.view.getSheetState(e,t).getRanges(),o=0;o<n.length;o++){var a=n[o];if(a.endRow>a.startRow||a.endCol>a.startCol)return!0}return!1}()?(s.disable("#"+c.SUBMENUITEM+I.SORT+c.IDENTITY+"_ASC"),s.disable("#"+c.SUBMENUITEM+I.SORT+c.IDENTITY+"_DSC")):(s.enable("#"+c.SUBMENUITEM+I.SORT+c.IDENTITY+"_ASC"),s.enable("#"+c.SUBMENUITEM+I.SORT+c.IDENTITY+"_DSC"))})}),U=!0);var v=JSUtil.fn.debounce(function(e){!function(e){if("TB_DATA_POPUP_CONTAINER"==e.id){var t=i.view.getActiveGridID(),n=i.view.getSheetID(t),o=i.view.getSheetState(t,n),a=i.view.getResourceID(t),S=o.getActiveRange(),T=i.view.getVersionID(t),r=i.data.getWorkBook(a,T),d=!(!r.getSheetObj(n).ProtectedRanges.isIntersecting(S)&&!r.ProtectedSheets.isSheetLocked(n));d?s.disable(e.querySelector("#"+c.MI+I.SORT+c.IDENTITY)):s.enable(e.querySelector("#"+c.MI+I.SORT+c.IDENTITY))}}(e)},200);r.register(d.UI,g.Toolbar.INIT_MENU,v,"DOM")}(this);
!function(e){var t=e.sPlusPlus,a=e.ZSConstants.FeatureConstants,n=e.ZSConstants.wCC,i=e.ZSEvents,s=e.UIUtil.Component,o=e.document.getElementById("popupmenu"),l=(t.data.Defaults.MAX_COL,e.JSUtil.Math,i.topic,i.Groups,i.Names,e.ZSConstants.I18N),u=t.view.Toolbar.Feature[a.SPARKLINE],r={id:n.SUBMENUITEM+a.SPARKLINE+n.IDENTITY,data:'{"componentOptions":{"label":"'+l["MenuTab.Tab.Sparkline"]+'","type":"text_only", "itemType": "submenu"}}',relativeto:"parent"},S=[{data:'{"label":"'+l["MenuTab.Tab.Sparkline.Create"]+'", "action": "CREATE"}'},{data:'{"label":"'+l["MenuTab.Tab.Sparkline.Edit"]+'", "action": "EDIT"}',id:"sPsplitEditButton"}];t.view.Menu.create(S,r,o).then(function(){s.bind("#"+n.SUBMENUITEM+a.SPARKLINE+n.IDENTITY,"zmenuitemclick",function(e,t){!function(e,t){"CREATE"==t.action?u.openDialog(!0):u.openSidePanel(e)}(e,t.data)})})}(this),function(e){var t=e.sPlusPlus,a=e.ZSConstants.FeatureConstants,n=(e.ZSConstants.wCC,e.ZSEvents),i=(e.document.getElementById("popupmenu"),t.data.Defaults.MAX_COL,e.JSUtil.Math,n.topic),s=n.Groups,o=n.Names;t.view.Toolbar.Feature[a.SPARKLINE];i.register(s.Listener,o.SheetAction.ACTIVE_CELL.INFO,function(){var e=t.view.getActiveGridID(),a=t.view.getResourceID(e),n=t.view.getSheetID(e),i=t.view.getVersionID(e),s=(t.view.getSelectedSheets(e),t.view.getSheetState(e,n).getActiveCellRange()),o=t.data.getWorkBook(a,i).getSheetObj(n).sparklines.getInfo(s.startRow,s.startCol),l=document.querySelector("#sPsplitEditButton");l&&(o?l.classList.remove("sPDisable"):l.classList.add("sPDisable"))},"RID","SHEETID","VERSION","ROW","COLUMN")}(this);
!function(t){var e=t.ZSClass.AutoSuggest,i=function(t,e,i,n,o){this.picklistItem=t,this.text=t.displayString,this.onSelect=function(t){i(this)}.bind(this),n&&(this.onInsert=function(t,e){n(this.picklistItem,t,e)}.bind(this)),function(t,e){var i=document.createElement("DIV");for(var n in e){var o=e[n];i.setAttribute(o,data[o])}this.dom=i,s(this.dom,t.displayString,t.style)}.call(this,t,e),o&&o(this)};function s(t,e,i){t.appendChild(document.createTextNode(e))}i.prototype={appendTo:function(t){t.appendChild(this.dom)},insert:function(t,e){this.onInsert.call(this,t,e)},select:function(t){this.onSelect.call(this,t)},decorate:function(t,e){var i=this.text,n=this.dom;n.innerHTML="",t.split("").forEach(function(t){var o=new RegExp(function(t){return new RegExp("[()*+-/.]","gi").test(t)?"\\"+t:t}(t),"i"),r=i.search(o);s(n,i.substring(0,r),e.style),function(t,e){var i=document.createElement("span");i.style.fontWeight="bold",i.style.textDecoration="underline",s(i,e),t.appendChild(i)}(n,i[r]),i=i.substring(r+1,i.length)}),s(n,i,e.style)}},e.PicklistEntry=i}(this),function(t){var e=t.ZSClass.AutoSuggest,i=(e.Entry,e.Selector),s=e.PicklistEntry,n=!1;function o(t){this.editor=t.editor,this.container=t.container,this.selector=new i(this.container,t.height),this.list=[],this.onInsert=t.onInsert,this.onMouseInsert=t.onMouseInsert,function(){var t=this.editor,e={input:a.bind(this),focus:a.bind(this),blur:function(){n||this.selector.flush()}.bind(this),keydown:function(t){if("="!==this.editor.value.charAt(0)){var e=t.keyCode||t.which;if(this.selector.isEmpty())return;switch(e){case 40:t.preventDefault(),t.stopPropagation(),this.selector.increment();break;case 38:t.preventDefault(),t.stopPropagation(),this.selector.decrement();break;case 9:t.preventDefault(),t.stopPropagation();break;case 13:t.preventDefault(),t.stopPropagation(),this.selector.insert(e,t),n||this.selector.flush();break;case 27:t.preventDefault(),t.stopPropagation(),this.selector.flush()}}}.bind(this)};t.addListeners(e);var i=this;this.container.addEventListener("scroll",function(t){this.scrollHeight-this.scrollTop<i.selector.height.container+i.scrollLimit&&i.onScroll.call(i)})}.call(this)}function r(t){var e=this;t.dom.addEventListener("mousedown",function(i){e.onMouseInsert(t.picklistItem)})}function a(){"="!==this.editor.value.charAt(0)&&this.editor.isEnabled&&this.list&&this.list.length>0&&this.suggest(this.editor.value)}function c(t){t.preventDefault(),t.stopPropagation()}function h(t,e,i){i.preventDefault(),i.stopPropagation()}o.prototype={suggest:function(t){var e=document.createDocumentFragment();this.selector.flush();var i=this.list;this.count=0;for(var o=0,r=0;r<i.length;r++){i[r];if(this.suggestEntry(i[r],e,t),++o>2e3)break}if(this.container.appendChild(e),this.selector.isEmpty()){n=!0;var a=new s({displayString:"No Results"},[],c,h,void 0);a.appendTo(e),this.selector.add(a)}else n=!1;var l=this.container.getBoundingClientRect(),u=l.height,d=l.width;UserAction.calcPosition(this.editor.PicklistContainer,this.editor,void 0,void 0,d,u),this.selector.reset()},suggestEntry:function(t,e,i){var s=t.text;if(s.startsWith(i)||i&&s.toLowerCase().startsWith(i.toLowerCase())||s.contains(" "+i)||i&&s.toLowerCase().contains(" "+i.toLowerCase())){if(this.limit&&++this.count>this.limit)return;t.appendTo(e),t.decorate(i,t.picklistItem),this.selector.add(t)}},flush:function(){this.list=[],this.selector.flush(),this.count=0,n=!1},addEntry:function(t,e){this.list.push(t),this.suggestEntry(t,e||this.container)},addEntries:function(t){var e=document.createDocumentFragment();for(var i in t){var n=t[i],o=new s(n,[],this.onSelect,this.onInsert,r.bind(this));this.addEntry(o,e)}this.container.appendChild(e),this.container.style.display="block"},suggestAndSelect:function(t){var e=document.createDocumentFragment();this.selector.flush();var i=this.list;this.count=0;for(var s=0,n=-1,o=0;o<i.length;o++){if(i[o].text==t&&(n=o),this.suggestEntry(i[o],e,""),++s>2e3)break}-1!=n&&this.selector.selectIndex(n),this.container.appendChild(e)}},ZSClass.AutoSuggest.Picklist=o}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSEvents,i=n.topic,a=n.Groups,o=n.Names;t.ZSClass,t.UserAction;i.register(a.Selector.DomUpdate.CellEdit,o.Selection.BOUND_UPDATE.ADD,function(t,n,s,l){var c=e.data.getWorkBook(t,s),I=c.getSheetObj(n).Picklist.getInfo(l.startRow,l.startCol);if(I){var r=c.Picklist.getPicklistById(I.properties.id);setTimeout(function(){i.publish(a.Listener,o.UserAction.PICKLIST.SHOW_LIST,{LIST_ARRAY:r.getItemList()})},0)}},"RID","SHEETID","VERSION","ActiveRange")}(this),function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,i=t.ZSConstants.wCC,a=t.ZSEvents,o=t.UIUtil.Component,s=t.document.getElementById("popupmenu"),l=(e.data.Defaults.MAX_COL,t.JSUtil.Math,a.topic,a.Groups,a.Names,t.ZSConstants.I18N),c=e.view.Toolbar.Feature[n.PICKLIST],I={id:i.SUBMENUITEM+n.PICKLIST+i.IDENTITY,data:'{"componentOptions":{"label":"'+l["Picklist.Dialog.Picklist"]+'","type":"text_only", "itemType":"submenu"}}',relativeto:"parent"};e.view.Menu.create([{data:'{"label":"Create", "action": "CREATE"}'},{data:'{"label":"Manage", "action": "MANAGE"}',id:"plApplyBtn"}],I,s).then(function(){o.bind("#"+i.SUBMENUITEM+n.PICKLIST+i.IDENTITY,"zmenuitemclick",function(t,e){"CREATE"==e.data.action?c.openDialog():c.openManage()})})}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSConstants.FeatureConstants,n=e.ZSEvents,s=n.topic,r=n.Groups,o=n.Names,S=e.ZSConstants.CommandConstants;function v(e,t,i,n){s.register(r.Listener,o.ServerAction.PROCESSRESPONSE,E,"RESPONSE")}function E(e){var i=t.view.getActiveGridID(),n=t.view.getResourceID(i),v=t.view.getVersionID(i),a=t.view.getSheetID(i),u=e[S.DOCUMENT_META][n][S.SHEET_META][a][S.BUTTON];if(u[S.INSERT]){var c=u[S.INSERT][0];s.publish(r.Listener,o.UserAction.BUTTONS.EDIT,{RID:n,SHEETID:a,VERSION:v,ID:c})}s.unregister(r.Listener,o.ServerAction.PROCESSRESPONSE,E)}t.view.Toolbar.Feature[i.BUTTON].execute=function(i){var n,s=t.view.getActiveGridID(),r=t.view.getResourceID(s),o=t.view.getVersionID(s),S=t.view.getSheetID(s),E=t.view.getSheetState(s,S),a=t.view.getGridComponent(s);n=e.isCanvasGrid?a.getZoom():E.getZoom();var u=a.getCenterPoint(),c=(u.x-42.5)/n,g=(u.y-12.5)/n,I=new ZSClass.Button("",c,g,85,25);UserAction.AddButton(r,S,o,I,v)}}(this);
!function(t){if(!t.isCanvasGrid){var n=t.sPlusPlus,o=t.ZSClass,i=(n.data.UserInfo,o.UIGridComponent.prototype),e=0;i.EditButton=function(t,n,o,i){i=i||s.call(this);this.Button.placeEdit(i)},i.CancelEditButton=function(t,n,i,e){var a=o.Layer.Button;if(a.EditLayer.isActive()){e=a.EditLayer.getInteracter().getID();this.Button.removeEdit(e)}},i.SubmitEditButton=function(t,n,i,e){var a=o.Layer.Button;if(a.EditLayer.isActive()){e=a.EditLayer.getInteracter().getID();this.Button.submitEdit(e)}},i.AssignMacroButton=function(t,n,o,i,e){(function(t,n,o,i,e){i=i||s.call(this),this.Button.assignMacro(i,e)}).call(this,t,n,o,i,e)},i.CloneButton=function(t,n,i,e){(function(t,n,i,e){var a=new o.Layer.Modules.Clone.Helper(100,100);this.Button.clone(e,a)}).call(this,t,n,i,e)},i.DeleteButton=function(t,n,o,i){(function(t,n,o,i){this.Button.delete(i)}).call(this,t,n,o,i)},i.onButtonRepaint=function(t,o,i){(function(t,o,i){var e=n.data.getWorkBook(t,i).getSheetObj(o).Buttons.getMap();for(var s in e)a.call(this,t,o,i,s),u.call(this,t,o,i,s)}).call(this,t,o,i)},i.onButtonMeta=function(t,n,o,i){for(var e in this.Button.removeAll(),i)this.onButtonInsert(t,n,o,i[e])},i.onButtonInsert=function(t,n,o,i){var s=i[e];a.call(this,t,n,o,s),u.call(this,t,n,o,s)},i.onButtonDelete=function(t,n,o,i){var a=i[e];(function(t,n,o,i){this.Button.remove(i)}).call(this,t,n,o,a)},i.onButtonMove=function(t,n,o,i){var u=i[e];a.call(this,t,n,o,u)},i.onButtonResize=function(t,n,o,i){var u=i[e];a.call(this,t,n,o,u)},i.onButtonModify=function(t,n,o,i){var s=i[e];a.call(this,t,n,o,s),u.call(this,t,n,o,s)}}function a(t,o,i,e){var a=n.data.getWorkBook(t,i).getSheetObj(o).Buttons.get(e),u=a.getX(),s=a.getY(),c=a.getWidth(),l=a.getHeight();a&&this.Button&&this.Button.place(e,u,s,c,l)}function u(t,o,i,e){var a=n.data.getWorkBook(t,i).getSheetObj(o).Buttons.get(e);this.Button&&this.Button.setLabel(e,a.getLabel())}function s(){var t=this.Button.getActive();for(var n in t)return n}}(this);
!function(s){s.sPlusPlus;var t=s.ZSEvents,n=t.topic,e=t.Groups,o=t.Names;s.sPlusPlus.view.Events.Key.Entry.Button.Context.keyDown[s.ZSConstants.JSKeyCode.F2]=function(s,t,u,i){n.publish(e.Listener,o.UserAction.BUTTONS.EDIT,{RID:t,SHEETID:u,VERSION:i})}}(this);
!function(t){var E=t.sPlusPlus,n=t.ZSEvents,e=n.topic,T=n.Groups,S=n.Names,s=t.sPlusPlus.view.Events.Key.Entry.ButtonEdit.Context.keyDown,i=t.ZSConstants.JSKeyCode;function r(t,E,n,s){e.publish(T.Listener,S.UserAction.BUTTONS.SUBMITEDIT,{RID:E,SHEETID:n,VERSION:s})}function o(){return!1}function U(){var t=E.view.Events.Key;t.focusContext(t.Entry.Button.Context)}s[i.ESC]=function(t,E,n,s){e.publish(T.Listener,S.UserAction.BUTTONS.CANCELEDIT,{RID:E,SHEETID:n,VERSION:s})},s[i.ENTER]=function(t,E,n,e){return r(0,E,n,e),!1},s[i.TAB]=r,s[i.SHIFT+"+"+i.TAB]=r,s[i.DELETE]=o,s[i.BACKSPACE]=o,s[i.SUPER+"+"+i.A]=o,s[i.SUPER+"+"+i.C]=o,s[i.SUPER+"+"+i.V]=o,s[i.SUPER+"+"+i.X]=o,s[i.SHIFT+"+"+i.SPACE]=o,s[i.LEFT]=o,s[i.RIGHT]=o,s[i.UP]=o,s[i.DOWN]=o,s[i.SHIFT+"+"+i.ENTER]=o,s[i.SUPER+"+"+i.LEFT]=o,s[i.SUPER+"+"+i.RIGHT]=o,s[i.SUPER+"+"+i.UP]=o,s[i.SUPER+"+"+i.DOWN]=o,s[i.SUPER+"+"+i.SHIFT+"+"+i.LEFT]=o,s[i.SUPER+"+"+i.SHIFT+"+"+i.RIGHT]=o,s[i.SUPER+"+"+i.SHIFT+"+"+i.UP]=o,s[i.SUPER+"+"+i.SHIFT+"+"+i.DOWN]=o,e.register(T.Listener,S.UserAction.BUTTONS.EDIT,function(){var t=E.view.Events.Key;t.focusContext(t.Entry.ButtonEdit.Context)}),e.register(T.Listener,S.UserAction.BUTTONS.CANCELEDIT,U),e.register(T.Listener,S.UserAction.BUTTONS.SUBMITEDIT,U)}(this);
!function(e){var n=e.ZSEvents,t=e.sPlusPlus,a=n.topic,r=n.Groups,i=n.Names,o=ZSConstants.I18N,c=!1,s={buttons:[{text:o.Refresh,primary:!0},{text:"Cancel"}],countDown:60,timerMsg:o["WorkerCheck.Reloading"],reload:!1},d="none",l="block";function u(){var e=t.view.getActiveGridID(),n=t.view.getResourceID(e),a=t.view.getSheetID(e),r=t.view.getVersionID(e);UserAction.UpdateViewport(n,a,r)}function m(e){return void 0===e}!function(){var e=document.createElement("div");e.setAttribute("id","ancBnr");var n=document.createElement("div");n.setAttribute("id","ancBdy");var t=document.createElement("span");t.setAttribute("id","ancCtn");var a=document.createElement("button");a.setAttribute("id","ancLm"),n.appendChild(t),n.appendChild(a);var r=document.createElement("div");r.setAttribute("id","bannerClose"),e.appendChild(n),e.appendChild(r),e.style.display=d,document.body.insertBefore(e,document.body.firstChild)}(),a.register(r.Listener,i.DocAction.BANNER.ADD,function(e){if(void 0!=e&&0!==Object.keys(e).length&&!c){var n,a,r,i,p="BANNER_MSG",v="BANNER_LEARN",y="BANNER_LINK",f=document.querySelector("#ancBnr"),B=f.querySelector("#ancBdy"),b=f.querySelector("#bannerClose"),E=f.querySelector("#ancCtn"),w=f.querySelector("#ancLm");f.classList.add("ntftBanner","txt_cen"),B.classList.add("ntftBannerCtn"),E.classList.add("mr10"),w.classList.add("ml10","ntftBannerBtn"),b.classList.add("ntftBannreCls"),f.style.display=l,e.readOnlyMode?(E.innerText=o["Banner.ReadOnly.App.Server"],w.style.display=d,n="zannouncementbarnewRO"):(n="zannouncementbarnew",e.BANNER_TYPE&&e.BANNER_TYPE,a=e.bannerName,m(e[v])||""==e[v]?m(e[y])||""==e[y]?(E.innerText=e[p],w.style.display=d,b.style.display=d):(E.innerText=e[p],w.innerText="Learn More",w.addEventListener("click",function(){window.open(e[y],"_blank").focus()})):(E.innerText=e[p],w.innerText=e[v],w.addEventListener("click",function(){window.open(e[y],"_blank").focus()})),e.isRefreshNeeded&&(r=e[p],i=setTimeout(function(){window.location.reload(!0)},6e4),s.buttons[0].click=function(){clearTimeout(i),window.location.reload(!0)},s.buttons[1].click=function(){clearTimeout(i)},ZSClass.ZSAlert(r,s))),c=!0,b.addEventListener("click",function(){!function(e,n){var a=document.querySelector("#ancBnr");a.classList.add("ntftBannerHide"),setTimeout(function(){a.style.display=d,u()},500),t.view.measures.Top.announcementBanner=0,"zannouncementbarnew"===e&&n&&localStorage&&localStorage.setItem("AB",n)}(n,a)}),t.view.measures.Top.announcementBanner=40,u()}},"RESPONSE")}(this);
!function(e){var t,s,n,i,o,l,r,a,c,u,d,y,f=sPlusPlus,L=e.ZSEvents,m=L.topic,p=L.Groups,v=L.Names,g=e.document,S=f.view.Events.Key,T=S.Entry.Announcement.Context,q=T.keyDown,h=e.ZSConstants.JSKeyCode,A=(e.ZSConstants.I18N,f.data.AppRegistry.IMAGEPath),E=!1;function x(e){var L;E=!!e,f.data.AppRegistry.isWalkthroughViewed&&!E||(t||(function(e){n=e.querySelector(".anounceBoxCont"),i=g.querySelector(".shProfile"),o=e.querySelector(".dotCont"),l=e.querySelector(".annClsBtn"),r=e.querySelector("#slide0"),a=e.querySelector(".announceBoxData"),c=e.querySelector("#annLeftArw"),u=e.querySelector("#annRightArw"),d=e.querySelectorAll(".dots"),c.addEventListener("mousedown",function(){w()}),u.addEventListener("mousedown",function(){C()}),l.addEventListener("mousedown",function(){R(),D()});for(var t=0;t<d.length;t++)d[t].addEventListener("mousedown",k);q[h.LEFT]=w,q[h.RIGHT]=C,q[h.ESC]=R}(L=UserAction.getTemplate(["WALKTHROUGH_TEMPLATE"]).WALKTHROUGH_TEMPLATE),g.body.append(L),s=g.querySelector("#annBox"),t=!0),s.style.display="",s.classList.remove("closeAnn"),u.classList.remove("tick"),I(y=0,!0),setTimeout(function(){S.focusContext(T),n.style.display="",o.style.visibility="visible",o.style.display="",l.style.display="",u.style.visibility="visible",u.style.display="",c.style.display="",s.classList.add("zoomEffect")},600))}function w(){r.checked||((y-=1)<0&&(y=d.length-1),b(),I(y))}function C(){(y+=1)>=d.length-1&&(u.classList.contains("tick")&&(R(),D()),P(),y=d.length-1),I(y)}function D(){var t=f.view.getActiveGridID(),s=f.view.getResourceID(t),n=f.view.getVersionID(t);f.data.AppRegistry.isWalkthroughViewed||e.UserAction.Announcement(s,n,1)}function P(){u.classList.add("tick")}function b(){u.classList.contains("tick")&&u.classList.remove("tick")}function k(e){for(var t=0;t<d.length;t++)d[t].classList.remove("active");e.target.classList.add("active");var s=e.target.attributes[1].value;y=parseInt(s),W("slide"+y),s!=d.length-1?b():P()}function R(){s.classList.add("closeAnn"),i.classList.add("highlightAnn"),n.style.display="none",o.style.display="none",l.style.display="none",c.style.display="none",u.style.display="none",S.focusContext(S.Entry.CellEditor.Context),setTimeout(function(){s.style.display="none",i.classList.remove("highlightAnn"),s.classList.remove("zoomEffect"),G()},1e3),E||m.publish(p.UserAction,v.UserAction.WALKTHROUGH_CLOSE)}function U(){for(var e=0;e<d.length;e++)d[e].classList.remove("active");s.querySelector(".lbl"+y).classList.add("active")}function I(e,t){var n=s.querySelector("#slide"+e);W("slide"+e,t),n.checked=!0,U()}function G(){s.querySelector(".splatter1").classList.remove("splatter"),s.querySelector(".splatter2").classList.remove("splatter"),s.querySelector(".splatter3").classList.remove("splatter"),s.querySelector(".splatter4").classList.remove("splatter")}function H(){s.querySelector(".splatter1").classList.add("splatter"),s.querySelector(".splatter2").classList.add("splatter"),s.querySelector(".splatter3").classList.add("splatter"),s.querySelector(".splatter4").classList.add("splatter")}function W(e,t){"slide0"==e?(a.style.transform="translateX(2000px)",s.classList.add("firstSldTxt"),setTimeout(function(){s.querySelector("#annceLogo").src=""},90),setTimeout(function(){s.querySelector("#annceLogo").src=A+"announcement/logo.gif"},95),t?(setTimeout(function(){s.classList.remove("firstSldTxt")},2e3),setTimeout(function(){H()},2400)):(setTimeout(function(){s.classList.remove("firstSldTxt")},1600),setTimeout(function(){H()},2e3))):"slide1"==e?(a.style.transform="translateX(1200px)",setTimeout(function(){s.querySelector("#annSidePanel").src=""},90),setTimeout(function(){s.querySelector("#annSidePanel").src=A+"announcement/annSidePanel.gif"},95),setTimeout(function(){G()},100)):"slide2"==e?(a.style.transform="translateX(400px)",setTimeout(function(){s.querySelector("#annZiaLarge").src=""},90),setTimeout(function(){s.querySelector("#annZiaLarge").src=A+"announcement/annZiaLarge.gif"},95)):"slide3"==e?(a.style.transform="translateX(-400px)",setTimeout(function(){s.querySelector("#annDuplicatesLarge").src=""},90),setTimeout(function(){s.querySelector("#annDuplicatesLarge").src=A+"announcement/annDuplicatesLarge.gif"},95)):"slide4"==e?(a.style.transform="translateX(-1200px)",s.querySelector("#annDelugeLarge").src=A+"announcement/annDelugeLarge.svg"):"slide5"==e&&(a.style.transform="translateX(-2000px)"),"slide0"==e?(c.style.visibility="hidden",c.classList.add("initPos")):(c.style.visibility="visible",c.classList.remove("initPos"))}m.register(p.UI,v.Layout.TEMPLATE_LOADED,x),UserAction.showWalkthrough=x}(this);
!function(e){var t,n,o,s,i,r,l,a,u,c,d,m,h,g,p,y,f,T,C,L,v,I=sPlusPlus,A=e.ZSEvents,S=A.topic,x=A.Groups,E=A.Names,w=(A.Groups,I.view.Events.Key),B=(w.Entry.Announcement.Context.keyDown,e.ZSConstants.JSKeyCode),k=e.ZSConstants.I18N,P=(I.data.AppRegistry.IMAGEPath,w.Entry.pageTour.Context),q=P.keyDown,W=!1,D=!0,N=0,R=["chart","userFilter","share","functionSP","zia","dataMenuItem","listingPage"],_=R.length,b=["#MI_51_item_IDENTITY","#MI_35_IDENTITY","#MI_87_IDENTITY","#SP_COMMENTS_ICON",".sPZIABtm","#TB_DATA_IDENTITY","#tblogo"],H=document.querySelector("#TB_DATA_IDENTITY"),G=[k["Walkthrough.HeadList.VisualizeBetter"],k["Walkthrough.HeadList.UserLevelFilter"],k["Walkthrough.HeadList.WorkAsATeam"],k["Walkthrough.HeadList.ContextualComments"],k["Walkthrough.HeadList.AskZia"],k["Walkthrough.HeadList.CleanYourData"],k["Walkthrough.HeadList.AllYourSpreadsheets"]],M=[k["Walkthrough.Content.VibrantCharts"],k["Walkthrough.Content.UserLevelFilter"],k["Walkthrough.Content.ShareSpreadsheets"],k["Walkthrough.Content.Comments"],k["Walkthrough.Content.Zia"],k["Walkthrough.Content.DataCleaning"],k["Walkthrough.Content.ListingPage"]],U={dataCleaning:"#MI_240_MENU"},Y=["Got it"];function F(e){var u;!I.data.UserInfo.Permission.isEditable||I.data.AppRegistry.isTourRippleViewed&&!e||(W||(n=document.querySelector("#pageTourCont"),o=document.querySelector(".featureNavigator"),s=o.querySelector(".leftArw"),i=o.querySelector(".rgtArw"),r=o.querySelector(".wtHead"),l=o.querySelector(".navCont"),a=document.querySelector("#annGotItBtn"),g=document.querySelector(".tourClsBtn"),t=document.querySelector(".shProfile"),s.addEventListener("mousedown",function(){z()}),i.addEventListener("mousedown",function(){V()}),a.addEventListener("mousedown",function(){Z(),X()}),g.addEventListener("mousedown",function(){Z(),X()}),L=document.querySelector(".pageTourHighlighter"),v=document.querySelector(".tourHighlightClose"),L.addEventListener("mousedown",function(e){var t=e.target?e.target:e.scrElement,n=t.classList;if("tourHighlightClose"!=n){var o=document.querySelector(b[0]),s=document.querySelector(b[0]).parentElement,i=s.getBoundingClientRect();L.style.right=window.innerWidth-i.left-40+"px",L.style.top=i.top+"px",L.classList.remove("showHl"),L.classList.add("reachDest"),setTimeout(function(){o.classList.add("highlightAnn")},200),setTimeout(function(){O(),o.classList.remove("highlightAnn"),L.classList.remove("reachDest"),L.removeAttribute("style")},800),setTimeout(function(){document.body.removeChild(L)},801)}}),v.addEventListener("mousedown",function(){Z("highlight"),X()}),W=!0),D&&(H=document.querySelector("#TB_DATA_IDENTITY"),T=document.querySelector("#TB_DATA_POPUP_CONTAINER"),H.click(),H.click(),u=e,setTimeout(function(){w.focusContext(P)},600),u?O():setTimeout(function(){document.body.prepend(L),setTimeout(function(){L.classList.add("showHl")},500)},500)))}function O(){document.body.insertBefore(n,document.body.firstChild);var e=(m=document.getElementById(b[3].substring(1,b[3].length))).offsetTop;(h=m.cloneNode(!0)).classList.add("commentBtnCln"),(d=document.getElementsByClassName("mainGrid"))[0].append(h),h.style.top=e-3+"px";var t=(u=document.getElementsByClassName(b[4].substring(1,b[4].length)))[0].offsetTop;(c=u[0].cloneNode(!0)).classList.add("ziaBtnCln"),(d=document.getElementsByClassName("mainGrid"))[0].append(c),c.style.top=t+"px",n.classList.add(R[N]),K(1),r.innerText=G[0],l.innerText=M[0],a.innerText=Y[0],n.addEventListener("contextmenu",J)}function Z(e){j(T),"highlight"==e?(L.classList.add("closeAnn"),t.classList.add("highlightAnn"),setTimeout(function(){L.classList.remove("showHl","closeAnn"),document.body.removeChild(L),t.classList.remove("highlightAnn")},800)):(n.classList.add("closeAnn"),t.classList.add("highlightAnn"),o.style.display="none",setTimeout(function(){n.classList.remove(R[N]),document.body.removeChild(n),t.classList.remove("highlightAnn"),d[0].removeChild(c),d[0].removeChild(h)},1e3),setTimeout(function(){n.classList.remove("closeAnn"),o.removeAttribute("style"),N=0},1010))}function z(){if(N>0){if(n.classList.remove(R[N]),n.classList.add(R[N-1]),"zia"==R[N-=1])K(5);else if("share"==R[N]){document.querySelector("#topPtr");K(3),a.innerText=Y[0]}else"functionSP"==R[N]?K(4):"chart"==R[N]?K(1):"dataMenuItem"==R[N]?K(6):"userFilter"==R[N]&&K(2);r.innerText=G[N],l.innerText=M[N]}}function V(){N<_-1&&((N+=1)>_-1&&(N=_-1),n.classList.remove(R[N-1]),n.classList.add(R[N]),"zia"==R[N]?K(5):"functionSP"==R[N]?K(4):"listingPage"==R[N]?K(7):"share"==R[N]?K(3):"dataMenuItem"==R[N]?K(6):"userFilter"==R[N]&&K(2),r.innerText=G[N],l.innerText=M[N])}function K(e){switch(C=window.innerWidth,window.innerHeight,function(){for(var e=document.getElementsByClassName("imgDetails"),t=0;t<e.length;t++)e[t].style.display="none"}(),document.querySelector("#imgDt"+e).style.display="block",e){case 1:var t=document.querySelector(b[0]).getBoundingClientRect();o.style.right=C-(t.left+o.offsetWidth/2)+"px",o.style.left="auto",o.style.top=t.top+t.height+25+"px";break;case 2:t=document.querySelector(b[1]).getBoundingClientRect();o.style.right=C-(t.left+o.offsetWidth/2)+"px",o.style.left="auto",o.style.top=t.top+t.height+25+"px";break;case 3:t=document.querySelector(b[2]).getBoundingClientRect();o.style.right=C-(t.left+t.width+10)+"px",o.style.left="auto",o.style.top=t.top+t.height+20+"px";break;case 4:var n=document.querySelector(b[3]);t=n.getBoundingClientRect();o.style.right=t.width+30+"px",o.style.top=t.top-20+"px",setTimeout(function(){n.classList.add("menuItemProp"),n.classList.add("higlit")},1e3);break;case 5:j(T),H.classList.remove("menuItemProp"),Q(H,"menuItemProp"),Q(T,"menuItemProp");t=document.querySelector(b[4]).getBoundingClientRect();o.style.right=t.width+30+"px",o.style.top=t.top+t.height-o.offsetHeight+"px";break;case 6:D&&(q[B.LEFT]=z,q[B.RIGHT]=V,q[B.ESC]=Z),f=document.querySelector(U.dataCleaning);var s=H.getBoundingClientRect().left,i=H.getBoundingClientRect().top;setTimeout(function(){T.style.display="flex",T.style.left=s+"px",T.style.top=i+30+"px";var e=T.getBoundingClientRect(),t=f.getBoundingClientRect();o.style.right=C-(e.left+o.offsetWidth+e.width+30)+"px",o.style.left="auto",o.style.top=t.top-50+"px"},100),setTimeout(function(){H.classList.add("menuItemProp"),T.classList.add("menuItemProp"),f.classList.add("higlit")},1200);break;case 7:j(T),H.classList.remove("menuItemProp"),Q(H,"menuItemProp"),Q(T,"menuItemProp");t=document.querySelector(b[6]).getBoundingClientRect();o.style.right=C-(o.offsetWidth+10)+"px",o.style.left="auto",o.style.top=t.top+t.height+26+"px"}p=document.getElementById("incrCount"),y=document.getElementById("totCount"),p.innerText=e,y.innerText=b.length}function J(e){return e.stopPropagation(),!1}function j(e){var t=H.offsetLeft,n=H.offsetTop;e.style.display="none",e.style.left=t+"px",e.style.top=n+"px"}function Q(e,t){(" "+e.className+" ").indexOf(" "+t+" ")>-1&&e.classList.remove(t)}function X(){var t=I.view.getActiveGridID(),n=I.view.getResourceID(t),o=I.view.getVersionID(t);I.data.AppRegistry.isTourRippleViewed||e.UserAction.Announcement(n,o,2)}D&&(q[B.LEFT]=z,q[B.RIGHT]=V,q[B.ESC]=Z),S.register(x.UserAction,E.UserAction.WALKTHROUGH_CLOSE,F),UserAction.showTour=F}(this);
!function(t){var s=sPlusPlus,e=t.ZSEvents,n=e.topic,i=e.Groups,o=e.Names,r=(t.document,s.view.Events.Key),a=r.Entry.tipsTricks.Context;a.keyDown,t.ZSConstants.JSKeyCode,t.ZSConstants.I18N,s.data.AppRegistry.IMAGEPath;function c(){}n.register(i.UI,o.Layout.TEMPLATE_LOADED,c),UserAction.showTipsTricks=c}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,s=e.ZSConstants.I18N,r=e.ZSEvents,i=r.topic,o=r.Groups,a=r.Names,S=(e.ZSConstants.CommandConstants,t.view.Toolbar.Feature[n.RECALCULATE]),c=new ZSClass.TBNotification(s.Recalculating+"...",{mode:"STD",type:"info"});function E(e){c.remove(),i.register(o.Listener,a.ServerAction.PROCESSTRIMCELLRESPONSE,R,"DOCID","SHEETID","VERSION","ROW_DATA","COLUMN_DATA","XAID","CONDITIONAL_FORMAT")}function R(e,t,n,s,r,S,c){if(s&&r){for(var E=0,l=s.length-1;l>=0;l--)for(var v=s[l],u=v[0]+v[1]-1,C=v[0],I=u;I>=C;I--)for(var A=r[v[2]],D=A.length-1;D>=0;D--){var g=A[D];if(g)for(var T=g[0]+g[1]-1,L=g[0],O=T;O>=L;O--)i.publish(o.Listener,a.Layers.Recalculate.Place,{RID:e,SHEETID:t,VERSION:n,ID:E++,RANGE:new ZSClass.Range(I,O,I,O)})}i.unregister(o.Listener,a.ServerAction.PROCESSTRIMCELLRESPONSE,R)}else Logger.log("EMPTY DATA RESPONSE",s,r)}S.execute=function(){var n=t.view.getActiveGridID(),s=t.view.getResourceID(n),r=(t.view.getSheetID(n),t.view.getVersionID(n)),i=t.view.getSelectedSheets(n);c.show(!0),e.UserAction.Recalculate(s,i,r,E)}}(this);
!function(a){if(!a.isCanvasGrid){var e=a.sPlusPlus;a.ZSClass.UIPaneComponent.prototype.PlaceRecalculateFlash=function(a,t,s,l,i){var o=e.data.getWorkBook(a,s).getSheetObj(t);o.Merge.extendRange(i);var u=o.Row.auxiliaryAxis.getPos(i.startRow),c=o.Column.auxiliaryAxis.getPos(i.startCol),r=o.Row.auxiliaryAxis.getPos(i.endRow+1),h=o.Column.auxiliaryAxis.getPos(i.endCol+1),n=e.view.getSheetState(this.gridID,t).getZoom();this.RecalculateFlash&&this.RecalculateFlash.place(l,u*n,c*n,(r-u)*n,(h-c)*n),this.RecalculateFlash&&this.RecalculateFlash.show(l)}}}(this);
!function(i){function t(i){var t=document.createElement("div");t.classList.add("rFlash"),this.Dom=t,this.timeout=i}t.prototype={place:function(i,t,e,s){if(!this.inView){var h=this.Dom.style;h.top=i-1+"px",h.left=t-1+"px",h.height=e+1+"px",h.width=s+1+"px"}},hide:function(){this.Dom.remove(),this.Dom.classList.remove("glow"),this.inView=!1},show:function(i){if(!this.inView){this.inView=!0;var t=this;i.appendChild(this.Dom),setTimeout(function(){t.hide()},this.timeout)}}},i.ZSClass.UIRecalculateFlashLayer=t}(this);
!function(i){var t=i.ZSClass,s=t.UIRecalculateFlashLayer;function e(i){this.parent=i,this.inActive=[],this.Alive={}}e.prototype={place:function(i,t,e,l,n){this.isExist(i)||(this.Alive[i]=new s(2e3)),this.Alive[i].place(t,e,l,n)},show:function(i){this.isExist(i)&&this.Alive[i].show(this.parent)},isExist:function(i){return!!this.Alive[i]}},t.UIRecalculateFlashController=e}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSConstants.FeatureConstants,s=e.ZSEvents,n=s.topic,o=s.Groups,a=s.Names,r=(e.ZSConstants.CommandConstants,e.UIUtil.Component,e.ZSConstants.I18N,t.view.Toolbar.Feature[i.NOTE]);r.execute=function(e){var i=t.view.getActiveGridID(),s=t.view.getResourceID(i),r=t.view.getSheetID(i),v=t.view.getVersionID(i),g=(t.data.getWorkBook(s,v).getSheetObj(r),t.view.getSheetState(i,r).getActiveCellRange());n.publish(o.Listener,a.CellAction.COMMENT.NEW,{RID:s,SHEETID:r,VERSION:v,ROW:g.startRow,COL:g.startCol})},r.Clear=function(e){var i=t.view.getActiveGridID(),s=t.view.getResourceID(i),n=t.view.getSheetID(i),o=t.view.getVersionID(i),a=t.view.getSheetState(i,n).getActiveRange(),r=t.view.getSelectedSheets(i);UserAction.CellComment(s,r,o,"remove","",a)}}(this);
!function(E){E.sPlusPlus;var S=E.ZSEvents,T=S.topic,P=S.Groups,R=S.Names,t=E.sPlusPlus.view.Events.Key.Entry.CellNote.Context.keyDown,U=E.ZSConstants.JSKeyCode;function H(){return!1}function e(E){return E.preventDefault(),E.stopPropagation(),T.publish(P.Listener,R.CellAction.COMMENT.UPDATE),!1}t[U.PURE_PRINTABLE_CHAR]=H,t[U.DELETE]=H,t[U.BACKSPACE]=H,t[U.SUPER+"+"+U.C]=H,t[U.SUPER+"+"+U.X]=H,t[U.SUPER+"+"+U.V]=H,t[U.LEFT]=H,t[U.RIGHT]=H,t[U.UP]=H,t[U.DOWN]=H,t[U.ENTER]=H,t[U.SHIFT+"+"+U.LEFT]=H,t[U.SHIFT+"+"+U.RIGHT]=H,t[U.SHIFT+"+"+U.UP]=H,t[U.SHIFT+"+"+U.DOWN]=H,t[U.SUPER+"+"+U.LEFT]=H,t[U.SUPER+"+"+U.RIGHT]=H,t[U.SUPER+"+"+U.UP]=H,t[U.SUPER+"+"+U.DOWN]=H,t[U.SUPER+"+"+U.SHIFT+"+"+U.LEFT]=H,t[U.SUPER+"+"+U.SHIFT+"+"+U.RIGHT]=H,t[U.SUPER+"+"+U.SHIFT+"+"+U.UP]=H,t[U.SUPER+"+"+U.SHIFT+"+"+U.DOWN]=H,t[U.SHIFT+"+"+U.ENTER]=H,t[U.SUPER+"+"+U.A]=H,t[U.PAGEUP]=H,t[U.PAGEDOWN]=H,t[U.HOME]=H,t[U.END]=H,t[U.CTRL+"+"+U.HOME]=H,t[U.CTRL+"+"+U.END]=H,t[U.SHIFT+"+"+U.HOME]=H,t[U.SHIFT+"+"+U.END]=H,t[U.SUPER+"+"+U.HOME]=H,t[U.SUPER+"+"+U.END]=H,t[U.ESC]=e,t[U.TAB]=e,t[U.SHIFT+"+"+U.TAB]=e,t[U.SUPER+"+"+U.ENTER]=e,t[U.SUPER+"+"+U.SHIFT+"+"+U.ENTER]=e}(this);
!function(t){t.sPlusPlus;var e=t.ZSClass,i=t.UserAction,s=e.Editors.BasicEditor,n=e.Range,o="CellNoteTemplate",h="CellNoteHolder",l="http://www.w3.org/2000/svg";function r(e){var i=JSUtil.Key.getKeyCombination(e),s=t.ZSConstants.JSKeyCode;switch(i){case s.SUPER+"+"+s.SHIFT+"+"+s.ENTER:case s.SUPER+"+"+s.ENTER:return!0}}function a(t,e,i){for(var s in e)t.addEventListener(s,e[s].bind(i))}function d(t,e){this.Dom=function(t,e){var i=document.createElement("div");return e&&(i.className=e),t.appendChild(i),i}(t,h),this.line=function(t){var e=document.createElementNS(l,"svg");e.setAttribute("class","CellNoteLine");var i=document.createElementNS(l,"line");return i.setAttribute("x1",0),i.setAttribute("y1",0),e.appendChild(i),t.appendChild(e),i}(this.Dom),this.setLineCoordinates(0,0),function(t){var e=this.Dom,n=i.getTemplate([o])[o];e.appendChild(n);var h=e.querySelector(".CNEditor"),l=e.querySelector(".CNTrash");this.Comment=new s(h),this.Comment.customPreventDefault=r,this.CellInfo=e.querySelector(".CNInfo"),this.Trash=l,a(e,t.Container,this),a(h,t.Editor,this),a(l,t.Trash,this)}.call(this,e),this.onHide=e.onHide,this.hide()}d.prototype={hide:function(){this.onHide&&this.onHide(),this.Dom.style.display="none",this.Comment.blur()},show:function(){this.Dom.style.display=""},focus:function(){this.Comment.focus();var t=this.Comment.value.length;this.Comment.setSelectionRange(t,t)},place:function(t,e,i,s){var n=this.Dom,o=n.style;this.x=t,this.y=e,o.left=i?"":t+"px",o.right=i?t+"px":"",o.top=s?"":e+"px",o.bottom=s?e+"px":"";var h=n.classList;s?h.add("fixB"):h.remove("fixB"),i?h.add("fixR"):h.remove("fixR")},enable:function(){this.Comment.enable(),this.Trash.style.display=""},disable:function(){this.Comment.disable(),this.Trash.style.display="none"},setComment:function(t,e,i,s,o,h,l){this.rid=t,this.sheetID=e,this.version=i,this.range=new n(s,o,s,o),this.isAdd=!!l,this.CellInfo.dataset.cell=JSUtil.Cell.getReference(s,o),this.Comment.value=h},setLineCoordinates:function(t,e){this.line.setAttribute("x2",t),this.line.setAttribute("y2",e)},update:function(){var t=this.Comment.value;if(t){var e=this.isAdd?"add":"edit";i.CellComment(this.rid,[this.sheetID],this.version,e,t,this.range)}else i.CellComment(this.rid,[this.sheetID],this.version,"remove","",this.range)},delete:function(){i.CellComment(this.rid,[this.sheetID],this.version,"remove","",this.range)}},e.UICellNote=d}(this);
!function(e){var t,i,s,o,n,a=e.sPlusPlus,r=e.ZSClass,h=a.data.Defaults.MAX_COL,l=r.UICellNote,v=e.ZSEvents,u=v.topic,c=v.Groups,d=v.Names;function g(e){e.stopPropagation();var t=a.view.Events.Key;t.focusContext(t.Entry.CellNote.Context)}function C(){m.call(s),u.unregister(c.Listener,d.Mouse.RangeDown,C)}function m(){t&&this.Comment.blur(),t&&this.update(),t=!1}function A(t){var i=a.view.getActiveGridID(),r=a.view.getSheetState(i,s.sheetID).getZoom();o==s.x&&n==s.y||e.UserAction.MoveCellComment(s.rid,s.sheetID,s.version,s.range.startRow,s.range.startCol,s.x/r,s.y/r),e.removeEventListener("mousemove",f),e.removeEventListener("mouseup",A)}function f(t){var o,n,r,l,v,g,C,m,A,f,p,S,E,w,b,k=t.clientX-i.clientX,y=t.clientY-i.clientY,D=a.view.getActiveGridID(),L=a.view.getSheetState(D,s.sheetID).getZoom();o=s.rid,n=s.sheetID,r=s.version,l=s.range.startRow,v=s.range.startCol,g=(s.x+k)/L,C=(s.y+y)/L,m=a.data.getWorkBook(o,r).getSheetObj(n),A=e.JSUtil.Math.hash(l,v,h),f=m.Notes.get(A),p=m.Column.auxiliaryAxis,S=m.Row.auxiliaryAxis,E=m.Merge.isXists(l,v),w=p.getPos((E?E.root.endCol:v)+1),b=S.getPos(l),u.publish(c.Listener,d.Layers.Note.Place,{RID:o,SHEETID:n,VERSION:r,ROW:l,COL:v,COMMENT:f.value,X:g,Y:C,ROWX:w,COLY:b}),i=t}var p={Container:{mousedown:function(t){var r=a.data.getWorkBook(this.rid,this.version);r.isEditable()&&!r.ProtectedSheets.isSheetLocked(this.sheetID)&&(i=t,o=(s=this).x,n=s.y,t.stopPropagation(),t.preventDefault(),e.addEventListener("mousemove",f),e.addEventListener("mouseup",A))}},Editor:{keydown:function(i){var s=e.JSUtil.Key.getKeyCombination(i),o=e.ZSConstants.JSKeyCode;switch(s){case o.SUPER+"+"+o.ENTER:m.call(this);break;case o.ESC+"":var n=a.data.getWorkBook(this.rid,this.version).getSheetObj(this.sheetID),r=e.JSUtil.Math.hash(this.range.startRow,this.range.startCol,h),l=n.Notes.get(r);this.Comment.value=l.value,t=!1,this.Comment.blur()}},mousedown:g,dblclick:function(e){e.stopPropagation()},focus:function(e){t=!0,g(e),s=this,u.register(c.Listener,d.Mouse.RangeDown,C)},blur:m},Trash:{click:function(){this.delete()}}};function S(t,i){return e.JSUtil.Math.hash(t,i,h)}function E(e){this.parent=e,this.Alive={},this.inActive=[]}E.prototype={place:function(e,t,i,s,o,n,r,h,l,v,u){var c=this.getNote(s,o),d=a.data.getWorkBook(e,i),g=d.getSheetObj(t).ProtectedRanges.isXists(s,o),C=d.ProtectedSheets.isSheetLocked(t);!d.isEditable()||g||C?c.disable():c.enable(),c.place(n,r,v,u),c.setLineCoordinates(h-n,l-r),c.show()},setComment:function(e,t,i,s,o,n){this.getNote(s,o).setComment(e,t,i,s,o,n)},getNote:function(e,t){var i=S(e,t);return this.Alive[i]||(this.inActive.length?this.Alive[i]=this.inActive.pop():this.Alive[i]=new l(this.parent,p)),this.Alive[i]},hide:function(e,t){var i=S(e,t);this.Alive[i]&&(this.Alive[i].hide(),this.inActive.push(this.Alive[i]),delete this.Alive[i])},hideAll:function(){for(var e in this.Alive)this.Alive[e].hide(),this.inActive.push(this.Alive[e]),delete this.Alive[e]}},r.UICellNoteController=E}(this);
!function(e){if(!e.isCanvasGrid){var t=e.sPlusPlus,s=e.ZSClass.UIPaneComponent.prototype;s.PlaceCellNote=function(e,s,o,i,l,n,a,h,c,u,C,N){var m=t.view.getSheetState(this.gridID,s).getZoom();this.Notes.place(e,s,o,i,l,a*m,h*m,c*m,u*m,C,N),this.Notes.setComment(e,s,o,i,l,n)},s.RemoveCellNote=function(e,t,s,o,i){this.Notes.hide(o,i)},s.RemoveAllCellNotes=function(e,t,s){this.Notes.hideAll()}}}(this);
!function(e){var t,i,n=e.sPlusPlus,s=e.document,o=e.ZSConstants.FeatureConstants,l=(e.ZSConstants.wCC,e.UIUtil.Component),r=e.ZSEvents,u=r.topic,I=r.Groups,c=r.Names,a=e.ZSConstants.I18N,A=n.view.Toolbar.Feature[o.NOTE_SHOW_HIDE];var E=!1;function N(e){E?(w(e),E=!1):(v(e),E=!0)}function v(e){var t=n.view.getActiveGridID(),i=n.view.getResourceID(t),s=n.view.getSheetID(t),o=n.view.getVersionID(t);u.publish(I.Listener,c.CellAction.COMMENT.SHOWALL,{RID:i,SHEETID:s,VERSION:o})}function w(e){var t=n.view.getActiveGridID(),i=n.view.getResourceID(t),s=n.view.getSheetID(t),o=n.view.getVersionID(t);u.publish(I.Listener,c.CellAction.COMMENT.HIDEALL,{RID:i,SHEETID:s,VERSION:o})}u.register(I.UI,c.Toolbar.INIT_MENU,function(e){"sidePanelViewSetting"==e.id&&l.zmenu("#sidePanelViewSetting","setMenuItemsAttribute",[t],"checked",E)},"DOM"),u.register(I.Listener,c.CellAction.COMMENT.SHOWALL,function(){l.zmenu("#TB_VIEW_POPUP_CONTAINER","setMenuItemsAttribute",[i],"label",a["Notes.HideNotes"])}),u.register(I.Listener,c.CellAction.COMMENT.HIDEALL,function(){l.zmenu("#TB_VIEW_POPUP_CONTAINER","setMenuItemsAttribute",[i],"label",a["MenuItem.View.ShowAllNotes"])}),A.createShowAllMenu=function(e){(t=s.createElement("li")).setAttribute("data-value","showAllNotes"),t.setAttribute("data-item-type","checkbox"),t.innerText=a["Viewsettings.notes"],t.addEventListener("click",N),e.appendChild(t)},A.execute=function(e,t){i=t,N(e)},A.ShowAll=v,A.HideAll=w}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSConstants.FeatureConstants,s=e.ZSEvents,r=(s.topic,s.Groups,s.Names,e.ZSConstants.CommandConstants,e.ZSConstants.I18N),o=t.view.Toolbar.Feature[i.INPUT_CONTROLS],n={buttons:[{text:r.OK,primary:!0}],title:r["Menu.Checkbox"]};o.execute=function(i){var s=t.view.getActiveGridID(),o=t.view.getSelectedSheets(s),v=t.view.getResourceID(s),a=(t.view.getSheetID(s),t.view.getVersionID(s));!function(){var e=t.view.getActiveGridID(),i=t.view.getResourceID(e),s=t.view.getSheetID(e),r=t.view.getVersionID(e),o=t.view.getSheetState(e,s).getRanges(),n=t.data.getWorkBook(i,r).getSheetObj(s);for(var v in o)for(var a=o[v],c=a.startRow;c<=a.endRow;c++)for(var g=a.startCol;g<=a.endCol;g++)if(n.Picklist.isXists(c,g))return!0;return!1}()?e.UserAction.CHECKBOX_ADD(v,o,a):ZSClass.ZSAlert(r["Picklist.CheckBox"],n)},o.Clear=function(i){var s=t.view.getActiveGridID(),r=t.view.getSelectedSheets(s),o=t.view.getResourceID(s),n=(t.view.getSheetID(s),t.view.getVersionID(s));e.UserAction.CHECKBOX_CLEAR(o,r,n)},o.Remove=function(i){var s=t.view.getActiveGridID(),r=t.view.getSelectedSheets(s),o=t.view.getResourceID(s),n=(t.view.getSheetID(s),t.view.getVersionID(s));e.UserAction.CLEARCONTENTS(o,r,n)}}(this);
!function(e){var t,n,o,r,s,a,i,c,l,d,u=e.sPlusPlus,C=e.ZSConstants.FeatureConstants,p=e.ZSClass,v=e.ZSConstants.I18N,y=e.UIUtil,h=y.Component,f=e.document,m=e.ZSEvents,E=m.topic,g=m.Groups,K=m.Names,S=u.view.Toolbar.Feature[C.KEYBOARD_SHORTCUTS],L=f.getElementById("popupmenu"),b=e.navigator.platform.contains("Mac")?"mac":"windows",x=88,k=e.document.body;function T(e){var o=0;!t&&(t=f.querySelector("#ancBnr")),o=t?t.offsetHeight:o,n.style.height=window.innerHeight-u.view.measures.Top.Height-10+"px";var r,s=k.classList.contains("shRtl");this.css("top",x+t.offsetHeight+"px"),s?this.css({left:"0px",right:"auto"}):this.css({left:"auto",right:"0px"}),(r=u.view.Events.Key).focusContext(r.Entry.KeyboardShortcut.Context),i.focus()}function w(){var e;i.value="",D(S.KeyListings,b),(e=u.view.Events.Key).focusContext(e.Entry.CellEditor.Context)}function B(){clearTimeout(c),c=setTimeout(function(){H()},120)}function H(){var e=i.value;e=e.trim().toLowerCase();var t=S.KeyListings,n={};if(0==e.length)n=t;else for(var o in t)for(var r in t[o]){-1!==v[r].toLowerCase().indexOf(e)&&0!=t[o][r].length&&(n[o]||(n[o]={}),n[o][r]=t[o][r])}D(n,b)}function D(e,t){if(o.innerHTML="",Object.keys(e).length>0)for(var n in e){var i=r.cloneNode(!0);i.querySelector(".shKeyHdr").textContent=v[n],o.appendChild(i);var c=e[n];for(var l in c){var u=s.cloneNode(!0);u.querySelector(".shKeyProp").textContent=v[l];for(var C=u.querySelector(".shKeyVal"),p=c[l],y=p.length,h=0;h<y;h++){var m=f.createElement("span");"super"===p[h].toLowerCase()?m.textContent="mac"===b?"Cmd":"Ctrl":"remove"===p[h].toLowerCase()?m.textContent="mac"===b?"Delete":"Backspace":("mac"===b&&"delete"===p[h].toLowerCase()&&C.appendChild((d||((d=f.createElement("span")).textContent="Fn"),d.cloneNode(!0))),m.textContent=p[h]),C.appendChild(m)}o.appendChild(u)}}else{var E=a.cloneNode(!0);o.appendChild(E)}}E.register(g.UI,K.Layout.TEMPLATE_LOADED_DEFER,function(){var e=new p.SBFeature("KEYBOARDSHORTCUT");(l=e.div).className="sTKeyBrd",y.fn.addIcon(l,"KEYBOARD_ICON"),l.title=v["StatusBar.KeyBoardShortcuts"],e.add(),function(){S.KeyListings=function(e){var t=S.KeyListings,n={};for(var o in t)for(var r in t[o])0!=t[o][r].length&&(n[o]||(n[o]={}),n[o][r]=t[o][r]);return n}(S.KeyListings);var e=S.KeyListings,t=UserAction.getTemplate(["kbsContainer","kbsHeaderContainer","kbsKeyContainer","kbsEmptyState"]);r=t.kbsHeaderContainer,s=t.kbsKeyContainer,a=t.kbsEmptyState;var c=t.kbsContainer;L.appendChild(c),n=f.querySelector("#kbsContainerDiv"),o=n.querySelector(".shKeyWhole"),i=n.querySelector("#kbsSearchBox"),n.querySelector("#kbsCloseKeyPanel").addEventListener("click",function(e){h.zpopover(l,"close")}),i.addEventListener("search",H),i.addEventListener("keyup",B),D(e)}(),h.zpopover(l,{isContentHTMLEncoded:!0,className:"shKeyboardMain",content:"#kbsContainerDiv",displayType:"box",open:T,close:w})})}(this);
!function(t){var e=t.sPlusPlus,r=t.ZSConstants.FeatureConstants;e.view.Toolbar.Feature[r.KEYBOARD_SHORTCUTS].KeyListings={"Shortcut.Category.FileOperations":{"Shortcut.OpenFile":["Super","O"],"Shortcut.SaveAsFile":["Super","Shift","S"],"Shortcut.PrintFile":["Super","P"]},"Shortcut.Category.Actions":{"Shortcut.Undo":["Super","Z"],"Shortcut.Redo":["Super","Y"],"Shortcut.Repeat":["Alt","Enter"],"Shortcut.Cut":["Super","X"],"Shortcut.Copy":["Super","C"],"Shortcut.Paste":["Super","V"],"Shortcut.InsertRows":["Ctrl","Alt","="],"Shortcut.InsertColumns":["Ctrl","Shift","="],"Shortcut.InsertNewWorksheet":["Shift","F11"],"Shortcut.HideRow":["Super","Alt","9"],"Shortcut.HideColumn":["Super","Alt","0"],"Shortcut.UnhideRow":["Super","Shift","9"],"Shortcut.UnhideColumn":["Super","Shift","0"],"Shortcut.RunViewMacroList":["Alt","F8"],"Shortcut.OpenVBAEditor":["Alt","F11"],"Shortcut.AddEditHyperlink":["Super","K"],"Shortcut.AddEditCellNote":["Shift","F2"],"Shortcut.AddComment":["Super","Alt","M"],"Shortcut.FillDown":["Super","D"],"Shortcut.FillToRight":["Super","R"],"Shortcut.Filter":["Super","Shift","L"],"Shortcut.Filter.Reapply":["Super","Alt","L"],"Shortcut.Find":["Super","F"],"Shortcut.Replace":["Super","Shift","H"],"Shortcut.NamedRanges":["Super","F3"],"Shortcut.InsertCurrentDate":["Super",";"],"Shortcut.InsertCurrentTime":["Super","Shift",";"],"Shortcut.InsertCurrentDateAndTime":["Super","Alt",";"],"Shortcut.DisplayAutoSuggest":["Alt","Down"],"Shortcut.ToggleAutoComplete":["Ctrl","Shift","Q"]},"Shortcut.Category.Navigate":{"Shortcut.NextCellInRow":["Tab"],"Shortcut.PreviousCellInRow":["Shift","Tab"],"Shortcut.UpOneScreen":["Page Up"],"Shortcut.DownOneScreen":["Page Down"],"Shortcut.FirstCellInDataRegion":["Super","Home"],"Shortcut.LastCellInDataRegion":["Super","End"],"Shortcut.GotoCell":["Super","G"],"Shortcut.DataRegionLeft":["Super","Left"],"Shortcut.DataRegionRight":["Super","Right"],"Shortcut.DataRegionDown":["Super","Down"],"Shortcut.DataRegionUp":["Super","Up"],"Shortcut.FocusNameBox":["Ctrl","Shift","N"],"Shortcut.MoveToNextWorksheet":["Alt","Right"],"Shortcut.MoveToPreviousWorksheet":["Alt","Left"]},"Shortcut.Category.Editing":{"Shortcut.EditActiveCell":["F2"],"Shortcut.CancelCellEntry":["Esc"],"Shortcut.FocusFormulaField":["Super","Shift","F"],"Shortcut.DeleteSelected":["Remove"],"Shortcut.DeleteSelectedFormats":["Shift","Remove"],"Shortcut.DeleteSelectedAll":["Super","Remove"],"Shortcut.DeleteCharacterToRight":["Delete"],"Shortcut.DeleteCharacterToLeft":["Remove"],"Shortcut.InsertLineBreak":["Alt","Enter"]},"Shortcut.Category.Formatting":{"Shortcut.BoldToggle":["Super","B"],"Shortcut.ItalicToggle":["Super","I"],"Shortcut.UnderlineToggle":["Super","U"],"Shortcut.StikethroughToggle":["Super","Shift","X"],"Shortcut.ApplyNumberFormat":["Ctrl","Shift","1"],"Shortcut.ApplyTimeFormat":["Ctrl","Shift","2"],"Shortcut.ApplyDateFormat":["Ctrl","Shift","3"],"Shortcut.ApplyCurrencyFormat":["Ctrl","Shift","4"],"Shortcut.ApplyPercentageFormat":["Ctrl","Shift","5"],"Shortcut.ApplyScientificFormat":["Ctrl","Shift","6"],"Shortcut.CancelFormatPainter":["Esc"]},"Shortcut.Category.Selection":{"Shortcut.SelectSpreadsheet":["Super","A"],"Shortcut.SelectColumn":["Ctrl","Space"],"Shortcut.SelectRow":["Shift","Space"],"Shortcut.SelectTillA1":["Ctrl","Shift","Home"],"Shortcut.SelectTillLastIndataRegion":["Ctrl","Shift","End"],"Shortcut.SelectFromCurrentToFirstInRow":["Shift","Home"],"Shortcut.SelectFromCurrentToLastInRow":["Shift","End"],"Shortcut.SelectDataRegionToLeft":["Super","Shift","Left"],"Shortcut.SelectDataRegionToRight":["Super","Shift","Right"],"Shortcut.SelectDataRegionToDown":["Super","Shift","Down"],"Shortcut.SelectDataRegionToUp":["Super","Shift","Up"]},"Shortcut.Category.Formula":{"Shortcut.StartFormula":["="],"Shortcut.Recalculate":["F9"],"Shortcut.ToggleReference":["F4"],"Shortcut.AutoSum":["Alt","="],"Shortcut.ShowFunctionDialog":["Shift","F3"],"Shortcut.ToggleFormulaBar":["Super","Shift","U"],"Shortcut.InsertArrayFormulaOnRange":["Super","Shift","Enter"],"Shortcut.SelectArrayFormula":["Super","/"]},"Shortcut.Category.Object":{"Shortcut.SelectFocusObject":["Super","Click"],"Shortcut.MoveObject":["Arrow"],"Shortcut.SnapLeftTopToAdjacentCell":["Super","Arrow"],"Shortcut.SnapRightBottomToAdjacentCell":["Super","Shift","Arrow"],"Shortcut.NavigateToNextObject":["Tab"],"Shortcut.NavigateToPrevObject":["Shift","Tab"],"Shortcut.EditMode":["F2"],"Shortcut.ReturnFocusToCell":["Esc"],"Shortcut.CancelDragging":["Esc"]}}}(this);
!function(e){var t,n,i,o=e.sPlusPlus,s=(e.ZSClass,e.ZSEvents),r=s.topic,a=s.Groups,c=s.Names,d=e.UIUtil,u=o.view.measures,v=o.view.Events.Key,l=e.ZSConstants.I18N,f=!1;function m(){(i=document.createElement("div")).className="sTchatBar",i.title=l["BottomBand.Chat.Show"],d.fn.addIcon(i,"WMS_CHAT"),i.addEventListener("click",I),t=document.querySelector(".sheetTabHldrCtn");var e=document.querySelector("#sheetTabsOption");e.insertBefore(i,e.children[0]),function(){n||"undefined"==typeof WmsMainUI||(n=WmsMainUI.maincontainer);n&&n.addEventListener("click",function(){var e=v.Entry.cliqTab.Context;v.focusContext(e)})}()}function I(){var e=o.view.getActiveGridID(),t=o.view.getResourceID(e),n=o.view.getVersionID(e),i=o.view.getSheetID(e);f?(g(t,i,n),f=!1,v.focusContext(v.Entry.CellEditor.Context)):(w(t,i,n),f=!0),function(e,t,n,i){UserAction.setUserSettings(e,t,n,"VIEW","CHATBAR",i)}(t,i,n,f)}function w(e,o,s){n||"undefined"==typeof WmsMainUI||(n=WmsMainUI.maincontainer),n&&(u.Bottom.chatBar=28,t.style.bottom="28px",n.style.display="block",i.title=l["BottomBand.Chat.Hide"],UserAction.UpdateViewport(e,o,s))}function g(e,o,s){n||"undefined"==typeof WmsMainUI||(n=WmsMainUI.maincontainer),n&&(u.Bottom.chatBar=0,t.style.bottom="0px",n.style.display="none",i.title=l["BottomBand.Chat.Show"],UserAction.UpdateViewport(e,o,s))}function U(e){if(e&&e.cbv){var t=o.view.getActiveGridID(),n=o.view.getResourceID(t),i=o.view.getVersionID(t),s=o.view.getSheetID(t);"true"==e.cbv?(w(n,s,i),f=!0):(g(n,s,i),f=!1,v.focusContext(v.Entry.CellEditor.Context))}}r.register(a.UI,c.Layout.TEMPLATE_LOADED_DEFER,function(){if(!o.data.PageRegistry.wmsOptions.isAnonUser){var e=o.view.getActiveGridID(),t=o.view.getResourceID(e),n=o.view.getSheetID(e),i=o.view.getVersionID(e);m(),function(e,t,n){UserAction.getUserSettings(e,t,n,"VIEW",U)}(t,n,i)}})}(this);
!function(e){var t,a=e.sPlusPlus,n=(e.document,e.ZSClass),s=e.ZSEvents,i=s.topic,u=s.Groups,r=s.Names,d=document.getElementById("popupmenu"),l=e.ZSConstants.I18N,o=(e.UIUtil.Component,a.view.measures,{}),c={akey:"sum",value:0},m={},v={sum:l["StatusBar.Sum"],avg:l["StatusBar.Average"],min:l["StatusBar.Minimum"],max:l["StatusBar.Maximum"],count:l["StatusBar.Count"],cn:l["StatusBar.CountNumbers"]},y=new n.SBFeature("AGGREGATEFUNCTION"),S=y.div;function p(e){var t=document.createElement("li");return function(e,t){e.setAttribute("mtype","custom"),e.classList.add("ui-zmenu-item"),e.dataset.akey=t,e.dataset.value=m[t],e.innerText=v[t]+" : "+m[t]}(t,e),t.addEventListener("click",function(){var e,t,a=this.dataset.akey,n=this.dataset.value;e=a,t=n,o.akey=e,o.value=t,f(a,n),g(a)}),t}function f(e,t){S.textContent=v[e]+" = "+t,S.style.display="block"}function g(e){for(var a=0;a<t.children.length;a++)t.children[a].classList.remove("selected"),e==t.children[a].dataset.akey&&t.children[a].classList.add("selected")}i.register(u.Listener,r.SheetAction.ACTIVE_CELL_RANGE.STATUS,function(e){if(0!=Object.keys(e).length){for(var a in v)m[a]=e[a];!function(){for(var e in t.innerHTML="",m)if(void 0!=m[e]){var a=p(e);t.appendChild(a)}t.children[0]}();var n=o.akey?o.akey:c.akey;void 0===m[n]&&(n="count"),f(n,m[n]),g(n)}else S.style.display="none"},"STATUS"),S.className="aggregationHolderVal",S.setAttribute("data-menu-id","aggreateNode"),S.style.display="none",y.add(),(t=document.createElement("ul")).id="aggreateNode",t.setAttribute("data-ctype","zmenu"),d.appendChild(t)}(this);
!function(e){var t,i=e.sPlusPlus,a=e.document,r=e.ZSConstants.wCC,n=e.ZSEvents,s=e.UIUtil.Component,o=n.topic,u=n.Groups,c=n.Names,d=i.view.measures,l=a.getElementById("popupmenu");function v(e){var t=i.view.getActiveGridID(),a=i.view.getResourceID(t),r=i.view.getSheetID(t),n=i.view.getVersionID(t);UserAction.SwitchSheet(a,r,n,e),o.publish(u.Listener,c.DocMeta.SCROLL_SHEET,{RID:a,SHEETID:e,VERSION:n})}i.view.Toolbar.Feature.VIEW_SHEET_LIST.createSheetList=function(){var n=i.view.getActiveGridID(),o=i.view.getResourceID(n),u=i.view.getSheetID(n),c=i.view.getVersionID(n),h=i.data.getWorkBook(o,c),I=h.SheetList.getSheets();t&&t.remove();var m=e.innerHeight-(d.Top.Height+d.Bottom.Height);(t=a.createElement("ul")).className="sheetListMenu",t.setAttribute("data-ctype","zmenu"),t.setAttribute("data-scroll","default"),t.setAttribute("data-min-width",160),t.setAttribute("data-height",m),t.setAttribute("data-content-type","icon-text"),t.id=r.SUBMENUITEM+"SHEETLIST"+r.IDENTITY;var S=function(e,t){for(var i=a.createDocumentFragment(),r=e.length,n=0;n<r;n++){var s=e[n],o=a.createElement("li");o.setAttribute("data-item-type","checkbox"),o.setAttribute("data-value",s.Id),s.Id==t&&o.setAttribute("data-checked",!0),o.innerText=s.Name,o.addEventListener("click",v.bind(null,s.Id)),i.appendChild(o)}return i}(I,u);t.appendChild(S),l.appendChild(t),s.bind(t,"zmenubeforeshow",function(e,t){for(var i=t.menu.children(),r=i.length,n=0;n<r;n++){var s=i[n],o=s.dataset.value;u=s,c=h.SheetList.getById(o).Style,void 0,l=void 0,d=u.querySelector(".zmenu__text"),(l=a.createElement("span")).className="shTabClr",l.style.backgroundColor=c,u.insertBefore(l,d)}var u,c,d,l})}}(this);
!function(e){var t,i=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,s=(e.UserAction,e.ZSEvents),o=s.topic,r=s.Groups,a=s.Names,S=e.ZSConstants.I18N,c=i.view.Toolbar.Feature[n.INSERT_SHEET],v=c.addSheetBtn,u=c.addBtnHolder,d=!0;function E(e){d||(v.style.pointerEvents="auto",d=!0,t&&t.remove())}function l(){u.style.display=""}c.execute=function(e,n){if(d){v.style.pointerEvents="none",d=!1,(t=new ZSClass.TBNotification(S["Statusbar.Sheet.Creating"],{mode:"STD",type:"info"})).show();var s=i.view.getActiveGridID(),o=i.view.getResourceID(s),r=(i.view.getSheetID(s),i.view.getVersionID(s)),a=i.view.getSelectedSheets(s),c=!n;UserAction.InsertSheet(o,a,r,void 0,void 0,void 0,c)}},o.register(r.Listener,a.DocAction.WORKSHEETS.INSERT,E,"isActionOwner"),o.register(r.Listener,a.GridAction.BEFORE_RELOAD,E),o.register(r.Listener,a.UserAction.VERSION_HISTORY.UPDATE_BUTTON_STATE,function(e){e==i.data.Defaults.version?l():u.style.display="none"},"versionNumber"),o.register(r.UI,a.SidePanel.VersionHistory.CLOSE,l)}(this);
!function(e){var t,n,i,a,s=e.sPlusPlus,o=e.ZSConstants,r=(o.FeatureConstants,e.UserAction,e.ZSEvents),l=(r.topic,r.Groups,r.Names,o.I18N),c=ZSClass.Editors,d=s.view.Toolbar.Feature.RENAME_SHEET,u=e.UIUtil,v={keydown:function(e){var t=s.view.getActiveGridID(),n=s.view.getResourceID(t),i=s.view.getSheetID(t),a=s.view.getVersionID(t);switch(e.keyCode||e.which){case 13:I(n,i,a,this.value),e.stopPropagation();break;case 27:E()}}},m=20;function h(e){if(!a){t=this.tab,n=this.name;var o=t.offsetWidth;t.innerText="";var r,l=document.createElement("input");l.className="shRenameInput",l.setAttribute("maxlength",31),l.style.width=o-m+"px",t.appendChild(l),(i=new c.TextAreaEditor(l)).value=this.name,i.addListeners(v),i.focus(),l.select(),(r=s.view.Events.Key).focusContext(r.Entry.SheetTab.Context),document.body.addEventListener("mousedown",C),a=!0}}function E(e){S(),t.innerText=n;var i=document.createElement("span");i.className="sheetTabArrow",i.setAttribute("data-menu-id","MI_SHEET_CONTEXT"),u.fn.addIcon(i,"PATCHED_DROPDOWN_ICON"),t.appendChild(i)}function S(){document.body.removeEventListener("mousedown",C),setTimeout(function(){var e=s.view.Events.Key;e.focusContext(e.Entry.CellEditor.Context)},10),a=!1}function C(e){var t=e.target,n=s.view.getActiveGridID(),a=s.view.getResourceID(n),o=s.view.getSheetID(n),r=s.view.getVersionID(n);if("shRenameInput"==t.className||t.className.contains("activeTab"))return!1;I(a,o,r,i.value)}function I(e,i,a,o){var r=s.data.getWorkBook(e,a),c={buttons:[{text:l.OK,primary:!0,click:E}],dontSetPrevContextFlag:!0};if(!o||0===o.trim().length)return S(),c.title=l["Alert.Title.InvalidSheetName"],void ZSClass.ZSAlert(l["Rename.SheetNameCannotBeEmpty"],c);var d=r.SheetList.clone();return d.removeById(d.getIdByName(n)),d.isNameExists(o)?(S(),c.title=l["Alert.Title.SheetNameExists"],void ZSClass.ZSAlert(l["Error.Sheet.Name.Exists"],c)):JSUtil.REGEXP.validSheetName.test(o)?void(o!=n?(t.innerText=o,UserAction.RenameSheet(e,[i],a,o),S()):E()):(S(),c.title=l["Alert.Title.InvalidSheetName"],void ZSClass.ZSAlert(l.SheetNameShouldContain,c))}d.execute=h,UserAction.UISheetRename=h}(this);
!function(e){var t=e.sPlusPlus,i=e.UserAction,o=t.view.Toolbar.Feature.DUPLICATE_SHEET,s=e.ZSConstants.I18N;o.execute=function(){var e=t.view.getActiveGridID(),o=t.view.getResourceID(e),c=t.view.getVersionID(e),n=t.data.getWorkBook(o,c),r=t.view.getSheetID(e),S=(a=n.getSheetObj(r)).Prop.Name,a=n.getSheetObj(r),u=n.ProtectedSheets.isSheetLocked(r),h=!a.ProtectedRanges.isEmpty(),g=t.view.getSelectedSheets(e);if(u||h){var l=new ZSClass.ZSConfirm(s["DuplicateSheet.LockConfirmMsg"]);l.onYES(function(){i.DuplicateSheet(o,g,c,S,!0,S)}),l.onNO(function(){i.DuplicateSheet(o,g,c,S,!1,S)}),l.execute()}else i.DuplicateSheet(o,g,c,S,!1,S)}}(this);
!function(e){var t=e.sPlusPlus,i=(e.ZSConstants.FeatureConstants,e.UserAction,e.ZSEvents),s=(i.topic,i.Groups,i.Names,e.ZSConstants.I18N);t.view.Toolbar.Feature.DELETE_SHEET.execute=function(){var i=t.view.getActiveGridID(),r=t.view.getResourceID(i),a=t.view.getVersionID(i,r),o=t.view.getSelectedSheets(i)[0],n=t.data.getWorkBook(r,a).SheetList.getById(o).getName();n='"'+n+'"';var v=s["SheetTab.DeleteSheet.Warning"],S=e.JSUtil.fn.replaceParams(v,[n]),c={buttons:[{text:s.Yes,primary:!0,click:function(){var e,i,s,r,a,o;e=t.view.getActiveGridID(),i=t.view.getResourceID(e),s=t.view.getSheetID(e),r=t.view.getVersionID(e),(a=t.data.getWorkBook(i,r)).getSheetObj(s),a.SheetList.getNextAvalable(s),o=t.view.getSelectedSheets(e),UserAction.RemoveSheet(i,o,r)}},{text:s.No}],title:s["Alert.Title.SheetDelete"]};ZSClass.ZSAlert(S,c)}}(this);
!function(e){var t=e.sPlusPlus,o=(e.ZSConstants.FeatureConstants,e.UserAction,e.ZSEvents),i=(o.topic,o.Groups,o.Names,e.ZSConstants.I18N,t.view.Toolbar.Feature.COPY_SHEET);t.view.Toolbar.Feature.PASTE_SHEET;i.execute=function(){var e=t.view.getActiveGridID(),o=t.view.getResourceID(e),i=t.view.getSheetID(e),r=t.view.getVersionID(e),s=t.data.getWorkBook(o,r).getSheetObj(i).Prop.Name,a=t.view.getSelectedSheets(e);UserAction.serverClipCopySheet(o,a,r,s)},i.copySheetAction=function(e,o,i){var r=t.data.getWorkBook(e,i).getSheetObj(o).Prop.Name,s=t.view.getActiveGridID(),a=t.view.getSelectedSheets(s);UserAction.serverClipCopySheet(e,a,i,r)}}(this);
!function(e){var t=e.sPlusPlus,s=(e.ZSConstants.FeatureConstants,e.UserAction,e.ZSEvents),a=s.topic,r=s.Groups,o=s.Names,i=e.ZSConstants.I18N,n=t.view.Toolbar.Feature.COPY_TO_NEW_SPREADSHEET,c=t.view.Toolbar.Feature.PASTE_SHEET;function S(e,s,a,r,o){var i=t.view.getActiveGridID(),n=(e=t.view.getResourceID(i),t.data.getWorkBook(e,a)),S=t.view.getSheetID(i),l=n.getSheetObj(S).Prop.Name;"sdoc"==o&&(0==r.length?UserAction.serverClipCopytoNewSheet(e,s,a,l,!1):c.openDialog(o,r))}n.copySheetAction=function(s,a,r){t.data.getWorkBook(s,r).getSheetObj(a).Prop.Name;var o=t.view.getActiveGridID(),i=t.view.getSelectedSheets(o);e.UserAction.CopyRefSheets(s,r,i,"sdoc",S)},a.register(r.Listener,o.DocAction.WORKSHEETS.SERVERCOPYSHEET,function(e,s,a,r){var o=sPlusPlus.data.AppRegistry.ctxpath+t.data.AppRegistry.ClientURI+r,n=document.createElement("div");n.innerHTML=JSUtil.fn.replaceParams(i["CopySheet.Create.New.Spreadsheet.SuccessMessage"],["<br><a class='ZsLink p0' href='"+o+"' target='_blank'>","</a>"]);var c=[{text:i["MenuItem.FileTab.Open"],primary:!0,click:function(){window.open(o,"_blank")}},{text:i.Close}];ZSClass.ZSAlert(n,{type:"success",title:i["Alert.Title.SpreadsheetCreated"],isHtml:!0,buttons:c})},"RID","SHEETID","VERSION","NEWRID")}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSConstants,o=i.FeatureConstants,s=e.UserAction,r=i.wCC,n=e.ZSEvents,a=n.topic,I=n.Groups,v=n.Names,g=e.UIUtil.Component,E=t.view.Toolbar.Feature[o.HIDE_SHEET];E.execute=function(){var e=t.view.getActiveGridID(),i=t.view.getResourceID(e),o=t.view.getSheetID(e),r=t.view.getVersionID(e),n=(t.data.getWorkBook(i,r).getSheetObj(o),t.view.getSelectedSheets(e));s.HideSheet(i,n,r)},a.register(I.UI,v.Toolbar.INIT_MENU,function(e){if(e==E.parent){var i=t.view.getActiveGridID(),s=t.view.getResourceID(i),n=(t.view.getSheetID(i),t.view.getVersionID(i));t.data.getWorkBook(s,n).SheetList.getSheets().length<=1?g.disable("#"+r.MI+o.HIDE_SHEET+r.MENU):g.enable("#"+r.MI+o.HIDE_SHEET+r.MENU)}},"DOM")}(this);
!function(e){var t,n=e.sPlusPlus,i=e.document,r=e.UserAction,d=e.ZSConstants,o=d.FeatureConstants,a=e.ZSEvents,u=(a.topic,a.Groups,a.Names,i.getElementById("popupmenu")),s=d.I18N,l=d.wCC,v=(n.view.Toolbar.Feature[o.UNHIDE_SHEET],e.UIUtil.Component);function c(e){var i=n.view.getActiveGridID(),d=n.view.getResourceID(i),o=n.view.getVersionID(i),a=[];if(e)a.push(e);else{e=n.view.getSheetID(i);for(var u=n.data.getWorkBook(d,o).SheetList.getHiddenSheets(),s=0;s<u.length;s++)a.push(u[s].Id)}t&&(t.style.display="none"),r.unHideSheet(d,a,o,m)}function m(e,t,i){var d=n.view.getActiveGridID(),o=n.view.getSheetID(d);r.SwitchSheet(e,o,i,t)}t&&t.remove(),(t=document.createElement("ul")).id=l.SUBMENUITEM+o.UNHIDE_SHEET+l.IDENTITY,t.setAttribute("data-ctype","zmenu"),u.appendChild(t),v.bind("#"+l.SUBMENUITEM+o.UNHIDE_SHEET+l.IDENTITY,"zmenubeforeshow",function(e){!function(){t.innerHTML="",v.zmenu(t,"destroy");var e=function(){for(var e=n.view.getActiveGridID(),t=n.view.getResourceID(e),i=(n.view.getSheetID(e),n.view.getVersionID(e)),r=n.data.getWorkBook(t,i).SheetList.getHiddenSheets(),d=r.length,o=document.createDocumentFragment(),a=0;a<d;a++){var u=r[a],l=document.createElement("li");l.setAttribute("label",u.Name),l.setAttribute("data-item-value",u.Id),l.innerText=u.Name,l.addEventListener("mousedown",c.bind(null,u.Id)),o.appendChild(l)}v=o,m=document.createElement("li"),m.setAttribute("data-item-type","separator"),v.appendChild(m);var v,m;var I=document.createElement("li");return I.innerText=s.UnHideAll,I.addEventListener("mousedown",c.bind(null,void 0)),o.appendChild(I),o}();t.appendChild(e),v.zmenu(t)}()})}(this);
!function(e){var t,n,o,a,u=e.sPlusPlus,r=e.document,E=(e.UserAction,e.ZSConstants.FeatureConstants),l=(e.ZSConstants.I18N,e.ZSConstants.wCC),s=e.UIUtil.Component,i=e.ZSEvents,c=i.topic,m=i.Groups,I=i.Names,p=(u.view.Toolbar.Feature[E.HIDE_UNHIDE],u.view.Toolbar.Feature[E.HIDE_ROWS]),d=u.view.Toolbar.Feature[E.HIDE_COLUMNS],T=u.view.Toolbar.Feature[E.HIDE_SHEET],b=u.view.Toolbar.Feature[E.UNHIDE_SHEET],C=r.getElementById("popupmenu");(t=document.createElement("ul")).id=l.SUBMENUITEM+E.HIDE_UNHIDE+l.IDENTITY,t.setAttribute("data-ctype","zmenu"),n=t,p&&p.createMenuElement(n),d&&d.createMenuElement(n),T&&T.createMenuElement(n),o=n,(a=document.createElement("li")).setAttribute("data-item-type","separator"),o.appendChild(a),p&&p.constructShowRowMenuElement(n),d&&d.createShowColMenuElement(n),b&&b.createMenuElement(n),C.appendChild(t),s.bind(t,"zmenubeforeshow",function(){c.publish(m.UI,I.Toolbar.INIT_MENU,{DOM:t})})}(this);
!function(e){var t=e.sPlusPlus,o=(e.ZSConstants.FeatureConstants,e.UserAction,e.ZSEvents),s=(o.topic,o.Groups,o.Names,e.ZSConstants.I18N),i=t.view.Toolbar.Feature.PASTE_SHEET;function n(o,s,n,r,a){var c=t.view.getActiveGridID(),S=(o=t.view.getResourceID(c),t.data.getWorkBook(o,n)),g=t.view.getSheetID(c),h=S.getSheetObj(g).Prop.Name;"ddoc"==a&&(0==r.length?e.UserAction.PasteSheet(o,s,n,h,!1):i.openDialog(a,r))}i.execute=function(){var o=t.view.getActiveGridID(),r=t.view.getResourceID(o),a=t.view.getSheetID(o),c=t.view.getVersionID(o),S=t.data.getWorkBook(r,c),g=t.view.getSelectedSheets(o),h=(u=S.getSheetObj(a)).Prop.Name,v=i.getCopiedSheetName(),d=v.sheetName;if(v.src_rid==r){a=S.SheetList.getIdByName(d);var u=S.getSheetObj(a),P=S.ProtectedSheets.isSheetLocked(a),f=!u.ProtectedRanges.isEmpty();if(P||f){var w=new ZSClass.ZSConfirm(s["CopySheet.LockConfirmMsg"]);w.onYES(function(){e.UserAction.PasteSheet(r,g,c,h,!0)}),w.onNO(function(){e.UserAction.PasteSheet(r,g,c,h,!1)}),w.execute()}else e.UserAction.PasteSheet(r,g,c,h,!1)}else e.UserAction.CopyRefSheets(r,c,g,"ddoc",n)}}(this);
!function(e){var t,s=e.sPlusPlus,o=e.ZSEvents,r=o.topic,l=o.Groups,i=o.Names,c=s.view.Toolbar.Feature.SHEET_NAVIGATION,n=document.querySelector("#MI_SHEET_HOLDER"),f=document.querySelector("#SB_SHEET_NAVIGATION_CONTAINER"),a=f.querySelector(".shlft"),u=f.querySelector(".shrht"),E=document.querySelector("#sheetTabsOption"),S=20,d=!1;function L(e){var s=n.scrollLeft,o="left"===e?s-S:s+S;n.scrollLeft=o,t-o==0?(d=!1,h(e)):N(),t=o,setTimeout(function(){d&&L(e)},5)}function T(){var e=n.scrollWidth,t=n.offsetWidth;c.navHolder.style.display=e>t?"":"none"}c.scrollLeft=function(e){d=!0,L("left")},c.scrollRight=function(e){d=!0,L("right")},c.stopScroll=function(e){d=!1},c.toggleNav=T;var v=JSUtil.fn.debounce(T,200);function h(e){var t="left"===e?a:u;t&&t.classList.add("zsDisable")}function N(){a&&a.classList.remove("zsDisable"),u&&u.classList.remove("zsDisable"),E.classList.add("fade")}function g(){N(),0===n.scrollLeft?(h("left"),E.classList.remove("fade")):n.scrollLeft===n.scrollWidth-n.offsetWidth&&h("right")}n.addEventListener("scroll",g),v(),g(),r.register(l.Listener,i.Browser.RESIZE,v),r.register(l.Listener,i.DocAction.WORKSHEETS.INSERT,v),r.register(l.Listener,i.DocAction.WORKSHEETS.DELETE,v),r.register(l.Listener,i.DocAction.WORKSHEETS.RENAME,v)}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,a=e.document,i=e.ZSConstants.wCC,l=(e.UIUtil.Component,t.data.AppRegistry),r=a.getElementById("popupmenu"),o=e.ZSConstants.I18N,s=e.ZSEvents,c=s.topic,d=s.Groups,p=s.Names,u=t.view.Toolbar.Feature[n.DELUGE],E=t.view.Toolbar.Feature[n.MANAGE_MACRO];function C(e){var t=a.createElement("li");t.setAttribute("data-item-type","separator"),e.appendChild(t)}var m,v,A,D=JSUtil.fn.once(function(){var e=[l.DELUGE_URL];(new ZSClass.LazyLoad).JS(e)});(A=a.createElement("ul")).id=i.SUBMENUITEM+n.DELUGE+i.IDENTITY,A.setAttribute("data",'{"componentOptions":{"type":"text_only"}}'),A.setAttribute("data-ctype","zmenu"),m=A,(v=a.createElement("li")).innerText=o["Deluge.Create"],v.addEventListener("click",function(e){u.createInsertDialog()}),m.appendChild(v),C(A),function(e){var t=a.createElement("li");t.innerText=o["Deluge.Editor"],t.addEventListener("click",function(e){u.openDialog()}),e.appendChild(t)}(A),function(e){var t=a.createElement("li");t.id=i.MI+n.MANAGE_MACRO+i.IDENTITY,t.setAttribute("data",'{"label" : "'+o["VBAMacros.Manage"]+'"}'),t.addEventListener("click",function(e){E.openDialog(!0)}),e.appendChild(t)}(A),C(A),function(e){var t=a.createElement("li");t.innerText=o["Deluge.Help"],t.addEventListener("click",function(e){u.openHelpPage()}),e.appendChild(t)}(A),r.appendChild(A),c.register(d.UI,p.Layout.TEMPLATE_LOADED_DEFER,D)}(this);
!function(e){var t,n=e.sPlusPlus,E=e.ZSEvents,r=(E.topic,E.Groups,E.Names,e.ZSConstants.FeatureConstants),a=e.document,I=(e.UserAction,e.ZSConstants.wCC),o=(e.ZSConstants.I18N,e.UIUtil.Component),u=a.getElementById("popupmenu"),i=(n.view.Toolbar.Feature[r.VBA],n.view.Toolbar.Feature[r.CREATE_MACRO]),T=n.view.Toolbar.Feature[r.RECORD_MACRO],s=n.view.Toolbar.Feature[r.MACRO_STOP_RECORDING],M=n.view.Toolbar.Feature[r.VBA_EDITOR],A=n.view.Toolbar.Feature[r.MACRO_HELP],m=n.view.Toolbar.Feature[r.MANAGE_MACRO];function C(e){var t=a.createElement("li");t.setAttribute("data-item-type","separator"),e.appendChild(t)}(t=a.createElement("ul")).id=I.SUBMENUITEM+r.VBA+I.IDENTITY,t.setAttribute("ctype","zmenu"),t.setAttribute("data",'{"componentOptions":{"type":"text_only"}}'),i&&i.createElement(t),T&&T.createElement(t),s&&s.createElement(t),i&&C(t),M&&M.createElement(t),m&&m.createElement(t),C(t),A&&A.createElement(t),o.bind(t,"zmenubeforeshow",function(e,t){T&&(T.isRecording?(o.zmenu("#"+I.SUBMENUITEM+r.VBA+I.IDENTITY,"setMenuItemsAttribute",["#"+I.MI+r.RECORD_MACRO+I.IDENTITY],"hidden",!0),o.zmenu("#"+I.SUBMENUITEM+r.VBA+I.IDENTITY,"setMenuItemsAttribute",["#"+I.MI+r.MACRO_STOP_RECORDING+I.IDENTITY],"hidden",!1)):(o.zmenu("#"+I.SUBMENUITEM+r.VBA+I.IDENTITY,"setMenuItemsAttribute",["#"+I.MI+r.RECORD_MACRO+I.IDENTITY],"hidden",!1),o.zmenu("#"+I.SUBMENUITEM+r.VBA+I.IDENTITY,"setMenuItemsAttribute",["#"+I.MI+r.MACRO_STOP_RECORDING+I.IDENTITY],"hidden",!0)))}),u.appendChild(t)}(this);
!function(e){var s=e.sPlusPlus,i=e.ZSConstants,t=i.FeatureConstants,r=(e.document,i.wCC),n=e.ZSClass,a=e.ZSEvents,o=a.Groups,d=a.Names,u=a.topic,c=e.ZSDevTools.Logger,A=(s.view.Toolbar.Feature[t.COLLAB_CHAT],s.view.Toolbar.Feature[t.COLLABORATORS]);function v(i,t,r){var n=s.data.PageRegistry.RS_ID;if(i.zuid!=s.data.UserInfo.zuid&&i.rsid!=n){var a=i.zuid;i.isActive?(c.log("Add Active User",a),void 0==A.ActiveUsersInfo[a]&&(A.ActiveUsersInfo[a]=new e.ZSClass.ActiveUser(a,i.dname,i.color))):O(a)}}function L(e){A.getCollabMeta=e;var s=e;for(var i in s){var t=s[i],r=""==t.zuid?C(t):t.zuid;v({dname:""==t.dname?S(t):t.dname,zuid:r,isActive:!0,rsid:t.rsid?t.rsid:""})}for(var i in A.ActiveUsersInfo){var n=!1;for(var a in s)("Guest"==s[a].dname&&"Guest_"+A.GuestList[s[a].rsid]==i||s[a].zuid==i||s[a].dname==i)&&(n=!0);!n&&O(i)}}function l(s,i){for(var t=s.length,r=0;r<t;r++){var n=s[r].zuid;switch(i){case"ADD":if(""==n)v({dname:S(s[r]),zuid:C(s[r]),isActive:!0});else void 0==A.ActiveUsersInfo[n]&&(A.ActiveUsersInfo[n]=new e.ZSClass.ActiveUser(n,s[r].dname,s[r].color));break;case"DELETE":O(""==n?C(s[r]):n)}}}A.ActiveUsersInfo={},A.GuestList=[];var f=1;function C(e){return-1!=e.dname.indexOf("#")?"Guest_"+e.dname.split("#")[1]:(void 0==A.GuestList[e.rsid]&&(A.GuestList[e.rsid]=f,f+=1),"Guest_"+A.GuestList[e.rsid])}function S(e){return-1!=e.dname.indexOf("#")?e.dname:"Guest_"+A.GuestList[e.rsid]}function O(e){c.log("removeCollaborator",e),A.ActiveUsersInfo[e]&&A.ActiveUsersInfo[e].removeUser()}function m(e){v({dname:e.fullname,zuid:e.id,isActive:!1})}!function(){if(-1!=ZSConstants.Meta.HideFeaturesList.indexOf(t.COLLABORATORS))return!1;var e=new n.SBFeature("COLLEAGUE_LIST"),s=e.div;s.className="sTCollab",s.id=r.SB+t.COLLABORATORS+r.MENU,e.add(),s.style.display="none",u.register(o.Listener,d.DocAction.COLLAB_LIST.ADDUSERINFO,m,"COLLABJSON"),u.register(o.Listener,d.CollabAction.SYNCCOLLABUSER,L,"META"),u.register(o.Listener,d.UserAction.COLLAB_LIST.STATUS,l,"MSG","ACTION"),u.register(o.Listener,d.DocAction.COLLAB_LIST.REMOVE,O,"ID")}(),A.getIdForGuest=C,A.getNameForGuest=S,A.getCollabMeta}(this);
!function(e){var t=e.sPlusPlus,a=e.ZSEvents,l=a.topic,r=a.Groups,n=a.Names,o=(e.ZSClass,e.ZSConstants),u=t.data.UserInfo,i=o.I18N,s=o.FeatureConstants,c=t.view.Toolbar.Feature[s.COLLAB_CHAT],d=t.view.Toolbar.Feature[s.COLLABORATORS],C=null,g=new Date,S=!0,f=0,h=null,v=null;function y(e){e;var t=!1;return null==C?(C=JSUtil.fn.dateLocaleFormat(e,null,null,null,null,!0),g=new Date(e),f=e,e,v=g):D(g,e)||(t=!0,C=JSUtil.fn.dateLocaleFormat(f,null,null,null,null,!0),f=e,g=new Date(e)),t}function m(e){var t=e,a=new Date(0),l=new Date(t);return a.getYear()!==l.getYear()?JSUtil.fn.dateLocaleFormat(l):a.getMonth()!==l.getMonth()?JSUtil.fn.dateLocaleFormat(l):a.getDay()!==l.getDay()?JSUtil.fn.dateLocaleFormat(l):a.getHours()!==l.getHours()?JSUtil.fn.dateLocaleFormat(l):(a.getMinutes(),l.getMinutes(),JSUtil.fn.dateLocaleFormat(l))}function D(e,t){var a=new Date(t);return a.getDate()==e.getDate()&&a.getMonth()==e.getMonth()&&a.getFullYear()==e.getFullYear()}l.register(r.Listener,n.DocAction.COLLAB_CHAT.ADD,function(a,l){var r=d.getCollabMeta;c.isPanelOpen||c.addPanelNotification();var n=t.view.getActiveGridID(),o=t.view.getResourceID(n),s=t.data.DocRegistry[o].RemoteViewInfo&&t.data.DocRegistry[o].RemoteViewInfo.REMOTE_ENC_DOC_ID;if(s&&(S=!1),!S){document.querySelector("#ZspNoChat")&&document.querySelector("#ZspNoChat").remove();var C=u.zuid==l,g=C?i.CollbChatMe:function(e){var a=t.view.getActiveGridID(),l=t.view.getResourceID(a);return e?t.data.getSharePublishMeta(l).getShareMeta().getSharedUserInfo().getNameByID(e):i.CollabChatGuest}(l);if(s){for(var f in r){var y=r[f].rsid;if(a.rsid==y){g=r[f].dname;break}}sPlusPlus.data.PageRegistry.RS_ID==a.rsid&&(C=!0,g=i.CollbChatMe)}var L=a.t,b=m(L),w=a.msg,p=function(e){var t=!1;return null!=v&&D(v,e)||(h=JSUtil.fn.dateLocaleFormat(e,null,null,null,null,!0),v=new Date(e),t=!0),e,t}(L);new e.ZSClass.Chat(l,g,b,w,"red",C,h,L,p,!0).setScroll(!0)}},"response","zuid"),l.register(r.Listener,n.UserAction.COLLAB_CHAT.GETCHAT,function(t){var a=t.userList,l=t.chatDetails,r=null,n=0;if(S&&0==l.length&&(document.querySelector("#ZspNoChat").style.display="",(p=document.querySelector(".colbChatPanel").querySelector("#initChatLoader"))&&p.remove()),0==l.length)return document.querySelector("#chatInfo").style.display="none",void(S=!1);document.querySelector("#colbChatLoader").style.display="none";for(var o=0;o<l.length;o++)for(var s,c=l[o].CHAT_CONTENT.length-1;c>=0;c--)for(var d=l[o].CHAT_CONTENT[c],g=(w=d.msg).split("<br>"),f=d.uid,h=u.zuid==f,v=h?i.CollbChatMe:a[f],D=m(s=d.t),L=y(s),b=g.length-1;b>=0;b--,n++){var w=g[b];r=new e.ZSClass.Chat(f,v,D,w,"red",h,C,s,L,!1),L=!1}if(n<50){var p;(p=document.querySelector(".colbChatPanel").querySelector("#colbChatLoader"))&&p.remove();var A=JSUtil.fn.dateLocaleFormat(s,null,null,null,!0),T=JSUtil.fn.replaceParams(i.CollabChatCoversionInfo,new Array(A)),I=document.querySelector("#dayBlock").cloneNode(!0);document.querySelector("#chatInfo").style.display="none",I.id=s,I.style.display="block",I.innerHTML=T,document.querySelector(".colbChatHistory").prepend(I)}S&&((p=document.querySelector(".colbChatPanel").querySelector("#initChatLoader")).remove(),S=!1,r.setScroll(!0))},"response")}(this);
!function(t){var e=t.sPlusPlus,i=t.ZSEvents,s=(i.topic,i.Groups,i.Names,t.ZSClass,t.ZSConstants,e.data.AppRegistry.USER_PHOTO_SERVER_URL);function a(t,e,i,s,a,h,r,c,o,l){this.parent=function(){if(document.querySelector(".colbChatHistory"))return document.querySelector(".colbChatHistory");var t=document.createElement("div");return t.classList.add("colbChatHistory"),t}(),this.scrollElement=document.querySelector(".colbChatPanel"),this.isCurrUser=h,this.zuid=t,this.name=e,this.displayTime=i,this.msg=s,this.color=a,this.time=c,this.isAppend=l,this.addDayBlock(r,c,o),this.constructChat()}a.prototype={chatDiv:null,constructChat:function(){this.isAppend?this.addChat():this.loadChat(),this.setName(),this.setPhoto(),this.setColor(),this.setTime(),this.setMessage()},addChat:function(){var t=UserAction.getTemplate(["SP_COLLABCHAT_ENTRY"]).SP_COLLABCHAT_ENTRY;this.chatDiv=document.createElement("div"),this.chatDiv.id=this.zuid,this.chatDiv.appendChild(t),this.setClass();var e=this.parent&&this.parent.lastChild,i=e?e.id:void 0;void 0==i&&document.querySelector(".colbChatHistory")&&(document.querySelector(".colbChatHistory").lastChild&&document.querySelector(".colbChatHistory").lastChild.remove(),i=this.parent.lastChild&&this.parent.lastChild.id),i==this.zuid&&(this.chatDiv.querySelector(".colbChatMsg").classList.add(this.className),this.chatDiv.querySelector(".colbChatUsr")&&this.chatDiv.querySelector(".colbChatUsr").remove(),this.chatDiv.querySelector("#name")&&this.chatDiv.querySelector("#name").remove()),this.parent&&this.parent.appendChild(this.chatDiv),this.chatDiv.querySelector(".colbChatList").setAttribute("id",this.time)},loadChat:function(){var t=UserAction.getTemplate(["SP_COLLABCHAT_ENTRY"]).SP_COLLABCHAT_ENTRY;this.chatDiv=document.createElement("div"),this.chatDiv.id=this.zuid,this.chatDiv.appendChild(t),this.setClass();var e=this.parent.firstChild;(e?e.id:void 0)==this.zuid&&(e.querySelector(".colbChatMsg").classList.add(this.className),e.querySelector(".colbChatUsr")&&e.querySelector(".colbChatUsr").remove(),e.querySelector("#name")&&e.querySelector("#name").remove()),this.parent.prepend(this.chatDiv),this.chatDiv.querySelector(".colbChatList").setAttribute("id",this.time)},setName:function(){if(this.chatDiv.querySelector("#name"))this.chatDiv.querySelector("#name").innerText=this.name;else{var t=document.createElement("p");t.classList.add("mb10"),t.id="name",t.style.color="#666",t.innerText=this.name,this.chatDiv.querySelector(".colbChatMsg")&&this.chatDiv.querySelector(".colbChatMsg").prepend(t)}},setPhoto:function(){this.chatDiv.querySelector(".colbChatUsr")&&(this.chatDiv.querySelector(".colbChatUsr").src=s+"/file?fs=thumb&ID="+this.zuid)},setColor:function(){},setTime:function(){this.chatDiv.querySelector("#time").setAttribute("data-timeStamp",this.displayTime)},setMessage:function(){var e=this.msg,i=t.JSUtil.LinkMaker.convert(e);e=i.msg,i.hasLinkMsg?this.chatDiv.querySelector("#msg").innerHTML=e:this.chatDiv.querySelector("#msg").innerText=e},setScroll:function(t){t&&this.scrollElement&&(this.scrollElement.scrollTop=this.scrollElement.scrollHeight)},addDayBlock:function(t,e,i){if(i&&document.querySelector("#dayBlock")){var s=document.querySelector("#dayBlock").cloneNode(!0);s.id=e,s.style.display="block",s.innerHTML=t,this.isAppend?this.parent&&this.parent.appendChild(s):this.parent&&this.parent.prepend(s)}},setClass:function(){this.isCurrUser?(this.chatDiv.querySelector(".colbChatList").classList.add("colbChatListCur"),this.chatDiv.querySelector(".colbChatUsr").remove(),this.className="colbChatMsgMore"):this.className="colbChatListOthCur"}},t.ZSClass.Chat=a}(this);
!function(e){var t=e.sPlusPlus,i=(e.ZSConstants.wCC,e.ZSClass,e.ZSConstants.FeatureConstants),s=e.document,r=!1,o=t.view.Toolbar.Feature[i.COLLAB_CHAT];o.add=function(e){var i=t.view.getActiveGridID(),s=t.view.getResourceID(i),r=t.view.getVersionID(i),o=t.view.getSelectedSheets(i);UserAction.chat(s,o,r,e)},o.load=function(e){var i=t.view.getActiveGridID(),o=t.view.getResourceID(i),n=t.view.getVersionID(i),a=t.view.getSelectedSheets(i),c=r?parseInt(s.querySelectorAll(".colbChatList")[0].id):-1;r=!0;var l=s.querySelectorAll(".colbChatList").length;UserAction.getChat(o,a,n,e,c,l)}}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSEvents,i=s.topic,o=s.Groups,r=s.Names,n=(e.ZSClass,e.ZSConstants.I18N),c=e.ZSDevTools.Logger,u=t.data.AppRegistry.USER_PHOTO_SERVER_URL,l=0;function h(e,t,s,i){this.parent=document.querySelector(e),this.zuid=s,this.block=t,this.userInfo=i,this.constructUser(),this.updateCount(this.block+"_cnt")}function a(e){return u+"/file?fs=thumb&ID="+(e.indexOf("Guest_")<0?e:"Guest")}h.prototype={userDiv:null,constructUser:function(){this.createUserTemplate(),this.setName(),this.setPhoto(),this.setColor(),this.setUserPresence(),this.parent.appendChild(this.userDiv),this.userDiv.addEventListener("click",function(){this.goToUserRef()}.bind(this))},createUserTemplate:function(){var e=UserAction.getTemplate(["SP_COLLABORATOR_ENTRY"]).SP_COLLABORATOR_ENTRY;this.userDiv=document.createElement("div"),this.userDiv.id="SP_COLLABORATOR_"+l++,this.userDiv.appendChild(e)},goToUserRef:function(){if(this.sheetName){var e=t.view.getActiveGridID(),s=t.view.getResourceID(e),n=t.view.getVersionID(e),c=t.data.getWorkBook(s,n).SheetList.getIdByName(this.sheetName),u=t.view.getSheetID(e),l=this.col,h=this.row;u!=c?UserAction.SwitchSheet(s,u,n,c,void 0,!1,function(){UserAction.ScrollCellIntoView(s,c,n,h,l),i.publish(o.Listener,r.DocAction.COLLAB_LIST.HIGHLIGHTDOM,{RID:s,VERSION:n,UOBJ:this.userInfo})}):(UserAction.ScrollCellIntoView(s,c,n,h,l),i.publish(o.Listener,r.DocAction.COLLAB_LIST.HIGHLIGHTDOM,{RID:s,VERSION:n,UOBJ:this.userInfo}))}},setName:function(){this.userDiv.querySelector("#name").innerText=this.userInfo.dname},setPhoto:function(){var e=this.userDiv.querySelector(".colbImg");e.src=a(this.userInfo.zuid),e.style.boxShadow="0 0 0 1px #fff, 0 0 0 2px #"+(this.userInfo.color?this.userInfo.color:"f2f2f2"),e.addEventListener("onerror",function(){e.src=a("-1")})},setUserPresence:function(){var e="";this.userInfo.isActive&&(e=this.userPresence?this.userPresence:""),this.userDiv.querySelector("#usrPresence").innerText=e},setColor:function(){var e=this.userInfo.color?"#"+this.userInfo.color:"#f2f2f2";this.userDiv.querySelector(".colUsrPresence").style.background=e},updateCount:function(e){var t=document.querySelector(this.block),s=this.parent.childElementCount;document.querySelector(e).innerHTML="("+s+")",t.style.display=0==s?"none":"block"},remove:function(e){this.userDiv.remove(),this.updateCount(e)},updateSession:function(e,t,s,i,o,r,c){this.userPresence,this.updateReference(t,s,i,o,r),this.userPresence=1==e?function(e,t,s,i,o,r){var c=r?n["CollabPanel.Msg.Editing"]:n["CollabPanel.Msg.IsOn"],u=e+"."+JSUtil.Cell.getReference(t,s);return t!=i&&(u+=":"+JSUtil.Cell.getReference(i,o)),void 0==e?"":JSUtil.fn.replaceParams(c,new Array(u))}(this.sheetName,this.row,this.col,this.erow,this.ecol,this.editstatus):JSUtil.fn.replaceParams(n["CollabPanel.Msg.Session"],new Array(e+"")),this.updateUserPresence(this.userPresence)},updateUserPresence:function(e){this.userDiv.querySelector("#usrPresence").innerText=e},updateUserInfo:function(e){this.userInfo=e,this.setPhoto(),this.setColor()},moveToActive:function(){c.log("moveToActive",this.zuid,this.userInfo.dname);var e=this.userDiv.cloneNode(!0);this.remove("#inActiveBlock_cnt"),this.userDiv=e,this.parent=document.querySelector("#activeCollabList"),this.block="#activeBlock",document.querySelector("#activeCollabList").prepend(this.userDiv),this.updateCount("#activeBlock_cnt")},moveToInActive:function(){c.log("moveToInActive",this.zuid,this.userInfo.dname);var e=this.userDiv.cloneNode(!0);this.remove("#activeBlock_cnt"),this.userDiv=e,this.parent=document.querySelector("#InActiveCollabList"),this.block="#inActiveBlock",document.querySelector("#InActiveCollabList").prepend(this.userDiv),this.updateCount("#inActiveBlock_cnt"),this.updateUserPresence("")},updateReference:function(e,t,s,i,o){this.sheetName=e,this.row=t,this.col=s,this.erow=i,this.ecol=o}},e.ZSClass.Collaborator=h}(this);
!function(e){var t,i,r=e.sPlusPlus,a=e.ZSEvents,o=a.topic,n=a.Groups,s=a.Names,d=e.ZSConstants.FeatureConstants,v=e.ZSDevTools.Logger,c={},l={},u=!1,A=null,g=r.view.Toolbar.Feature[d.COLLABORATORS];r.data.AppRegistry.USER_PHOTO_SERVER_URL;function L(e){if(t=e,!i)return u=!0,void(A=e);v.log("updateCollaborators inn",t),v.log("ActiveUserList::",c),v.log("InActiveUserList::",l);var a,o={};for(var n in c){var s=!1;for(var d in t)("Guest"==t[d].dname&&"Guest_"+g.GuestList[t[d].rsid]==n||t[d].zuid==n||t[d].dname==n)&&(o[n]=!0,(a=t[d]).isActive=!0,c[n].updateUserInfo(a),s=!0);s||(c[n].moveToInActive(),l[n]=c[n],delete c[n])}for(var n in l)for(var d in t)t[d].zuid==n&&(o[n]=!0,(a=t[d]).isActive=!0,l[n].updateUserInfo(a),l[n].moveToActive(),c[n]=l[n],delete l[n]);for(var n in t){var L=t[n];o[L.zuid]||((a=L).isActive=!0,a.zuid=""==L.zuid?g.getIdForGuest(L):L.zuid,a.dname=""==L.dname?g.getNameForGuest(L):L.dname,a.rsid=L.rsid?L.rsid:"",f(a,"#activeCollabList","#activeBlock"))}var S=r.view.getActiveGridID(),I=r.view.getResourceID(S),C=r.data.getSharePublishMeta(I).getShareMeta().getSharedUserInfo();if(!!Object.keys(C).length)var T=C.get();for(var n in l){var h=!1;for(var d in T){if(T[d].id==n){a={dname:l[n].dname,zuid:n,isActive:!1},l[n].updateUserInfo(a),h=!0;break}}h||m(n)}}function f(t,i,a){var o=r.data.PageRegistry.RS_ID;if(t.zuid!=r.data.UserInfo.zuid&&document.querySelector(i)&&t.dname&&t.rsid!=o){var n,s=""==t.zuid?t.dname:t.zuid;c[s]?t.isActive||(c[s].moveToInActive(),l[s]=c[s],delete c[s]):l[s]?t.isActive&&(l[s].moveToActive(),c[s]=l[s],delete l[s]):(n=new e.ZSClass.Collaborator(i,a,s,t),t.isActive?c[s]=n:l[s]=n)}}function m(e){c[e]?(c[e].remove("#activeBlock_cnt"),delete c[e]):l[e]&&(l[e].remove("#inActiveBlock_cnt"),delete l[e])}g.load=function(){var e=r.view.getActiveGridID(),a=r.view.getResourceID(e);!function(e){var r;Object.keys(e).length&&(r=e.get());var a=t;if(r){g.toggleUserPresenceLoader(r.length>0);for(var o=0;o<r.length;o++)if("ORG"!=r[o].role){var n=r[o],s=n.id,d="#inActiveBlock",v={dname:n.fullname,zuid:s,isActive:!1},c="#InActiveCollabList";if(a)for(var l=0;l<a.length;l++){var m=a[l],S=m.zuid;if(s===S){(v=m).isActive=!0,c="#activeCollabList",d="#activeBlock";break}}v.zuid=""==v.zuid?g.getIdForGuest(v):v.zuid,v.dname=""==v.dname?g.getNameForGuest(v):v.dname,v.rsid=n.rsid?n.rsid:"",f(v,c,d),o==r.length-1&&g.toggleUserPresenceLoader(!1)}else o==r.length-1&&g.toggleUserPresenceLoader(!1)}i=!0,u&&(L(A),u=!1)}(r.data.getSharePublishMeta(a).getShareMeta().getSharedUserInfo())},o.register(n.Listener,s.CollabAction.SYNCCOLLABUSER,L,"META"),o.register(n.Listener,s.DocAction.COLLAB_LIST.ADD,function(e){var t=e.zuid,i=c[t];i&&i.updateSession(1,e.sheetName,e.row,e.col,e.erow,e.ecol,e.editstatus)},"LIST"),o.register(n.Listener,s.DocAction.COLLAB_LIST.REMOVE,m,"ID"),o.register(n.Listener,s.UserAction.COLLAB_LIST.STATUS,function(e,t){if(i)for(var r=e.length,a=0;a<r;a++){var o=e[a],n=o.zuid,s=o.dname;switch(t){case"ADD":(d=l[n])?(d.moveToActive(),c[n]=l[n],delete l[n]):""==n&&f(o,"#activeCollabList","#activeBlock");break;case"DELETE":var d;(d=c[n])?(d.moveToInActive(),l[n]=c[n],delete c[n]):""==n&&delete c[s]}}},"MSG","ACTION"),o.register(n.Listener,s.DocAction.COLLAB_LIST.ADDUSERINFO,function(e){i&&f({dname:e.fullname,zuid:e.id+"",isActive:!1},"#InActiveCollabList","#inActiveBlock")},"COLLABJSON")}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSEvents,i=s.topic,r=s.Groups,n=s.Names,u=e.ZSConstants,o=e.ZSConstants.I18N,a=u.FeatureConstants,l=u.wCC,c=t.view.Toolbar.Feature[a.COLLABORATORS],h=t.data.AppRegistry.USER_PHOTO_SERVER_URL,v=3;function d(e,t,s,i){this.parent=f(),this.id=e,this.name=t,this.color=s,this.userDiv=i,this.parent&&(i?this.replaceUser(i):this.constructUser())}function C(e){var t=c.ActiveUsersInfo,s=Object.keys(c.ActiveUsersInfo).length,i="",r=0;for(var n in t)if(++r,i+=t[n].name,r<v&&(i+=", "),r==v)break;if(s>2){var u=void 0!=e?e:s-2;i=u>0?i+" & "+u+" others":i}return JSUtil.fn.replaceParams(o["Share.ActiveCollaboratorsInfo"],new Array(i))}function f(){return document.querySelector("#"+l.SB+a.COLLABORATORS+l.MENU)}function p(e){e.classList.remove("addAciAnim"),e.classList.add("rmAciAnim"),setTimeout(function(){e.remove()},500)}d.prototype={userDiv:null,constructUser:function(){var e=Object.keys(c.ActiveUsersInfo).length;e<v?this.parent.prepend(this.getUserDiv()):void 0==f().querySelector("#sTCollabListCnt")?(this.parent.appendChild(this.getUserEllipseDiv(1)),this.updateTitle()):(this.userDiv=f().querySelector("#sTCollabListCnt"),this.updateCount(e-v+1),this.updateTitle()),this.parent.style.display="block"},replaceUser:function(){this.userDiv.querySelector("#userImg").src=h+"/file?fs=thumb&ID="+(this.id.indexOf("Guest_")<0?this.id:"Guest"),this.userDiv.querySelector("#userImg").title=this.name},getUserDiv:function(){this.userDiv=document.createElement("div"),this.userDiv.className="sTCollabList",this.userDiv.id="sTCollabList"+this.id;var e=document.createElement("img");return e.src=h+"/file?fs=thumb&ID="+(this.id.indexOf("Guest_")<0?this.id:"Guest"),e.title=this.name,e.id="userImg",this.userDiv.appendChild(e),this.userDiv.classList.add("addAciAnim"),this.userDiv.addEventListener("click",function(){i.publish(r.UI,n.SidePanel.Chat.open,{COLLAB_PANEL:!0})}),this.userDiv},getUserEllipseDiv:function(e){return this.userDiv=document.createElement("div"),this.userDiv.id="sTCollabListCnt",this.userDiv.className="sTCollabList",this.userDiv.innerText="+"+e,this.userDiv.addEventListener("click",function(){i.publish(r.UI,n.SidePanel.Chat.open,{COLLAB_PANEL:!0})}),this.userDiv},updateCount:function(e){e>0&&f().querySelector("#sTCollabListCnt")&&(f().querySelector("#sTCollabListCnt").innerText="+"+e,f().querySelector("#sTCollabListCnt").title=C(e))},updateTitle:function(){this.userDiv&&(this.userDiv.title=C())},removeUser:function(){var e=Object.keys(c.ActiveUsersInfo).length;"sTCollabListCnt"!=this.userDiv.id?(e<4&&p(this.userDiv),e>3&&function(e){for(var t in c.ActiveUsersInfo)if("sTCollabListCnt"==c.ActiveUsersInfo[t].userDiv.id){c.ActiveUsersInfo[t].upgradeToImg(e);break}}(this.userDiv)):4==e&&p(f().querySelector("#sTCollabListCnt")),this.updateCount(e-(v+1)),1==e&&this.parent&&(this.parent.style.display="none"),delete c.ActiveUsersInfo[this.id]},upgradeToImg:function(t){c.ActiveUsersInfo[this.id]=new e.ZSClass.ActiveUser(this.id,this.name,this.color,t)}},e.ZSClass.ActiveUser=d}(this);
!function(e){var t,i=e.sPlusPlus,o=e.ZSClass,r=e.ZSConstants,n=(i.view.Events.Key,r.JSKeyCode),s=e.ZSEvents,a=s.topic,l=s.Groups,v=s.Names,c=e.ZSConstants.I18N,I=o.Pivot,g=e.ZSConstants.PivotConstant,p=e.ZSConstants.CommandConstants,E=I.Util||(I.Util={});I.Group||(I.Group={});function h(e,t,o){var r=i.view.getActiveGridID(),n=i.view.getResourceID(r),s=i.view.getVersionID(r),a=i.data.getWorkBook(n,s).PivotCollection,l=a.PivotNameList.keys(),v=Array.from(l);I.currentPivotId=void 0,I.ID=void 0;for(var c=0;c<v.length;c++){var g=v[c],E=a.get(g)[p.TARGET],h=E[0],d=E[1],u=E[2],P=E[3],f=E[4];if(h===e&&d<=t&&t<=P&&u<=o&&o<=f){I.currentPivotId=g,I.ID=g;break}}return I.ID}function d(r,n,s,a){var l=i.view.getActiveGridID(),v=i.view.getResourceID(l),c=i.view.getSheetID(l),I=i.view.getVersionID(l),g=i.data.getWorkBook(v,I);if(g.isEditable()){var p=g.getSheetObj(c),E=p.Column.auxiliaryAxis.getPos(n),h=p.Row.auxiliaryAxis.getPos(r),d=p.Row.auxiliaryAxis.getDim(r),f=p.Column.auxiliaryAxis.getDim(n),S=(l=i.view.getActiveGridID(),i.view.getSheetState(l,c)),R=p.Row.FreezedCount,A=n>=p.Column.FreezedCount,C=r>=R,w=S.getScrollLefts(),L=S.getScrollTops(),_=S.getScreenHeights(),V=S.getScreenWidths(),F=C?_[0]:_[1],m=A?V[0]:V[1],x=A?V[1]:0,N=C?_[1]:0,U=A?w[0]:w[1],k=C?L[0]:L[1],y={applyFilter:O,applyCustomFilter:T,sortPivot:D};t||(t=new o.Pivot.Dialog.Filter(y),P());var G=t.getDialogPos(),b=G.height,W=G.width;E=E-U;(h=h-k)+b+d>F?(h=(h=h+N-b)<0?0:h,d=0):h+=N,E+W+f>m?E=(E=E+x-W)<0?0:E:E+=x,t.clean(),t.show(h,E,d,f,s),u(),e.UserAction.getPivotFilterInfo(v,c,I,r,n,a)}}function u(){var e=i.view.Events.Key;e.focusContext(e.Entry.Filter.Context)}function P(){var e=i.view.Events.Key.Entry.Filter.Context.keyDown;e[n.ESC]=function(){S()},e[n.PURE_PRINTABLE_CHAR]=f}function f(){return!1}function O(t,o,r,n,s,a,l,v,c,I){var g=i.view.getActiveGridID(),p=i.view.getResourceID(g),E=i.view.getSelectedSheets(g),h=i.view.getVersionID(g);e.UserAction.applyPivotFilter(p,E,h,t,o,r,n,s,a,l,v,c,I)}function T(t,o,r,n,s,a){var l=i.view.getActiveGridID(),v=i.view.getResourceID(l),c=i.view.getSelectedSheets(l),I=i.view.getVersionID(l);e.UserAction.applyPivotCustomFilter(v,c,I,t,o,r,n,s,a)}function D(t,o,r,n,s){var a=i.view.getActiveGridID(),l=i.view.getResourceID(a),v=i.view.getSelectedSheets(a),c=i.view.getVersionID(a);e.UserAction.sortPivot(l,v,c,t,o,r,n,s)}function S(){if(t){t.close();var e=i.view.Events.Key;e.focusContext(e.Entry.CellEditor.Context)}}function R(e,t){this.pivot=e,this.version=t}R.prototype={init:function(){this.createPivotObject()},createPivotObject:function(){var e=this.getFilterCells();this.pivot[g.FILTER_CELLS]=e,this.createFilterIcon(e)},createFilterIcon:function(e,t){var o=i.view.getActiveGridID(),r=i.view.getResourceID(o),n=this.pivot[p.TARGET][0];i.view.getSheetID(o)===n&&a.publish(l.Listener,v.UserAction.PIVOT.FILTER_ADD,{RID:r,SHEETID:n,VERSION:this.version,F_CEllS:e,TYPE:"add"})},isFilterApplied:function(e,t,i){if(e)for(var o=0;o<e.length;o++){var r=e[o];if(r[g.PIVOT_FIELD_TYPE]===t&&r[g.HEADER_INDEX]===i)return!0}return!1},getSortType:function(e,t,i){if(e)for(var o=0;o<e.length;o++){var r=e[o];if(r[g.PIVOT_FIELD_TYPE]===t&&r[g.HEADER_INDEX]===i)return r[g.ASCENDING_SORT]?0:1}return-1},getIconType:function(e,t){switch(t){case-1:return e?"filterApplied":"filter_new";case 0:return e?"pivot_filter_ascending":"pivot_ascending";case 1:return e?"pivot_filter_descending":"pivot_descending"}return"pivotdown"},getValueObj:function(){var e=this.pivot.rf,t=this.pivot.cf;return e&&-1!==e.indexOf(-1)?{pft:"row",hidx:e.indexOf(-1)}:t&&-1!==t.indexOf(-1)?{pft:"column",hidx:t.indexOf(-1)}:void 0},getFilterCells:function(){var e=this.pivot[p.TARGET],t=e[0],o=e[1],r=e[2],n=i.view.getActiveGridID(),s=i.view.getResourceID(n),a=i.data.getWorkBook(s,this.version).getSheetObj(t).Prop.getName(),l=this.pivot.rf.length,v=this.pivot.cf.length,c=this.pivot.pf.length,I=this.pivot.pb,E=this.pivot.pfd,h=this.pivot.psd,d=this.getValueObj();I&&I.indexOf("'")>-1&&a.indexOf(" ")>-1&&(a="'"+a+"'");var u,P=[];if(I=I?I.trim():""){var f=I.split(a);f.splice(0,1);for(var O=0;O<f.length;O++){var T,D,S=f[O];if(S=S.substring(S.indexOf(".")+1).trim(),u=JSUtil.fn.getCellPosByLabel(S),O<c?(T="page",D=O,u.pft=T,u.hidx=D):O<c+l?(T="row",D=O-c,u.pft=T,u.hidx=D):(T="column",D=O-c-l,u.pft=T,u.hidx=D),!d||T!==d[g.PIVOT_FIELD_TYPE]||D!==d[g.HEADER_INDEX]){var R=this.isFilterApplied(E,T,D),A=this.getSortType(h,T,D);u.pic=this.getIconType(R,A),u.sa=!R,u.pId=this.pivot.id,P.push(u)}}}else{var C=0===c?0:1;for(O=0;O<v;O++){u={row:o+c+C,col:r+O+Math.max(l,1),pft:"column",hidx:O};R=this.isFilterApplied(E,"row",O),A=this.getSortType(h,"row",O);u.pic=this.getIconType(R,A),u.pId=this.pivot.id,u.sa=!R,P.push(u)}for(var w=0;w<l;w++){u={row:o+Math.max(v,1)+c+C,col:r+w,pft:"row",hidx:w};R=this.isFilterApplied(E,"col",w),A=this.getSortType(h,"col",w);u.pic=this.getIconType(R,A),u.pId=this.pivot.id,u.sa=!R,P.push(u)}for(var L=0;L<c;L++){u={row:o+L,col:r,pft:"page",hidx:L};R=this.isFilterApplied(E,"page",L),A=this.getSortType(h,"page",L);u.pic=this.getIconType(R,A),u.pId=this.pivot.id,u.sa=!R,P.push(u)}}return P},getCellContentByIndex:function(e,t){for(var i=e.length,o=0;o<i;o++){var r=e[o];if(r.colIndex==t)return r.content}},getFilterDetails:function(){var e=this.pivot[p.TARGET],t=e[0],o=e[1],r=e[2],n=i.view.getActiveGridID(),s=i.view.getResourceID(n),a=i.data.getWorkBook(s,this.version).getSheetObj(t).Prop.getName(),l=this.pivot.af,v=this.pivot.rf.length,c=this.pivot.cf.length,I=this.pivot.pf.length,E=this.pivot.pb,h=this.pivot.pfd,d=this.pivot.psd,u=this.getValueObj();E&&E.indexOf("'")>-1&&a.indexOf(" ")>-1&&(a="'"+a+"'");var P,f={},O=[],T=[],D=[];if(E=E?E.trim():""){var S=E.split(a);S.splice(0,1);for(var R=0;R<S.length;R++){var A,C,w=S[R];if(w=w.substring(w.indexOf(".")+1).trim(),P=JSUtil.fn.getCellPosByLabel(w),R<I){A="page",C=R,P.pft=A,P.hidx=C;var L=this.pivot.pf[C],_=this.getCellContentByIndex(l,L);P.content=_}else if(R<I+v){A="row",C=R-I,P.pft=A,P.hidx=C;L=this.pivot.rf[C],_=this.getCellContentByIndex(l,L);P.content=_}else{A="column",C=R-I-v,P.pft=A,P.hidx=C;L=this.pivot.cf[C],_=this.getCellContentByIndex(l,L);P.content=_}if(!u||A!==u[g.PIVOT_FIELD_TYPE]||C!==u[g.HEADER_INDEX]){var V=this.isFilterApplied(h,A,C),F=this.getSortType(d,A,C);P.pic=this.getIconType(V,F),P.sa=!V,P.pId=this.pivot.id,"page"===A?D.push(P):"row"===A?O.push(P):"column"===A&&T.push(P)}}}else{var m=0===I?0:1;for(R=0;R<c;R++){P={row:o+I+m,col:r+R+Math.max(v,1),pft:"column",hidx:R};V=this.isFilterApplied(h,"row",R),F=this.getSortType(d,"row",R);P.pic=this.getIconType(V,F),P.pId=this.pivot.id,P.sa=!V,filterCells.push(P)}for(var x=0;x<v;x++){P={row:o+Math.max(c,1)+I+m,col:r+x,pft:"row",hidx:x};V=this.isFilterApplied(h,"col",x),F=this.getSortType(d,"col",x);P.pic=this.getIconType(V,F),P.pId=this.pivot.id,P.sa=!V,filterCells.push(P)}for(var N=0;N<I;N++){P={row:o+N,col:r,pft:"page",hidx:N};V=this.isFilterApplied(h,"page",N),F=this.getSortType(d,"page",N);P.pic=this.getIconType(V,F),P.pId=this.pivot.id,P.sa=!V,filterCells.push(P)}}return f.pf=D,f.rf=O,f.cf=T,f}},E.getPrimitiveFnFromStr=function(e){if(e){for(var t=[],i=0;i<e.length;i++){var o,r,n,s,a=e[i];for(o in a)r=a[o];a={},"sum"===o?n=1:"count"===o?n=2:"max"===o?n=3:"min"===o?n=4:"product"===o?n=5:"average"===o?n=6:"stdev"===o?n=7:"stdevp"===o?n=8:"var"===o?n=9:"varp"===o?n=10:"median"===o?n=11:"countnums"===o&&(n=12),"none"===r?s=0:"row-percentage"===r?s=5:"column-percentage"===r?s=6:"total-percentage"===r&&(s=7),a[n]=s,t.push(a)}return t}},E.getsortByValues=function(e,t,o){var r=i.view.getActiveGridID(),n=i.view.getResourceID(r),s=i.view.getVersionID(r),a=[],l=[],v=i.data.getWorkBook(n,s).PivotCollection.get(e);if(v){if("row"==t)var I=v[g.ROW_FIELDS];else"column"==t?I=v[g.COLUMN_FIELDS]:"page"==t&&(I=v[g.PAGE_FIELDS]);for(var p=v[g.FUNCTION],E=v[g.ALL_FIELDS],h=v[g.DATA_FIELDS],d=[],u=I[o],P=0;P<E.length;P++)u==E[P].colIndex&&(a.push(E[P]),l.push(E[P].content));for(var f=0;f<h.length;f++){var O=h[f];for(P=0;P<E.length;P++)O==E[P].colIndex&&d.push(E[P].content)}for(P=0;P<p.length;P++){var T,D=p[P];for(T in D)D[T];var S=T.charAt(0).toUpperCase()+T.slice(1),R=JSUtil.fn.replaceParams(c["Pivot.UI.Datafield.Content."+S],new Array(d[P]));l.push(R)}a.push(l)}return a},E.checkSourceChanges=function(e,t,r){if(t==o.Pivot.ID){var n=i.view.getActiveGridID(),s=i.view.getResourceID(n),c=i.view.getVersionID(n),I=o.Pivot.ID;if("temp"!=t)var p=i.data.getWorkBook(s,c).PivotCollection.get(I),E=p.af;for(var h=0,d=0;d<e.length;d++){var u=e[d],P=u.content;if(!P)break;if("Ud"===u.type&&(h+=1),E&&E.length){for(var f=0;f<E.length;f++){var O=!0,T=E[d];if(T.content===P&&T.colIndex===u.colIndex){O=!1,void 0!==T[g.GROUP]&&(u[g.GROUP]=T[g.GROUP]),T.pgmn&&T.pgmx&&T.pgrz&&(u.pgmn=T.pgmn,u.pgmx=T.pgmx,u.pgrz=T.pgrz);break}}if(O)for(var D=T.colIndex,S=[g.PAGE_FIELDS,g.ROW_FIELDS,g.COLUMN_FIELDS,g.DATA_FIELDS],R=0;R<S.length;R++){var A=p[S[R]];if(A){var C=A.indexOf(D);-1!==C&&A.splice(C,1)}}}}if(h==e.length)return a.publish(l.Listener,v.UserAction.PIVOT.CANCEL_BUILDER),"temp"!=t?(a.publish(l.Listener,v.ERROR.SHOW,{ERRORMSG:"Error.Pivot.Field.Changed"}),!1):(a.publish(l.Listener,v.ERROR.SHOW,{ERRORMSG:"Error.Pivot.Invalid.Source.Empty"}),!1);"temp"===t?a.publish(l.Listener,v.UserAction.PIVOT.NEW_GET_FIELDS,{allFields:e,overwrite:r}):(p.af=e,a.publish(l.Listener,v.UserAction.PIVOT.GET_FIELDS))}},E.getLocationToInsert=function(e,t,r,n){var s=i.view.getActiveGridID(),a=i.view.getResourceID(s),l=i.view.getVersionID(s),v=i.data.getWorkBook(a,l).PivotCollection,c=e[g.PIVOT_ACTION_JSON];if(c[p.SOURCE]=[c[g.ASSOCIATED_SOURCE_SHEET_NAME],c[g.SOURCE_START_ROW],c[g.SOURCE_START_COLUMN],c[g.SOURCE_END_ROW],c[g.SOURCE_END_COLUMN]],c.id="temp",c[g.SUBTOTALOPTION]=c.pto[0],c[g.ROWGRANDTOTALOPTION]=c.pto[1],c[g.COLGRANDTOTALOPTION]=c.pto[2],v.add("temp",c),o.Pivot.ID="temp",o.Pivot.InsertSheetCallBack="INSERT_PIVOT",c.isFromZia=!0,t&&r){var I=i.view.getSheetID(s);c[p.TARGET]=[I,t,r,t,r];var E=i.view.getSelectedSheets(s);UserAction.createPivot(a,E,l,c)}else sPlusPlus.view.Toolbar.Feature[ZSConstants.FeatureConstants.PIVOT_MOVE].openDialog(void 0)},E.insertFromRecommendation=function(e,t){var o=i.view.getActiveGridID(),r=i.view.getResourceID(o),n=i.view.getVersionID(o),s=i.data.getWorkBook(r,n).PivotCollection.get("temp"),a=i.view.getSelectedSheets(o);UserAction.createPivot(r,a,n,s,e,t)},E.getPixelRatio=function(e){var t=e.getContext("2d");return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)},E.create=function(e,t,i){var o=document.createElement("canvas");return o.className="canvasStyle",o},E.setHiDPI=function(e,t,i,o){var r=E.getPixelRatio(e);return o||(o=r),e.width=t*o,e.height=i*o,e.style.width=t+"px",e.style.height=i+"px",e.getContext("2d").setTransform(o,0,0,o,0,0),e},E.getTextWidth=function(e,t,i){return e.font=i,e.measureText(t).width},E.getPivotChartFilterDetails=function(e,t,o){return new R(i.data.getWorkBook(e,t).PivotCollection.get(o),t).getFilterDetails()},E.openPivotChartFilterDialog=function(r,n,s){var a=i.view.getActiveGridID(),l=i.view.getResourceID(a),v=i.view.getSheetID(a),c=i.view.getVersionID(a),I=n.top,g=n.left,p=n.height,E=n.width,h=r.row,d=r.col,f=r.pId,S={applyFilter:O,applyCustomFilter:T,sortPivot:D};t||(t=new o.Pivot.Dialog.Filter(S),P()),t.getDialogPos(),t.clean(),t.setConfiguration(s),t.show(I,g,p,E,r),u(),e.UserAction.getPivotFilterInfo(l,v,c,h,d,f)},a.register(l.UI,v.Menu.SHOW_PIVOTFILTER_OPTION,d,"ROW","COL","PIVOT_FILTERCELL","PIVOT_ID"),a.register(l.UI,v.Menu.OPEN_PIVOTFILTER_OPTION,function(e,t,o,r,n){var s=h(t,r,n),a=i.data.getWorkBook(e,o).PivotCollection.get(s).fc;if(a){for(var l=0;l<a.length;l++){var v=a[l];if(v.row===r&&v.col===n){var c=a[l];break}}d(r,n,c,s)}},"RID","SHEETID","VERSION","ROW","COL"),a.register(l.Listener,v.SheetAction.ACTIVE_CELL.INFO,S),a.register(l.UI,v.Menu.SHOW_FILTER_OPTION,S),a.register(l.Listener,v.SheetAction.PIVOT.FILTER_INFO,function(e){t.generatePivotData(e)},"filterInfo"),a.register(l.Listener,v.SheetAction.PIVOT.FILTER_CLOSE,function(e){t&&(t.close(),e&&e.call(this))},"CONTEXT"),a.register(l.Listener,v.SheetAction.ACTIVE_CELL.INFO,function(e,t,r,n){if(n.pivot){h(n.id,n.row,n.col),a.publish(l.UI,v.SidePanel.PIVOT.SHOW_ICON);var s=i.data.getWorkBook(e,r).PivotCollection.get(I.ID);s[g.ROW_FIELDS].length<1&&s[g.DATA_FIELDS].length<1&&s[g.COLUMN_FIELDS].length<1&&s[g.PAGE_FIELDS].length<1&&a.publish(l.UI,v.SidePanel.PIVOT.OPEN)}else{if(void 0!=I.ID&&null!=I.ID){var c=i.data.getWorkBook(e,r).PivotCollection.get(I.ID);c&&c.rf.length<1&&c.cf.length<1&&c.df.length<1&&c.pf.length<1&&a.publish(l.Listener,v.UserAction.PIVOT.PIVOTPLACEHOLDER_MESSAGE,{RID:e,SHEETID:t,VERSION:r,ID:I.ID})}var p=o.Pivot.InsertSheetCallBack,E=!1;I.SP&&(E="true"==I.SP.isEditMode),"NEW_PIVOT"!=p&&0==E&&("temp"!=I.ID&&(I.currentPivotId=void 0,I.ID=void 0),a.publish(l.UI,v.SidePanel.PIVOT.HIDE_ICON)),I.SP&&(I.SP.isEditMode="false"),"NEW_PIVOT"==p&&(o.Pivot.InsertSheetCallBack=void 0)}},"RID","SHEETID","VERSION","VALUE"),a.register(l.Listener,v.UserAction.PIVOT.RESUSCITATE_PIVOTMODEL,function(e,t){var o=i.view.getActiveGridID(),r=i.view.getResourceID(o);new R(i.data.getWorkBook(r,t).PivotCollection.get(e),t).init()},"pivotId","version"),a.register(l.Listener,v.UserAction.PIVOT.MOVE_ACTIVECELL,function(t){var r=i.view.getActiveGridID(),n=i.view.getResourceID(r),s=i.view.getVersionID(r),a=e.ZSConstants.CommandConstants,l=i.data.getWorkBook(n,s).PivotCollection.get(t)[a.TARGET],v=new o.Range(l[1],l[2],l[1],l[2]);e.UserAction.gotoCell(n,l[0],s,v,l[1],l[2])},"pivotId"),a.register(l.Listener,v.UserAction.PIVOT.MOVE_PIVOTCELL,function(t,r,n){var s=i.view.getActiveGridID(),a=sPlusPlus.view.getSheetID(s),l=sPlusPlus.view.getSheetState(s,a).getRanges()[0],v=l.startRow,c=l.startCol,g=e.ZSConstants.CommandConstants,p=i.data.getWorkBook(t,r).PivotCollection.get(n),E=p[g.SOURCE],h=p[g.TARGET],d=o.Pivot.LastAction;if(!("EDIT_PIVOT"!=d&&"DIALOG_MOVE"!=d||a==E[0]&&v>=E[1]&&c>=E[2]&&v<=E[3]+1&&c<=E[4])){var u=new o.Range(h[1],h[2],h[1],h[2]);a!=h[0]||v>=h[1]&&c>=h[2]&&v<=h[3]&&c<=h[4]||(e.UserAction.gotoCell(t,h[0],r,u,h[1],h[2]),I.SP&&(I.SP.isEditMode="true"))}},"rID","version","pivotId"),a.register(l.Listener,v.UserAction.PIVOT.FILTER_SHOW,function(e,t,o){for(var r=i.data.getWorkBook(e,o).PivotCollection.getPivotList(t),n=0;n<r.length;n++)new R(i.data.getWorkBook(e,o).PivotCollection.get(r[n]),o).init()},"RID","SHEETID","VERSION"),a.register(l.Listener,v.UserAction.PIVOT.SHEETINSERT_CALLBACK,function(e){var t=i.view.getActiveGridID(),r=i.view.getResourceID(t),n=i.view.getVersionID(t),s=o.Pivot.ID,c=o.Pivot.InsertSheetCallBack,I=i.view.getSelectedSheets(t),g=i.data.getWorkBook(r,n).PivotCollection.get(s);if(e)switch(c){case"ERR_NEW_PIVOT":a.publish(l.Listener,v.UserAction.PIVOT.CREATE_INNEWSHEET,{NEWSHEETID:e});break;case"NEW_PIVOT":e&&(g[p.TARGET]=[e,0,0,0,0]);var E=new o.Range(0,0,0,0);a.publish(l.Listener,v.UserAction.PIVOT.PIVOTPLACEHOLDER_ADD,{RID:r,SHEETID:e,VERSION:n,ID:s,RANGE:E}),a.publish(l.UI,v.SidePanel.PIVOT.SHOW_ICON),a.publish(l.UI,v.SidePanel.PIVOT.OPEN);break;case"COPY_PIVOT":case"MOVE_PIVOT":E=new o.Range(0,0,0,0);var h="MOVE_PIVOT"===c?"move":"copy",d={};d.range=E,d.sheetID=e,UserAction.movePivot(r,I,n,s,d,!1,!1,h);break;case"INSERT_PIVOT":e&&(g[p.TARGET]=[e,0,0,0,0]),o.Pivot.Util.insertFromRecommendation()}},"NEWSHEETID"),a.register(l.Listener,v.ERROR.SHOW,function(e,t){if("Error.Action.Execution"!==e)switch(t||o.Pivot.LastAction){case"SP_MOVE":case"DIALOG_MOVE":case"DIALOG_COPY":case"DIALOG_INSERT":sPlusPlus.view.Toolbar.Feature[ZSConstants.FeatureConstants.PIVOT_MOVE].handleError(e);break;case"APPLYFILTER_PIVOT":case"REFRESH_PIVOT":e.contains("Error.Pivot.Table.Overlaps")&&o.ZSAlert(c["Error.Pivot.Table.Overlaps"]),e.contains("Error.Pivot.Overwrite.Data")&&"REFRESH_PIVOT"==I.LastAction&&sPlusPlus.view.Toolbar.Feature[ZSConstants.FeatureConstants.PIVOT_REFRESH].handleError(e,I.ID);break;default:a.publish(l.UserAction,v.UserAction.PIVOT.HANDLE_ERROR,{ERRORMSG:e})}},"ERRORMSG","ACTION"),a.register(l.Listener,v.UserAction.PIVOT.PIVOTPLACEHOLDER_REPAINT,function(t,r,n,s){var c=i.data.getWorkBook(t,n).PivotCollection,I=c.getPivotList(r);if(null!=I)for(var g=null,p=e.ZSConstants.CommandConstants,E=0;E<I.length;E++)if((g=c.get(I[E])).rf.length<1&&g.cf.length<1&&g.df.length<1){var h=g[p.TARGET][1],d=g[p.TARGET][2],u=new o.Range(h,d,h,d);a.publish(l.Listener,v.UserAction.PIVOT.PIVOTPLACEHOLDER_ADD,{RID:t,SHEETID:r,VERSION:n,ID:g.id,RANGE:u})}},"RID","SHEETID","VERSION")}(this);
!function(t){t.sPlusPlus;var i=t.ZSClass.Pivot,h=i.Util||(i.Util={}),o=t.ZSConstants.PivotConstant,s=t.ZSConstants.PivotColorConstant;function e(t,i,h){this.getPivotType(h.pa_json),this.canvas=t,this.context=i,h.height<300&&h.data.length>50?this.pivotData=h.data.splice(0,50):h.height>300&&h.data.length>700?this.pivotData=h.data.splice(0,700):this.pivotData=h.data,this.containerWidth=Math.round(h.width-10),this.containerHeight=h.height,this.widthArray=[],this.gridCoObj=[],this.defaultRowHeight=17,this.defaultColWidth=70,this.rowCount,this.colCount,this.pfCount,this.rfCount,this.cfCount,this.dfCount,this.rowHeight=22,this.gridWidth,this.gridHeight,this.algLeft=5,this.algTop=5,this.algRight=12}e.prototype={getPivotType:function(t){var i="";t[o.PAGE_FIELDS].length>0&&(i="P"+t[o.PAGE_FIELDS].length+"_",this.pfCount=t[o.PAGE_FIELDS].length),t[o.ROW_FIELDS].length>0&&(i=i+"R"+t[o.ROW_FIELDS].length+"_",this.rfCount=t[o.ROW_FIELDS].length),t[o.COLUMN_FIELDS].length>0&&(i=i+"C"+t[o.COLUMN_FIELDS].length+"_",this.cfCount=t[o.COLUMN_FIELDS].length),t[o.DATA_FIELDS].length>0?(i=i+"D"+t[o.DATA_FIELDS].length,this.dfCount=t[o.DATA_FIELDS].length):i.endsWith("_")&&(i=i.substring(0,i.length-1)),this.pivotType=s[i]?i:"R1_D1"},draw:function(){this.getRowColCount(),this.getMaxWidth(),this.defaultColWidth=this.containerWidth/this.colCount,this.maxCanvasWidth=this.containerWidth,this.gridWidth=this.colCount*this.defaultColWidth,this.gridHeight=this.rowCount*this.rowHeight;for(var t=0,i=0;i<this.colCount;i++)t+=this.widthArray[i]&&this.widthArray[i]>this.defaultColWidth?this.widthArray[i]:this.defaultColWidth;h.setHiDPI(this.canvas,t>this.maxCanvasWidth?this.maxCanvasWidth:t,this.gridHeight);var o,s=0;this.setCoordinates();var e=this.gridCoObj.R0;for(i=0;i<=this.colCount;i++){o=s,this.context.beginPath(),this.context.moveTo(s,0),this.context.lineTo(s,this.gridHeight);var n=this.getBorderColor("C",i);this.context.strokeStyle=n,this.context.stroke();e[i];s+=this.defaultColWidth,this.context.closePath()}o>this.gridWidth&&(this.gridWidth=o);var a=.5;for(i=0;i<=this.rowCount;i++){n=this.getBorderColor("R",i);this.context.strokeStyle=n,this.context.beginPath(),this.rowCount==i?(this.context.moveTo(0,a-1),this.context.lineTo(this.gridWidth,a-1)):(this.context.beginPath(),this.context.moveTo(0,a),this.context.lineTo(this.gridWidth,a)),a+=this.rowHeight,this.context.stroke(),this.context.closePath()}this.parseData();this.canvas.offsetLeft,this.canvas.offsetTop},setCoordinates:function(){for(var t=0,i=0,h=0;h<=this.rowCount;h++){var o=[];t=0;for(var s=0;s<this.colCount;s++){var e,n={x:t,y:i,wd:e=this.defaultColWidth,ht:this.rowHeight};t+=e,o.push(n)}i+=this.rowHeight,this.gridCoObj["R"+h]=o}},parseData:function(){for(var t=0;t<this.rowCount;t++)for(var i=this.gridCoObj["R"+t],o=this.pivotData[t],s=this.getCellBGColor(t),e=this.getTextColor(t),n=this.getFontFace(t),a=0;a<this.colCount;a++){var r=o[a],l=i[a],g=void 0===r.v?"":r.v,d=r.gp;if(this.context.beginPath(),this.context.fillStyle=s,this.rowCount-1==t?this.context.fillRect(l.x+.5,l.y+1,l.wd-1,l.ht-2):this.context.fillRect(l.x+.5,l.y+1,l.wd-1,l.ht-1),this.context.font="bold"==n?"bold 10pt Arial":"10pt Arial",this.context.fillStyle=e,"GRIDROW"==d){var C=h.getTextWidth(this.context,g,"10pt Arial")+10;this.context.textAlign=l.wd>C?"end":"start",this.context.fillText(g,l.wd>C?l.x+l.wd-this.algRight:l.x+this.algLeft,l.y+l.ht-this.algTop)}else this.context.textAlign="start",this.context.fillText(g,l.x+this.algLeft,l.y+l.ht-this.algTop);this.context.closePath()}},getRowColCount:function(){this.rowCount=this.pivotData.length,this.colCount=this.pivotData[0].length},getMaxWidth:function(){for(var t=0;t<this.pivotData.length;t++)for(var i=this.pivotData[t],o=0;o<i.length;o++){var s=this.widthArray[o],e=i[o].v;if(e){var n=h.getTextWidth(this.context,e,"10pt Arial");(!s||n>s)&&(this.widthArray[o]=n)}}},getBorderColor:function(t,i){return"R"===t&&this.rowCount==i||"C"===t&&this.colCount==i?s[this.pivotType][t][99][o.STROKE_STYLE]:s[this.pivotType][t].hasOwnProperty(i)?s[this.pivotType][t][i][o.STROKE_STYLE]:s[this.pivotType][t][999][o.STROKE_STYLE]},getCellBGColor:function(t){return s[this.pivotType][o.ROW].hasOwnProperty(t)?s[this.pivotType][o.ROW][t][o.BACKGROUND_STYLE]:this.rowCount-1==t?s[this.pivotType][o.ROW][99][o.BACKGROUND_STYLE]:s[this.pivotType][o.ROW][999][o.BACKGROUND_STYLE]},getTextColor:function(t){return s[this.pivotType][o.ROW].hasOwnProperty(t)?s[this.pivotType][o.ROW][t][o.FONT_STYLE]:this.rowCount-1==t?s[this.pivotType][o.ROW][99][o.FONT_STYLE]:s[this.pivotType][o.ROW][999][o.FONT_STYLE]},getFontFace:function(t){return s[this.pivotType][o.ROW].hasOwnProperty(t)?s[this.pivotType][o.ROW][t][o.FONT_FACE]:this.rowCount-1==t?s[this.pivotType][o.ROW][99][o.FONT_FACE]:s[this.pivotType][o.ROW][999][o.FONT_FACE]}},h.CanvasGrid=e}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSClass,o=e.ZSEvents,s=o.topic,l=o.Groups,r=o.Names,a=(i=e.ZSClass,e.JSUtil.Math),h=t.data.Defaults.MAX_COL,n=i.UIFilterController,m=i.Filter.Icon;function c(e){n.call(this),this.parentDom=e}function u(){var e=this.row,t=this.col;s.publish(l.UI,r.Menu.SHOW_PIVOTFILTER_OPTION,{ROW:e,COL:t,PIVOT_FILTERCELL:this.filterCell,PIVOT_ID:this.PID})}c.prototype=new n,c.prototype.place=function(e,i,o,s){for(var l=t.view.getActiveGridID(),r=(t.view.getSheetID(l),t.data.getWorkBook(e,o).getSheetObj(i)),n=0;n<s.length;n++){var c=s[n],g=r.Row.auxiliaryAxis.getDim(c.row),p=r.Row.auxiliaryAxis.getPos(c.row)+g,I=r.Column.auxiliaryAxis.getPos(c.col)+r.Column.auxiliaryAxis.getDim(c.col),v="/sheet/appsheet/styles/images/"+c.pic+".svg",w=a.hash(c.row,c.col,h);if(this.elems[w]){this.elems[w].src!=v&&(this.changeIcon(w,v),this.elems[w].src=v)}else{this.elems[w]=new m,this.elems[w].PID=c.pId,this.elems[w].row=c.row,this.elems[w].col=c.col;var f=r.Column.auxiliaryAxis.getDim(c.col);this.elems[w].filterCell=c,this.show(w,this.parentDom,p,I,g,f,v,u.bind(this.elems[w])),this.elems[w].src=v}}},c.prototype.hide=function(e,t,i,o){for(var s in this.elems)this.elems[s].PID&&this.elems[s].PID==o&&this.remove(this.parentDom,s)},c.prototype.onRowDelete=function(e,i,o,s,l){t.data.getWorkBook(e,o).getSheetObj(i);var r=s+l-1;for(var a in this.elems){var h=this.elems[a],n=h.row;s<=n&&n<=r?(delete this.elems[a],h.elem.remove()):n>r&&(h.row=h.row-l,h.filterCell.row=h.row,this.rearrangeIcons(e,i,o,a))}},c.prototype.onColDelete=function(e,i,o,s,l){t.data.getWorkBook(e,o).getSheetObj(i);var r=s+l-1;for(var a in this.elems){var h=this.elems[a],n=h.col;s<=n&&n<=r?(delete this.elems[a],h.elem.remove()):r<n&&(h.col=h.col-l,h.filterCell.col=h.col,this.rearrangeIcons(e,i,o,a))}},c.prototype.rearrangeIcons=function(e,i,o,s){var l=t.data.getWorkBook(e,o).getSheetObj(i),r=this.elems[s],a=r.row,h=r.col,n=l.Row.auxiliaryAxis.getPos(parseInt(a)),m=l.Row.auxiliaryAxis.getDim(a),c=l.Column.auxiliaryAxis.getPos(parseInt(h)),u=l.Column.auxiliaryAxis.getDim(h);r.rePosition(n+m,c+u)},i.UIPivotFilterController=c}(this);
!function(e){var t=e.sPlusPlus,i=(e.ZSConstants.FeatureConstants,t.data.AppRegistry.IMAGEPath+"placeholder.svg"),o=e.ZSConstants.I18N;function n(e,t){this.domRef=function(e){var t=UserAction.getTemplate(["placeholder"]).placeholder,n=t.querySelector(".pvtplchldr"),s=t.querySelector("#divtxt2");return n.querySelector(".pIArea").src=i,e.appendChild(n),e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),s.innerText=o["Pivot.PlaceHolder.Content.Click"]}),document.body.querySelector(".sheetPaneContainer").addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),s.innerText=o["Pivot.PlaceHolder.Content"]}),e}(e),this.range=t}n.prototype={paint:function(e,t,i,o){var n=this.domRef.style;n.top=e-0+"px",n.left=t-0+"px",n.height=i+0-1+"px",n.width=o+0-1+"px"},addHighlight:function(){this.domRef.classList.add("highlightLocks");var e=document.createElement("span");this.range;e.className="curPtr",this.domRef.appendChild(e)},removeHighlight:function(){this.domRef.classList.remove("highlightLocks"),this.domRef&&this.domRef.firstChild&&this.domRef.removeChild(this.domRef.firstChild)},remove:function(){this.domRef.style.display="none",this.domRef.parentNode.removeChild(this.domRef)},hide:function(){this.domRef.style.display="none"},revoke:function(){this.domRef.style.display=""}},e.ZSClass.UIPivotPlaceHolderCue=n}(this);
!function(e){var t,i=e.sPlusPlus,r=e.ZSEvents,n=r.topic,l=r.Groups,s=r.Names,o=e.ZSClass,a=o.Pivot,d=o.Editors,c=e.ZSConstants.I18N,h=e.ZSConstants.PivotConstant,p=e.ZSConstants.CommandConstants,u=e.UIUtil.Component,v=0,g=void 0;function m(e){this.panel=e,this.tempModel,this.isFieldChanged=!1,this.usedFields=[],this.isDummyPivot=!1,this.selection={draggingField:void 0,sender:null,receiver:null,dropped:!1,usedElement:!1},this.placeholder={element:void 0,parent:void 0,position:void 0}}function f(){var e=e||window.event,t=e.target,i=t.className,r=t.parentNode.className,n=t.parentNode.parentNode.className,l=i;-1!=i.indexOf("zselectbox pDtmBox")?l=r:-1!=i.indexOf("ui-icon-triangle-1-s")?l=n:-1==i.indexOf("ui-zmenu-item")&&-1==i.indexOf("ui-zmenu-text")||(l="pDtmBox");var s=document.getElementsByClassName("pvtDataMenuBox");if(-1==l.indexOf("pDtmBox")){for(var o=0;o<s.length;o++)s[o].style.display="none";document.body.removeEventListener("mousedown",f)}}function S(t){return e.UserAction.getTemplate([t])}function E(){this.css("zIndex",1e3)}m.prototype={init:function(){if(this.panel.querySelector("#createPivot")&&this.panel.querySelector("#createPivot").addEventListener("click",this.create.bind(this)),this.panel.querySelector("#confirmPivot")&&this.panel.querySelector("#confirmPivot").addEventListener("click",this.create.bind(this)),this.panel.querySelector("#resetPivot")&&this.panel.querySelector("#resetPivot").addEventListener("click",this.reset.bind(this)),this.panel.querySelector("#pvtSearchField")&&this.panel.querySelector("#pvtSearchField").addEventListener("keyup",this.searchField.bind(this)),this.constructDateMenu(),this.constructGroupMenu(),this.constructDataMenu(),UIUtil.Component.initComponent("#pivot"),this.panel.querySelector("#cancelPivot")&&this.panel.querySelector("#cancelPivot").addEventListener("click",this.cancel.bind(this)),this.panel.querySelector("#nSheetErr")&&this.panel.querySelector("#nSheetErr").addEventListener("click",this.eSheetHide.bind(this)),this.panel.querySelector("#eSheetErr")&&this.panel.querySelector("#eSheetErr").addEventListener("click",this.eSheetShow.bind(this)),this.panel.querySelector("#overwrite")&&this.panel.querySelector("#overwrite").addEventListener("click",this.overwrite.bind(this)),this.panel.querySelector("#aRef")&&this.panel.querySelector("#aRef").addEventListener("click",this.autoEnable.bind(this)),this.panel.querySelector("#aExp")&&this.panel.querySelector("#aExp").addEventListener("click",this.autoEnable.bind(this)),this.panel.querySelector("#targetCellErr")){var e=this.panel.querySelector("#targetCellErr");g=new d.RangeEditor(e,!0),o.RangePicker.register(g,!0,!0),g.addListeners({valueChanged:this.targetCellErrEditorInputHandler.bind(this)})}this.panel.querySelector(".errMaxFieldClose")&&this.panel.querySelector(".errMaxFieldClose").addEventListener("click",this.hideMaxFieldError.bind(this))},targetCellErrEditorInputHandler:function(){g.value.trim().length>0?this.panel.querySelector("#confirmPivot").classList.remove("ui-button-disabled","ui-state-disabled"):this.panel.querySelector("#confirmPivot").classList.add("ui-button-disabled","ui-state-disabled")},eSheetHide:function(){this.panel.querySelector("#targetLocErr").classList.add("pvtHide"),this.panel.querySelector("#confirmPivot").classList.contains("ui-button-disabled")&&this.panel.querySelector("#confirmPivot").classList.remove("ui-button-disabled","ui-state-disabled")},eSheetShow:function(){this.targetCellErrEditorInputHandler(),this.panel.querySelector("#targetLocErr").classList.remove("pvtHide"),this.panel.querySelector("#targetCellErr").focus()},create:function(e){a.LastAction=void 0;var t=e&&e.target.id,r=i.view.getActiveGridID(),n=i.view.getResourceID(r),l=i.view.getVersionID(r),s=i.view.getSelectedSheets(r),d=!1,h=this.tempModel.overwrite;if("confirmPivot"===t){if(this.panel.querySelector("#nSheetErr").checked){s=i.view.getSelectedSheets(r);d=!0}else{var u=JSUtil.Range.parseRange(n,l,g.value.trim());if(!u){var v=c["GoalSeek.Msg.InvalidCell"],m={buttons:[{text:c.OK,primary:!0,click:function(){g.value="",g.focus()}}],title:c["Alert.Title.InvalidCellRange"]};return o.ZSAlert(v,m),!1}this.tempModel[p.TARGET]=[u.sheetID,u.range.startRow,u.range.startCol,u.range.startRow,u.range.startCol]}this.panel.querySelector("#err").style.display="none"}this.setGroupObj(),this.setNumGroupObj(),this.isDummyPivot=!1,this.changeCreatePivotBt(!1),UserAction.createPivot(n,s,l,this.tempModel,d,h)},autoEnable:function(e){var t=e.target.id,r=e.target.checked,n=i.view.getActiveGridID(),l=i.view.getResourceID(n),s=i.view.getSelectedSheets(n),a=i.view.getVersionID(n),d=o.Pivot.currentPivotId,c=i.data.getWorkBook(l,a).PivotCollection.get(d);c.aRef=!!this.panel.querySelector("#aRef").checked,c.aExp=!!this.panel.querySelector("#aExp").checked,UserAction.changeAutoAction(l,s,a,d,t,r)},showAlertDialog:function(e,t){var i={buttons:[{text:c.OK,primary:!0}]};o.ZSAlert(e,i)},setGroupObj:function(){for(var e=this.tempModel[h.ALL_FIELDS],t={},i=0;i<e.length;i++){var r=e[i],n=r[h.GROUP];if(void 0!==n)t[r.colIndex.toString()]=n}this.tempModel[h.GROUP]=t},setNumGroupObj:function(){for(var e=this.tempModel[h.ALL_FIELDS],t={},i=0;i<e.length;i++){var r=e[i];if(r.hasOwnProperty(h.PIVOT_GROUP_MIN)&&r.hasOwnProperty(h.PIVOT_GROUP_MAX)&&r.hasOwnProperty(h.PIVOT_GROUP_RANGE_SIZE)){var n={};n[h.PIVOT_GROUP_MIN]=r[h.PIVOT_GROUP_MIN],n[h.PIVOT_GROUP_MAX]=r[h.PIVOT_GROUP_MAX],n[h.PIVOT_GROUP_RANGE_SIZE]=r[h.PIVOT_GROUP_RANGE_SIZE],t[r.colIndex]=n}}this.tempModel[h.NUMERIC_GROUP]=t},createPivotinNewSheet:function(e){this.tempModel[p.TARGET]=[e,0,0,0,0],this.create()},toggleButton:function(e,t){a.SP.isEditMode=t?"false":"true"},closeErrBanner:function(){g.value="";var e=i.view.getActiveGridID(),t=i.view.getResourceID(e),r=i.view.getVersionID(e);this.panel.querySelector("#err").style.display="none";i.data.getWorkBook(t,r).PivotCollection;"temp"===a.ID&&(this.isDummyPivot=!0,this.create())},cancel:function(){this.closeErrBanner(),n.publish(l.UI,s.SidePanel.PIVOT.CLOSE)},reset:function(){for(var e=this.panel.querySelector("#df ul").children,t=[],i=e.length,r=0;r<i;r++){var n=e[r];if(n){var l=n.getAttribute("content");t[r]=l}}for(var s=this.panel.querySelector("#pB_allFields").children,o=0;o<s.length;o++){var a=s[o].textContent.trim(),d=this.getUsedField(a);d&&this.removeDroppedElement(d,a,!0);for(r=0;r<t.length;r++){(l=t[r])===a&&this.removeDroppedElement(h.DATA_FIELDS,l,!0)}}this.toggleButton("createPivot",!0)},constructDataMenu:function(){if(!document.querySelector("#dataDropDown")){var i=document.getElementById("popupmenu"),r=e.UserAction.getTemplate(["DataMenuTemplate"]).DataMenuTemplate,n=r.querySelector("#dataDropDown");r.querySelector(".PvtDataClsBtn").addEventListener("click",this.pvtClosePopOver.bind(this),!1),i.appendChild(n),u.initComponent("#pvtFunctnOpt"),u.initComponent("#pvtShowDataOpt"),u.bind("#pvtFunctnOpt","zselectboxchange",function(e,i){var r=i.value,n=this.tempModel[h.FUNCTION],l="none",s=n[t];for(var o in s)l=s[o];var a={};a[r.toLowerCase()]=l,n[t]=a;var d=this.panel.querySelector("#df ul").children[t],p=d.getAttribute("content"),u=JSUtil.fn.replaceParams(c["Pivot.UI.Datafield.Content."+r],new Array(p));"none"!=l&&(u="% "+u),(p=d.querySelector(".fldL")).innerText=u,this.create(),this.toggleButton("createPivot",!1)}.bind(this)),u.bind("#pvtShowDataOpt","zselectboxchange",function(e,i){var r=i.value,n=this.tempModel[h.FUNCTION],l=n[t];for(var s in l)l[s];var o={};o[s]=r,n[t]=o;var a=this.panel.querySelector("#df ul").children[t],d=a.getAttribute("content"),p=(s=s.charAt(0).toUpperCase()+s.slice(1),JSUtil.fn.replaceParams(c["Pivot.UI.Datafield.Content."+s],new Array(d)));"none"!=r&&(p="% "+p),(d=a.querySelector(".fldL")).innerText=p,this.toggleButton("createPivot",!1),this.create()}.bind(this))}},pvtClosePopOver:function(){var e=this.panel.querySelector("#df ul").children[t].querySelector(".pDrpdwn");UIUtil.Component.zpopover(e,"close")},constructDateMenu:function(){if(!document.querySelector("#dateDropDown")){var e,t,i=[c.None,c["Pivot.Submenu.Year"],c["Pivot.Submenu.Quarter"],c["Pivot.Submenu.Month"],c["Pivot.Submenu.Day"],c["Pivot.Submenu.Day.Week"],c["Pivot.Submenu.Quarter.Year"],c["Pivot.Submenu.Month.Year"]],r=document.getElementById("popupmenu"),n=document.createElement("ul");n.id="dateDropDown",n.setAttribute("data-ctype","zmenu"),n.setAttribute("relativeto","parent"),n.setAttribute("data-content-type","icon-text");for(var l=i.length,s=0;s<l;s++){var o=i[s],a=document.createElement("li"),d=s+1;a.id="gr"+d,a.textContent=o,a.setAttribute("data-item-type","checkbox"),n.appendChild(a)}r.appendChild(n),u.bind(n,"zmenushow",function(i,r){var n=r.forElement[0].parentNode;t=n.textContent.trim();for(var l,s=this.tempModel[h.ALL_FIELDS],o=0;o<s.length;o++){var a=s[o];"Td"===a.type&&a.content===t&&(l=a[h.GROUP])}e=void 0===l?"#gr1":"#gr"+(l+1),u.zmenu("#dateDropDown","setMenuItemsAttribute",[e],"checked",!0)}.bind(this)),u.bind(n,"zmenuhide",function(t,i){u.zmenu("#dateDropDown","setMenuItemsAttribute",[e],"checked",!1)}),u.bind(n,"zmenuitemclick",function(e,i){for(var r=i.data.id.substring(2)-1,n=this.tempModel[h.ALL_FIELDS],l=0;l<n.length;l++){var s=n[l];"Td"===s.type&&s.content===t&&(s[h.GROUP]=r)}this.toggleButton("createPivot",!1),this.create()}.bind(this))}},constructGroupMenu:function(){if(!document.querySelector("#GroupMenuDropDown")){var e,t=[c["SidePanel.Sparklines.Group"],c["Pivot.UI.UNGROUP"]],r=document.getElementById("popupmenu"),n=document.createElement("ul");n.id="GroupMenuDropDown",n.setAttribute("data-ctype","zmenu"),n.setAttribute("relativeto","parent");for(var l=0;l<t.length;l++){var s=t[l],a=document.createElement("li");a.id="pg"+l,a.textContent=s,n.appendChild(a)}r.appendChild(n),u.bind(n,"zmenushow",function(t,r){var n=r.forElement[0].parentNode;e=n.textContent.trim();for(var l=i.view.getActiveGridID(),s=i.view.getResourceID(l),a=i.view.getVersionID(l),d=o.Pivot.currentPivotId,c=i.data.getWorkBook(s,a).PivotCollection.get(d).af,h=0;h<c.length;h++){var p;"Tn"===c[h].type&&c[h].content===e&&(p=c[h])}p.hasOwnProperty("pgmn")&&p.hasOwnProperty("pgmx")&&p.hasOwnProperty("pgrz")?u.zmenu("#GroupMenuDropDown","setMenuItemsAttribute",["#pg1"],"disabled",!1):u.zmenu("#GroupMenuDropDown","setMenuItemsAttribute",["#pg1"],"disabled",!0)}.bind(this)),u.bind(n,"zmenuitemclick",function(t,i){var r=i.data.id,n=i.forElement[0].parentNode;e=n.textContent.trim();for(var l,s=this.tempModel[h.ALL_FIELDS],o=0;o<s.length;o++)if("Tn"===s[o].type&&s[o].content.trim()===e){l=s[o];break}"pg0"==r?sPlusPlus.view.Toolbar.Feature[ZSConstants.FeatureConstants.PIVOT_GROUP].openDialog(l):"pg1"==r&&sPlusPlus.view.Toolbar.Feature[ZSConstants.FeatureConstants.PIVOT_GROUP].unGroupSubmit(l)}.bind(this))}},overwrite:function(){if(!this.panel.querySelector("#overwrite").classList.contains("ui-button-disabled")){var e=i.view.getActiveGridID(),t=i.view.getResourceID(e),r=i.view.getVersionID(e),n=i.view.getSelectedSheets(e);this.panel.querySelector("#err").style.display="none",UserAction.createPivot(t,n,r,this.tempModel,!1,!0)}},handleError:function(e){if((l=(t=e.split("#"))[0]).toString().includes("Error.Pivot.Table.Overlaps")||"Error.Pivot.Table.Overlaps.Create"===l||"Error.Pivot.Overwrite.Data"==l){this.changeCreatePivotBt(!0,!0);var t,r,n,l=(t=e.split("#"))[0],s=t.slice(1,t.length),a=this.tempModel[p.TARGET],d=i.view.getActiveGridID(),h=i.view.getResourceID(d),u=i.view.getVersionID(d),v=i.data.getWorkBook(h,u).getSheetObj(a[0]).Prop.getName(),g=new o.Range(a[1],a[2],a[3],a[4]);return s.length<1&&(s=v+"."+g.getLabel()),l.toString().includes("Error.Pivot.Table.Overlaps")||"Error.Pivot.Table.Overlaps.Create"===l?(r=c[l],n=c["Error.Pivot.Table.Overlaps.Header"],this.panel.querySelector("#overwrite").style.display="none"):(r=c[l],n=c["Error.Pivot.Overwrite.Data.Header"],this.panel.querySelector("#overwrite").style.display="block"),r=JSUtil.fn.replaceParams(r,new Array(s)),this.panel.querySelector("#builder_err_msg").innerHTML=r,this.panel.querySelector("#builder_err_msg_title").innerText=n,this.panel.querySelector("#err").style.display="block",this.panel.querySelector("#confirmPivot").classList.add("ui-button-disabled","ui-state-disabled"),this.eSheetShow(),!0}return!1},searchField:function(){for(var e=this.panel.querySelector("#pvtSearchField").value.toLowerCase(),t=this.panel.querySelector("#pB_allFields").children,i=0;i<t.length;i++){var r=t[i];-1===r.textContent.trim().toLowerCase().indexOf(e)?r.style.display="none":r.style.display="block"}},changeLoaderDisp:function(e){this.panel.querySelector("#nameLstLoader").style.display=e?"block":"none"},wipe:function(){this.wipeContainer("#pB_allFields"),this.wipeContainer("#pf ul,#rf ul,#cf ul,#df ul")},wipeContainer:function(e){this.panel.querySelectorAll(e).forEach(function(e){if(e.hasChildNodes())for(;e.firstChild;)e.removeChild(e.firstChild)})},construct:function(e){var t=i.view.getActiveGridID(),r=i.view.getResourceID(t),n=i.view.getVersionID(t);e||(e=o.Pivot.ID),a.SP||(a.SP={});var l=i.data.getWorkBook(r,n).PivotCollection.get(e);this.tempModel=JSON.parse(JSON.stringify(l)),this.usedFields=[],this.wipe(),this.allFields=this.tempModel[h.ALL_FIELDS],this.constructFieldList(),this.constructMainList(),this.bindElementEvent(),this.clearSelections(),v=0},constructMainList:function(){for(var e=this.panel.querySelector("#pB_allFields"),t=this.tempModel.af,i=document.createDocumentFragment(),r=0;r<t.length;r++){var n=t[r],l=n.colIndex,s=n.content,o=n.type;if(-1!==l){n.i=r+1;var a=S("allFieldsTemplate").allFieldsTemplate,d=a.querySelector("li"),c=a.querySelector(".fldL");c.classList.add("txtOverflow"),a.querySelector(".fldIns").addEventListener("click",this.insertField.bind(this),!1),c.parentNode.children[1].className="fld"+o,c.innerText=s,this.isUsedField(l)&&(d.className+=" used-element"),i.appendChild(a)}}e.appendChild(i),this.toggleButton("createPivot",!0)},constructFieldList:function(){for(var e=[h.PAGE_FIELDS,h.ROW_FIELDS,h.COLUMN_FIELDS,h.DATA_FIELDS],t=this.tempModel[h.ALL_FIELDS],i=this.tempModel[h.FUNCTION],r=0;r<e.length;r++){var n=e[r],l=this.tempModel[n],s=this.panel.querySelector("#"+n+" ul");if(l&&l.length>0)for(var o=0;o<l.length;o++){var a=l[o];if(-1===a){var d={content:"Values",colIndex:-1,type:"Tt"},p=document.createDocumentFragment(),v=(I=S("fieldTemplate").fieldTemplate).querySelector("li");I.querySelector(".fldRmv").addEventListener("click",this.removeField.bind(this),!1),I.querySelector(".fldL").innerText=d.content,p.appendChild(v),s.appendChild(p),v.addEventListener("dragstart",this,!1),this.usedFields.push({content:d.content,colIndex:d.colIndex,field:n}),this.allFields.push(d)}else for(var g=0;g<t.length;g++){var m=t[g];if(a===m.colIndex){var f=m.content;if(n===h.DATA_FIELDS){var D,y=i[o];for(D in y)var F=y[D];var L=D.charAt(0).toUpperCase()+D.slice(1);f=JSUtil.fn.replaceParams(c["Pivot.UI.Datafield.Content."+L],new Array(m.content));"none"!=F&&(f="% "+f)}var I;p=document.createDocumentFragment(),v=(I=S("fieldTemplate").fieldTemplate).querySelector("li");if(n===h.DATA_FIELDS)v.setAttribute("content",m.content),(A=I.querySelector(".pDrpdwn")).style.visibility="visible",u.zpopover(A,{isContentHTMLEncoded:!0,content:"#dataDropDown",className:"pvtBldrDataMenu",beforeopen:this.updateDataMenuValues.bind(this,A),open:E});else if("Td"===m.type){(A=I.querySelector(".pDrpdwn")).style.visibility="visible",A.setAttribute("data-menu-id","dateDropDown")}else if("Tn"===m.type&&n!=h.PAGE_FIELDS){var A;(A=I.querySelector(".pDrpdwn")).style.visibility="visible",A.setAttribute("data-menu-id","GroupMenuDropDown")}v.addEventListener("dragover",this,!1),v.addEventListener("dragstart",this,!1),v.addEventListener("dragenter",this,!1),I.querySelector(".fldRmv").addEventListener("click",this.removeField.bind(this),!1),I.querySelector(".fldL").innerText=f,p.appendChild(v),s.appendChild(p),this.usedFields.push({content:m.content,colIndex:m.colIndex,field:n})}}}}},updateDataMenuValues:function(e){var i=e,r=i.parentNode,n=i.parentNode.parentNode,l=Array.prototype.slice.call(n.children).indexOf(r),s="Sum",o="none",a=this.tempModel[h.FUNCTION][l];for(s in a)o=a[s];t=l;var d=s.charAt(0).toUpperCase()+s.slice(1);u.zcombo("#pvtFunctnOpt","setValue",d),u.zcombo("#pvtShowDataOpt","setValue",o)},isUsedField:function(e){for(var t=[h.PAGE_FIELDS,h.ROW_FIELDS,h.COLUMN_FIELDS,h.DATA_FIELDS],i=!1,r=0;r<t.length;r++){var n=t[r];if(this.tempModel[n].indexOf(e)>-1){i=!0;break}}return i},getUsedField:function(e){for(var t=0;t<this.usedFields.length;t++){var i=this.usedFields[t];if(i.content===e&&i.field!==h.DATA_FIELDS)return i.field}},insertField:function(e){var t,i=e.target.parentNode,r=i.textContent.trim();if(this.getUsedField(r))if(this.tempModel[h.DATA_FIELDS].length>=5)this.showMaxFieldError("all",c["Error.Pivot.Field.Already.Exist.Please.Rearrange"]);else{s=(l=this.panel.querySelector("#df ul")).children.length;this.addDataField(l,r,s)}else{var n=i.children[1];if(t=this.getDefaultField(n)){i.className+=" used-element";var l,s=(l=this.panel.querySelector("#"+t+" ul")).children.length;this.selection.sender="allFields",t===h.DATA_FIELDS?this.addDataField(l,r,s):this.addField(t,r,s)}}this.isFieldChanged&&this.create()},removeField:function(e){var t,i=e.target.parentNode,r=i.parentNode.parentNode.id;t=r===h.DATA_FIELDS?i.getAttribute("content"):i.textContent.trim(),r&&this.removeDroppedElement(r,t,!0,void 0),this.isFieldChanged&&this.create()},addValuesField:function(){var e=h.COLUMN_FIELDS;if((t=this.panel.querySelector("#"+e+" ul").children.length)>=5){e=h.ROW_FIELDS;var t=this.panel.querySelector("#"+e+" ul").children.length}if(t>=5)return!1;return this.addListElement(e,"Values",t),this.allFields.push({content:"Values",colIndex:-1,type:"Tt"}),this.addElementToUsedField(e,"Values",t),!0},addDataField:function(e,t,i){var r=h.DATA_FIELDS;return!this.isMaxField(r)&&(!(1===this.getFieldLength(h.DATA_FIELDS)&&!this.addValuesField())&&(this.addListElement(h.DATA_FIELDS,t,i),this.addElementToUsedField(h.DATA_FIELDS,t,i),!0))},addField:function(e,t,r){var a=o.Pivot.ID,d=i.view.getActiveGridID(),c=i.view.getResourceID(d),p=i.view.getVersionID(d),u=i.view.getSheetID(d);if(!this.isMaxField(e)){if(e===h.DATA_FIELDS){this.panel.querySelector("#"+h.DATA_FIELDS+" ul").children;if(1===this.getFieldLength(h.DATA_FIELDS)&&!this.addValuesField())return!1}"allFields"!==this.selection.sender&&this.selection.sender!==h.DATA_FIELDS||(this.addListElement(e,t,r),this.addElementToUsedField(e,t,r)),(this.tempModel[h.PAGE_FIELDS].length<1||this.tempModel[h.ROW_FIELDS].length>=1||this.tempModel[h.COLUMN_FIELDS].length>=1||this.tempModel[h.DATA_FIELDS].length>=1)&&n.publish(l.Listener,s.UserAction.PIVOT.PIVOTPLACEHOLDER_REMOVE,{RID:c,SHEETID:u,VERSION:p,ID:a})}},addListElement:function(e,t,i){var r,n=this.panel.querySelector("#"+e+" ul"),l=this.getFieldType(t);if(e===h.DATA_FIELDS){var s,o={},a=this.tempModel[h.FUNCTION];o[s="Tn"===l?"sum":"count"]="none",a.splice(i,0,o),s=s.charAt(0).toUpperCase()+s.slice(1),"data",r=t,t=JSUtil.fn.replaceParams(c["Pivot.UI.Datafield.Content."+s],new Array(t))}else"Td"===l&&"date";var d=document.createDocumentFragment(),p=S("fieldTemplate").fieldTemplate,v=p.querySelector(".pDrpdwn"),g=p.querySelector("li");e===h.DATA_FIELDS?(g.setAttribute("content",r),v.style.visibility="visible",u.zpopover(v,{isContentHTMLEncoded:!0,content:"#dataDropDown",beforeopen:this.updateDataMenuValues.bind(this,v),open:E})):"Td"===l?(v.style.visibility="visible",v.setAttribute("data-menu-id","dateDropDown")):"Tn"===l&&e!=h.PAGE_FIELDS&&(v.style.visibility="visible",v.setAttribute("data-menu-id","GroupMenuDropDown")),p.querySelector(".fldRmv").addEventListener("click",this.removeField.bind(this),!1),p.querySelector(".fldL").innerText=t,d.appendChild(p),g.addEventListener("dragstart",this,!1),g.addEventListener("dragover",this,!1),g.addEventListener("dragenter",this,!1);var m=n.querySelector(".dropPos");m?m.replaceWith(d):n.appendChild(d)},replacePlaceHolderWithElem:function(){var e;if(this.selection.sender===h.DATA_FIELDS&&this.selection.receiver!=h.DATA_FIELDS){e=this.selection.draggingField.getAttribute("content"),(l=this.selection.draggingField.querySelector(".pDrpdwn")).parentNode.removeChild(l);var t=document.createElement("div");t.className="pDrpdwn",t.style.visibility="hidden";var i=this.selection.draggingField.querySelector(".fldL");i.parentNode.insertBefore(t,i.nextSibling),i.innerText=e}var r=this.selection.receiver,n=this.panel.querySelector("#"+r+" ul").querySelector(".dropPos");r=this.selection.receiver;e=e||this.selection.draggingField.textContent.trim();var l=this.selection.draggingField.querySelector(".pDrpdwn"),s=this.getFieldType(e);"Td"===s?(l.style.visibility="visible",l.setAttribute("data-menu-id","dateDropDown")):"Tn"===s&&r!=h.PAGE_FIELDS?(l.style.visibility="visible",l.setAttribute("data-menu-id","GroupMenuDropDown")):"Tn"===s&&r===h.PAGE_FIELDS&&(l.style.visibility="hidden"),n&&("none"==this.selection.draggingField.style.display&&(this.selection.draggingField.style.display="block"),n.replaceWith(this.selection.draggingField))},addElementToUsedField:function(e,t,i){var r=this.getColIndex(t);this.usedFields.push({content:t,colIndex:r,field:e}),this.changeElementInFieldArray(r,i,e)},changeElementInFieldArray:function(e,t,i,r,n){this.isFieldChanged=!0,this.usedFields.length>0?this.toggleButton("createPivot",!1):this.toggleButton("createPivot",!0);var l=void 0;if(r){var s=this.tempModel[r];if(void 0!==n&&n>-1&&r===h.DATA_FIELDS){s.splice(n,1);var o=this.tempModel[h.FUNCTION];l=o.splice(n,1)[0]}else for(var a=0;a<s.length;a++)if(s[a]===e){s.splice(a,1),r===h.DATA_FIELDS&&(l=(o=this.tempModel[h.FUNCTION]).splice(a,1)[0]);break}}i&&(this.tempModel[i].splice(t,0,e),l&&i===h.DATA_FIELDS&&o.splice(t,0,l))},removeALLDataField:function(){for(var e=this.panel.querySelector("#"+h.DATA_FIELDS+" ul").children,t=e.length,i=0;i<t;i++){var r=e[0];this.removeDroppedElement(h.DATA_FIELDS,r.getAttribute("content"),!0)}},removeDroppedElement:function(e,t,i,r){this.removeListElement(e,t,r);var n=this.removeElementFromUsedField(e,t,i,r);i&&-1===n&&this.removeALLDataField()},removeListElement:function(e,t,i){var r,n=this.panel.querySelector("#"+e+" ul").children,l=e===h.DATA_FIELDS;if(void 0!==i&&i>-1)"dropPos"===(r=n[i]).getAttribute("class")?(r=n[i+1]).parentNode.removeChild(r):r.parentNode.removeChild(r);else for(var s=0;s<n.length;s++){r=n[s],(l?r.getAttribute("content"):r.textContent.trim())===t&&r.parentNode.removeChild(r)}if(l&&this.getFieldLength(h.DATA_FIELDS)<=1){var o=this.getUsedField("Values");o&&this.removeDroppedElement(o,"Values",!1)}},getFieldLength:function(e){for(var t=0,i=this.panel.querySelector("#"+e+" ul").children,r=0;r<i.length;r++){i[r].classList.contains("dropPos")||t++}return t},showMaxFieldError:function(e,t){this.panel.querySelector(".errMaxFieldMsg").innerText=t,this.panel.querySelector("#errMaxField").classList.add("showErr"),setTimeout(function(){this.panel.querySelector("#errMaxField").classList.contains("showErr")&&this.panel.querySelector("#errMaxField").classList.remove("showErr")},4e3)},hideMaxFieldError:function(){this.panel.querySelector("#errMaxField").classList.contains("showErr")&&this.panel.querySelector("#errMaxField").classList.remove("showErr")},removeElementFromUsedField:function(e,t,i,r){for(var n=-2,l=0;l<this.usedFields.length;l++){var s=this.usedFields[l];if(s.field===e&&s.content===t){n=s.colIndex,this.usedFields.splice(l,1);break}}return n>=-1&&this.changeElementInFieldArray(n,void 0,void 0,e,r),i&&-1!==n&&this.toggleAllFieldCheck(t,n,!1),n},toggleAllFieldCheck:function(e,t,i){if(!this.isUsedField(t))for(var r=this.panel.querySelector("#pB_allFields").children,n=0;n<r.length;n++){var l=r[n];if(l.textContent.trim()===e){i?l.classList.add("used-element"):l.classList.remove("used-element");break}}},getFieldType:function(e){for(var t=0;t<this.allFields.length;t++){var i=this.allFields[t];if(i.content.trim()===e)return i.type}return"Tt"},isMaxField:function(e){if(this.getFieldLength(e)>=10){var t=c["Error.Pivot.Max.Field"];return this.showMaxFieldError(e,t),!0}return!1},unbindEvent:function(){for(var e=this.panel.querySelector("#pB_allFields").children,t=0;t<e.length;t++){e[t].removeEventListener("dragstart",this,!1)}var i=this.panel.querySelectorAll("#pf ul,#rf ul,#cf ul,#df ul");for(t=0;t<i.length;t++){var r=i[t];r.removeEventListener("dragenter",this,!1),r.removeEventListener("dragover",this,!1),r.removeEventListener("drop",this,!1),r.removeEventListener("dragend",this,!1)}},bindElementEvent:function(){var e=document.createElement("li");e.className="dropPos",this.placeholder.element=e;for(var t=this.panel.querySelector("#pB_allFields").children,i=0;i<t.length;i++){t[i].addEventListener("dragstart",this,!1)}var r=this.panel.querySelectorAll("#pf ul,#rf ul,#cf ul,#df ul");for(i=0;i<r.length;i++){var n=r[i];n.addEventListener("dragenter",this,!1),n.addEventListener("dragover",this,!1),n.addEventListener("drop",this,!1),n.addEventListener("dragleave",this,!1)}},handleEvent:function(e){var t=e.target.parentNode,i=e.target.nodeName;if("dragend"===e.type)this.pFieldDragEnd(e);else if("LI"===i){var r=t.id?t.id:t.parentNode.id;if("pB_allFields"===r)switch(e.type){case"dragstart":this.allField_dragstart(e)}else if("pf"===r||"rf"===r||"cf"===r||"df"===r)switch(e.type){case"dragstart":this.field_dragstart(e);break;case"dragenter":this.field_dragEnter(e);break;case"dragover":this.field_dragover(e);break;case"drop":this.fieldContainer_drop(e)}}else if("UL"===i)switch(e.type){case"dragenter":this.fieldContainer_dragEnter(e);break;case"dragover":this.fieldContainer_dragover(e);break;case"drop":this.fieldContainer_drop(e);break;case"dragend":this.fieldContainer_dropEnd(e);break;case"dragleave":this.fieldContainer_dragLeave(e)}else if("DIV"===i)switch(e.type){case"dragenter":case"dragover":this.field_eventDPrevent(e);break;case"drop":this.fieldContainer_drop(e)}},pFieldDragEnd:function(){var e=this.selection.draggingField.textContent.trim();if(this.selection.sender===h.DATA_FIELDS&&(e=this.selection.draggingField.getAttribute("content")),"allFields"==this.selection.sender){var t=this.panel.querySelector("#dummyField");t&&t.parentNode.removeChild(t)}if(this.selection.dropped)this.getUsedField(e);else{var i=this.selection.sender;"allFields"!=i&&this.removeDroppedElement(i,e,!0)}for(var r=[h.PAGE_FIELDS,h.ROW_FIELDS,h.COLUMN_FIELDS,h.DATA_FIELDS],n=0;n<r.length;n++){var l=this.panel.querySelector("#"+r[n]).children[0];l.contains(this.placeholder.element)&&l.removeChild(this.placeholder.element)}this.applyOrRemoveHoverClass(!1),document.body.removeEventListener("dragend",this,!1),this.isFieldChanged&&this.create()},addSelection:function(e){if(this.selection.owner){if(this.selection.owner!=e.parentNode)return}else this.selection.owner=e.parentNode;this.selection.draggingField=e},clearSelections:function(){this.selection={draggingField:void 0,sender:null,receiver:null,dropped:!1,usedElement:!1}},allField_dragstart:function(e){var t=e.target;this.clearSelections(),this.addSelection(e.target);var i=t.cloneNode(!0);i.querySelector(".fldL").style.width="50%",i.id="dummyField",i.style.width=" 50%",i.style.position="absolute",i.style.left="-100%",i.style.border="1px solid #dfdfdf",t.parentNode.appendChild(i),e.dataTransfer.effectAllowed="copy",e.dataTransfer.setData("text",this.outerHTML),this.selection.sender="allFields",t.classList.contains("used-element")?this.selection.usedElement=!0:this.selection.usedElement=!1,document.body.addEventListener("dragend",this,!1),this.applyOrRemoveHoverClass(!0)},field_dragstart:function(e){e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",this.outerHTML),e.stopImmediatePropagation();var t=e.target;this.clearSelections(),this.addSelection(t),this.selection.sender=t.parentNode.parentNode.id,this.selection.receiver=t.parentNode.parentNode.id,document.body.addEventListener("dragend",this,!1),this.applyOrRemoveHoverClass(!0)},fieldContainer_dragEnter:function(e){e.preventDefault(),"UL"==e.target.nodeName&&(this.selection.receiver=e.target.parentNode.id,this.placeholder.parent!=e.target.parentNode.id&&(this.placeholder.parent=e.target.parentNode.id),e.target.contains(this.placeholder.element)||e.target.appendChild(this.placeholder.element))},fieldContainer_dragover:function(e){var t,i,r=e.target,n=r.getBoundingClientRect(),l=(e.target.parentNode.id,0),s=r.childNodes;if(n.top==e.y){for(var o=0;o<s.length;o++){if("none"!=(a=s[o]).style.display&&"dropPos"!=a.className){i=a;break}}i&&this._before(i,this.placeholder.element)}else{for(o=0;o<s.length;o++){var a;(a=s[o]).style&&"none"!=a.style.display&&"dropPos"!=a.className&&(l+=a.clientHeight,t=a)}if(t)n.top+l<e.y&&e.y<n.bottom&&this._after(t,this.placeholder.element)}e.preventDefault(),e.stopPropagation()},field_dragEnter:function(e){e.target.parentNode;e.preventDefault(),e.stopPropagation()},field_dragover:function(e){e.preventDefault(),e.stopPropagation();var t=e.target,i=this._index(this.placeholder.element);this._index(t);this.placeholder.position=i,"allFields"!=this.selection.sender&&"none"!==this.selection.draggingField.style.display&&(this.selection.draggingField.style.display="none"),t.getBoundingClientRect().y+10<e.y?this._after(t,this.placeholder.element):this._before(t,this.placeholder.element)},fieldContainer_drop:function(e){e.target.parentNode,e.target.nodeName;e.preventDefault(),e.stopPropagation(),this.checkAddField(),this.selection.dropped=!0},field_eventDPrevent:function(e){e.preventDefault(),e.stopPropagation()},fieldContainer_dragLeave:function(e){e.target.parentNode.id;var t=e.target.getBoundingClientRect();this.placeholder.parent;(t.top>e.y||t.bottom<e.y||t.left>e.x||t.right<e.x)&&e.target.contains(this.placeholder.element)&&e.target.removeChild(this.placeholder.element)},checkAddField:function(){var e=this.selection.draggingField.textContent.trim();this.selection.sender===h.DATA_FIELDS&&(e=this.selection.draggingField.getAttribute("content"));var t=this.selection.receiver,i=this.panel.querySelector("#"+t+" ul").querySelector(".dropPos"),r=this._index(i);t=this.selection.receiver;if(this.isMaxField(t))"none"==this.selection.draggingField.style.display&&(this.selection.draggingField.style.display="block");else{if(this.selection.receiver===h.DATA_FIELDS){if((s=this.getColIndex(e))<0)return void("none"==this.selection.draggingField.style.display&&(this.selection.draggingField.style.display="block"));if(this.selection.draggingField.classList.contains("used-element")||(this.selection.draggingField.className+=" used-element"),this.selection.sender===h.DATA_FIELDS)this.replacePlaceHolderWithElem(),this.changeElementInFieldArray(s,r,this.selection.sender,this.selection.sender);else{this.removeElementFromUsedField(this.selection.sender,e,!1);var n=this.panel.querySelector("#df").children[0];n.contains(this.placeholder.element)&&n.removeChild(this.placeholder.element);var l=this.panel.querySelector("#df ul");this.addDataField(l,e,r)}}else if("allFields"===this.selection.sender){if(this.selection.usedElement)(o=this.getUsedField(e))?o!==this.selection.receiver&&(this.removeDroppedElement(o,e,!1),this.addField(t,e,r)):this.addField(t,e,r);else this.selection.draggingField.className+=" used-element",this.addField(t,e,r)}else if(this.selection.sender===this.selection.receiver){var s=this.getColIndex(e);this.replacePlaceHolderWithElem(),this.changeElementInFieldArray(s,r,this.selection.sender,this.selection.sender)}else{var o;s=this.getColIndex(e);if(this.selection.receiver===h.PAGE_FIELDS&&s<0)return void("none"==this.selection.draggingField.style.display&&(this.selection.draggingField.style.display="block"));this.removeElementFromUsedField(this.selection.sender,e,!1),(o=this.getUsedField(e))&&this.removeDroppedElement(o,e,!1),this.replacePlaceHolderWithElem(),this.addElementToUsedField(t,e,r)}if(this.selection.sender===h.DATA_FIELDS&&1===this.getFieldLength(h.DATA_FIELDS)){var a=this.getUsedField("Values");a&&this.removeDroppedElement(a,"Values",!1)}}},_index:function(e){return e.parentElement?Array.prototype.indexOf.call(e.parentElement.children,e):0},_before:function(e,t){e.parentElement.insertBefore(t,e)},_after:function(e,t){e.parentElement.insertBefore(t,e.nextElementSibling)},applyOrRemoveHoverClass:function(e,t,i){i=this.selection.draggingField.textContent.trim(),t=this.selection.sender;for(var r=[h.PAGE_FIELDS,h.ROW_FIELDS,h.COLUMN_FIELDS,h.DATA_FIELDS],n=0;n<r.length;n++){var l=r[n],s=this.panel.querySelector("#"+l+" ul"),o=void 0;"allFields"===t&&i&&(o=this.getUsedField(i)),e&&o!==l&&(s.children.length<5||l===this.selection.sender)?s.classList.add("dragStart"):s.classList.remove("dragStart")}},getDefaultField:function(e){return e.classList.contains("fldTn")&&this.tempModel[h.DATA_FIELDS].length<5?h.DATA_FIELDS:e.classList.contains("fldTd")&&this.tempModel[h.ROW_FIELDS].length<5?h.ROW_FIELDS:this.getMinUsedField()},getColIndex:function(e){for(var t=0;t<this.allFields.length;t++){var i=this.allFields[t];if(i.content.trim()===e)return i.colIndex}},getMinUsedField:function(){var e=this.tempModel[h.ROW_FIELDS].length,t=this.tempModel[h.COLUMN_FIELDS].length;return e<5||t<5?t<e?h.COLUMN_FIELDS:h.ROW_FIELDS:0===this.tempModel[h.DATA_FIELDS].length?h.DATA_FIELDS:this.tempModel[h.PAGE_FIELDS].length<5?h.PAGE_FIELDS:void 0},showPivotBuilderDataMenu:function(t){var i=e.UserAction.getTemplate(["pivotBuilderDataMenuTemplate"]),r=e.UIUtil.Component;if(!document.getElementById("DI_PIVOT_BUILDER_DATAMENU")){var n=document.createElement("div");n.id="DI_PIVOT_BUILDER_DATAMENU",n.appendChild(i.pivotBuilderDataMenuTemplate),document.body.appendChild(n)}for(var l=document.getElementsByClassName("pvtDataMenuBox"),s=0;s<l.length;s++)l[s].style.display="none";var o,a,d,p=event.target.parentNode.parentNode,u=p.parentNode,g=Array.prototype.slice.call(u.children).indexOf(p),m=p.children,S=this.panel_Datamenu.querySelector("#pvtDataMenus");if(m.length<2){(o=S.cloneNode(!0)).removeAttribute("id");var E=o.getElementsByTagName("select"),D=E[0],y=E[1];v+=1,D.setAttribute("id","Data"+v),r.bind(D,"combochange",function(e){var t=new Event("change");D.dispatchEvent(t)}),D.addEventListener("change",function(e,t){var i=e.target.parentNode.parentNode.parentNode.parentNode,r=i.parentNode,n=Array.prototype.slice.call(r.children).indexOf(i),l=e.target.value,s=this.tempModel[h.FUNCTION],o="none",a=s[n];for(var d in a)o=a[d];var p={};p[l.toLowerCase()]=o,s[n]=p;var u=i.getAttribute("content"),v=JSUtil.fn.replaceParams(c["Pivot.UI.Datafield.Content."+l],new Array(u));"none"!=o&&(v="% "+v),(u=i.querySelector(".fldL")).innerText=v}.bind(this)),v+=1,y.setAttribute("id","Data"+v),r.bind(y,"combochange",function(e){var t=e.target.parentNode.parentNode.parentNode.parentNode,i=t.parentNode,r=Array.prototype.slice.call(i.children).indexOf(t),n=e.target.value,l=this.tempModel[h.FUNCTION],s=l[r];for(var o in s)b=s[o];var a={};a[o]=n,l[r]=a;var d=t.getAttribute("content"),p=o.charAt(0).toUpperCase()+o.slice(1),u=JSUtil.fn.replaceParams(c["Pivot.UI.Datafield.Content."+p],new Array(d));"none"!=n&&(u="% "+u),(d=t.querySelector(".fldL")).innerText=u}.bind(this)),r.initComponent(o),p.appendChild(o)}a=p.children[1],d=p.offsetTop-(parseInt(S.style.height)+p.offsetHeight-5),a.style.top=d+"px",a.style.display="block";var F=g+(g+1),L="#Data"+F,I="#Data"+(F+1),A="Sum",b="none",P=this.tempModel[h.FUNCTION][g];for(A in P)b=P[A];var C=A.charAt(0).toUpperCase()+A.slice(1);a.querySelector(L).value=C,a.querySelector(I).value=b,r.zcombo(D,"refresh"),r.zcombo(y,"refresh"),setTimeout(function(e){document.body.addEventListener("mousedown",f)},10)},changeCreatePivotBt:function(e,t){this.tempModel&&"temp"==this.tempModel.id&&(this.tempModel.id=o.Pivot.ID),t&&(a.SP.isEditMode="false")},setGroupValue:function(e,t,i,r){for(var n=this.tempModel[h.ALL_FIELDS],l=0;l<n.length;l++){var s=n[l];if(s.colIndex===e){s[h.PIVOT_GROUP_MIN]=t,s[h.PIVOT_GROUP_MAX]=i,s[h.PIVOT_GROUP_RANGE_SIZE]=r;break}}}},a.BuilderModel=m}(this);
!function(t){var i=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,s=(t.document,t.ZSConstants.I18N,t.ZSConstants.wCC,ZSClass.Editors,ZSClass.Pivot);function e(t){this.PivotPanel=t}e.prototype={bindEvent:function(){this.PivotPanel.querySelector("#pvtChrt").addEventListener("click",this.initPivotChart.bind(this))},initPivotChart:function(){i.view.Toolbar.Feature[n.CHART].execute(this,!0)}},s.Chart=e}(this);
!function(e){var t,i=e.sPlusPlus,s=(e.ZSConstants.FeatureConstants,e.document,e.ZSConstants.I18N,e.ZSConstants.wCC,ZSClass.Pivot),a=e.ZSEvents,n=a.topic,r=a.Groups,o=a.Names,l=e.ZSConstants.CommandConstants,g=e.ZSConstants.PivotConstant;function c(e){this.PivotPanel=e}c.prototype={bindEvent:function(){var e=this.PivotPanel.querySelector("#explBtns").children,i=this.PivotPanel.querySelector("#expSave"),s=this.PivotPanel.querySelector("#expCancel");e[0].addEventListener("click",this._editRange.bind(this)),s.addEventListener("click",this._cancelRange.bind(this)),i.addEventListener("click",this._saveRange.bind(this));var a=this.PivotPanel.querySelector("#expCellRef");this.PivotPanel.querySelector(".zsRangePicker").classList.add("zRDisable"),t=new ZSClass.Editors.RangeEditor(a),ZSClass.RangePicker.register(t,!0)},setValue:function(){var e=s.ID,a=i.view.getActiveGridID(),n=i.view.getResourceID(a),r=i.view.getVersionID(a),o=i.data.getWorkBook(n,r).PivotCollection.get(e)[l.SOURCE];if(o.length>0){var g=i.data.getWorkBook(n,r).getSheetObj(o[0]);if("temp"==e){this.PivotPanel.querySelector("#expEdit").classList.add("disableHLink");var c=new ZSClass.Range(o[1],o[2],o[3],o[4])}else{this.PivotPanel.querySelector("#expEdit").classList.remove("disableHLink");c=new ZSClass.Range(o[1],o[2],o[3],o[4])}var v=g.Prop.Name;v=v?-1!==v.indexOf(" ")?"'"+v+"'":v:"",t.value=v+"."+c.getLabel()}},_editRange:function(){var e=i.view.getActiveGridID(),a=i.view.getResourceID(e),n=i.view.getVersionID(e);s.SP.isEditMode="true";var r=JSUtil.Range.parseRange(a,n,t.value.trim()),o=r.sheetID,l=sPlusPlus.view.getSheetID(e);r.sheetID!=sPlusPlus.view.getSheetID(e)&&UserAction.SwitchSheet(a,l,n,o,void 0,void 0,this._highlightRange.bind()),this.PivotPanel.querySelector("#expSrc").classList.add("editRange"),this.PivotPanel.querySelector(".zsRangePicker").classList.remove("zRDisable"),this.PivotPanel.querySelector("#expCellRef").focus()},_highlightRange:function(e){n.publish(r.Listener,o.RangePicker.Highlight,{highlight:!0,text:t.value,start:0,end:0})},_reset:function(){s.SP.isEditMode="false",this.setValue(),this.PivotPanel.querySelector("#expSrc").classList.remove("editRange"),this.PivotPanel.querySelector(".zsRangePicker").classList.add("zRDisable")},_cancelRange:function(){this._reset();var t=s.ID,a=i.view.getActiveGridID(),n=i.view.getResourceID(a),r=i.view.getVersionID(a),o=i.data.getWorkBook(n,r).PivotCollection.get(t)[l.TARGET],g=new ZSClass.Range(o[1],o[2],o[1],o[2]);e.UserAction.gotoCell(n,o[0],r,g,o[1],o[2])},_saveRange:function(){var a=s.ID,n=i.view.getActiveGridID(),r=i.view.getResourceID(n),o=i.view.getVersionID(n),c=i.data.getWorkBook(r,o).PivotCollection.get(a),v=c[l.TARGET],d=new ZSClass.Range(v[1],v[2],v[1],v[2]);e.UserAction.gotoCell(r,v[0],o,d,v[1],v[2]),s.SP.isEditMode="false",this.PivotPanel.querySelector("#expSrc").classList.remove("editRange"),this.PivotPanel.querySelector(".zsRangePicker").classList.add("zRDisable");var h=c[l.SOURCE],P=JSUtil.Range.parseRange(r,o,t.value.trim()),S=!1;if(h[0]!==P.sheetID||h[1]!==P.range.startRow)S=!0;else if(h[2]!==P.range.startCol||h[4]!==P.range.endCol){for(var u=h[4],R=h[2],C=[g.PAGE_FIELDS,g.ROW_FIELDS,g.COLUMN_FIELDS,g.DATA_FIELDS],D=0;D<C.length;D++){var I=c[C[D]];if(I&&I.length>0)for(var w=0;w<I.length;w++){var f=I[w];f<u&&(u=f),f>R&&(R=f)}}(u<P.range.startCol||R>P.range.endCol)&&(S=!0,(R>=P.range.startCol&&R<=P.range.endCol||P.range.endCol>=u&&P.range.endCol<=R)&&(S=!1))}if(!S){c[l.SOURCE]=[P.sheetID,P.range.startRow,P.range.startCol,P.range.endRow,P.range.endCol];var E=i.view.getSelectedSheets(n);UserAction.changePivotSource(r,E,o,a,P.range,!1)}}},s.ChangeSource=c}(this);
!function(e){var t,i=e.sPlusPlus,o=(e.ZSConstants.FeatureConstants,e.document),n=e.ZSConstants.I18N,s=(e.ZSConstants.wCC,ZSClass.Editors),a=ZSClass.Pivot,c=(e.ZSConstants.CommandConstants,e.ZSConstants.PivotConstant,void 0);function l(e){this.PivotPanel=e,this.action="move"}function r(e){var i=o.getElementById("ZsAlertBtn");-1==e.path.indexOf(i)&&-1==e.path.indexOf(t)&&(ZSClass.RangePicker.isActiveOn(c)||d())}function d(){a.SP.isEditMode="false",c&&(c.value=""),t.querySelector("#nSheet").checked=!0,t.querySelector("#targetLoc").classList.add("pvtHide"),t.style.display="none",o.body.removeEventListener("mousedown",r,!1)}l.prototype={bindEvent:function(){this.PivotPanel.querySelector("#pvtMove").addEventListener("click",this.popupDialog.bind(this)),this.PivotPanel.querySelector("#pvtCopy").addEventListener("click",this.popupDialog.bind(this)),this.construct()},popupDialog:function(e){a.SP.isEditMode="true";e.target.id;var t=this.PivotPanel.querySelector(".pbMoveDlg"),i=o.getElementById("pvtCopy");-1!=e.path.indexOf(i)?(this.action="copy",t.classList.add("ptrChange")):(this.action="move",t.classList.remove("ptrChange")),t.style.display="block",o.body.addEventListener("mousedown",r,!1)},construct:function(){t=this.PivotPanel.querySelector(".pbMoveDlg");var i=e.UserAction.getTemplate(["pivotDestinationTemplate","pivotButtonTemplate"]),n=o.createDocumentFragment();n.appendChild(i.pivotDestinationTemplate),n.appendChild(i.pivotButtonTemplate),t.appendChild(n),t.querySelector("#targetLoc").classList.add("moveTable"),t.querySelector("#confirmPivot").addEventListener("click",this.doAction.bind(this)),t.querySelector("#cancelPivot").addEventListener("click",d),t.querySelector("#nSheet").addEventListener("click",this.eSheetHide),t.querySelector("#eSheet").addEventListener("click",this.eSheetShow.bind(this));var a=t.querySelector("#pivotTargetCell");c=new s.RangeEditor(a,!0),ZSClass.RangePicker.register(c,!0,!0),c.addListeners({valueChanged:this.changeBtnStyle})},eSheetHide:function(){t.querySelector("#targetLoc").classList.add("pvtHide"),t.querySelector("#confirmPivot").classList.contains("zsDisable")&&t.querySelector("#confirmPivot").classList.remove("zsDisable")},eSheetShow:function(){this.changeBtnStyle(),t.querySelector("#targetLoc").classList.remove("pvtHide"),c.value="",t.querySelector("#pivotTargetCell").focus()},changeBtnStyle:function(){c.value.trim().length>0?t.querySelector("#confirmPivot").classList.remove("zsDisable"):t.querySelector("#confirmPivot").classList.add("zsDisable")},doAction:function(){a.SP.isEditMode="false";var e=i.view.getActiveGridID(),o=i.view.getResourceID(e),s=i.view.getSelectedSheets(e),l=i.view.getVersionID(e),r=a.PanelID;if(t.querySelector("#nSheet").checked)"copy"===this.action?a.InsertSheetCallBack="COPY_PIVOT":"move"===this.action&&(a.InsertSheetCallBack="MOVE_PIVOT"),UserAction.InsertPivotSheet(o,s,l,void 0,void 0,!0,void 0);else{"copy"===this.action?a.LastAction="SP_COPY":"move"===this.action&&(a.LastAction="SP_MOVE");var v=JSUtil.Range.parseRange(o,l,c.value.trim());if(!v){var u=n["GoalSeek.Msg.InvalidCell"],S={buttons:[{text:n.OK,primary:!0,click:function(){c.value="",c.focus()}}],title:n["Alert.Title.InvalidCellRange"]};return ZSClass.ZSAlert(u,S),!1}v&&UserAction.movePivot(o,s,l,r,v,!1,!1,this.action)}d()}},a.Move=l}(this);
!function(e){var t=e.sPlusPlus,r=(e.ZSConstants.FeatureConstants,e.document,e.ZSConstants.I18N),n=(e.ZSConstants.wCC,ZSClass.Editors,ZSClass.Pivot.Group),o=e.ZSEvents,i=(o.topic,o.Groups,o.Names,n.Action||(n.Action={}));e.ZSConstants.CommandConstants,e.ZSConstants.PivotConstant;function a(e,t){for(var r=0;r<e.length;r++)for(var n=e[r],o=n.rangeList,i=0;i<o.length;i++){var a=o[i];if(new ZSClass.Range(a.sR,a.sC,a.eR,a.eC).intersects(t))return n}}i.getNumFieldInfoDetails=function(){var e,r=t.view.getActiveGridID(),n=t.view.getResourceID(r),o=t.view.getVersionID(r),i=ZSClass.Pivot.currentPivotId,s=t.view.getSheetID(r),l=t.view.getSheetState(r,s).getActiveCellRange(),f=(c=t.data.getWorkBook(n,o).PivotCollection.get(i)).pnrd;if(f)if(f.row){if(e=a(f.row,l)){e.fieldType="row";for(var v=0;v<c.rf.length;v++)if(e.colIndex===c.rf[v]){e.headerIndex=v;break}}}else if(!e&&f.col&&(e=a(f.col,l)))for(e.fieldType="column",v=0;v<c.cf.length;v++)if(e.colIndex===c.cf[v]){e.headerIndex=v;break}if(e){var c,d,u=(c=t.data.getWorkBook(n,o).PivotCollection.get(i)).af;for(v=0;v<u.length;v++)if((d=u[v]).colIndex==e.colIndex){e.colInfo=d;break}}return e},i.getFieldPositioninPivot=function(e){for(var r=t.view.getActiveGridID(),n=t.view.getResourceID(r),o=t.view.getVersionID(r),i=ZSClass.Pivot.currentPivotId,a=t.data.getWorkBook(n,o).PivotCollection.get(i),s=0;s<a.rf.length;s++)if(e.colIndex==a.rf[s])return(l={fieldType:"row"}).headerIndex=s,l;for(s=0;s<a.cf.length;s++){var l;if(e.colIndex==a.cf[s])return(l={fieldType:"column"}).headerIndex=s,l}},i.validate=function(e,t,n){if(0==e.length||0==t.length||0==n.length){var o=r["Error.Invalid.Group.Entry"];return ZSClass.ZSAlert(o),!1}if(isNaN(e)||isNaN(t)||isNaN(n))return o=r["Error.Invalid.Group.Entry"],ZSClass.ZSAlert(o),!1;if(1*t<1*e)return o=r["Error.Invalid.Group.MinMax"],ZSClass.ZSAlert(o),!1;if(n<1)return o=r["Error.Invalid.Group.Entry"],ZSClass.ZSAlert(o),!1;return!0}}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSConstants.FeatureConstants,s=e.document,n=e.ZSConstants.I18N,r=(e.ZSConstants.wCC,ZSClass.Pivot),o=(e.document.getElementById("popupmenu"),e.jQuery,e.UIUtil.Component,t.view.Toolbar.Feature[i.PIVOT_REFRESH]);e.ZSConstants.CommandConstants;function v(e){this.PivotPanel=e}v.prototype={bindEvent:function(){this.PivotPanel.querySelector(".pvtRefBtn").addEventListener("click",this.selected.bind(this)),this.PivotPanel.querySelector("#ref").addEventListener("click",this.selected.bind(this)),this.PivotPanel.querySelector("#refAll").addEventListener("click",this.refreshPivot.bind(this))},selected:function(){this.refreshPivot(!0)},refreshPivot:function(e){var i=e&&!0===e?ZSClass.Pivot.ID:void 0,s=t.view.getActiveGridID(),n=t.view.getResourceID(s),r=t.view.getSelectedSheets(s),o=t.view.getVersionID(s);UserAction.refreshPivot(n,r,o,i)}},r.Refresh=v,o.handleError=function(e,i){var r=n["Error.Pivot.Overwrite.Data.Refresh"],o=s.createElement("div");o.innerHTML=r;var v={buttons:[{text:n.Yes,primary:!0,click:function(){var e=t.view.getActiveGridID(),s=t.view.getResourceID(e),n=t.view.getSelectedSheets(e),r=t.view.getVersionID(e);UserAction.refreshPivot(s,n,r,i,!0)}},{text:n.No}],isHtml:!0};ZSClass.ZSAlert(o,v)}}(this);
!function(t){var e=t.sPlusPlus,i=(t.ZSConstants.FeatureConstants,t.document,t.ZSConstants.I18N),n=(t.ZSConstants.wCC,ZSClass.Pivot);function o(){var t=i["Pivot.UI.Delete.Confirm"],o={buttons:[{text:i.Yes,primary:!0,click:function(){var t,i,o,s;t=e.view.getActiveGridID(),i=e.view.getResourceID(t),o=e.view.getVersionID(t),s=e.view.getSelectedSheets(t),UserAction.deletePivot(i,s,o,n.currentPivotId)}},{text:i.No}],title:i["Alert.Title.PivotTableDelete"]};ZSClass.ZSAlert(t,o)}function s(t){this.PivotPanel=t}s.prototype={bindEvent:function(){this.PivotPanel.querySelector("#pvtDelete").addEventListener("click",o)}},n.Delete=s,n.pivotDeleteConfirmation=o}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSConstants.FeatureConstants,o=e.ZSConstants.PivotConstant,l=e.document,a=(e.ZSConstants.I18N,e.ZSConstants.wCC,t.view.Toolbar.Feature[i.PIVOT_STYLES],ZSClass.Pivot),s=e.UIUtil.Component;function r(e){this.PivotPanel=e}r.prototype={init:function(){this.constructCSchemeMenu(),this.PivotPanel.querySelector("#prev").addEventListener("click",this.slideTheme.bind(this)),this.PivotPanel.querySelector("#next").addEventListener("click",this.slideTheme.bind(this)),this.PivotPanel.querySelector("#pvtThemeContainer").querySelectorAll("ul").forEach(function(e){for(var t=e.children,i=0;i<t.length;i++){t[i].addEventListener("click",this.changeTheme.bind(this),!1)}}.bind(this))},constructCSchemeMenu:function(){var t=l.getElementById("popupmenu"),i=e.UserAction.getTemplate(["pivotColorSchemeTemplate"]).pivotColorSchemeTemplate.querySelector("#pivotColorpaletteContainer");t.appendChild(i);var o=this.PivotPanel.querySelector("#pivotColorPalette");s.zpopover(o,{beforeopen:this.updateColorPalette.bind(this)}),l.getElementById("pvtCPaletteClose").addEventListener("click",this.pvtCSThemeClosePopOver.bind(this),!1),s.bind("ul#pvtColorPaletteHolder > li > .wid100","click",function(e,t){var i=e.target.parentElement,o=i.dataset,a=o.basecolor,s=o.name.split("-")[3].replace("THEME",""),r=this.pivotStyleID.split("_")[0],n=this.pivotStyleID.split("_")[1];if(r!==s){for(var c=l.querySelector("#pvtColorPaletteHolder").childNodes,v=0;v<c.length;v++){var h=c[v];if("LI"===h.nodeName&&h.className.contains("active")){h.classList.remove("active");var p=h.dataset.name.split("-")[3].replace("THEME","");break}}var d=new ZSChart.Utility.SheetChartColor(JSON.parse(a)).generateLinearGradient();this.PivotPanel.querySelector("#pivotColorPalette").style["background-image"]=d,i.classList.add("active"),this.pivotStyleID=s+"_"+n,this.PivotPanel.querySelector("#pvtThemeContainer").classList.contains("cScheme"+p)&&this.PivotPanel.querySelector("#pvtThemeContainer").classList.remove("cScheme"+p),this.PivotPanel.querySelector("#pvtThemeContainer").classList.add("cScheme"+s),this.changePivotStyle()}}.bind(this))},pvtCSThemeClosePopOver:function(){var e=this.PivotPanel.querySelector("#pivotColorPalette");s.zpopover(e,"close")},updateColorPalette:function(){for(var e=this.pivotStyleID.split("_")[0],t=l.querySelector("#pvtColorPaletteHolder").childNodes,i=0;i<t.length;i++){var o=t[i];if("LI"===o.nodeName&&o.dataset.name.split("-")[3].replace("THEME","")===e){o.classList.add("active");break}}},selectColorPalette:function(e){var t=e.target,i=e.target.dataset.name.split("-")[3].replace("THEME",""),o=this.pivotStyleID.split("_")[0],l=this.pivotStyleID.split("_")[1];o!==i&&(this.PivotPanel.querySelectorAll("ul.cPaletteCode > li").forEach(function(e){e.className.contains("active")&&e.classList.remove("active")}),t.classList.add("active"),this.pivotStyleID=i+"_"+l,this.PivotPanel.querySelector("#pvtThemeContainer")[0].classList.add("cScheme"+i),this.changePivotStyle())},slideTheme:function(e){var t,i,o=e.target.id;this.PivotPanel.querySelector("#pvtThemeContainer").querySelectorAll("input").forEach(function(e){e.checked&&(t=parseInt(e.id.substr(4)))}),i="prev"===o?1==t?5:t-1:5==t?1:t+1,this.PivotPanel.querySelector("#pvtThemeContainer").querySelector("#them"+i).checked=!0},setValue:function(){this.resetValue();var e=a.ID,i=t.view.getActiveGridID(),s=t.view.getResourceID(i),r=t.view.getVersionID(i),n=t.data.getWorkBook(s,r).PivotCollection.get(e)[o.PIVOTTEMPLATE_ID];if(n.contains("_"))var c=n.split("_")[0],v=n.split("_")[1];else c=1,v=(n="1_"+n).split("_")[1];l.getElementById(v).classList.add("active");var h=v.split("tc")[0];if(this.pivotStyleID=n,this.PivotPanel.querySelector("#pvtThemeContainer").querySelector("#them"+h).checked=!0,this.PivotPanel.querySelector("#pivotColorPalette")){c=0==c?"1":c,this.PivotPanel.querySelector("#pvtThemeContainer").classList.add("cScheme"+c);for(var p=l.querySelector("#pvtColorPaletteHolder").childNodes,d=0;d<p.length;d++){var S=p[d];if("LI"===S.nodeName)if(c===S.dataset.name.split("-")[3].replace("THEME","")){var P=S.dataset.basecolor,u=new ZSChart.Utility.SheetChartColor(JSON.parse(P)).generateLinearGradient();this.PivotPanel.querySelector("#pivotColorPalette").style["background-image"]=u;break}}}},resetValue:function(){if(this.pivotStyleID){if(this.pivotStyleID.contains("_"))var e=this.pivotStyleID.split("_")[0],t=this.pivotStyleID.split("_")[1];else e=0,t=this.pivotStyleID.split("_")[1];if(l.getElementById(t).classList.remove("active"),this.PivotPanel.querySelector("#pivotColorPalette")){e=0==e?1:e,this.PivotPanel.querySelector("#pvtThemeContainer").classList.remove("cScheme"+e);for(var i=l.querySelector("#pvtColorPaletteHolder").childNodes,o=0;o<i.length;o++){var a=i[o];if("LI"===a.nodeName&&a.className.contains("active")){a.classList.remove("active");break}}}}},changeTheme:function(e){for(var t,i=0;i<4&&"LI"!==(t=e.path[i]).tagName;i++);var o=t.id,a=this.pivotStyleID.split("_")[0],s=this.pivotStyleID.split("_")[1];s!==o&&(l.getElementById(s).classList.remove("active"),this.pivotStyleID=a+"_"+o,l.getElementById(o).classList.add("active"),this.changePivotStyle())},changePivotStyle:function(){var e=t.view.getActiveGridID(),i=t.view.getResourceID(e),l=t.view.getSelectedSheets(e),a=t.view.getVersionID(e),s=ZSClass.Pivot.ID;t.data.getWorkBook(i,a).PivotCollection.get(s)[o.PIVOTTEMPLATE_ID]=this.pivotStyleID;var r=0,n=this.pivotStyleID.split("_")[1],c=n.split("tc")[0],v=n.split("tc")[1];this.PivotPanel.querySelector("#pivotColorPalette")&&(r=this.pivotStyleID.split("_")[0]),UserAction.changePivotStyle(i,l,a,s,r,c,v)}},a.Style=r}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,o=(t.document,t.ZSConstants.I18N,t.ZSConstants.wCC,e.view.Toolbar.Feature[n.PIVOT_TOTALS],t.UIUtil.Component,ZSClass.Pivot);t.ZSConstants.PivotConstant;function i(t){this.PivotPanel=t}i.prototype={bindEvent:function(){this.PivotPanel.querySelectorAll('input[type="checkbox"]').forEach(function(t){t.addEventListener("change",this._changeOption)}.bind(this))},setValue:function(){var t=ZSClass.Pivot.ID,n=e.view.getActiveGridID(),o=e.view.getResourceID(n),i=e.view.getVersionID(n),s=e.data.getWorkBook(o,i).PivotCollection.get(t);this.PivotPanel.querySelectorAll('input[type="checkbox"]').forEach(function(t){s[t.id]?t.checked=!0:t.checked=!1})},_changeOption:function(t){var n=t.target.id,o=t.target.checked,i=e.view.getActiveGridID(),s=e.view.getResourceID(i),c=e.view.getSelectedSheets(i),a=e.view.getVersionID(i),r=ZSClass.Pivot.ID;UserAction.changeTotalOption(s,c,a,r,n,o)}},o.TotalController=i}(this);
!function(e){function t(){this.isRender=!1}t.prototype={isRendered:function(){return this.isRender},setRendered:function(e){this.isRender=e}},e.ZSClass.StateChart=t}(this);
!function(e){var t,r,o=e.document,E=e.sPlusPlus,a=e.ZSChart,n=e.ZSConstants.FeatureConstants,i=E.view.Toolbar.Feature[n.CHART],l=a.Constants.MessageConstant,c=ZSConstants.I18N,s=e.ZSEvents,U=s.topic,u=s.Groups,P=s.Names,T=e.ZSConstants.wCC,S=e.UIUtil.Component,R=o.getElementById("popupmenu");e.ZSDevTools.Logger;function O(e){var t=d+e;return UserAction.getTemplate([t])[t]}var M=["NEXT","PREV"],N=["RECOMMEND"],C=["COLMENU","BARMENU","LINEMENU","PIEMENU","AREAMENU","SCATTERMENU","OTHERSMENU"],A=[{CHART_POPUP:["MENULINE",{MENUWRAPPER:[{RECOMMEND:["ZSLOADER","RECOMMEND_PREVIEW_WRAPPER","RECOMMEND_ALERT"]},"COLMENU","BARMENU","LINEMENU","PIEMENU","AREAMENU","SCATTERMENU",{OTHERSMENU:["NEXT","PREV"]},"BOTTOMLINE"]}]}],h="RECOMMEND",d="CHART_POPUP_",v="RECOMMEND",f="OTHERSMENU_SUBMENU_1";function p(e){var r=t.querySelector("#MENUWRAPPER"),o=null,E=a.Wrapper.DOMUtils,n=null;switch(e){case"PREV":case"othrCht1":o=r.querySelector("#PREV"),n=r.querySelector("#NEXT");break;case"NEXT":case"othrCht2":n=r.querySelector("#PREV"),o=r.querySelector("#NEXT")}n&&E.show(n),o&&E.hide(o)}function b(){return N.concat(C)}function I(){return t.querySelector("#MENUWRAPPER").querySelector("#"+N[0])}-1!=ZSConstants.Meta.DisableFeaturesList.indexOf(n.CHART)&&S.disable(i.chartBtn),i.execute=function(e,t){if(E.view.Toolbar.showChartPopup&&!t)U.publish(u.UI,P.Toolbar.CHART.POPUP.OPEN_POPUP);else{var r=a.Utility.isAllowdToInsertChartInSheet();if(r==l.ERROR.READONLY)return void ZSClass.ZSAlert(c["Banner.ReadOnly.App.Server"],{title:c["Alert.Title.ROMode"]});if(r==l.ERROR.SHEET_LOCKED)return void ZSClass.ZSAlert(c["ProtectRange.UI.SheetLocked"],{title:c["Alert.Title.LockedSheet"]});var o=a.Manager.SidePanelManager;o.initPanelManager(),o.init(t)}},i.getRecommendationHolder=I,i.getFooterBar=function(){return t.querySelector("#MENUWRAPPER").querySelector("#footerBar")},U.register(u.UI,P.Toolbar.CHART.POPUP.CLOSE,function(){S.zpopover(r,"close")}),U.register(u.UI,P.Toolbar.CHART.POPUP.OPEN_POPUP,function(){S.zpopover(r,"open",{target:r})}),U.register(u.UI,P.Toolbar.CHART.POPUP.CLEAR,function(){var e=a.Wrapper.DOMUtils;U.publish(u.UI,P.Toolbar.CHART.POPUP.SELECT,{ID:h});var r=I(),o=e.createElement("div",{id:"recommendChartPreview"}),E=r.querySelector("#recommendChartPreview");E?E.innerHTML="":r.appendChild(o),e.hide(E);var n=r.querySelector("#RECOMMENDALERT");n.setAttribute("noChart","false"),e.hide(n),function(){a.Wrapper.DOMUtils;var e=t.querySelector("#MENUWRAPPER");function r(e){e&&Object.keys(e).forEach(function(t){var r=e[t];r&&(r.checked=!1)})}Object.keys(C).forEach(function(t){var o=C[t],E=e.querySelector("#"+o);"OTHERSMENU"==o?["OTHERSMENU_SUBMENU_1","OTHERSMENU_SUBMENU_2"].forEach(function(e){var t=E.querySelector("#"+e);r(t.querySelectorAll("input"))}):r(E.querySelectorAll("input"))})}(),U.publish(u.UI,P.Toolbar.CHART.POPUP.SELECT_SUBMENU,{ID:"OTHERSMENU_SUBMENU_1"}),U.publish(u.UI,P.Toolbar.CHART.POPUP.SETRECOMMENDATIONSOURCE,{HOLDER:i.getFooterBar(),VALUE:c["Chart.Recommendations.Footer"]||"Based on the selection Zoho Sheet recommends the above charts."})}),U.register(u.UI,P.Toolbar.CHART.POPUP.LOADER.SHOW,function(){var e=a.Wrapper.DOMUtils,t=i.getRecommendationHolder().querySelector(".ZsLoader");t.setAttribute("loadData","true"),e.show(t)}),U.register(u.UI,P.Toolbar.CHART.POPUP.LOADER.HIDE,function(){var e=a.Wrapper.DOMUtils,t=i.getRecommendationHolder().querySelector(".ZsLoader");t.setAttribute("loadData","false"),e.hide(t)}),U.register(u.UI,P.Toolbar.CHART.POPUP.SELECT,function(e){if(e!=v){v=e;var r=t.querySelector("#MENUWRAPPER"),o=t.querySelector("#MENULINE");(function(){var e=b();Object.keys(e).forEach(function(t){var E=e[t];r.querySelector("#"+E).classList.add("dsp_none"),o.querySelector("#"+E).classList.remove("active")})}).call(this),r.querySelector("#"+v).classList.remove("dsp_none"),o.querySelector("#"+v).classList.add("active"),b().indexOf(v)>0?U.publish(u.UI,P.Toolbar.CHART.POPUP.SETDATASOURCE,{HOLDER:i.getFooterBar()}):U.publish(u.UI,P.Toolbar.CHART.POPUP.SETRECOMMENDATIONSOURCE,{HOLDER:i.getFooterBar()})}},"ID"),U.register(u.UI,P.Toolbar.CHART.POPUP.SELECT_SUBMENU,function(e){if(e!=f){f=e;var r=t.querySelector("#MENUWRAPPER").querySelector("#OTHERSMENU");(function(){var e=["OTHERSMENU_SUBMENU_1","OTHERSMENU_SUBMENU_2"];Object.keys(e).forEach(function(t){var o=e[t];r.querySelector("#"+o).classList.add("dsp_none")})}).call(this),r.querySelector("#"+e).classList.remove("dsp_none"),r.querySelector("#"+e).classList.remove("dspFlex"),r.querySelector("#botNav").querySelector("#"+{OTHERSMENU_SUBMENU_1:"othrCht1",OTHERSMENU_SUBMENU_2:"othrCht2"}[e]).checked=!0}},"ID"),U.register(u.UI,P.Layout.TEMPLATE_LOADED,function(){if(!e.isCraftGrid){r=document.getElementById(T.MI+n.CHART+T.IDENTITY);var o=UserAction.getTemplate(["CHART_POPOVER_TEMPLATE"]);t=o.CHART_POPOVER_TEMPLATE.querySelector("#CHART_POPUP"),R.appendChild(t),r.setAttribute("data-content","#CHART_POPUP"),r.setAttribute("data-is-content-html-encoded",!0),r.setAttribute("data-class-name","chrtPopup"),function e(t,r){Object.keys(r).forEach(function(o){var E=r[o];if("object"==typeof E){var a=Object.keys(E)[0];if(t.id!=a){var n=O(a),i=n.querySelector("#"+a);t.appendChild(n),e(i,E[a])}else e(t,E[a])}else{var n=O(E);t.appendChild(n)}})}.call(this,t,A),U.publish(u.UI,P.SidePanel.CHARTS.LINKED_ICON,{PARENT:t}),S.zpopover(r,{open:function(){E.view.Toolbar.showChartPopup&&U.publish(u.UI,P.Toolbar.CHART.POPUP.OPEN),!E.view.Toolbar.showChartPopup&&U.publish(u.UI,P.Toolbar.CHART.POPUP.CLOSE)},close:function(){E.view.Toolbar.showChartPopup&&U.publish(u.UI,P.Toolbar.CHART.POPUP.CLEAR)}}),function(){var e,r;e=b(),r=t.querySelector("#MENULINE"),Object.keys(e).forEach(function(t){var o=e[t],E=r.querySelector("#"+o);E.addEventListener("click",function(){U.publish(u.UI,P.Toolbar.CHART.POPUP.SELECT,{ID:o})})}),function(){var e=a.Wrapper.DOMUtils,r=t.querySelector("#MENUWRAPPER");function o(e){e&&Object.keys(e).forEach(function(t){var r=e[t];r.addEventListener&&r.addEventListener("click",function(){U.publish(u.UI,P.Toolbar.CHART.POPUP.EDIT,{TYPE:this.previousElementSibling.id})})})}Object.keys(C).forEach(function(t){var E=C[t],a=r.querySelector("#"+E);if("OTHERSMENU"==E){var n=["OTHERSMENU_SUBMENU_1","OTHERSMENU_SUBMENU_2"];n.forEach(function(e){var t=a.querySelector("#"+e);o(t.querySelectorAll("label"))});var i=r.querySelector("#botNav"),l=i.querySelectorAll("input");e.addEventByNode(l,e.Events.CLICK,function(){var e,t={othrCht1:(e=["OTHERSMENU_SUBMENU_1","OTHERSMENU_SUBMENU_2"])[0],othrCht2:e[1]};U.publish(u.UI,P.Toolbar.CHART.POPUP.SELECT_SUBMENU,{ID:t[this.id]}),p(this.id)})}else o(a.querySelectorAll("label"))})}(),function(){var e=t.querySelector("#MENUWRAPPER");function r(e){switch(e){case"NEXT":U.publish(u.UI,P.Toolbar.CHART.POPUP.SELECT_SUBMENU,{ID:(t=["OTHERSMENU_SUBMENU_1","OTHERSMENU_SUBMENU_2"],r=t.length,o=(t.indexOf(f)+1)%r,t[o])});break;case"PREV":U.publish(u.UI,P.Toolbar.CHART.POPUP.SELECT_SUBMENU,{ID:function(){var e=["OTHERSMENU_SUBMENU_1","OTHERSMENU_SUBMENU_2"],t=e.length,r=e.indexOf(f)-1;return e[r<0?t-1:r]}()})}var t,r,o}Object.keys(M).forEach(function(t){var o=M[t],E=e.querySelector("#"+o);E.addEventListener("click",function(){r(M[t]),p(M[t])})})}()}.call(this)}}),U.register(u.UI,P.Toolbar.INIT_MENU,function(e){if("TB_INSERT_POPUP_CONTAINER"==e.id){var t=E.view.getActiveGridID(),r=E.view.getSheetID(t),o=E.view.getResourceID(t),a=E.view.getVersionID(t),i=E.data.getWorkBook(o,a).ProtectedSheets.isSheetLocked(r),l=ZSConstants.Meta.DisableFeaturesList;i||-1!=l.indexOf(n.CHART)?S.disable("#"+T.MI+n.CHART+T.MENU):S.enable("#"+T.MI+n.CHART+T.MENU)}},"DOM")}(this);
!function(t){if(!t.isCanvasGrid){var n=t.sPlusPlus,i=t.ZSClass,a=(n.data.UserInfo,t.ZSChart,i.UIGridComponent.prototype),h=t.ZSEvents;h.topic,h.Groups,h.Names;a.onChartMeta=function(t,n,i,a,h){this.Chart.removeAll(),this.onChartMetaAsync(t,n,i,a)},a.onChartMetaAsync=function(t,n,i,a){if(a){var h=a.shift();h&&function(t,n,i,a){return new Promise(function(h,r){e.call(this,a),o.call(this,t,n,i,a),s.call(this,t,n,i,a),function(t){var n=this.Chart.getInteracter(t);n&&this.Chart.onLoad(t,n)}.call(this,a),setTimeout(function(){h()},100)}.bind(this))}.call(this,t,n,i,h.id||h).then(function(){this.onChartMetaAsync(t,n,i,a)}.bind(this))}},a.onChartUpdateBoundary=function(t,n,i,a){this.Chart.removeAll(),this.attachChartAsync(t,n,i,a)},a.onChartInsert=function(t,n,i,a,h){return new Promise(function(e,r){for(var s in a){var f=a[s].id;o.call(this,t,n,i,f),c.call(this,f),!h&&this.Chart.getInteracter(f).chart.isActionOwner()&&this.Chart.focus(f)}setTimeout(function(){e()},100)}.bind(this))},a.onUpdatePanelStatus=function(t,n,i,a,h){(function(t,n){this.Chart.getInteracter(t)&&this.Chart.updatePanelStatus(t,n)}).call(this,a,h)},a.onChartDelete=function(t,n,i,a){for(var h in a){var o=a[h];o&&r.call(this,o)}},a.onRemoveChart=function(t,n,i,a){for(var h in a){var o=a[h];o&&e.call(this,o)}},a.onChartUpdate=function(t,n,i,a,h){if(a){var e=a.shift();e&&function(t,n,i,a,h){return new Promise(function(e,r){try{s.call(this,t,n,i,a),o.call(this,t,n,i,a),function(t){var n=this.Chart.getInteracter(t);n&&this.Chart.onRefresh(t,n)}.call(this,a),!h&&this.Chart.focus(a)}catch(t){}setTimeout(function(){e()},100)}.bind(this))}.call(this,t,n,i,e.id,h).then(function(){this.onChartUpdate(t,n,i,a,h)}.bind(this))}},a.onChartNotificationAdd=function(t,i,a,h){(function(t,i,a,h){n.data.getWorkBook(t,a).getSheetObj(i).Charts.get(h)&&this.Chart.placeNotification(h)}).call(this,t,i,a,h)},a.onChartNotificationRemove=function(t,i,a,h){(function(t,i,a,h){n.data.getWorkBook(t,a).getSheetObj(i).Charts.get(h)&&this.Chart.removeNotification(h)}).call(this,t,i,a,h)},a.onChartNotificationUpdate=function(t,i,a,h,o){(function(t,i,a,h,o){n.data.getWorkBook(t,a).getSheetObj(i).Charts.get(h)&&this.Chart.updateNotification(h,o)}).call(this,t,i,a,h,o)},a.onSheetSwitchChartUpdate=function(t,n,i,a,h){var o=a.length,e=h.length;o>0&&this.onChartMetaAsync(t,n,i,a),e>0&&this.attachChartAsync(t,n,i,h)},a.onChartZoom=function(t,n,i,a,h){if(a){var e=a.shift();e&&function(t,n,i,a){return new Promise(function(h,e){o.call(this,t,n,i,a),function(t){var n=this.Chart.getInteracter(t);n&&this.Chart.onZoom(t,n)}.call(this,a),setTimeout(function(){h()},100)}.bind(this))}.call(this,t,n,i,e.id).then(function(){this.onChartZoom(t,n,i,a,!0)}.bind(this))}},a.attachChartAsync=function(t,n,i,a){var h=a.shift();h&&this.attachChart(t,n,i,h).then(function(){this.attachChartAsync(t,n,i,a)}.bind(this))},a.onChartPlace=function(t,n,i,a){o.call(this,t,n,i,a)},a.onChartBlur=function(t,n,i,a){for(var h=0;h<a.length;h++){var o=a[h];this.Chart.blur(o)}},a.onChartFocus=function(t,n,i,a){for(var h=0;h<a.length;h++){var o=a[h];this.Chart.focus(o)}},a.attachChart=function(t,n,i,a){return new Promise(function(h,e){o.call(this,t,n,i,a),function(t){var n=this.Chart.getInteracter(t);n&&this.Chart.onCachedViewAttach(t,n)}.call(this,a),setTimeout(function(){h()},100)}.bind(this))}}function o(t,i,a,h){var o=n.data.getWorkBook(t,a).getSheetObj(i).Charts.get(h),e=o.getLeft(),r=o.getTop(),s=o.getHeight(),c=o.getWidth();o&&this.Chart.place(h,e,r,c,s)}function e(t){t&&this.Chart.remove(t)}function r(t){t&&this.Chart.delete(t)}function s(t,i,a,h){var o=n.data.getWorkBook(t,a).getSheetObj(i).Charts.get(h);o&&o.flushInstance()}function c(t){var n=this.Chart.getInteracter(t);n&&this.Chart.onRender(t,n)}}(this);
!function(s){var t=s.sPlusPlus,e=(s.ZSZIA,s.ZSConstants.FeatureConstants),n=t.view.Toolbar.Feature[e.ZIA],u=s.ZSEvents,a=u.topic,i=u.Groups,o=u.Names;n.execute=function(){a.publish(i.UI,o.SidePanel.ZIA.TOGGLE)}}(this);
!function(e){var t,i,a,s,n,d=e.sPlusPlus,r=e.ZSConstants,o=e.document,u=r.I18N,c=(r.wCC,r.FeatureConstants),I=(r.CommandConstants,e.UIUtil.Component),l=e.ZSEvents,S=l.topic,g=l.Groups,m=l.Names,E=e.UIUtil,w=d.data.Defaults,C=e.UserAction,A=!1,V=!1,p={},v=o.getElementById("popupmenu"),b=o.querySelector(".gridContainer");d.view.Toolbar.Feature[c.VIEW_SETTINGS];S.register(g.UI,m.Layout.TEMPLATE_LOADED,function(){var e=new ZSClass.SBFeature("VIEW_SETTINGS"),t=e.div;E.fn.addIcon(t,"GRID_VIEW_ICON"),t.className="sTGridView",t.title=u["View.GridSpacing"],t.setAttribute("data-menu-id","gridViewOptions"),e.add()}),(n=o.createElement("ul")).id="gridViewOptions",n.className="sTGridView curPtr",n.setAttribute("data-ctype","zmenu"),n.setAttribute("data-content-type","icon-text"),s=n,(t=o.createElement("li")).setAttribute("data-value","CLASSIC"),t.setAttribute("data-item-type","checkbox"),t.setAttribute("data-checked",!0),t.innerText=u["View.GridSpacing.Classic"],s.appendChild(t),function(e){(i=o.createElement("li")).setAttribute("data-value","COZY"),i.setAttribute("data-item-type","checkbox"),i.innerText=u["View.GridSpacing.Cozy"],e.appendChild(i)}(n),function(e){(a=o.createElement("li")).setAttribute("data-value","COMFORT"),a.setAttribute("data-item-type","checkbox"),a.innerText=u["View.GridSpacing.Comfort"],e.appendChild(a)}(n),v.appendChild(n),I.bind(n,"zmenubeforeshow",function(){var e=w.VIEW;e==d.data.View.CLASSIC?(I.zmenu("#gridViewOptions","setMenuItemsAttribute",[t],"checked",!0),I.zmenu("#gridViewOptions","setMenuItemsAttribute",[i],"checked",!1),I.zmenu("#gridViewOptions","setMenuItemsAttribute",[a],"checked",!1)):e==d.data.View.COZY?(I.zmenu("#gridViewOptions","setMenuItemsAttribute",[t],"checked",!1),I.zmenu("#gridViewOptions","setMenuItemsAttribute",[i],"checked",!0),I.zmenu("#gridViewOptions","setMenuItemsAttribute",[a],"checked",!1)):e==d.data.View.COMFORT&&(I.zmenu("#gridViewOptions","setMenuItemsAttribute",[t],"checked",!1),I.zmenu("#gridViewOptions","setMenuItemsAttribute",[i],"checked",!1),I.zmenu("#gridViewOptions","setMenuItemsAttribute",[a],"checked",!0))}),I.bind(n,"zmenuitemclick",function(e,t){var i,a=t.data.value,s=d.view.getActiveGridID(),n=d.view.getResourceID(s),r=d.view.getSheetID(s),o=d.view.getVersionID(s),u=d.view.getSelectedSheets(s);for(var c in d.view.getSheetState(s,r),d.data.View)if(w.VIEW==d.data.View[c]){i=c;break}if(a!==i){A=!0;var I=d.view.CellEditor;I&&I.getEditStatus()&&S.publish(g.Selector.BoundUpdate.CellEdit,m.Selection.BOUND_UPDATE.REMOVE,{RID:n,SHEETID:r,VERSION:o,isSubmittable:!0}),C.GRID_VIEW(n,u,o,a,i)}}),S.register(g.Listener,m.SheetAction.GRID_SPACING.MODIFY,function(t,i,a,s,n,r,o){var u=d.view.getActiveGridID();if(!t&&(t=d.view.getResourceID(u)),!i&&(i=d.view.getSheetID(u)),!a&&(a=d.view.getVersionID(u)),!n||V){if(o&&!r){if(i!=d.view.getSheetID(u))return void(p[i]=!0);A=!0}var c=d.data.getWorkBook(t,a).getSheetObj(i);if(w.VIEW!=s||p[i]){var I=ZSClass.Padding.getRowPaddingDiff(s,w.VIEW),l=ZSClass.Padding.getColPaddingDiff(s,w.VIEW);b.classList.remove("classic","cozy","comfort"),s==d.data.View.CLASSIC?b.classList.add("classic"):s==d.data.View.COZY?b.classList.add("cozy"):s==d.data.View.COMFORT&&b.classList.add("comfort");var E=d.view.getSheetState(u,i),v=E.sTops,O=E.sLefts,D=O[0],f=v[0],h=O[1],T=v[1],R=c.Row.auxiliaryAxis.findAbs(f),k=c.Row.auxiliaryAxis.findAbs(T),x=c.Column.auxiliaryAxis.findAbs(D),G=c.Column.auxiliaryAxis.findAbs(h);w.VIEW=s,function(e,t,i){for(var a=d.data.getWorkBook(e,i).getSheetObj(t),s=a.Row.axis,n=a.Row.auxiliaryAxis,r=a.Column.axis,o=a.Column.auxiliaryAxis,u=w.MAX_ROW,c=w.MAX_COL,I=ZSClass.Padding.getRowPadding(),l=ZSClass.Padding.getColPadding(),S=0;S<u;S++){var g=s.getDim(S);n.setDim(S,1,g?g+I:g)}for(S=0;S<c;S++)g=r.getDim(S),o.setDim(S,1,g?g+l:g)}(t,i,a),f+=(R+.5)*I,T+=(k+.5)*I,D+=(x+.5)*l,h+=(G+.5)*l,C.ScrollTo(t,i,a,D,f,h,T);var M=d.view.getGridComponent(u);A&&(e.isCanvasGrid?M.refresh():M.onReload(t,i,a)),A&&C.UpdateViewport(t,i,a),S.publish(g.Listener,m.SheetMeta.GRIDVIEW,{RID:t,SHEETID:i,VERSION:a}),A=!1,delete p[i]}}},"RID","SHEETID","VERSION","GRID_SPACING","ISSHEETSWITCH","ISACTIONOWNER","XAID"),S.register(g.UserAction,m.DocAction.ACTIVE_SHEET.BEFORE_SWITCH,function(e,t,i,a){d.data.getWorkBook(e,i).getSheetObj(a).Visited?(A=!0,V=!0):(A=!1,V=!1)},"RID","SHEETID","VERSION","TARGET_SHEET")}(this);
!function(e){var t,i,n,r,o=e.sPlusPlus,c=e.document,s=e.UserAction,u=e.ZSEvents,a=e.ZSConstants,d=e.UIUtil,l=u.topic,I=u.Groups,E=u.Names,m=a.FeatureConstants,b=a.I18N,p=(a.wCC,a.CommandConstants,d.Component),D=c.getElementById("popupmenu"),S=(o.view.Toolbar.Feature[m.SHEET_RTL],"rl-tb");(r=c.createElement("ul")).id="directionOptions",r.setAttribute("data-ctype","zmenu"),r.setAttribute("data-content-type","icon-text"),n=r,(t=c.createElement("li")).setAttribute("data-value","ltr"),t.setAttribute("data-item-type","checkbox"),t.setAttribute("data-checked",!0),t.innerText=b["GridDirection.LTR"],n.appendChild(t),function(e){(i=c.createElement("li")).setAttribute("data-value","rtl"),i.setAttribute("data-item-type","checkbox"),i.innerText=b["GridDirection.RTL"],e.appendChild(i)}(r),D.appendChild(r),p.bind(r,"zmenubeforeshow",function(){var e=o.view.getActiveGridID(),n=o.view.getResourceID(e),r=o.view.getSheetID(e),c=o.view.getVersionID(e);o.data.getWorkBook(n,c).getSheetObj(r).gridDirection===S?(p.zmenu("#directionOptions","setMenuItemsAttribute",[t],"checked",!1),p.zmenu("#directionOptions","setMenuItemsAttribute",[i],"checked",!0)):(p.zmenu("#directionOptions","setMenuItemsAttribute",[t],"checked",!0),p.zmenu("#directionOptions","setMenuItemsAttribute",[i],"checked",!1))}),p.bind(r,"zmenuitemclick",function(e,t){var i=t.data.value,n=o.view.getActiveGridID(),r=o.view.getResourceID(n),c=o.view.getSheetID(n),u=o.view.getVersionID(n),a=o.view.getSelectedSheets(n);if((o.data.getWorkBook(r,u).getSheetObj(c).gridDirection===S?"rtl":"ltr")!==i){var d="rtl"===i,m=o.view.cellEditor;m&&m.getEditStatus()&&l.publish(I.Selector.BoundUpdate.CellEdit,E.Selection.BOUND_UPDATE.REMOVE,{RID:r,SHEETID:c,VERSION:u,isSubmittable:!0}),s.SwitchRTL(r,a,u,d)}}),l.register(I.Listener,E.SheetAction.SHEET_DIRECTION.MODIFY,function(e,t,i,n,r){var o=n===S;l.publish(I.Listener,E.GridAction.FLIP,{RID:e,SHEETID:t,VERSION:i,FLIP:o})},"RID","SHEETID","VERSION","DIRECTION","ISACTIONOWNER")}(this);
!function(e){var t,s,i,n,r,o=e.sPlusPlus,l=e.document,a=e.ZSEvents,d=a.topic,c=a.Groups,u=a.Names,f=e.ZSConstants.wCC,v=e.ZSConstants.FeatureConstants,h=(o.view.Toolbar.Feature[v.TOOLBAR_RESIZE],l.getElementById("popupmenu"),100),p=!1,E=[],m=!0,I=!0;function y(e){return s||((s=l.createElement("div")).className="shIcon shMoreMenuIcon",s.id=f.MI+v.TOOLBAR_RESIZE+f.IDENTITY,(r=l.createElement("span")).className="shMoreMenuPtr",s.appendChild(r),T(r,!1),s.addEventListener("click",function(){if(I){T(i,!0),s.classList.add("shIconActive");var e=s.offsetLeft+s.clientWidth,t=s.offsetParent.offsetTop+s.offsetTop+30;if(i.style.top=t+"px",T(r,!0),n>=850)i.style.removeProperty("left"),i.style.right=n-e-20+"px";else{i.style.removeProperty("right");var o=i.offsetWidth,l=(n-o)/2;i.style.left=l+"px"}I=!1}else T(r,!1),T(i,!1),s.classList.remove("shIconActive"),I=!0}),(i=l.createElement("ul")).id=f.SUBMENUITEM+v.TOOLBAR_RESIZE+f.IDENTITY,i.className="shMoreMenu shIconsHldr",l.body.appendChild(i),e.appendChild(s)),s}function L(r){var a=o.view.getActiveGridID(),f=o.view.getVersionID(a);"none"!=l.querySelector("#quickToolBar").style.display&&f==o.data.Defaults.version&&(n=l.body.clientWidth,e.clearTimeout(t),t=e.setTimeout(function(){C();var e=l.querySelector(".shTopMenu"),t=o.view.getViewMenu().TBObject.quickAccessContainer,n=e.querySelector(".shFindBar"),a=e.offsetWidth,f=t.offsetWidth,v=n.offsetWidth;if(a<f+v+h&&"remove"!=r){var I=function e(t,s){t===s&&(t=t.previousElementSibling);var i=t;if(0!=i.childElementCount)return i;var n=i.previousElementSibling;return null!=n?e(n,s):void 0}(t.lastElementChild,s);if(I){I.childElementCount<=1&&T(I,!1);var S=I.lastElementChild;E.push({ButtonSet:I,Element:S}),s=y(t),p=!0,T(s,!0),i.appendChild(S),L("add")}}else if(p){var B=E.length;if(B>0&&"add"!=r){var M=E[B-1].ButtonSet,b=E[B-1].Element;g(i,!1),T(i,!0);var w=t.offsetWidth+b.offsetWidth+h+v;if(g(i,!0),T(i,!1),a>w){M.style.display;T(M,!0),M.appendChild(b),E.splice(B-1,1),0==E.length?(T(s,!1),E=[],p=!1):L("remove")}}}else E=[],p=!1,s&&T(s,!1);m&&(d.unregister(c.Listener,u.Browser.UIPageLoad,L),m=!1)},0))}function T(e,t){e.style.display=t?"":"none"}function g(e,t){e.style.visibility=t?"visible":"hidden"}function C(){i&&T(i,!1),r&&T(r,!1),s&&s.classList.remove("shIconActive"),I=!0}d.register(c.Listener,u.Browser.RESIZE,L),d.register(c.Listener,u.Browser.UIPageLoad,L),d.register(c.Listener,u.ContextMenu.INIT,C),d.register(c.UI,u.Toolbar.FULLSCREEN_TOGGLE,L),d.register(c.UI,u.Layout.DEFER_JS_LOADED,L)}(this);
!function(e){var t,n=e.sPlusPlus,r=e.ZSEvents,i=r.topic,o=r.Groups,s=(e.ZSClass,r.Names),a=e.ZSConstants.I18N,u=(e.document,function(e){if("undefined"!=typeof Clipboard&&e.constructor==Clipboard)return e.files.length>0;var t;if("undefined"!=typeof DOMStringList&&(t=e.types).constructor==DOMStringList)return!!t.contains("Files");if("undefined"!=typeof Array&&(t=e.types).constructor==Array)return-1!=t.indexOf("Files")}),f=function(e,r){t.ondragleave=function(t){t.stopPropagation(),t.preventDefault(),c(e)},t.ondrop=function(t){!function(e,t){e.preventDefault(),e.stopPropagation();var r=n.view.getResourceID(t),a=n.view.getSheetID(t),u=n.view.getVersionID(t),f=e.target.files||e.dataTransfer.files;i.publish(o.Listener,s.UserAction.DRAG_DROP.DROPEND,{RID:r,SHEETID:a,VERSION:u,FILES:f})}(t,r),c(e)},t.ondragover=function(e){e.preventDefault(),e.stopPropagation()}},c=function(e){e.removeChild(t),e.classList.remove("dragOver"),t=""},d=function(e,n){t||((t=document.createElement("div")).innerText=a.dropYourFile,t.className="dragOverCue",e.appendChild(t),e.classList.add("dragOver"),f(e,n))};i.register(o.Listener,s.UserAction.DRAG_DROP.DRAGOVER,function(e,t,n){e.stopPropagation(),e.preventDefault(),u(e.dataTransfer)&&d(t,n)},"EVENT","DOM","GRID_ID")}(this);
!function(i){i.sPlusPlus;var t=i.ZSClass,s=i.ZSConstants.I18N;function e(i,t,s,e,l,o){this.rID=i,this.sheetID=t,this.version=s,this.files=e,this.options=l,this.callback=o,this.init()}e.prototype={init:function(){this.allowedFilType=this.options.allowedFileTypes,this.maxSize=this.options.maxFileSize,this.alertMsg=this.options.alertMsg},validate:function(){for(var i,e,l=!0,o=0;e=this.files[o];o++){var a=e.name,r=e.size,n=a.lastIndexOf("."),h=a.substring(n+1).toLowerCase();if(-1==this.allowedFilType.indexOf(h)){i=s.Wecurrentlydonotsupportfiles,l=!1;break}if(this.maxSize<r){this.alertMsg&&(i=this.alertMsg),l=!1;break}if(h!==h){l=!1,i=s.selectValidFiles;break}l=!0}l?this.callback.onDrop(this.rID,this.sheetID,this.version,this.files):t.ZSAlert(i,{title:s["Alert.Title.UnsupportedFormat"]})}},t.DragAndDrop=e}(this);
!function(e){if(!e.isCanvasGrid){var t=e.sPlusPlus,i=e.ZSClass.UIPaneComponent.prototype;i.PlaceDragSelection=function(e,i,o,a,r){var s=t.data.getWorkBook(e,o).getSheetObj(i),l=s.Row.auxiliaryAxis.getPos(r.startRow),n=s.Column.auxiliaryAxis.getPos(r.startCol),g=s.Row.auxiliaryAxis.getPos(r.endRow+1),c=s.Column.auxiliaryAxis.getPos(r.endCol+1),u=t.view.getSheetState(this.gridID,i).getZoom();this.DragSelection&&this.DragSelection.place(a,l*u,n*u,(g-l)*u,(c-n)*u)},i.RemoveDragSelection=function(e,t,i,o){this.DragSelection&&this.DragSelection.hide(o)},i.PlaceHeaderDragSelection=function(e,i,o,a,r){var s=t.data.getWorkBook(e,o).getSheetObj(i),l=s.Row.auxiliaryAxis.getPos(r.startRow),n=s.Column.auxiliaryAxis.getPos(r.startCol),g=s.Row.auxiliaryAxis.getPos(r.endRow),c=s.Column.auxiliaryAxis.getPos(r.endCol),u=t.view.getSheetState(this.gridID,i).getZoom();this.HeaderDragSelection&&this.HeaderDragSelection.place(a,l*u,n*u,(g-l)*u,(c-n)*u)},i.RemoveHeaderDragSelection=function(e,t,i,o){this.HeaderDragSelection&&this.HeaderDragSelection.hide(o)}}}(this);
!function(e){e.sPlusPlus;var s=e.ZSClass.Selector,t=s.Design||(s.Design={}),l={class:"dragSelection",filler:!0,edges:{top:!0,bottom:!0,left:!0,right:!0}};t.Drag=l;l={class:"dragHeader",edges:{top:!0,left:!0}};t.HeaderDrag=l}(this);
!function(i){if(!i.isCanvasGrid){var e=i.sPlusPlus,t=i.ZSClass.UIPaneComponent.prototype;t.PlaceFillSelection=function(i,t,s,l,o){var a=e.data.getWorkBook(i,s).getSheetObj(t),r=a.Row.auxiliaryAxis.getPos(o.startRow),n=a.Column.auxiliaryAxis.getPos(o.startCol),u=a.Row.auxiliaryAxis.getPos(o.endRow+1),S=a.Column.auxiliaryAxis.getPos(o.endCol+1),h=e.view.getSheetState(this.gridID,t).getZoom();this.FillSeries&&this.FillSeries.place(l,r*h,n*h,(u-r)*h,(S-n)*h)},t.RemoveFillSelection=function(i,e,t,s){this.FillSeries&&this.FillSeries.hide(s)},t.RemoveFillSeriesCue=function(i,e,t,s){this.FillSeriesCue&&this.FillSeriesCue.hide(s)}}}(this);
!function(t){var e,a,o,i,r,n=t.sPlusPlus,l=t.ZSEvents,s=l.topic,S=l.Groups,R=l.Names,u=t.ZSClass;u.SelectorHelper.Constants.MULTI_DIRECTION,u.Selector.Assistor;function g(t,e){var i=180*Math.atan2(a-t,o-e)/Math.PI;return i=(360-Math.round(i))%360}function E(t,e,a,o,r,l,s){var S=n.data.getWorkBook(t,a).getSheetObj(e),R=S.Row.auxiliaryAxis.findAbs(r),g=S.Column.auxiliaryAxis.findAbs(o),E=S.Row.auxiliaryAxis.findAbs(s),A=S.Column.auxiliaryAxis.findAbs(l),D=S.Merge.isIntersecting(i);return R=function(t,e,a,o,i,r){if(n.data.getWorkBook(t,a).getSheetObj(e),i=Math.min(i,o.startRow),r&&i<o.startRow){var l=~~((o.startRow-i-1)/o.getRowSpan());i=o.startRow-(l+1)*o.getRowSpan(),i=Math.max(0,i),i=Math.min(i,n.data.Defaults.MAX_ROW)}return i}(t,e,a,i,R,D),g=function(t,e,a,o,i,r){if(n.data.getWorkBook(t,a).getSheetObj(e),i=Math.min(i,o.startCol),r&&i<o.startCol){var l=~~((o.startCol-i-1)/o.getColSpan());i=o.startCol-(l+1)*o.getColSpan(),i=Math.max(0,i),i=Math.min(i,n.data.Defaults.MAX_COL)}return i}(t,e,a,i,g,D),E=function(t,e,a,o,i,r){if(i=Math.min(Math.max(i,o.endRow),n.data.Defaults.MAX_ROW-1),r&&i>o.endRow){var l=~~((i-o.endRow-1)/o.getRowSpan());i=o.endRow+(l+1)*o.getRowSpan(),i=Math.max(0,i),i=Math.min(i,n.data.Defaults.MAX_ROW)}return i}(0,0,0,i,E,D),A=function(t,e,a,o,i,r){if(i=Math.min(Math.max(i,o.endCol),n.data.Defaults.MAX_COL-1),r&&i>o.endCol){var l=~~((i-o.endCol-1)/o.getColSpan());i=o.endCol+(l+1)*o.getColSpan(),i=Math.max(0,i),i=Math.min(i,n.data.Defaults.MAX_COL)}return i}(0,0,0,i,A,D),new u.Range(R,g,E,A)}function A(t,e,i,n,l){!function(t,e){var a=g(t,e);return a<r||180-r<a&&a<180+r||360-r<a}(n,l)?l=o:n=a;var s=Math.min(n,a),S=Math.max(n,a);return E(t,e,i,s,Math.min(l,o),S,Math.max(l,o))}var D=function(t,l,u,E,A,D,d,c,I){var h=n.view.getActiveGridID(),M=(n.data.getWorkBook(t,u).getSheetObj(l),n.view.getSheetState(h,l).getActiveRange());e=!!I;var O=M.clone();!function(t,e,l,s){var S=n.data.getWorkBook(t,l).getSheetObj(e),R=S.Column.auxiliaryAxis.getPos(s.startCol),u=S.Column.auxiliaryAxis.getPos(s.endCol+1),E=S.Row.auxiliaryAxis.getPos(s.startRow),A=S.Row.auxiliaryAxis.getPos(s.endRow+1);a=(R+u)/2,o=(E+A)/2,i=s.clone(),r=g(u,E)}(t,l,u,M),s.register(S.Selector.BoundUpdate.FillSeries,R.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:l,VERSION:u,RANGE:O,RANGEID:0,TYPE:c})},d=function(t,e,a,o,i,r,l){n.data.getWorkBook(t,a).getSheetObj(e);var u=n.view.getActiveGridID(),g=(n.data.getWorkBook(t,a).getSheetObj(e),n.view.getSheetState(u,e).getActiveRange(),A(t,e,a,i,r));s.publish(S.Selector.BoundUpdate.FillSeries,R.Selection.BOUND_UPDATE.MODIFY,{RID:t,SHEETID:e,VERSION:a,RANGEID:o,RANGE:g,TYPE:l})},c=function(a,o,i,r,l,u,g){n.data.getWorkBook(a,i).getSheetObj(o);var E=n.view.getActiveGridID(),D=(n.data.getWorkBook(a,i).getSheetObj(o),n.view.getSheetState(E,o).getActiveRange()),d=A(a,o,i,l,u);t.UserAction.CalcFillDetails(a,[o],i,d,D,e),s.publish(S.Selector.BoundUpdate.FillSeries,R.Selection.BOUND_UPDATE.REMOVE,{RID:a,SHEETID:o,VERSION:i,RANGEID:r})};s.register(S.Gesture.Selector.FillSeries,R.GESTURE.ACTION.START,D,"RID","SHEETID","VERSION","RANGEID","x","y","point","TYPE","ISCTRLPRESSED"),s.register(S.Gesture.Selector.FillSeries,R.GESTURE.ACTION.MOVE,d,"RID","SHEETID","VERSION","RANGEID","x","y","TYPE"),s.register(S.Gesture.Selector.FillSeries,R.GESTURE.ACTION.END,c,"RID","SHEETID","VERSION","RANGEID","x","y","TYPE")}(this);
!function(e){var t=e.sPlusPlus,i=(e.ZSClass,e.ZSEvents),D=i.topic,E=i.Groups,S=i.Names;var l=function(e,i,l,r,o,I){r=function(e,i,D,E){return t.data.getWorkBook(e,D).getSheetObj(i).Merge.extendRange(E),E}(e,i,l,r);var n=t.view.getActiveGridID();t.view.getSheetState(n,i).addFill(r,0,I),D.publish(E.Selector.DomUpdate.FillSeries,S.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:i,VERSION:l,ActiveRange:r,RANGEID:0,TYPE:I})},r=function(e,t,i,l,r,o){D.publish(E.Selector.DomUpdate.FillSeries,S.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,ActiveRange:r,RANGEID:l,TYPE:o})},o=function(e,i,l,r){var o=t.view.getActiveGridID();t.view.getSheetState(o,i).removeFill(),D.publish(E.Selector.DomUpdate.FillSeries,S.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:i,VERSION:l,RANGEID:r})};D.register(E.Selector.BoundUpdate.FillSeries,S.Selection.BOUND_UPDATE.ADD,l,"RID","SHEETID","VERSION","RANGE","RANGEID","TYPE"),D.register(E.Selector.BoundUpdate.FillSeries,S.Selection.BOUND_UPDATE.MODIFY,r,"RID","SHEETID","VERSION","RANGEID","RANGE","TYPE"),D.register(E.Selector.BoundUpdate.FillSeries,S.Selection.BOUND_UPDATE.REMOVE,o,"RID","SHEETID","VERSION","RANGEID")}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSClass,s=e.ZSEvents,o=s.topic,r=s.Groups,l=s.Names,n=i.Selector,a=e.UserAction,S=n.Design||(n.Design={}),g=e.ZSConstants.I18N,v={class:"fillSeriesCue",corners:{br:{mousedown:function(i){i.stopPropagation(),i.returnValue=!1;var s=t.view.getActiveGridID(),n=t.view.getGridComponent(s).getRelativeCoordinates(i),a=e.JSUtil.Key.getKeyCombination(i)===e.ZSConstants.JSKeyCode.SUPER+"+"+i.which;o.publish(r.Listener,l.Mouse.FillStart,{GRIDID:s,COORDINATES:n,ISCTRLPRESSED:a})},dblclick:function(e){e.stopPropagation(),e.preventDefault();var s=t.view.getActiveGridID(),o=t.view.getResourceID(s),r=t.view.getSheetID(s),l=t.view.getVersionID(s),n=t.view.getSheetState(s,r),S=t.view.getSelectedSheets(s),v=n.getActiveRange(),c=t.data.getWorkBook(o,l).getSheetObj(r).Pivot;if(c&&c.isXists(v.startRow,v.startCol))return void i.ZSAlert(g["Error.Pivot.Table.Part.Change"]);a.FillSeriesAuto(o,S,l,v)}}}};S.FillSeries={class:"fillSeriesSelection",edges:{top:!0,bottom:!0,left:!0,right:!0}},S.FillSeriesCue=v}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSEvents,o=i.topic,n=i.Groups,l=i.Names,a=t.data.Defaults,r=e.UserAction,s=e.ZSClass.Range,R=r.CellNavigation||(r.CellNavigation={});function d(e,t,i,a){"checkbox"!=a&&o.publish(n.Listener,l.ERROR.SHOW,{ERRORMSG:a}),o.publish(n.Selector.BoundUpdate.CellEdit,l.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:t,VERSION:i}),o.publish(n.UserAction,l.KeyBoard.ForceQuit,{RID:e,SHEETID:t,VERSION:i})}function S(i,a,R,S,E){for(var c=new s(S,E,S,E),D=t.view.getActiveGridID(),g=t.view.getActiveState(D).getFormulaRanges(a),v=(t.view.getSheetState(D,a),t.view.CellEditor&&t.view.CellEditor.getEditStatus()),A=t.data.getWorkBook(i,R).getSheetObj(a),I=0;g&&I<g.length;I++)o.publish(n.Selector.BoundUpdate.Formula,l.Selection.BOUND_UPDATE.REMOVE,{RID:i,SHEETID:a,VERSION:R,RANGEID:g[I].id});r.ScrollCellIntoView(i,a,R,S,E);var u=t.view.getGridComponent(D),C=u.isInViewPort(c);if(e.isCanvasGrid||C){o.publish(n.Selector.BoundUpdate.Range,l.Selection.BOUND_UPDATE.ADD,{RID:i,SHEETID:a,VERSION:R,RANGE:c}),o.publish(n.Selector.BoundUpdate.Cell,l.Selection.BOUND_UPDATE.ADD,{RID:i,SHEETID:a,VERSION:R,ActiveCellRange:c,ROW:S,COL:E}),o.publish(n.Listener,l.Selection.BOUND_UPDATE.UPDATE_ASSISTOR,{RID:i,SHEETID:a,VERSION:R,ActiveCellRange:c});var O=A.ProtectedRanges.isXists(c.startRow,c.startCol),N=A.Pivot.isXists(c.startRow,c.startCol),h=u.getCellRef(i,a,R,S,E),U=!(!h||!h.data)&&h.data.isCheckbox;if(v&&(O||N||U))d(i,a,R,O?"ProtectedRange.alert.ProtectRangeMessage":N?"Error.Pivot.Table.Part.Change":"checkbox"),v=!1;v&&o.publish(n.Selector.BoundUpdate.CellEdit,l.Selection.BOUND_UPDATE.ADD,{RID:i,SHEETID:a,VERSION:R,RANGE:c})}else setTimeout(function(){o.publish(n.Selector.BoundUpdate.Range,l.Selection.BOUND_UPDATE.ADD,{RID:i,SHEETID:a,VERSION:R,RANGE:c}),o.publish(n.Selector.BoundUpdate.Cell,l.Selection.BOUND_UPDATE.ADD,{RID:i,SHEETID:a,VERSION:R,ActiveCellRange:c,ROW:S,COL:E}),o.publish(n.Listener,l.Selection.BOUND_UPDATE.UPDATE_ASSISTOR,{RID:i,SHEETID:a,VERSION:R,ActiveCellRange:c});var e=A.ProtectedRanges.isXists(c.startRow,c.startCol),t=A.Pivot.isXists(c.startRow,c.startCol),r=u.getCellRef(i,a,R,S,E),s=!(!r||!r.data)&&r.data.isCheckbox;v&&(e||t||s)&&(d(i,a,R,e?"ProtectedRange.alert.ProtectRangeMessage":t?"Error.Pivot.Table.Part.Change":"checkbox"),v=!1);v&&o.publish(n.Selector.BoundUpdate.CellEdit,l.Selection.BOUND_UPDATE.ADD,{RID:i,SHEETID:a,VERSION:R,RANGE:c})},50)}R.Left=function(e,i,o){var n=t.data.getWorkBook(e,o).getSheetObj(i),l=t.view.getActiveGridID(),r=t.view.getSheetState(l,i),s=r.getActiveRow(),R=r.getActiveCol(),d=n.Merge.isXists(s,R);R=d?d.root.startCol:R,S(e,i,o,s,R=n.Column.hidden.prevNonHidden(R)<a.MIN_COL?R:n.Column.hidden.prevNonHidden(R))},R.Up=function(e,i,o){var n=t.data.getWorkBook(e,o).getSheetObj(i),l=t.view.getActiveGridID(),r=t.view.getSheetState(l,i),s=r.getActiveRow(),R=r.getActiveCol(),d=n.Merge.isXists(s,R);s=d?d.root.startRow:s,S(e,i,o,s=n.Row.Visibility.prevNonHidden(s)<a.MIN_ROW?s:n.Row.Visibility.prevNonHidden(s),R)},R.Right=function(e,i,o){var n=t.data.getWorkBook(e,o).getSheetObj(i),l=t.view.getActiveGridID(),r=t.view.getSheetState(l,i),s=r.getActiveRow(),R=r.getActiveCol(),d=n.Merge.isXists(s,R);R=d?d.root.endCol:R,S(e,i,o,s,R=n.Column.hidden.nextNonHidden(R)>=a.MAX_COL?R:n.Column.hidden.nextNonHidden(R))},R.Down=function(e,i,o){var n=t.data.getWorkBook(e,o).getSheetObj(i),l=t.view.getActiveGridID(),r=t.view.getSheetState(l,i),s=r.getActiveRow(),R=r.getActiveCol(),d=n.Merge.isXists(s,R);s=d?d.root.endRow:s,S(e,i,o,s=n.Row.Visibility.nextNonHidden(s)>=a.MAX_ROW?s:n.Row.Visibility.nextNonHidden(s),R)},R.Move=S}(this);
!function(e){e.sPlusPlus;var n=e.UserAction,l=n.CellNavigation||(n.CellNavigation={}),t=e.ZSEvents,o=t.topic,s=t.Groups,a=t.Names,i={},r={};i.setCellInfo=function(e,n,l,t){i.hasValues()||(r={Cell:e,Row:n,Col:l,SheetID:t})},i.getCellInfo=function(){return r},i.hasValues=function(){return!!Object.keys(r).length},i.clearCellInfo=function(){r={}},l.TabInfo=i,o.register(s.Gesture.Selector.Range,a.GESTURE.ACTION.DOWN,l.TabInfo.clearCellInfo)}(this);
!function(e){var t=e.sPlusPlus,o=e.ZSEvents,i=o.topic,n=o.Groups,a=o.Names,r=e.UserAction,R=t.data.Defaults,s=e.ZSClass.Range,l=r.CellNavigation||(r.CellNavigation={}),g=l.Left,d=l.Right,v=l.Up,w=l.Down,C=l.Move;function c(e,o,R,l,g,d,v){var w=new s(l,g,l,g),C=t.data.getWorkBook(e,R).getSheetObj(o),c=t.view.getActiveGridID(),S=(o=t.view.getSheetID(c),t.view.getSheetState(c,o),t.view.CellEditor.getEditStatus()),A=C.ProtectedRanges.isXists(d.startRow,d.startCol),D=C.Pivot.isXists(d.startRow,d.startCol),I=t.view.getGridComponent(c).getCellRef(e,o,R,l,g),E=!(!I||!I.data)&&I.data.isCheckbox;S&&(A||D||E)&&(msg=A?"ProtectedRange.alert.ProtectRangeMessage":"Error.Pivot.Table.Part.Change",function(e,t,o,r){"checkbox"!=r&&i.publish(n.Listener,a.ERROR.SHOW,{ERRORMSG:r}),i.publish(n.Selector.BoundUpdate.CellEdit,a.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:t,VERSION:o}),i.publish(n.UserAction,a.KeyBoard.ForceQuit,{RID:e,SHEETID:t,VERSION:o})}(e,o,R,msg),S=!1),i.publish(n.Listener,a.SheetAction.ADD_TILES.EXCEED_BOUNDARY,{RID:e,SHEET_ID:o,VERSION:R,ROW:l,COL:g,MODE:v}),r.ScrollCellIntoView(e,o,R,l,g),setTimeout(function(){i.publish(n.Selector.BoundUpdate.Range,a.Selection.BOUND_UPDATE.MODIFY,{RID:e,SHEETID:o,VERSION:R,RANGE:d,RANGEID:d.id,MODE:!0}),i.publish(n.Selector.BoundUpdate.Cell,a.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:o,VERSION:R,ActiveCellRange:w,ROW:l,COL:g}),i.publish(n.Listener,a.Selection.BOUND_UPDATE.UPDATE_ASSISTOR,{RID:e,SHEETID:o,VERSION:R,ActiveCellRange:w}),S&&i.publish(n.Selector.BoundUpdate.CellEdit,a.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:o,VERSION:R,RANGE:w})},50)}l.LeftWithinRange=function(e,o,i){var n=t.data.getWorkBook(e,i).getSheetObj(o),a=t.view.getActiveGridID(),r=t.view.getSheetState(a,o),R=r.getActiveRange(),l=r.getActiveRangeCount(),d=n.Merge.getInfo(R.startRow,R.startCol),v=d&&d.equals(R);if(1===l&&(v||R.startRow===R.endRow&&R.startCol===R.endCol))g(e,o,i);else{var w=function(e){var o=t.view.getActiveGridID(),i=t.view.getSheetID(o),n=t.view.getSheetState(o,i),a=n.getActiveRow(),r=n.getActiveCol(),R=e.Merge.isXists(a,r);R&&(r=R.root.startCol),r=e.Column.hidden.prevNonHidden(r);var l=n.getRanges(),g=n.getActiveRange(),d=g.id,v=0;for(var w in l){var C=l[w];g.intersects(C)&&(v=parseInt(w))}return r<g.startCol&&(a=e.Row.Visibility.prevNonHidden(a),r=l[v].endCol,a<g.startRow&&(l.length>1&&(v=v-1<0?l.length-1:v-1),a=l[v].endRow,r=l[v].endCol,g=new s(l[v].startRow,l[v].startCol,a,r),d=l[v].id)),(C=new s(g.startRow,g.startCol,g.endRow,g.endCol)).id=d,{ROW:a,COL:r,RANGE:C}}(n);c(e,o,i,w.ROW,w.COL,w.RANGE,"COL")}},l.UpWithinRange=function(e,o,i){var n=t.data.getWorkBook(e,i).getSheetObj(o),a=t.view.getActiveGridID(),r=t.view.getSheetState(a,o),R=r.getActiveRange(),l=r.getActiveRangeCount(),g=n.Merge.getInfo(R.startRow,R.startCol),d=g&&g.equals(R);if(1===l&&(d||R.startRow===R.endRow&&R.startCol===R.endCol))v(e,o,i);else{var w=function(e){var o=t.view.getActiveGridID(),i=t.view.getSheetID(o),n=t.view.getSheetState(o,i),a=n.getActiveRow(),r=n.getActiveCol(),R=e.Merge.isXists(a,r);R&&(a=R.root.startRow),a=e.Row.Visibility.prevNonHidden(a);var l=n.getRanges(),g=n.getActiveRange(),d=g.id,v=0;for(var w in l){var C=l[w];g.intersects(C)&&(v=parseInt(w))}return a<g.startRow&&(r=e.Column.hidden.prevNonHidden(r),a=l[v].endRow,r<g.startCol&&(l.length>1&&(v=v-1<0?l.length-1:v-1),a=l[v].endRow,r=l[v].endCol,g=new s(l[v].startRow,l[v].startCol,a,r),d=l[v].id)),(C=new s(g.startRow,g.startCol,g.endRow,g.endCol)).id=d,{ROW:a,COL:r,RANGE:C}}(n);c(e,o,i,w.ROW,w.COL,w.RANGE,"ROW")}},l.RightWithinRange=function(e,o,i){var n=t.data.getWorkBook(e,i).getSheetObj(o),a=t.view.getActiveGridID(),r=t.view.getSheetState(a,o),R=r.getActiveRange(),g=r.getActiveRangeCount(),v=r.getActiveCellRange(),w=r.getActiveRow(),C=r.getActiveCol();l.TabInfo.setCellInfo(v,w,C,o);var S=n.Merge.getInfo(R.startRow,R.startCol),A=S&&S.equals(R);if(1===g&&(A||R.startRow===R.endRow&&R.startCol===R.endCol))d(e,o,i);else{var D=function(e){var o=t.view.getActiveGridID(),i=t.view.getSheetID(o),n=t.view.getSheetState(o,i),a=n.getActiveRow(),r=n.getActiveCol(),R=e.Merge.isXists(a,r);R&&(r=R.root.endCol),r=e.Column.hidden.nextNonHidden(r);var l=n.getRanges(),g=n.getActiveRange(),d=g.id,v=0;for(var w in l){var C=l[w];g.intersects(C)&&(v=parseInt(w))}return r>g.endCol&&(a=e.Row.Visibility.nextNonHidden(a),r=l[v].startCol,a>g.endRow&&(l.length>1&&(v=v+1>=l.length?0:v+1),a=l[v].startRow,r=l[v].startCol,g=new s(a,r,l[v].endRow,l[v].endCol),d=l[v].id)),(C=new s(g.startRow,g.startCol,g.endRow,g.endCol)).id=d,{ROW:a,COL:r,RANGE:C}}(n);c(e,o,i,D.ROW,D.COL,D.RANGE,"COL")}},l.DownWithinRange=function(e,o,i){var n=t.data.getWorkBook(e,i).getSheetObj(o),a=t.view.getActiveGridID(),r=t.view.getSheetState(a,o),g=r.getActiveRange(),d=r.getActiveRangeCount(),v=l.TabInfo.getCellInfo(),S=v.Cell,A=v.Row,D=v.Col,I=v.SheetID,E=(O=n.Merge.getInfo(g.startRow,g.startCol))&&O.equals(g);if(1===d&&(E||g.startRow===g.endRow&&g.startCol===g.endCol))if(void 0!=S&&void 0!=A&&void 0!=D&&I==o){var O;if(A=(O=n.Merge.isXists(A,D))?O.root.endRow:A,(A=n.Row.Visibility.nextNonHidden(A))>=R.MAX_ROW)return void(A=R.MAX_ROW-1);C(e,o,i,A,D,"ROW")}else w(e,o,i);else{var h=function(e){var o=t.view.getActiveGridID(),i=t.view.getSheetID(o),n=t.view.getSheetState(o,i),a=n.getActiveRow(),r=n.getActiveCol(),R=e.Merge.isXists(a,r);R&&(a=R.root.endRow),a=e.Row.Visibility.nextNonHidden(a);var l=n.getRanges(),g=n.getActiveRange(),d=g.id,v=0;for(var w in l){var C=l[w];g.intersects(C)&&(v=parseInt(w))}return a>g.endRow&&(r=e.Column.hidden.nextNonHidden(r),a=l[v].startRow,r>g.endCol&&(l.length>1&&(v=v+1>=l.length?0:v+1),a=l[v].startRow,r=l[v].startCol,g=new s(a,r,l[v].endRow,l[v].endCol),d=l[v].id)),(C=new s(g.startRow,g.startCol,g.endRow,g.endCol)).id=d,{ROW:a,COL:r,RANGE:C}}(n);c(e,o,i,h.ROW,h.COL,h.RANGE,"ROW")}l.TabInfo.clearCellInfo()},l.MoveRangeTo=c}(this);
!function(t){var e=t.sPlusPlus,o=t.ZSEvents,n=o.topic,r=o.Groups,i=o.Names,a=t.UserAction,s=t.ZSClass.Range,d=e.data.Defaults,l=a.CellNavigation||(a.CellNavigation={});function w(t,e){e.startCol=t.Column.hidden.prevNonHidden(e.startCol),-1===e.startCol&&(e.startCol=0)}function R(t,e){e.startRow=t.Row.Visibility.prevNonHidden(e.startRow),-1===e.startRow&&(e.startRow=0)}function C(t,e){e.endCol=t.Column.hidden.nextNonHidden(e.endCol),e.endCol===d.MAX_COL&&(e.endCol=d.MAX_COL-1)}function v(t,e){e.endRow=t.Row.Visibility.nextNonHidden(e.endRow),e.endRow===d.MAX_ROW&&(e.endRow=d.MAX_ROW-1)}function g(t,e,o,a,s,d,l){n.publish(r.Selector.BoundUpdate.Range,i.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:e,VERSION:o,RANGE:s})}l.SelectionLeft=function(t,o,n){var r=e.data.getWorkBook(t,n).getSheetObj(o),i=e.view.getActiveGridID(),d=e.view.getSheetState(i,o),l=d.getActiveRange(),R=d.getActiveRow(),C=d.getActiveCol(),v=new s(l.startRow,l.startCol,l.endRow,l.endCol),c=r.Merge.isXists(R,C);c&&(C=c.root.startCol);var u=l.startCol<C||l.endCol===C;u?w(r,v):function(t,e){e.endCol=t.Column.hidden.prevNonHidden(e.endCol);var o=t.Merge.getIntersectedRangesNotSubset(e);o.length&&(e.endCol=t.Column.hidden.prevNonHidden(function(t){var e;for(var o in t){var n=t[o];e=e<n.startCol?e:n.startCol}return e}(o)))}(r,v),(C<v.startCol||C>v.endCol)&&w(r,v=new s(l.startRow,l.startCol,l.endRow,l.endCol)),g(t,o,n,0,v),a.ScrollColIntoView(t,o,n,u?v.startCol:v.endCol)},l.SelectionUp=function(t,o,n){var r=e.data.getWorkBook(t,n).getSheetObj(o),i=e.view.getActiveGridID(),d=e.view.getSheetState(i,o),l=d.getActiveRange(),w=d.getActiveRow(),C=d.getActiveCol(),v=new s(l.startRow,l.startCol,l.endRow,l.endCol),c=r.Merge.isXists(w,C);c&&(w=c.root.startRow);var u=l.startRow<w||l.endRow===w;u?R(r,v):function(t,e){e.endRow=t.Row.Visibility.prevNonHidden(e.endRow);var o=t.Merge.getIntersectedRangesNotSubset(e);o.length&&(e.endRow=t.Row.Visibility.prevNonHidden(function(t){var e;for(var o in t){var n=t[o];e=e>n.startRow?e:n.startRow}return e}(o)))}(r,v),(w<v.startRow||w>v.endRow)&&R(r,v=new s(l.startRow,l.startCol,l.endRow,l.endCol)),g(t,o,n,0,v),a.ScrollRowIntoView(t,o,n,u?v.startRow:v.endRow)},l.SelectionRight=function(t,o,n){var r=e.data.getWorkBook(t,n).getSheetObj(o),i=e.view.getActiveGridID(),d=e.view.getSheetState(i,o),l=d.getActiveRange(),w=d.getActiveRow(),R=d.getActiveCol(),v=new s(l.startRow,l.startCol,l.endRow,l.endCol),c=r.Merge.isXists(w,R);c&&(R=c.root.startCol);var u=l.startCol<R||l.startCol!==R;u?function(t,e){e.startCol=t.Column.hidden.nextNonHidden(e.startCol);var o=t.Merge.getIntersectedRangesNotSubset(e);o.length&&(e.startCol=t.Column.hidden.nextNonHidden(function(t){var e;for(var o in t){var n=t[o];e=e>n.endCol?e:n.endCol}return e}(o)))}(r,v):C(r,v),(R<v.startCol||R>v.endCol)&&C(r,v=new s(l.startRow,l.startCol,l.endRow,l.endCol)),g(t,o,n,0,v),a.ScrollColIntoView(t,o,n,u?v.startCol:v.endCol)},l.SelectionDown=function(t,o,n){var r=e.data.getWorkBook(t,n).getSheetObj(o),i=e.view.getActiveGridID(),d=e.view.getSheetState(i,o),l=d.getActiveRange(),w=d.getActiveRow(),R=d.getActiveCol(),C=new s(l.startRow,l.startCol,l.endRow,l.endCol),c=r.Merge.isXists(w,R);c&&(w=c.root.startRow);var u=l.startRow<w||l.startRow!==w;u?function(t,e){e.startRow=t.Row.Visibility.nextNonHidden(e.startRow);var o=t.Merge.getIntersectedRangesNotSubset(e);o.length&&(e.startRow=t.Row.Visibility.nextNonHidden(function(t){var e;for(var o in t){var n=t[o];e=e<n.endRow?e:n.endRow}return e}(o)))}(r,C):v(r,C),(w<C.startRow||w>C.endRow)&&v(r,C=new s(l.startRow,l.startCol,l.endRow,l.endCol)),g(t,o,n,0,C),a.ScrollRowIntoView(t,o,n,u?C.startRow:C.endRow)}}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSEvents,o=i.topic,s=i.Groups,a=i.Names,l=e.UserAction,n=e.ZSClass.Range,r=l.CellNavigation||(l.CellNavigation={});function g(e,t,i,o,s){var a=e.Row.axis.findAbs(t),l=e.Column.axis.findAbs(i),r=e.Row.axis.findAbs(t+o),g=e.Column.axis.findAbs(t+s);return new n(a,l,r,g)}function S(e,t,i,l){o.publish(s.Selector.BoundUpdate.Range,a.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,RANGE:l,TYPE:0}),o.publish(s.Selector.BoundUpdate.Cell,a.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,ActiveCellRange:l,ROW:l.startRow,COL:l.startCol,TYPE:0}),o.publish(s.Listener,a.Selection.BOUND_UPDATE.UPDATE_ASSISTOR,{RID:e,SHEETID:t,VERSION:i,ActiveCellRange:l})}r.pageNavigateSelectionDown=function(e,i,o){var s=t.data.getWorkBook(e,o).getSheetObj(i),a=t.view.getActiveGridID(),r=t.view.getSheetState(a,i),c=r.getScrollTops()[0],R=r.getActiveCellRange(),w=s.Row.auxiliaryAxis.getPos(R.startRow)-c;l.ScrollPage(e,i,o,!1);var v=t.view.getSheetState(a,i),A=v.getScrollTops()[0]+w,d=s.Row.axis.findAbs(A),D=R.startCol,u=new n(d,D,d,D),E=g(s,v.getScrollTops()[0],v.getScrollLefts()[0],r.getScreenHeights()[0],r.getScreenWidths()[0]+r.getScreenWidths()[1]);E.intersects(u)||(u.endRow=u.startRow=E.startRow+1),S(e,i,o,u)},r.pageNavigateSelectionUp=function(e,i,o){var s=t.data.getWorkBook(e,o).getSheetObj(i),a=t.view.getActiveGridID(),r=t.view.getSheetState(a,i),c=r.getScrollTops()[0],R=r.getActiveCellRange(),w=c-s.Row.auxiliaryAxis.getPos(R.startRow);l.ScrollPage(e,i,o,!0);var v=t.view.getSheetState(a,i),A=v.getScrollTops()[0]-w,d=s.Row.axis.findAbs(A),D=R.startCol,u=new n(d,D,d,D),E=g(s,v.getScrollTops()[0],v.getScrollLefts()[0],r.getScreenHeights()[0],r.getScreenWidths()[0]+r.getScreenWidths()[1]);E.intersects(u)||(u.endRow=u.startRow=E.startRow),S(e,i,o,u)}}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSEvents,n=i.topic,o=i.Groups,v=i.Names,l=e.UserAction,c=e.ZSClass.Range,g=l.CellNavigation||(l.CellNavigation={});function a(e,t,i,l){n.publish(o.Selector.BoundUpdate.Range,v.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,RANGE:l})}function w(e,i,g,w){var r=t.view.getActiveGridID(),S=t.view.getSheetState(r,i),R=S.getActiveRow(),C=S.getActiveCol(),A=t.view.getSelectedSheets(r);l.CtrlNavigate(e,A,g,R,C,w,function(e,t,i,g,w){!function(e,t,i,g,w){var r=new c(g,w,g,w);l.ScrollCellIntoView(e,t,i,g,w),n.publish(o.Selector.BoundUpdate.Cell,v.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,ActiveCellRange:r,ROW:g,COL:w}),a(e,t,i,r),n.publish(o.Listener,v.Selection.BOUND_UPDATE.UPDATE_ASSISTOR,{RID:e,SHEETID:t,VERSION:i,ActiveCellRange:r})}(e,t,i,g,w)})}g.CtrlLeft=function(e,t,i){w(e,t,i,4)},g.CtrlRight=function(e,t,i){w(e,t,i,3)},g.CtrlDown=function(e,t,i){w(e,t,i,1)},g.CtrlUp=function(e,t,i){w(e,t,i,2)},g.CtrlShiftLeft=function(e,i,n){var o=t.view.getActiveGridID(),v=t.view.getSheetState(o,i),g=v.getActiveRange(),w=v.getActiveCellRange();g.endCol===w.endCol?function(e,i,n){var o=t.view.getActiveGridID(),v=t.view.getSheetState(o,i),g=v.getActiveRange(),w=v.getActiveRow(),r=t.view.getSelectedSheets(o);l.CtrlNavigate(e,r,n,w,g.startCol,4,function(e,t,i,n,o){a(e,t,i,g=new c(g.startRow,o,g.endRow,g.endCol)),l.ScrollColIntoView(e,t,i,o)})}(e,i,n):function(e,i,n){var o=t.view.getActiveGridID(),v=t.view.getSheetState(o,i),g=v.getActiveRange(),w=v.getActiveRow(),r=v.getActiveCol(),S=t.view.getSelectedSheets(o);l.CtrlNavigate(e,S,n,w,g.endCol,4,function(e,t,i,n,o){o=o<r?r:o,a(e,t,i,g=new c(g.startRow,g.startCol,g.endRow,o)),l.ScrollColIntoView(e,t,i,o)})}(e,i,n)},g.CtrlShiftRight=function(e,i,n){var o=t.view.getActiveGridID(),v=t.view.getSheetState(o,i),g=v.getActiveRange(),w=v.getActiveCellRange();g.startCol===w.startCol?function(e,i,n){var o=t.view.getActiveGridID(),v=t.view.getSheetState(o,i),g=v.getActiveRange(),w=v.getActiveRow(),r=t.view.getSelectedSheets(o);l.CtrlNavigate(e,r,n,w,g.endCol,3,function(e,t,i,n,o){a(e,t,i,g=new c(g.startRow,g.startCol,g.endRow,o)),l.ScrollColIntoView(e,t,i,o)})}(e,i,n):function(e,i,n){var o=t.view.getActiveGridID(),v=t.view.getSheetState(o,i),g=v.getActiveRange(),w=v.getActiveRow(),r=v.getActiveCol(),S=t.view.getSelectedSheets(o);l.CtrlNavigate(e,S,n,w,g.startCol,3,function(e,t,i,n,o){o=o>r?r:o,a(e,t,i,g=new c(g.startRow,o,g.endRow,g.endCol)),l.ScrollColIntoView(e,t,i,o)})}(e,i,n)},g.CtrlShiftUp=function(e,i,n){var o=t.view.getActiveGridID(),v=t.view.getSheetState(o,i),g=v.getActiveRange(),w=v.getActiveCellRange();g.endRow===w.endRow?function(e,i,n){var o=t.view.getActiveGridID(),v=t.view.getSheetState(o,i),g=v.getActiveRange(),w=v.getActiveCol(),r=t.view.getSelectedSheets(o);l.CtrlNavigate(e,r,n,g.startRow,w,2,function(e,t,i,n,o){a(e,t,i,g=new c(n,g.startCol,g.endRow,g.endCol)),l.ScrollRowIntoView(e,t,i,n)})}(e,i,n):function(e,i,n){var o=t.view.getActiveGridID(),v=t.view.getSheetState(o,i),g=v.getActiveRange(),w=v.getActiveRow(),r=v.getActiveCol(),S=t.view.getSelectedSheets(o);l.CtrlNavigate(e,S,n,g.endRow,r,2,function(e,t,i,n,o){n=n<w?w:n,a(e,t,i,g=new c(g.startRow,g.startCol,n,g.endCol)),l.ScrollRowIntoView(e,t,i,n)})}(e,i,n)},g.CtrlShiftDown=function(e,i,n){var o=t.view.getActiveGridID(),v=t.view.getSheetState(o,i),g=v.getActiveRange(),w=v.getActiveCellRange();g.startRow===w.startRow?function(e,i,n){var o=t.view.getActiveGridID(),v=t.view.getSheetState(o,i),g=v.getActiveRange(),w=v.getActiveCol(),r=t.view.getSelectedSheets(o);l.CtrlNavigate(e,r,n,g.endRow,w,1,function(e,t,i,n,o){a(e,t,i,g=new c(g.startRow,g.startCol,n,g.endCol)),l.ScrollRowIntoView(e,t,i,n)})}(e,i,n):function(e,i,n){var o=t.view.getActiveGridID(),v=t.view.getSheetState(o,i),g=v.getActiveRange(),w=v.getActiveRow(),r=v.getActiveCol(),S=t.view.getSelectedSheets(o);l.CtrlNavigate(e,S,n,g.startRow,r,1,function(e,t,i,n,o){a(e,t,i,g=new c(n=n>w?w:n,g.startCol,g.endRow,g.endCol)),l.ScrollRowIntoView(e,t,i,n)})}(e,i,n)}}(this);
!function(e){var t=e.UserAction.CellNavigation,o=e.sPlusPlus,n=o.data.Defaults,i=e.ZSClass,l=e.ZSEvents,a=l.topic,r=l.Groups,R=l.Names,S=e.sPlusPlus.view.Events.Key.Entry.RangeSelection.Context.keyDown,D=e.ZSConstants.JSKeyCode,E=e.isCanvasGrid;var c=n.MAX_ROW-1,g=n.MAX_COL-1,d=new i.Range(0,0,c,g);function I(e,t,o,n){a.publish(r.Selector.BoundUpdate.Range,R.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:o,VERSION:n,RANGE:e})}S[D.LEFT]=function(e,n,i,l){t.TabInfo.clearCellInfo();var a=o.data.getWorkBook(n,l).getSheetObj(i).gridDirection;E&&"rl-tb"===a?t.Right(n,i,l):t.Left(n,i,l)},S[D.RIGHT]=function(e,n,i,l){t.TabInfo.clearCellInfo();var a=o.data.getWorkBook(n,l).getSheetObj(i).gridDirection;E&&"rl-tb"===a?t.Left(n,i,l):t.Right(n,i,l)},S[D.UP]=function(e,o,n,i){t.TabInfo.clearCellInfo(),t.Up(o,n,i)},S[D.DOWN]=function(e,o,n,i){t.TabInfo.clearCellInfo(),t.Down(o,n,i)},S[D.TAB]=function(e,o,n,i){e.preventDefault(),t.RightWithinRange(o,n,i)},S[D.ENTER]=function(e,o,n,i){t.DownWithinRange(o,n,i)},S[D.SHIFT+"+"+D.LEFT]=function(e,n,i,l){t.TabInfo.clearCellInfo();var a=o.data.getWorkBook(n,l).getSheetObj(i).gridDirection;E&&"rl-tb"===a?t.SelectionRight(n,i,l):t.SelectionLeft(n,i,l)},S[D.SHIFT+"+"+D.RIGHT]=function(e,n,i,l){t.TabInfo.clearCellInfo();var a=o.data.getWorkBook(n,l).getSheetObj(i).gridDirection;E&&"rl-tb"===a?t.SelectionLeft(n,i,l):t.SelectionRight(n,i,l)},S[D.SHIFT+"+"+D.UP]=function(e,o,n,i){t.TabInfo.clearCellInfo(),t.SelectionUp(o,n,i)},S[D.SHIFT+"+"+D.DOWN]=function(e,o,n,i){t.TabInfo.clearCellInfo(),t.SelectionDown(o,n,i)},S[D.SHIFT+"+"+D.TAB]=function(e,o,n,i){e.preventDefault(),t.LeftWithinRange(o,n,i)},S[D.SHIFT+"+"+D.ENTER]=function(e,o,n,i){t.UpWithinRange(o,n,i)},S[D.SUPER+"+"+D.A]=function(e,t,n,i){e.preventDefault();var l=o.view.getActiveGridID();o.view.getSheetState(l,n).getActiveRange(),I(d,t,n,i)},S[D.CTRL+"+"+D.SPACE]=function(e,t,n,l){e.preventDefault(),o.data.getWorkBook(t,l).getSheetObj(n);var a=o.view.getActiveGridID(),r=o.view.getSheetState(a,n).getActiveRange();I(new i.Range(0,r.startCol,c,r.endCol),t,n,l)},S[D.SHIFT+"+"+D.SPACE]=function(e,t,n,l){e.preventDefault(),o.data.getWorkBook(t,l).getSheetObj(n);var a=o.view.getActiveGridID(),r=o.view.getSheetState(a,n).getActiveRange();I(new i.Range(r.startRow,0,r.endRow,g),t,n,l)},S[D.SHIFT+"+"+D.HOME]=function(e,t,n,l){o.data.getWorkBook(t,l).getSheetObj(n);var S=o.view.getActiveGridID(),D=o.view.getSheetState(S,n).getActiveRange(),E=new i.Range(D.startRow,0,D.endRow,D.endCol);a.publish(r.Selector.BoundUpdate.Range,R.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:n,VERSION:l,RANGE:E,TYPE:0}),a.publish(r.Selector.BoundUpdate.Cell,R.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:n,VERSION:l,ActiveCellRange:E,ROW:E.startRow,COL:E.startCol,TYPE:0})},S[D.SHIFT+"+"+D.END]=function(e,t,n,l){o.data.getWorkBook(t,l).getSheetObj(n);var S=o.view.getActiveGridID(),D=o.view.getSheetState(S,n).getActiveRange(),E=new i.Range(D.startRow,D.startCol,D.endRow,g);a.publish(r.Selector.BoundUpdate.Range,R.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:n,VERSION:l,RANGE:E,TYPE:0}),a.publish(r.Selector.BoundUpdate.Cell,R.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:n,VERSION:l,ActiveCellRange:E,ROW:E.startRow,COL:E.startCol,TYPE:0})},S[D.CTRL+"+"+D.SHIFT+"+"+D.HOME]=function(e,t,n,l){o.data.getWorkBook(t,l).getSheetObj(n);var S=o.view.getActiveGridID(),D=o.view.getSheetState(S,n).getActiveRange(),E=new i.Range(0,0,D.endRow,D.endCol);a.publish(r.Selector.BoundUpdate.Range,R.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:n,VERSION:l,RANGE:E,TYPE:0}),a.publish(r.Selector.BoundUpdate.Cell,R.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:n,VERSION:l,ActiveCellRange:E,ROW:E.startRow,COL:E.startCol,TYPE:0})},S[D.CTRL+"+"+D.SHIFT+"+"+D.END]=function(t,n,l,S){var D=o.data.getWorkBook(n,S).getSheetObj(l),E=D.MaxUsedRow,c=D.MaxUsedCol,g=o.view.getActiveGridID(),d=o.view.getSheetState(g,l).getActiveRange(),I=new i.Range(d.startRow,d.startCol,E,c);e.UserAction.ScrollCellIntoView(n,l,S,I.startRow,I.startCol),a.publish(r.Selector.BoundUpdate.Range,R.Selection.BOUND_UPDATE.ADD,{RID:n,SHEETID:l,VERSION:S,RANGE:I,TYPE:0}),a.publish(r.Selector.BoundUpdate.Cell,R.Selection.BOUND_UPDATE.ADD,{RID:n,SHEETID:l,VERSION:S,ActiveCellRange:I,ROW:I.startRow,COL:I.startCol,TYPE:0})},S[D.CTRL+"+"+D.HOME]=function(t,o,n,l){var S=new i.Range(0,0,0,0);e.UserAction.ScrollCellIntoView(o,n,l,S.startRow,S.startCol),a.publish(r.Selector.BoundUpdate.Range,R.Selection.BOUND_UPDATE.ADD,{RID:o,SHEETID:n,VERSION:l,RANGE:S,TYPE:0}),a.publish(r.Selector.BoundUpdate.Cell,R.Selection.BOUND_UPDATE.ADD,{RID:o,SHEETID:n,VERSION:l,ActiveCellRange:S,ROW:S.startRow,COL:S.startCol,TYPE:0})},S[D.CTRL+"+"+D.END]=function(t,n,l,S){var D=o.data.getWorkBook(n,S).getSheetObj(l),E=D.MaxUsedRow,c=D.MaxUsedCol,g=new i.Range(E,c,E,c);e.UserAction.ScrollCellIntoView(n,l,S,g.startRow,g.startCol),a.publish(r.Selector.BoundUpdate.Range,R.Selection.BOUND_UPDATE.ADD,{RID:n,SHEETID:l,VERSION:S,RANGE:g,TYPE:0}),a.publish(r.Selector.BoundUpdate.Cell,R.Selection.BOUND_UPDATE.ADD,{RID:n,SHEETID:l,VERSION:S,ActiveCellRange:g,ROW:g.startRow,COL:g.startCol,TYPE:0})},S[D.PAGEUP]=function(e,o,n,i){t.pageNavigateSelectionUp(o,n,i)},S[D.PAGEDOWN]=function(e,o,n,i){t.pageNavigateSelectionDown(o,n,i)},S[D.SUPER+"+"+D.LEFT]=function(e,n,i,l){e.preventDefault();var a=o.data.getWorkBook(n,l).getSheetObj(i).gridDirection;E&&"rl-tb"===a?t.CtrlRight(n,i,l):t.CtrlLeft(n,i,l)},S[D.SUPER+"+"+D.RIGHT]=function(e,n,i,l){e.preventDefault();var a=o.data.getWorkBook(n,l).getSheetObj(i).gridDirection;E&&"rl-tb"===a?t.CtrlLeft(n,i,l):t.CtrlRight(n,i,l)},S[D.SUPER+"+"+D.UP]=function(e,o,n,i){e.preventDefault(),t.CtrlUp(o,n,i)},S[D.SUPER+"+"+D.DOWN]=function(e,o,n,i){e.preventDefault(),t.CtrlDown(o,n,i)},S[D.SUPER+"+"+D.SHIFT+"+"+D.LEFT]=function(e,n,i,l){e.preventDefault();var a=o.data.getWorkBook(n,l).getSheetObj(i).gridDirection;E&&"rl-tb"===a?t.CtrlShiftRight(n,i,l):t.CtrlShiftLeft(n,i,l)},S[D.SUPER+"+"+D.SHIFT+"+"+D.RIGHT]=function(e,n,i,l){e.preventDefault();var a=o.data.getWorkBook(n,l).getSheetObj(i).gridDirection;E&&"rl-tb"===a?t.CtrlShiftLeft(n,i,l):t.CtrlShiftRight(n,i,l)},S[D.SUPER+"+"+D.SHIFT+"+"+D.UP]=function(e,o,n,i){e.preventDefault(),t.CtrlShiftUp(o,n,i)},S[D.SUPER+"+"+D.SHIFT+"+"+D.DOWN]=function(e,o,n,i){e.preventDefault(),t.CtrlShiftDown(o,n,i)},S[D.ESC]=function(e,t,o,n){a.publish(r.Listener,R.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:t,SHEETID:o,VERSION:n}),a.publish(r.Listener,R.KeyBoard.Escape,{RID:t,SHEETID:o,VERSION:n})},S[D.HOME]=function(t,n,l,S){o.data.getWorkBook(n,S).getSheetObj(l);var D=o.view.getActiveGridID(),E=o.view.getSheetState(D,l).getActiveRange(),c=new i.Range(E.startRow,0,E.endRow,0);e.UserAction.ScrollCellIntoView(n,l,S,c.startRow,c.startCol),a.publish(r.Selector.BoundUpdate.Range,R.Selection.BOUND_UPDATE.ADD,{RID:n,SHEETID:l,VERSION:S,RANGE:c,TYPE:0}),a.publish(r.Selector.BoundUpdate.Cell,R.Selection.BOUND_UPDATE.ADD,{RID:n,SHEETID:l,VERSION:S,ActiveCellRange:c,ROW:c.startRow,COL:c.startCol,TYPE:0})},S[D.END]=function(t,l,S,D){o.data.getWorkBook(l,D).getSheetObj(S);var E=o.view.getActiveGridID(),c=o.view.getSheetState(E,S).getActiveRange(),g=n.MAX_COL-1,d=new i.Range(c.startRow,g,c.endRow,g);e.UserAction.ScrollCellIntoView(l,S,D,d.startRow,d.startCol),a.publish(r.Selector.BoundUpdate.Range,R.Selection.BOUND_UPDATE.ADD,{RID:l,SHEETID:S,VERSION:D,RANGE:d,TYPE:0}),a.publish(r.Selector.BoundUpdate.Cell,R.Selection.BOUND_UPDATE.ADD,{RID:l,SHEETID:S,VERSION:D,ActiveCellRange:d,ROW:d.startRow,COL:d.startCol,TYPE:0})},S[D.SUPER+"+"+D.HOME]=function(t,n,l,S){var D=o.data.getWorkBook(n,S).getSheetObj(l),E=o.view.getActiveGridID(),c=(o.view.getSheetState(E,l).getActiveRange(),D.Row.Visibility.isHidden(0)?D.Row.Visibility.nextNonHidden(0):0),g=D.Column.hidden.isHidden(0)?D.Column.hidden.nextNonHidden(0):0,d=new i.Range(c,g,c,g);e.UserAction.ScrollCellIntoView(n,l,S,d.startRow,d.startCol),a.publish(r.Selector.BoundUpdate.Range,R.Selection.BOUND_UPDATE.ADD,{RID:n,SHEETID:l,VERSION:S,RANGE:d}),a.publish(r.Selector.BoundUpdate.Cell,R.Selection.BOUND_UPDATE.ADD,{RID:n,SHEETID:l,VERSION:S,ActiveCellRange:d,ROW:d.startRow,COL:d.startCol})},S[D.SUPER+"+"+D.END]=function(t,n,l,S){var D=o.data.getWorkBook(n,S).getSheetObj(l),E=o.view.getActiveGridID(),c=(o.view.getSheetState(E,l).getActiveRange(),D.Row.Visibility.isHidden(D.MaxUsedRow)?D.Row.Visibility.prevNonHidden(D.MaxUsedRow):D.MaxUsedRow),g=D.Column.hidden.isHidden(D.MaxUsedCol)?D.Column.hidden.prevNonHidden(D.MaxUsedCol):D.MaxUsedCol,d=new i.Range(c,g,c,g);e.UserAction.ScrollCellIntoView(n,l,S,d.startRow,d.startCol),a.publish(r.Selector.BoundUpdate.Range,R.Selection.BOUND_UPDATE.ADD,{RID:n,SHEETID:l,VERSION:S,RANGE:d}),a.publish(r.Selector.BoundUpdate.Cell,R.Selection.BOUND_UPDATE.ADD,{RID:n,SHEETID:l,VERSION:S,ActiveCellRange:d,ROW:d.startRow,COL:d.startCol})}}(this);
!function(r){var a=r.ZSConstants.CommandConstants;r.ZSResponseParser.ExtractCellInfo=function(r,n,t){for(var o=[],s=r[a.DOCUMENT_META][n][a.SHEET_META][t][a.CELL_META][a.META],E=s[a.ROW_DATA],e=s[a.COLUMN_DATA],f=E.length-1;f>=0;f--)for(var A=E[f],T=A[0]+A[1]-1,v=A[0],C=T;C>=v;C--)for(var l=e[A[2]],M=l.length-1;M>=0;M--){var i=l[M];if(i)for(var u=i[0]+i[1]-1,_=i[0],c=u;c>=_;c--){var h=i[2][1];o.push({r:C,c:c,displayValue:h})}}return o}}(this);
!function(e){if(!e.isCanvasGrid){var i=e.sPlusPlus,t=e.ZSClass.UIPaneComponent.prototype;t.PlaceRangePickerSelection=function(e,t,o,a,s,n,r,c){var l=i.data.getWorkBook(e,o).getSheetObj(t),g=l.Row.auxiliaryAxis.getPos(s.startRow),P=l.Column.auxiliaryAxis.getPos(s.startCol),R=l.Row.auxiliaryAxis.getPos(s.endRow+1),u=l.Column.auxiliaryAxis.getPos(s.endCol+1),h=i.view.getSheetState(this.gridID,t).getZoom();this.RangePicker.place(a,g*h,P*h,(R-g)*h,(u-P)*h,n,!r),this.RangePicker.setData(a,s.startRow,s.startCol,s.endRow,s.endCol),this.RangePicker.setColor(a,c)},t.RemoveRangePickerSelection=function(e,i,t,o){this.RangePicker.hide(o)},t.RemoveRangePickerSelectionFrom=function(e,i,t,o){this.RangePicker&&this.RangePicker.hideFrom(o)}}}(this);
!function(e){var t,n,i=e.sPlusPlus,r=e.ZSEvents,s=r.topic,a=r.Groups,o=r.Names,g=e.ZSClass,l=g.RangePicker={},c="",u="",R=0,v=!1,f=!1,h=e.JSUtil.REGEXP,S=h.matchRegex,d=h.rangeRegex;function k(){e.sPlusPlus.view.Events.Key.focusContext(n),s.unregister(a.Gesture.Selector.RangePicker,o.GESTURE.ACTION.END,k)}function P(){e.sPlusPlus.view.Events.Key.focusContext(n),s.unregister(a.Listener,o.RangePicker.Disable,P)}s.register(a.Listener,o.Mouse.RangeDown,function(){if(f){var t=e.sPlusPlus.view.Events.Key;(n=t.Stack[t.Stack.length-1])&&s.register(a.Gesture.Selector.RangePicker,o.GESTURE.ACTION.END,k)}}),s.register(a.Gesture.Selector.RangePicker,o.GESTURE.ACTION.START,function(){var t=e.sPlusPlus.view.Events.Key;(n=t.Stack[t.Stack.length-1])&&s.register(a.Listener,o.RangePicker.Disable,P)}),s.register(a.Listener,o.RangePicker.Modify,function(e){var n=t.value,i=n.match(S),r=0,s=0;for(var a in i){var o=i[a];if(d.test(o)){if(s===e)return void p(n,r,r+o.length);s++}r+=o.length}},"index");var E=document.createElement("span");function C(e,n,i,r){if(r){if(t.RangePickerOptions.SingleSelection)n=0,i=e.length;else{var s=function(e,t,n){var i=e.substring(0,t),r=e.substring(n),s=i.match(/(.*[(;,!=+\-/*<>&^])/),a=s?s[0].length:0,o=r.match(/[);,=+\-/*<>&]/);return{start:a,end:o?i.length+o.index:e.length}}(e,n,i);n=s.start,i=s.end}p(e,n,i),v=r}else p(e,n,i),v=v&&n===i,E.remove(),v&&(t.focus(),t.setSelectionRange(n,i),a=window.getSelection(),(o=a.getRangeAt(0)).deleteContents(),E.innerHTML="",o.insertNode(E),(o=o.cloneRange()).setStartBefore(E),o.setEndBefore(E),o.collapse(!1),a.removeAllRanges(),a.addRange(o));var a,o}function p(e,n,i){R=n,i;e=t.value;c=e.substring(0,n),u=e.substring(i);var r=/(?:([\(;,.!\=\+-\/*<>&^]([\s]*)?$)|(^$))/.test(c)&&(!t.valueCheck||t.valueCheck(c)),s=/(?:(^([\s]*)?[\);,=\+-\/*<>&])|(^$))/.test(u);v=(v=r&&s)&&(!t.valueCheck||t.valueCheck(e)),I(e,n,i)}function m(e,n,r,s,a){var o=i.data.getWorkBook(e,r).getSheetObj(n),l=o.Prop.Name;new RegExp("^[a-zA-Z0-9]*$").test(l)&&!/[-\s]/.test(l)||(l="'"+l+"'"),l+=".";var c=i.view.CellEditor.getEditCell();if(c&&c.getRID()===e&&c.getSheetID()===n&&c.getVersion()===r&&(l=""),!t.RangePickerOptions.skipMerge){var u=o.Merge.getInfo(s.startRow,s.startCol);u&&s.equals(u)&&(s=new g.Range(s.startRow,s.startCol,s.startRow,s.startCol))}return l+s.getLabel(a)}function D(e,t,n,r){return i.data.getWorkBook(e,n).getSheetObj(t).Merge.extendRange(r)}function I(e,n,i){var r=!t.valueCheck||t.valueCheck(e);s.publish(a.Listener,o.RangePicker.Highlight,{highlight:r,text:e,start:n,end:i})}function w(){return f&&v}function O(){t=void 0;var n=i.view.getActiveGridID(),r=i.view.getResourceID(n),g=i.view.getVersionID(n),c=i.view.getSheetID(n);if(l.KeyBoardApi.Clear(),e.isCanvasGrid)for(;l.State.getMaxRange();)s.publish(a.Listener,o.RangePicker.Hide,{RID:r,SHEETID:c,VERSION:g,index:l.State.getMaxRange()-1}),l.State.removeLast();else s.publish(a.Listener,o.RangePicker.HideFrom,{RID:r,SHEETID:c,VERSION:g,fromIndex:0});v=!1,f=!1}E.className="RSCue",s.register(a.Listener,o.RangePicker.Disable,function(){v=!1}),s.register(a.Listener,o.RangePicker.Update,function(e,n,i,r){v&&function(e,n,i,r){D(e,n,i,r);var s=m(e,n,i,r,t.RangePickerOptions.mode),a=c+s+u,o=(c+s).length;t.value=a,t.valueChanged(),t.setSelectionRange(o,o),I(a,R,o)}(e,n,i,r)},"RID","SHEETID","VERSION","RANGE"),s.register(a.Listener,o.RangePicker.ReHighlight,function(){f&&I(t.value,t.selectionStart,t.selectionEnd)}),l.setRanges=function(e,n,i,r){if(f&&r.length>0){var s="",a=r[0];D(e,n,i,a),s+=m(e,n,i,a,t.RangePickerOptions.mode);for(var o=1;o<r.length;o++)s+=",",s+=m(e,n,i,a=r[o],t.RangePickerOptions.mode);t.value=s,t.valueChanged();var g=s.length;t.setSelectionRange(g,g),I(s,g,g)}},l.register=function(e,n,i,r,s,a){(t=e).RangePickerOptions={SingleSelection:!!n,SingleCell:!!i,DialogMode:!s,mode:r,skipMerge:!!a},function(e){var n=function(){f=!0,t!==this&&(t=this),0!=t.isEnabled&&C(t.value,t.selectionStart,t.selectionEnd,t.RangePickerOptions.DialogMode)}.bind(e),i={blur:O,focus:n,selectionChanged:n};e.addListeners(i)}(e)},l.isSelection=w,l.isSingleCell=function(){return t.RangePickerOptions.SingleCell},l.isActiveOn=function(e){return w()&&t===e},function(e){var t=e.ZSClass||(e.ZSClass={});function n(){this.state=[],this.maxRange}n.prototype={add:function(e,t){this.state[e]=t},get:function(e){return this.state[e]},removeLast:function(){this.state.pop()},getMaxRange:function(){return this.state.length}},t.StateRangePicker=n}(e),l.State=new g.StateRangePicker}(this);
!function(t){var o,n,e,r,a=t.sPlusPlus,l=t.UserAction,w=t.ZSEvents,i=w.topic,R=w.Groups,C=w.Names,s=t.ZSClass,c=a.data.Defaults,d=s.Range,u=s.RangePicker.KeyBoardApi={};function f(t,n,e){return o||v(t,n,e),o}function v(t,o,n){var e=a.view.getActiveGridID();S(t,o,n,a.view.getSheetState(e,o).getActiveCellRange())}function S(t,e,r,a){o=a,n&&o.subset(n)||I(t,e,r,a.startRow,a.startCol)}function g(t,o,n,e){return a.data.getWorkBook(t,n).getSheetObj(o).Merge.extendRange(e)}function I(t,o,a,l,w){r=l,e=w,n=g(t,o,a,n=new d(l,w,l,w))}function V(t,o,n,e){a.data.getWorkBook(t,n).getSheetObj(o);i.publish(R.Listener,C.RangePicker.Update,{RID:t,SHEETID:o,VERSION:n,RANGE:e}),i.publish(R.Gesture.Selector.RangePicker,C.GESTURE.ACTION.UPDATE_ASSISTOR,{RID:t,SHEETID:o,VERSION:n,RANGE:e})}function h(t,o,n,e){var r=a.data.getWorkBook(t,n).getSheetObj(o).Column.hidden.prevNonHidden(e);return r<0&&(r=0),r}function N(t,o,n,e){var r=a.data.getWorkBook(t,n).getSheetObj(o).Column.hidden.nextNonHidden(e);return r>=c.MAX_COL&&(r=c.MAX_COL-1),r}function k(t,o,n,e){var r=a.data.getWorkBook(t,n).getSheetObj(o).Row.Visibility.prevNonHidden(e);return r<0&&(r=0),r}function E(t,o,n,e){var r=a.data.getWorkBook(t,n).getSheetObj(o).Row.Visibility.nextNonHidden(e);return r>=c.MAX_ROW&&(r=c.MAX_ROW-1),r}function O(t,o,e){var r=f(t,o,e),a=new d(r.startRow,n.startCol,r.endRow,n.endCol);return g(t,o,e,a),a}function A(t,o,e){var r=f(t,o,e),a=new d(n.startRow,r.startCol,n.endRow,r.endCol);return g(t,o,e,a),a}function p(t,o,n,e,r){var a=new d(e,r,e,r);I(t,o,n,e,r),V(t,o,n,a),l.ScrollCellIntoView(t,o,n,a.startRow,a.startCol)}function D(t,o,n,a){l.CtrlNavigate(t,[o],n,r,e,a,p)}function b(t,n,e){l.CtrlNavigate(t,[n],e,r,o.startCol,4,function(t,n,e,r,a){var w=new s.Range(o.startRow,a,o.endRow,o.endCol);g(t,n,e,w),V(t,n,e,w),l.ScrollColIntoView(t,n,e,w.startCol)})}function U(t,n,e){l.CtrlNavigate(t,[n],e,r,o.endCol,3,function(t,n,e,r,a){var w=new d(o.startRow,o.startCol,o.endRow,a);g(t,n,e,w),V(t,n,e,w),l.ScrollColIntoView(t,n,e,w.endCol)})}function L(t,n,r){l.CtrlNavigate(t,[n],r,o.startRow,e,2,function(t,n,e,r,a){var w=new s.Range(r,o.startCol,o.endRow,o.endCol);g(t,n,e,w),V(t,n,e,w),l.ScrollRowIntoView(t,n,e,w.startRow)})}function W(t,n,r){l.CtrlNavigate(t,[n],r,o.endRow,e,1,function(t,n,e,r,a){var w=new s.Range(o.startRow,o.startCol,r,o.endCol);g(t,n,e,w),V(t,n,e,w),l.ScrollRowIntoView(t,n,e,w.startRow)})}function B(t,n,e){l.CtrlNavigate(t,[n],e,r,o.startCol,3,function(t,n,e,r,a){var w=new d(o.startRow,a,o.endRow,o.endCol);g(t,n,e,w),V(t,n,e,w),l.ScrollColIntoView(t,n,e,w.startCol)})}function G(t,n,e){l.CtrlNavigate(t,[n],e,r,o.endCol,4,function(t,n,e,r,a){var w=new s.Range(o.startRow,o.startCol,o.endRow,a);g(t,n,e,w),V(t,n,e,w),l.ScrollColIntoView(t,n,e,w.endCol)})}function H(t,n,r){l.CtrlNavigate(t,[n],r,o.startRow,e,1,function(t,n,e,r,a){var w=new s.Range(r,o.startCol,o.endRow,o.endCol);g(t,n,e,w),V(t,n,e,w),l.ScrollRowIntoView(t,n,e,w.startRow)})}function P(t,n,r){l.CtrlNavigate(t,[n],r,o.endRow,e,2,function(t,n,e,r,a){var w=new s.Range(o.startRow,o.startCol,r,o.endCol);g(t,n,e,w),V(t,n,e,w),l.ScrollRowIntoView(t,n,e,w.startRow)})}u.Init=v,u.Clear=function(){o=null},u.Left=function(t,o,e){var a=r,w=h(t,o,e,n.startCol),i=new d(a,w,a,w);I(t,o,e,a,w),V(t,o,e,i),l.ScrollCellIntoView(t,o,e,i.startRow,i.startCol)},u.Right=function(t,o,e){var a=r,w=N(t,o,e,n.endCol),i=new d(a,w,a,w);I(t,o,e,a,w),V(t,o,e,i),l.ScrollCellIntoView(t,o,e,i.startRow,i.startCol)},u.Up=function(t,o,r){var a=n.startRow,w=e,i=k(t,o,r,a),R=new d(i,w,i,w);I(t,o,r,i,w),V(t,o,r,R),l.ScrollCellIntoView(t,o,r,R.startRow,R.startCol)},u.Down=function(t,o,r){var a=n.endRow,w=e,i=E(t,o,r,a),R=new d(i,w,i,w);I(t,o,r,i,w),V(t,o,r,R),l.ScrollCellIntoView(t,o,r,R.startRow,R.startCol)},u.ShiftLeft=function(t,o,n){var e=f(t,o,n),r=O(t,o,n);e.endCol===r.endCol?function(t,o,n){var e=f(t,o,n),r=h(t,o,n,e.startCol),a=new d(e.startRow,r,e.endRow,e.endCol);g(t,o,n,a),V(t,o,n,a),l.ScrollColIntoView(t,o,n,a.startCol)}(t,o,n):function(t,o,n){var e=f(t,o,n),r=new d(e.startRow,e.endCol,e.endRow,e.endCol);g(t,o,n,r);var a=h(t,o,n,r.startCol),w=new d(e.startRow,e.startCol,e.endRow,a);V(t,o,n,w),l.ScrollColIntoView(t,o,n,w.endCol)}(t,o,n)},u.ShiftRight=function(t,o,n){var e=f(t,o,n),r=O(t,o,n);e.startCol===r.startCol?function(t,o,n){var e=f(t,o,n),r=N(t,o,n,e.endCol),a=new d(e.startRow,e.startCol,e.endRow,r);g(t,o,n,a),V(t,o,n,a),l.ScrollColIntoView(t,o,n,a.endCol)}(t,o,n):function(t,o,n){var e=f(t,o,n),r=new d(e.startRow,e.startCol,e.endRow,e.startCol);g(t,o,n,r);var a=N(t,o,n,r.endCol),w=new d(e.startRow,a,e.endRow,e.endCol);V(t,o,n,w),l.ScrollColIntoView(t,o,n,w.startCol)}(t,o,n)},u.ShiftUp=function(t,o,n){var e=f(t,o,n),r=A(t,o,n);e.endRow===r.endRow?function(t,o,n){var e=f(t,o,n),r=k(t,o,n,e.startRow),a=new d(r,e.startCol,e.endRow,e.endCol);g(t,o,n,a),V(t,o,n,a),l.ScrollRowIntoView(t,o,n,a.startRow)}(t,o,n):function(t,o,n){var e=f(t,o,n),r=new d(e.endRow,e.startCol,e.endRow,e.endCol);g(t,o,n,r);var a=k(t,o,n,r.startRow),w=new d(e.startRow,e.startCol,a,e.endCol);V(t,o,n,w),l.ScrollRowIntoView(t,o,n,w.endRow)}(t,o,n)},u.ShiftDown=function(t,o,n){var e=f(t,o,n),r=A(t,o,n);e.startRow===r.startRow?function(t,o,n){var e=f(t,o,n),r=E(t,o,n,e.endRow),a=new d(e.startRow,e.startCol,r,e.endCol);g(t,o,n,a),V(t,o,n,a),l.ScrollRowIntoView(t,o,n,a.endRow)}(t,o,n):function(t,o,n){var e=f(t,o,n),r=new d(e.startRow,e.startCol,e.startRow,e.endCol);g(t,o,n,r);var a=E(t,o,n,r.endRow),w=new d(a,e.startCol,e.endRow,e.endCol);V(t,o,n,w),l.ScrollRowIntoView(t,o,n,w.startRow)}(t,o,n)},u.CtrlLeft=function(t,o,n){D(t,o,n,4)},u.CtrlRight=function(t,o,n){D(t,o,n,3)},u.CtrlUp=function(t,o,n){D(t,o,n,2)},u.CtrlDown=function(t,o,n){D(t,o,n,1)},u.CtrlShiftLeft=function(t,o,n){var e=f(t,o,n),r=O(t,o,n);e.endCol===r.endCol?b(t,o,n):G(t,o,n)},u.CtrlShiftRight=function(t,o,n){var e=f(t,o,n),r=O(t,o,n);e.startCol===r.startCol?U(t,o,n):B(t,o,n)},u.CtrlShiftUp=function(t,o,n){var e=f(t,o,n),r=A(t,o,n);e.endRow===r.endRow?L(t,o,n):P(t,o,n)},u.CtrlShiftDown=function(t,o,n){var e=f(t,o,n),r=A(t,o,n);e.startRow===r.startRow?W(t,o,n):H(t,o,n)},i.register(R.Listener,C.RangePicker.Update,S,"RID","SHEETID","VERSION","RANGE")}(this);
!function(e){var t=e.sPlusPlus,r=e.ZSEvents,a=r.topic,g=r.Groups,i=r.Names,n=e.ZSClass,s=e.JSUtil,R=new(0,n.RangeColorChoser)(["5883DA","E5575B","A43FBC","5B9C27","11A9CC","F7900C","BD4F90","2B799C","AC3135","5F5F5F","0D6856","9B8C2B","3FD0B4","F2B405","4B10AC","65765A","9258F1","795011","584A71","EF3964"]),o=s.REGEXP,h=o.matchRegex,v=o.rangeRegex,D=n.RangePicker;a.register(g.Listener,i.RangePicker.Highlight,function(e,r,n,o){var c=0,C=t.view.getActiveGridID(),S=t.view.getResourceID(C),l=t.view.getSheetID(C),E=t.view.getVersionID(C),I=t.data.getWorkBook(S,E).getSheetObj(l);if(e){var d=r.match(h),B=0;for(var F in R.reset(),n>o&&(n+=o,n-=o=n-o),d){var u=d[F];if(v.test(u)){var A=s.Range.parseRange(S,E,u);if(A){var f=R.get(u),x=B<=n&&o<=B+u.length;I.Merge.extendRange(A.range),a.publish(g.Listener,i.RangePicker.Add,{RID:S,SHEETID:A.sheetID,VERSION:E,RANGEID:c,Range:A.range,isCurrentRange:x,bringForward:x,color:"#"+f}),D.State.add(c,A.range),c++}}B+=u.length}}for(;D.State.getMaxRange()>c;)a.publish(g.Listener,i.RangePicker.Hide,{RID:S,SHEETID:l,VERSION:E,index:D.State.getMaxRange()-1}),D.State.removeLast()},"highlight","text","start","end")}(this);
!function(e){var t,r,E=e.sPlusPlus,R=e.ZSEvents,i=R.topic,s=R.Groups,S=R.Names,o=e.ZSClass,a=o.SelectorHelper.Constants.MULTI_DIRECTION,n=o.Selector.Assistor,I=(o.Range,o.RangePicker);function O(e,t,r,E){i.publish(s.Listener,S.RangePicker.Update,{RID:e,SHEETID:t,VERSION:r,RANGE:E})}function T(e,R,i,s,S,o,I,T){var g=E.data.getWorkBook(e,i).getSheetObj(R);t=new n(o,!0,a),O(e,R,i,r=t.ADD(g,s,S,I,T))}function g(e,R,i,s,S,o){if(!I.isSingleCell()){var a=E.data.getWorkBook(e,i).getSheetObj(R);O(e,R,i,r=t.MODIFY(a,s,S,r))}}i.register(s.Gesture.Selector.RangePicker,S.GESTURE.ACTION.UPDATE_ASSISTOR,function(e,r,R,i){var s=E.data.getWorkBook(e,R).getSheetObj(r),S=s.Column.auxiliaryAxis.getPos(i.startCol),o=s.Row.auxiliaryAxis.getPos(i.startRow);(t=new n(void 0,!0,a)).ADD(s,S,o)},"RID","SHEETID","VERSION","RANGE"),i.register(s.Gesture.Selector.RangePicker,S.GESTURE.ACTION.DOWN,T,"RID","SHEETID","VERSION","COLX","ROWY","TYPE"),i.register(s.Gesture.Selector.RangePicker,S.GESTURE.ACTION.START,T,"RID","SHEETID","VERSION","COLX","ROWY","TYPE","point","fixedRange"),i.register(s.Gesture.Selector.RangePicker,S.GESTURE.ACTION.MOVE,g,"RID","SHEETID","VERSION","COLX","ROWY","TYPE"),i.register(s.Gesture.Selector.RangePicker,S.GESTURE.ACTION.END,g,"RID","SHEETID","VERSION","COLX","ROWY","TYPE")}(this);
!function(t){t.sPlusPlus;var e,n=t.ZSEvents,r=n.topic,f=n.Groups,i=n.Names,u=(t.UserAction,t.ZSConstants.JSKeyCode),o=t.ZSClass.RangePicker,l=o.KeyBoardApi,S=t.sPlusPlus.view.Events.Key.Entry.RangePicker.Context.keyDown;u=t.ZSConstants.JSKeyCode;function c(){return o.isSelection()}function D(t,n,r,f){e||(l.Init(n,r,f),e=!0)}function a(t,n,r,f){e=!1}function E(t,e,n,r){if(c())return!1}r.register(f.Selector.BoundUpdate.CellEdit,i.Selection.BOUND_UPDATE.REMOVE,a),S[u.PURE_PRINTABLE_CHAR]=function(t,e,n,r){return a(),D(0,e,n,r),!1},S[u.LEFT]=function(t,e,n,r){if(c())return t.preventDefault(),D(0,e,n,r),l.Left(e,n,r),!1},S[u.RIGHT]=function(t,e,n,r){if(c())return t.preventDefault(),D(0,e,n,r),l.Right(e,n,r),!1},S[u.UP]=function(t,e,n,r){if(c())return t.preventDefault(),D(0,e,n,r),l.Up(e,n,r),!1},S[u.DOWN]=function(t,e,n,r){if(c())return t.preventDefault(),D(0,e,n,r),l.Down(e,n,r),!1},S[u.DELETE]=E,S[u.BACKSPACE]=E,S[u.SHIFT+"+"+u.LEFT]=function(t,e,n,r){if(c())return t.preventDefault(),l.ShiftLeft(e,n,r),!1},S[u.SHIFT+"+"+u.RIGHT]=function(t,e,n,r){if(c())return t.preventDefault(),l.ShiftRight(e,n,r),!1},S[u.SHIFT+"+"+u.UP]=function(t,e,n,r){if(c())return t.preventDefault(),l.ShiftUp(e,n,r),!1},S[u.SHIFT+"+"+u.DOWN]=function(t,e,n,r){if(c())return t.preventDefault(),l.ShiftDown(e,n,r),!1},S[u.SUPER+"+"+u.LEFT]=function(t,e,n,r){if(c())return t.preventDefault(),l.CtrlLeft(e,n,r),!1},S[u.SUPER+"+"+u.RIGHT]=function(t,e,n,r){if(c())return t.preventDefault(),l.CtrlRight(e,n,r),!1},S[u.SUPER+"+"+u.UP]=function(t,e,n,r){if(c())return t.preventDefault(),l.CtrlUp(e,n,r),!1},S[u.SUPER+"+"+u.DOWN]=function(t,e,n,r){if(c())return t.preventDefault(),l.CtrlDown(e,n,r),!1},S[u.SUPER+"+"+u.SHIFT+"+"+u.LEFT]=function(t,e,n,r){if(c())return t.preventDefault(),l.CtrlShiftLeft(e,n,r),!1},S[u.SUPER+"+"+u.SHIFT+"+"+u.RIGHT]=function(t,e,n,r){if(c())return t.preventDefault(),l.CtrlShiftRight(e,n,r),!1},S[u.SUPER+"+"+u.SHIFT+"+"+u.UP]=function(t,e,n,r){if(c())return t.preventDefault(),l.CtrlShiftUp(e,n,r),!1},S[u.SUPER+"+"+u.SHIFT+"+"+u.DOWN]=function(t,e,n,r){if(c())return t.preventDefault(),l.CtrlShiftDown(e,n,r),!1}}(this);
!function(e){var t=e.sPlusPlus,i=(t.view.measures,e.ZSEvents),n=i.topic,s=i.Groups,o=i.Names,r=e.ZSClass,u=r.SelectorHelper.Constants.POINT,a=r.Range,c=(u=r.SelectorHelper.Constants.POINT,a=r.Range,r.Selector),d=c.Design||(c.Design={}),l={class:"rangePicker",filler:!0,corners:{tl:{mousedown:function(e){R(e),g(this.index,e,this.endRow,this.endCol,u.LEFT_TOP)}},tr:{mousedown:function(e){R(e),g(this.index,e,this.endRow,this.startCol,u.RIGHT_TOP)}},bl:{mousedown:function(e){R(e),g(this.index,e,this.startRow,this.endCol,u.LEFT_BOTTOM)}},br:{mousedown:function(e){R(e),g(this.index,e,this.startRow,this.startCol,u.RIGHT_BOTTOM)}}},edges:{top:!0,bottom:!0,left:!0,right:!0}},v=document.body;function R(e){e.preventDefault(),e.stopPropagation()}function g(e,i,r,u,c){n.publish(s.Listener,o.RangePicker.Modify,{index:e});var d=t.view.getActiveGridID(),l=t.view.getResourceID(d),R=t.view.getSheetID(d),g=t.view.getVersionID(d),I=t.view.getGridComponent(d).getRelativeCoordinates(i),T=new a(r,u,r,u);n.publish(s.Gesture.Selector.RangePicker,o.GESTURE.ACTION.START,{RID:l,SHEETID:R,VERSION:g,COLX:I.x,ROWY:I.y,point:c,fixedRange:T}),v.addEventListener("mousemove",h),v.addEventListener("mouseup",w)}function h(e){R(e);var i=t.view.getActiveGridID(),r=t.view.getResourceID(i),u=t.view.getSheetID(i),a=t.view.getVersionID(i),c=t.view.getGridComponent(i).getRelativeCoordinates(e);n.publish(s.Gesture.Selector.RangePicker,o.GESTURE.ACTION.MOVE,{RID:r,SHEETID:u,VERSION:a,COLX:c.x,ROWY:c.y})}function w(e){R(e),n.publish(s.Listener,o.RangePicker.Disable),v.removeEventListener("mousemove",h),v.removeEventListener("mouseup",w)}d.RangePicker=l}(this);
!function(t){t.sPlusPlus;var e=t.ZSClass.AutoSuggest;function s(s){this.category=s.category,this.categoryList={},s.callBack=function(e,s){var i=t.document.createElement("span");i.className="plus",i.addEventListener("mousedown",function(t){t.stopPropagation(),t.preventDefault(),this.insert()}.bind(e)),e.dom.addEventListener("mousedown",function(t){t.preventDefault(),this.select()}.bind(e)),e.dom.appendChild(i);var n=s.Category;!this.categoryList[n]&&(a=this.category,o=n,r=t.document.createElement("option"),r.value=o,r.textContent=o,a.appendChild(r)),(this.categoryList[n]||(this.categoryList[n]={}))[e.text]=e;var a,o,r}.bind(this),e.register.call(this,s),function(){var t=this.suggest.bind(this),e=this.categoryList;this.category.addEventListener("change",function(s){t("",e[this.value])});var s={input:i.bind(this),focus:i.bind(this)};this.editor.addListeners(s)}.call(this)}function i(){var t=this.editor.value;this.suggest(t),this.selector.reset()}s.prototype=new e.register,e.Search=s}(this);
!function(t){t.sPlusPlus;var e=t.ZSClass.AutoSuggest;function s(t){t.onSelect=function(t){this.selector.flush(),function(t,e){var s=t.value,n=t.selectionStart,o=t.selectionEnd,a=i(s,n,o),l=s.substring(0,a.start),c=s.substring(a.end,s.length),u=!!c[0]&&"("===c[0],h=l+e.text+(u?"":"(")+c,g=a.start+e.text.length+1;t.value=h,t.setSelectionRange(g,g),r(t.Editor,"input"),r(t.Editor,"selectionChanged")}(this.editor,t)}.bind(this),t.callBack=n,e.register.call(this,t);var s={input:function(){if("="===this.editor.value.charAt(0)){var t=function(t){var e=t.value,s=t.selectionStart;if("="!==e.charAt(0)||(n=e,r=s,!(n.substring(0,r).split('"').length%2)))return"";var n,r;var o=t.selectionEnd,a=i(e,s,o);return e.substring(a.start,a.end)}(this.editor);""===t?this.selector.flush():this.suggest(t),this.selector.reset()}}.bind(this),blur:function(){this.selector.flush()}.bind(this),keydown:function(t){var e=t.keyCode||t.which;if(this.selector.isEmpty())return;switch(e){case 40:t.preventDefault(),t.stopPropagation(),this.selector.increment();break;case 38:t.preventDefault(),t.stopPropagation(),this.selector.decrement();break;case 37:case 39:this.selector.flush();break;case 13:t.preventDefault(),t.stopPropagation(),t.metaKey?this.selector.insert():this.selector.select();break;case 27:t.preventDefault(),t.stopPropagation(),this.selector.flush()}}.bind(this)};this.editor.addListeners(s)}function n(t){t.dom.addEventListener("mousedown",function(t){t.preventDefault(),t.stopPropagation(),this.select()}.bind(t))}function i(t,e,s){var n=/[\/\-()-+=,~@%^*"|;<>'&}{\n ]/g,i=t.substring(0,e),r=t.substring(s,t.length),o=e-i.split(n).pop().length,a=s+r.split(n)[0].length;t.substring(0,o),t.substring(a,t.length);return{start:o,end:a}}function r(t,e){e=new Event(e);t.dispatchEvent(e)}s.prototype=new e.register,e.Formula=s}(this);
!function(t){var s=ZSClass.AutoSuggest||(ZSClass.AutoSuggest={});function n(t,s,n,i){this.dom=t,this.text=s,this.onSelect=n,this.onInsert=i}n.prototype={appendTo:function(t){t.appendChild(this.dom)},insert:function(t){this.onInsert.call(this)},select:function(t){this.onSelect.call(this,t)}},s.Entry=n}();
!function(t){var i=ZSClass.AutoSuggest||(ZSClass.AutoSuggest={});function s(t,i){this.container=t,this.height=i,this.list=[],this.index=0}function e(t){t=~~t,this.list[t]&&(this.active&&this.active.dom.classList.remove("active"),this.index=t,this.active=this.list[t],this.active.dom.classList.add("active"),this.height&&function(t){var i=this.container.scrollTop,s=t*this.height.inActive-i,e=s+this.height.active,c=this.height.container;s<0?this.container.scrollTop+=s:e>c&&(this.container.scrollTop+=e-c)}.call(this,t))}s.prototype={add:function(t,i){this.list.push(i)},flush:function(){this.container.innerHTML="",this.list=[],this.index=0,this.removeActive()},increment:function(){e.call(this,this.index+1)},decrement:function(){e.call(this,this.index-1)},reset:function(){e.call(this,0)},removeActive:function(){this.active&&this.active.dom.classList.remove("active"),this.active=void 0},isEmpty:function(){return!this.list.length},select:function(t){this.active&&this.active.select(t)},insert:function(t){this.active&&this.active.insert(t)}},i.selector=s}();
!function(t){var s=ZSClass.AutoSuggest||(ZSClass.AutoSuggest={}),e=t.sPlusPlus,i=t.ZSConstants.FeatureConstants;e.view.Toolbar.Feature[i.DELUGE];function o(t,s,e,i){this.container=t,this.editor=s,this.select=e,this.selector=i,this.list={},this.allCategory=new ZSClass.AutoSuggest.AllCategory}o.prototype={suggest:function(t,s){this.container.innerHTML="";var e={},i={};(s=this.list[s]||this.allCategory).suggest(t,e,i);var o=this.container;this.selector.flush();var n=this.selector;Object.keys(e).sort().forEach(function(t){e[t].appendTo(o),n.add(t,e[t])}),Object.keys(i).sort().forEach(function(t){i[t].appendTo(o),n.add(t,i[t])}),this.selector.reset()},isEmpty:function(){return this.selector.isEmpty()},getCategory:function(s){this.list[s];if(!this.list[s]){var e=new ZSClass.AutoSuggest.Category,i=t.document.createElement("option");i.value=s,i.textContent=s,this.select.appendChild(i),this.list[s]=e,this.allCategory.addCategory(e)}return this.list[s]},flush:function(t){t.flush()}},s.Search=o}(this);
!function(t){var s=ZSClass.AutoSuggest||(ZSClass.AutoSuggest={});function i(){this.map={}}function e(){this.categories=[]}i.prototype={addEntry:function(t,s){this.map[t]=s},deleteEntry:function(t){delete this.map[t]},suggest:function(t,s,i){for(var e in this.map)e.startsWith(t)?s[e]=this.map[e]:e.contains(t)&&(i[e]=this.map[e])},flush:function(){this.map={}}},e.prototype={addCategory:function(t){this.categories.push(t)},suggest:function(t,s,i){for(var e=0;e<this.categories.length;e++){this.categories[e].suggest(t,s,i)}}},s.Category=i,s.AllCategory=e}();
!function(t){var s=ZSClass.AutoSuggest||(ZSClass.AutoSuggest={});function n(t,s,n,i){this.dom=t,this.key=s,this.text=n,this.onInsert=i}n.prototype={appendTo:function(t){t.appendChild(this.dom)},insert:function(){this.onInsert(this)}},s.FormulaEntry=n}();
!function(t){var i=ZSClass.AutoSuggest||(ZSClass.AutoSuggest={});function s(t,i){this.container=t,this.height=i,this.list=[],this.index=0}function e(t){t=~~t,this.list[t]&&(this.active&&this.active.dom.classList.remove("active"),this.index=t,this.active=this.list[t],this.active.dom.classList.add("active"),this.height&&function(t){var i=this.container.scrollTop,s=t*this.height.inActive-i,e=s+this.height.active,n=this.height.container;s<0?this.container.scrollTop+=s:e>n&&(this.container.scrollTop+=e-n)}.call(this,t))}s.prototype={add:function(t,i){this.list.push(i)},flush:function(){this.container.innerHTML="",this.list=[],this.index=0,this.removeActive(),this.container.style.display="none"},increment:function(){e.call(this,this.index+1)},decrement:function(){e.call(this,this.index-1)},reset:function(){e.call(this,0)},removeActive:function(){this.active&&this.active.dom.classList.remove("active"),this.active=void 0},isEmpty:function(){return!this.list.length},insert:function(){this.active&&this.active.insert()}},i.Formulaselector=s}();
!function(t){var e,s,i=t.sPlusPlus,r=t.ZSClass,n=t.UIUtil.Component,o=r.AutoSuggest||(r.AutoSuggest={});function a(t,e,s){this.container=t,this.container.style.display="none",this.editor=e,this.selector=s,this.list={},this.allCategory=new r.AutoSuggest.FormulaAllCategory;var i={input:function(){if("="===this.editor.value.charAt(0)){var t=function(t){var e=t.value,s=t.selectionStart;if("="!==e.charAt(0)||(i=e,r=s,!(i.substring(0,r).split('"').length%2)))return"";var i,r;var n=t.selectionEnd,o=function(t,e,s){var i=/[\/\-()-+=,~@%^*"|;<>'&}{\n ]/g,r=t.substring(0,e),n=t.substring(s,t.length),o=e-r.split(i).pop().length,a=s+n.split(i)[0].length;t.substring(0,o),t.substring(a,t.length);return{start:o,end:a}}(e,s,n);return e.substring(o.start,o.end)}(this.editor);""===t?this.selector.flush():this.suggest(t),this.selector.reset()}}.bind(this),blur:function(){this.selector.flush()}.bind(this),keydown:function(t){var e=t.keyCode||t.which;if(this.selector.isEmpty())return;switch(e){case 40:t.preventDefault(),t.stopPropagation(),this.selector.increment();break;case 38:t.preventDefault(),t.stopPropagation(),this.selector.decrement();break;case 37:case 39:this.selector.flush();break;case 13:t.preventDefault(),t.stopPropagation(),this.selector.insert();break;case 27:t.preventDefault(),t.stopPropagation(),this.selector.flush()}}.bind(this)};n.ztooltip(this.container,{displayType:"callout",position:"right"}),this.editor.addListeners(i)}a.prototype={suggest:function(t){var r=i.view.getActiveGridID(),n=(i.view.getResourceID(r),i.view.getSheetID(r),i.view.getVersionID(r),this.editor.range.startRow),o=this.editor.range.startCol;UserAction.flushSuggest(),this.container.style.display="",t=t.toUpperCase(),this.container.innerHTML="";var a={};this.allCategory.suggest(t,a);var l=this.container;this.selector.flush();var h=this.selector;if(Object.keys(a).sort().forEach(function(t){a[t].appendTo(l),h.add(t,a[t])}),"{}"!=JSON.stringify(a)){this.container.style.display="";var u=this.container.getBoundingClientRect();e=u.height,s=u.width,UserAction.calcPosition(this.container,this.editor,n,o,s,e)}},getCategory:function(e){this.list[e];if(!this.list[e]){var s=new r.AutoSuggest.FormulaCategory,i=t.document.createElement("option");i.value=e,i.textContent=e,this.list[e]=s,this.allCategory.addCategory(s)}return this.list[e]},flush:function(t){t.flush()}},o.Formula=a}(this);
!function(t){var s=ZSClass.AutoSuggest||(ZSClass.AutoSuggest={});function e(){this.map={}}function i(){this.categories=[]}e.prototype={addEntry:function(t,s){this.map[t]=s},deleteEntry:function(t){delete this.map[t]},getEntry:function(t){return this.map[t]},suggest:function(t,s){for(var e in this.map)t=(t=t.toLowerCase()).startsWith("_")?t.substring(1,t.length):t,e.toLowerCase().startsWith(t)&&(s[e]=this.map[e])},flush:function(){this.map={}}},i.prototype={addCategory:function(t){this.categories.push(t)},suggest:function(t,s){for(var e=0;e<this.categories.length;e++){this.categories[e].suggest(t,s)}},flush:function(){this.categories=[]}},s.FormulaCategory=e,s.FormulaAllCategory=i}();
!function(t){var e,n,i=ZSClass.AutoSuggest||(ZSClass.AutoSuggest={}),a=t.sPlusPlus,r=t.ZSConstants.FeatureConstants,s=t.UIUtil.Component,o=(a.view.Toolbar.Feature[r.DELUGE],0),c=4,d=5,h=6,l=0;function p(t,e){this.container=t,this.editor=e;var n={keydown:function(t){switch(t.keyCode||t.which){case 27:this.flush()}}.bind(this)};this.editor.addListeners(n)}p.prototype={flush:function(){this.container.innerHTML="",this.container.style.display="none"},show:function(){this.container.style.display="",u(this.container)},hide:function(){this.container.style.display="none"},constructHelp:function(i,r){this.container.innerHTML="";var s=r.getEntry(i).key,p=ZSConstants.Function.functions[s.trim()],u=p[o],v=p[c],f=p[d],m=document.createElement("span");m.innerText=u,t.isCraftGrid&&!t.isRangeGrid||(m.classList.add("formulaHelpLink"),m.addEventListener("mousedown",function(t){UserAction.functionSelection(u),t.stopPropagation(),t.preventDefault()})),this.container.appendChild(m);var C=document.createElement("span");C.classList.add("openBrace"),C.innerText="(",this.container.appendChild(C);var w=0;if(f&&f.length){s=(E=f[l])[0];this.container.appendChild(g(s));for(var y=1,L=E.length;y<L;y++){s=E[y];this.container.appendChild(g(";",!0)),this.container.appendChild(g(s)),w=E.length}}var T=p[h];if(T&&T.length){var E,D=!1,S="";(w+=(E=T[l]).length)!==v&&(D=!0,S="1");var I=0;if(!f.length){I=1,S="1";s=E[0];s+=S,this.container.appendChild(g(s))}for(y=I,L=E.length;y<L;y++){s=E[y];s+=S,this.container.appendChild(g(";",!0)),this.container.appendChild(g("["+s+"]"))}if(D){for(y=0,L=E.length;y<L;y++){s=E[y];s+="2",this.container.appendChild(g(";",!0)),this.container.appendChild(g("["+s+"]"))}this.container.appendChild(g("..."))}}var R=document.createElement("span");R.innerText=")",this.container.appendChild(R);var x=a.view.getActiveGridID(),A=(a.view.getResourceID(x),a.view.getSheetID(x),a.view.getVersionID(x),this.editor.range.startRow),U=this.editor.range.startCol;this.show();var H=this.container.getBoundingClientRect();e=H.height,n=H.width,this.container.style.top="",UserAction.calcPosition(this.container,this.editor,A,U,n,e)},delugeHelp:function(t){this.container.innerHTML="";var i=a.view.getActiveGridID(),r=a.view.getResourceID(i),s=(a.view.getSheetID(i),a.view.getVersionID(i),a.data.DocRegistry[r].delugeFunctions.get(t)),o=t,c=(s.returntype,s.arguments),d=(document.createDocumentFragment(),document.createElement("span"));d.innerText=o,d.classList.add("formulaHelpLink"),d.addEventListener("mousedown",function(){UserAction.functionSelection(o)}),this.container.appendChild(d);var h=document.createElement("span");h.innerText="( ",this.container.appendChild(h);var l=0;if(null!=c){var p=c.length;for(l=0;l<p;l++){var u=c[l].name;l!=p-1&&(u+=" , ");var g=document.createElement("span");g.innerText=u,this.container.appendChild(g)}}var v=document.createElement("span");v.innerText=")",this.container.appendChild(v);var f=this.editor.range.startRow,m=this.editor.range.startCol;this.show();var C=this.container.getBoundingClientRect();e=C.height,n=C.width,UserAction.calcPosition(this.container,this.editor,f,m,n,e)}};var u=JSUtil.fn.once(function(t){s.draggable(t,{})});function g(t,e){var n=document.createElement("span");return n.innerText=t,n.classList.add("fParams"),e&&n.classList.add("fPadRight"),n}i.SuggestToolTip=p}(this);
!function(t){function e(){this.cell,this.rID,this.sheetID,this.version,this.row,this.col,this.mode}e.prototype={add:function(t,e,i,n,s,o){this.cell=n,this.rID=t,this.sheetID=e,this.version=i,this.row=s,this.col=o},getCell:function(){return this.cell},setMode:function(t){this.mode=t},getMode:function(){return this.mode},getRID:function(){return this.rID},getSheetID:function(){return this.sheetID},getVersion:function(){return this.version},getRow:function(){return this.row},getCol:function(){return this.col}},t.ZSClass.UIEditCellInfo=e}(this);
!function(t){var e=t.sPlusPlus,n=new ZSClass.UIEditCellInfo,l="",u={setValue:function(t){l=t},getValue:function(){return l},addEditCell:function(t,e,l,u,i,d){n.add(t,e,l,u,i,d),n.setMode(1)},clearEditCell:function(){n.setMode(0)},getEditCell:function(){return u.getEditStatus()?n:null},getEditStatus:function(){return n.getMode()}};e.view.CellEditor=u}(this);
!function(e){if(!e.isCanvasGrid){var a=sPlusPlus,t=a.data.Defaults.MAX_COL,o=e.ZSConstants.ActionConstants,n=(e.JSUtil.Math,e.ZSClass.Range),r=(ZSClass.CellDecorator,e.ZSEvents),s=r.topic,i=r.Groups,l=r.Names,v=e.ZSClass.UIPaneComponent.prototype;v.setConditionalStyle=function(e,t,o,n,r,s,i,l){var v=this.pane,C=a.data.getWorkBook(e,t).getSheetObj(n),d=new ZSClass.Range(v.iHave.startRow,v.iHave.startCol,v.iHave.endRow,v.iHave.endCol);for(var R in r){var g=[];for(var w in r[R])g.push(r[R][w]);var p=d.getIntersectingRange(new ZSClass.Range(g[0],g[1],g[2],g[3])),h=p.startRow,f=p.startCol,u=p.endRow,S=p.endCol,H=g[4];for(w=h;w<=u;w++){l&&!l[w]&&(l[w]=[]);for(var c=f;c<=S;c++){var k=v.getCellRef(e,n,t,w,c);if(k){var D=C.Merge.isXists(w,c);D&&D&&!D.isRoot&&this.pane.mergeHolder.insert(e,n,t,D.root,null,s,i,this.pane);var m=k.getData();if(l&&(m.ConditionalFormat=H,l[w][c]=H),m.ConditionalFormat){l||(m.ConditionalFormat=[]);var O=new ZSClass.Range(h,f,u,S),Z=v.pushDomUtility(e,n,t,w,c,m,s,i,O);k&&v.CELLUtil.setCellStyleandData(k,m,null,null,null,null,w,c,Z,o,n)}}}}}return l},v.pushDOMChanges=function(e,t,n,r,s,i){if(r&&s){for(var l=this.pane,v=a.data.getWorkBook(e,n),C=v.getSheetObj(t),d=(new ZSClass.Range(l.iHave.startRow,l.iHave.startCol,l.iHave.endRow,l.iHave.endCol),{}),R={},g=(C.Row,C.Column,this.pushDOMRange(r,s)),w=r.length-1;w>=0;w--){var p=r[w],h=p[0]+p[1]-1,f=p[0];if(!(h<l.iHave.startRow||f>l.iHave.endRow)){f=Math.max(f,l.iHave.startRow);for(var u=h=Math.min(h,l.iHave.endRow);u>=f;u--)for(var S=s[p[2]],H=S.length-1;H>=0;H--){var c=S[H];if(c){var k=c[0]+c[1]-1,D=c[0];if(!(k<l.iHave.startCol||D>l.iHave.endCol)){D=Math.max(D,l.iHave.startCol);for(var m=k=Math.min(k,l.iHave.endCol);m>=D;m--){var O=c[2],Z=l.getCellRef(e,t,n,u,m),I=new ZSClass.Range(u,m,u,m),A=C.DataValidation.getIntersectedRanges(I);if(this.revokeLastAction&&this.revokeLastAction(e,t,n,i,A),Z&&O.length){var W=C.Merge.isXists(u,m);W&&W&&!W.isRoot&&this.pane.mergeHolder.insert(e,t,n,W.root,null,R,d,this.pane);var M=Z.data.ConditionalFormat;C.MaxUsedRow=u>C.MaxUsedRow?u:C.MaxUsedRow,C.MaxUsedCol=m>C.MaxUsedCol?m:C.MaxUsedCol;var L={ActualValue:O[0],DisplayValue:O[1],Formula:O[2],Format:v.CellStyle.getMappedKey(O[3]),ConditionalFormat:M,CellComment:O[5],Hyperlink:O[6],CellType:O[7],patternColor:O[8],Pattern:O[9],IsContentValid:O[10],hasLink:O[11],isCheckbox:O[O.length-1],Picklist:O[12],repeatIndex:O[13],repeatChar:O[14]};Z.setData(L);var U=this.ClientCache.get(i);if(U){var y=U.ACTION;if(this.ClientCache.remove(i),y!==o.CLEARALL&&y!==o.CLEARSTYLES&&y!==o.CLEARCONTENTS&&"SUBMIT"!==y)continue}var E=l.pushDomUtility(e,t,n,u,m,L,R,d,g);Z&&l.CELLUtil.setCellStyleandData(Z,L,null,null,null,null,u,m,E,i,t)}}}}}}}l.setBorderCache(e,t,n,R,d)}else Logger.log("EMPTY DATA RESPONSE",r,s)},v.pushDOMRange=function(e,a){var t=e[e.length-1],o=t[0]+t[1]-1,n=a[t[2]],r=n[n.length-1][0]+n[n.length-1][1]-1,s=e[0][0],i=a[e[0][2]][0][0];return new ZSClass.Range(s,i,o,r)},v.pushFaultyChanges=function(e,o,n,r,s){var i=this.pane,l=(a.data.getWorkBook(e,n),new ZSClass.Range(i.iHave.startRow,i.iHave.startCol,i.iHave.endRow,i.iHave.endCol));for(var v in r){(C=new ZSClass.Range(r[v][0],r[v][1],r[v][2],r[v][3])).intersects(l)&&i.updateCells(e,o,n,"ROW",C.startRow,C.startCol,C.endRow,C.endCol)}for(var v in s){var C,d=parseInt(s[v]/t),R=s[v]%t;(C=new ZSClass.Range(d,R,d,R)).intersects(l)&&i.updateCells(e,o,n,"ROW",C.startRow,C.startCol,C.endRow,C.endCol)}},v.pushCfChanges=function(e,o,n,r,s,i,l){var v=this.pane,C={},d={};r&&this.setConditionalStyle(e,n,l,o,r,d,C,{}),v.setBorderCache(e,o,n,d,C);a.data.getWorkBook(e,n);var R=new ZSClass.Range(v.iHave.startRow,v.iHave.startCol,v.iHave.endRow,v.iHave.endCol);for(var g in s){(w=new ZSClass.Range(s[g][0],s[g][1],s[g][2],s[g][3])).intersects(R)&&v.updateCells(e,o,n,"ROW",w.startRow,w.startCol,w.endRow,w.endCol)}for(var g in i){var w,p=parseInt(i[g]/t),h=i[g]%t;(w=new ZSClass.Range(p,h,p,h)).intersects(R)&&v.updateCells(e,o,n,"ROW",w.startRow,w.startCol,w.endRow,w.endCol)}},v.insertSparklines=function(e,t,o,r){for(var v=a.data.getWorkBook(e,o).getSheetObj(t),C=a.view.getActiveGridID(),d=(a.view.getGridComponent(C),a.view.getSheetState(C,t),this.pane),R=v.sparklines.RangeList.getAllNodes(),g=[],w=0;w<r.length;w++){var p=r[w];for(var h in R){var f=R[h].properties;if(f.id==p)for(var u=f.outputRange,S=new ZSClass.Range(d.iHave.startRow,d.iHave.startCol,d.iHave.endRow,d.iHave.endCol),H=0;H<u.length;H++){var c=u[H];g.push(new n(c[0],c[1],c[2],c[3]));for(var k=c[0];k<=c[2];k++)for(var D=c[1];D<=c[3];D++)k>=S.startRow&&D>=S.startCol&&k<S.endRow&&D<S.endCol&&d.updateCells(e,t,o,"ROW",k,D,k,D)}}}s.publish(i.UI,l.SidePanel.Sparklines.CREATE)},v.changeSparklineData=function(e,t,o,n){for(var r=a.view.getActiveGridID(),s=a.view.getGridComponent(r),i=this.pane,l=new ZSClass.Range(i.iHave.startRow,i.iHave.startCol,i.iHave.endRow,i.iHave.endCol),v=0;v<n.length;v++){var C=n[v],d=C[0][0],R=C[0][1],g=C[0][2];if(d>=l.startRow&&R>=l.startCol&&d<l.endRow&&R<l.endCol){s.getCellRef(e,t,o,d,R);i.updateCells(e,g,o,"ROW",d,R,d,R)}}},v.applySparklineProperties=function(t,o,n,r){for(var s=a.data.getWorkBook(t,n).getSheetObj(o),i=a.view.getActiveGridID(),l=(a.view.getGridComponent(i),this.pane),v=s.sparklines,C=new ZSClass.Range(l.iHave.startRow,l.iHave.startCol,l.iHave.endRow,l.iHave.endCol),d=0;d<r.length;d++)for(var R=r[d][0],g=v.getRootCellInfo(R.sr,R.sc)[0].properties.outputRange,w=0;w<g.length;w++)for(var p=g[w],h=p[0];h<=p[2];h++)for(var f=p[1];f<=p[3];f++)h>=C.startRow&&f>=C.startCol&&h<C.endRow&&f<C.endCol&&this.pane.updateCells(t,o,n,"ROW",h,f,h,f);e.JSUtil.SparklinePool.highlightRanges(t,o,n)},v.editSparklinesGroup=function(e,t,o,n){for(var r=a.data.getWorkBook(e,o).getSheetObj(t),s=a.view.getActiveGridID(),i=a.view.getGridComponent(s),l=this.pane,v=new ZSClass.Range(l.iHave.startRow,l.iHave.startCol,l.iHave.endRow,l.iHave.endCol),C=r.sparklines.getAllRanges(),d={},R=0;R<n.length;R++){d[(w=n[R])[0]]=!0}for(var g in C){var w;if(1!=d[(w=C[g].properties).id])for(var p=w.outputRange,h=0;h<p.length;h++)for(var f=p[h],u=f[0];u<=f[2];u++)for(var S=f[1];S<=f[3];S++)if(u>=v.startRow&&S>=v.startCol&&u<v.endRow&&S<v.endCol){i.getCellRef(e,t,o,u,S);l.updateCells(e,t,o,"ROW",u,S,u,S)}}},v.removeSparklines=function(t,o,n,r){for(var s=a.view.getActiveGridID(),i=(t=a.view.getResourceID(s),n=a.view.getVersionID(s),a.data.getWorkBook(t,n).getSheetObj(o),this.pane),l=new ZSClass.Range(i.iHave.startRow,i.iHave.startCol,i.iHave.endRow,i.iHave.endCol),v=0;v<r.length;v++)for(var C=r[v],d=C[0];d<=C[2];d++)for(var R=C[1];R<=C[3];R++)d>=l.startRow&&R>=l.startCol&&d<l.endRow&&R<l.endCol&&i.updateCells(t,o,n,"ROW",d,R,d,R);e.JSUtil.SparklinePool.highlightRanges(t,o,n)},v.sparklineUndo=function(e,t,o,n){for(var r=a.view.getActiveGridID(),s=(e=a.view.getResourceID(r),o=a.view.getVersionID(r),a.data.getWorkBook(e,o).getSheetObj(t),this.pane),i=new ZSClass.Range(s.iHave.startRow,s.iHave.startCol,s.iHave.endRow,s.iHave.endCol),l=0;l<n.length;l++)for(var v=n[l],C=v[0];C<=v[2];C++)for(var d=v[1];d<=v[3];d++)C>=i.startRow&&d>=i.startCol&&C<i.endRow&&d<i.endCol&&s.updateCells(e,t,o,"ROW",C,d,C,d)},v.setSparklineExtremes=function(e,t,o,n){var r=a.view.getActiveGridID(),s=(e=a.view.getResourceID(r),o=a.view.getVersionID(r),a.data.getWorkBook(e,o).getSheetObj(t)),i=this.pane,l=new ZSClass.Range(i.iHave.startRow,i.iHave.startCol,i.iHave.endRow,i.iHave.endCol),v=s.sparklines.RangeList;for(var C in n){var d=n[C][0],R=v.getLeafNode(d.sr,d.sc,d.er,d.ec)[0].outputRange;for(C=0;C<R.length;C++)for(var g=R[C],w=g[0];w<=g[2];w++)for(var p=g[1];p<=g[3];p++)w>=l.startRow&&p>=l.startCol&&w<l.endRow&&p<l.endCol&&this.pane.updateCells(e,t,o,"ROW",w,p,w,p)}},v.redrawRange=function(e,a,t,o){var n=this.pane,r=new ZSClass.Range(n.iHave.startRow,n.iHave.startCol,n.iHave.endRow,n.iHave.endCol);for(var s in o){var i=o[s],l=new ZSClass.Range(i[0],i[1],i[2],i[3]);l.intersects(r)&&(l=l.getIntersectingRange(r),this.pane.updateCells(e,a,t,"ROW",l.startRow,l.startCol,l.endRow,l.endCol))}}}}(this);
!function(e){if(!e.isCanvasGrid){var t=sPlusPlus,a=t.data.Defaults.MAX_COL,l=e.ZSConstants.ActionConstants,i=e.ZSConstants.CommandConstants,n=e.JSUtil.Math,o=(e.ZSClass.Range,ZSClass.CellDecorator),r=e.UserAction,s=e.ZSClass.UIPaneComponent.prototype,d=0,c=1,C=4,g=5,L=6,v=7,u=8,f=9,b=10,D=12,O=13;s.modifyPivot=function(e,a,l,n){var o=t.data.getWorkBook(e,l).PivotCollection,r=t.view.getActiveGridID();a=t.view.getSheetID(r);for(var s in n){var d=o.get(s)[i.TARGET];d[0]===a&&this.ClientFirstActions(e,a,l,61,d[1],d[2],d[3],d[4],1)}},s.ClientFirstActions=function(r,s,S,R,h,E,m,k,M){var y,U=t.data.getWorkBook(r,S).getSheetObj(s),p=this,I=this.pane,B=t.view.getActiveGridID(),F=["DisplayValue","ActualValue","Format","Formula","CellComment","Hyperlink","CellType","IsContentValid","hasLink","isCheckbox"],T=t.data.getWorkBook(r,S),A=T.getSheetObj(s),w=R.action?R.action:R;switch(w){case"SUBMIT":y=function(a,l,n,d,c,C){var g,L="",v=new ZSClass.Range(c,C,c,C);if(U.ArrayFormula&&(g=U.ArrayFormula.getIntersectedRanges(v)),!g.length){if(t.view.fetchCellData(r,s,S,c,C,F,B,function(e){L=e[c][C]},function(t){e.ZSClass.Logger.log("Cell Content couldnt be retrieved",t)}),L){L&&(L.DisplayValue=M,L.ActualValue=M,L.Formula=M);var u,f=L.Format?L.Format:"Default",b=T.CellStyle.getStyleDef(f),D=a.getDOM();D.innerHTML="";var O=a.data.ConditionalFormat;if(O)for(var R=0;O.length&&R<O.length;R++){var h=O[R];h[i.ICONSET]&&(D=I.CELLUtil.setIconSet(D,h[i.ICONSET])),h[i.ICONSET]&&(u=h[i.ICONSET][3]),h[i.COLORSCALE]&&(u=h[i.COLORSCALE][2])}if(!u){I.CELLUtil.setCellValue(D,M);var E=a.getDOM().classList;isNaN(M)||(E.add("tar"),"STRING"!=L.CellType&&"start"!=b[9]||E.remove("tar"))}U.Picklist.isXists(c,C)&&o.drawPicklist(r,s,S,D,c,C,!1),U.sparklines.isXists(c,C)&&o.drawSparkline(s,D,c,C)}}};break;case l.COLOR:y=function(l,i,c,C,g,L){var v=new ZSClass.Range(g,L,g,L),u="";t.view.fetchCellData(r,s,S,g,L,F,B,function(e){var t=(u=e[g][L]).Format||A.ColStyleNames.getStyle(L)||"Default",a=JSUtil.Object.clone(T.CellStyle.getStyleDef(t),!0);a[d]=M,a=ZSClass.CellDecorator.getStyle(a,u),I.CELLUtil.setBGColor(l.getDOM(),a[d])},function(t){e.ZSClass.Logger.log("Cell Content couldnt be retrieved",t)});var f=o.getCellStyleDef(r,s,S,u,L);M="transparent"===M?"":M,f[0]=M,f=o.getStyle(f,u);var b={},D={},O=I.pushDomUtility(r,s,S,g,L,u,b,D,v,f),R=I.getCellRef(r,s,S,g,L);if(O[11]&&I.CELLUtil.setCellBorder(g,L,R.getDOM(),O[11],s),U.Merge.isXists(g,L)){var h=U.Row,E=U.Column,m=h.Visibility.prevNonHidden(g),k=E.hidden.prevNonHidden(L),y=n.hash(m,L,a),p=n.hash(g,k,a);I.getBorderMergeLeft(r,s,S,v.endRow,v.endCol,D[p],g,L,D),I.getBorderMergeTop(r,s,S,v.endRow,v.endCol,b[y],g,L,b)}I.setBorderCache(r,s,S,b,D)};break;case l.TEXTCOLOR:y=function(a,l,i,n,o,d){var C="";t.view.fetchCellData(r,s,S,o,d,F,B,function(e){var t=(C=e[o][d]).Format||A.ColStyleNames.getStyle(d)||"Default",l=JSUtil.Object.clone(T.CellStyle.getStyleDef(t),!0);l[c]=M,l=ZSClass.CellDecorator.getStyle(l,C),I.CELLUtil.setForeColor(a.getDOM(),l[c])},function(t){e.ZSClass.Logger.log("Cell Content couldnt be retrieved",t)})};break;case l.FONTFAMILY:y=function(e,t,a,l,i,n){I.CELLUtil.setFontFamily(e.getDOM(),M)};break;case l.BOLD:y=function(e,t,a,l,i,n){var o=e.getDOM().classList;0==M?o.remove("fwb"):o.add("fwb"),e.getDOM().classList=o};break;case l.ITALIC:y=function(e,t,a,l,i,n){var o=e.getDOM().classList;0==M?o.remove("fsi"):o.add("fsi"),e.getDOM().classList=o};break;case l.STRIKETHROUGH:y=function(e,t,a,l,i,n){var o=e.getDOM().classList;0==M?o.contains("tdsu")?(o.remove("tdsu"),o.add("tdu")):o.remove("tds"):o.add(o.contains("tdu")?"tdsu":"tds"),e.getDOM().classList=o};break;case l.UNDERLINE:y=function(e,t,a,l,i,n){var o=e.getDOM().classList;0==M?o.contains("tdsu")?(o.remove("tdsu"),o.add("tds")):o.remove("tdu"):o.add(o.contains("tds")?"tdsu":"tdu"),e.getDOM().classList=o};break;case l.FONTSIZE:y=function(e,t,a,l,i,n){I.CELLUtil.setFontSize(e.getDOM(),M)};break;case l.HALIGN:y=function(e,t,a,l,i,n){var o=void 0!=e.data.repeatIndex&&-1!=e.data.repeatIndex,d=I.getCellRef(r,s,S,i,n),c=!(!d||!d.data)&&d.data.isCheckbox,C=e.getDOM().classList;if(C.remove("tac","tar"),c)C.add("tac");else if(o)C.add("tar");else switch(M){case"center":C.add("tac");break;case"right":C.add("tar")}};break;case l.VALIGN:y=function(e,t,a,l,i,n){var o=I.getCellRef(r,s,S,i,n),d=!(!o||!o.data)&&o.data.isCheckbox,c=e.getDOM().classList;if(c.remove("vab","vam"),d)c.add("vam");else switch(M){case"middle":case"vcenter":c.add("vam");break;case"bottom":case"vbottom":c.add("vab")}};break;case l.ALIGN:y=function(e,t,a,l,i,n){var o=I.getCellRef(r,s,S,i,n),d=!(!o||!o.data)&&o.data.isCheckbox,c=e.getDOM().classList;if(c.remove("tac","tar","vam","vab"),d)c.add("tac","vam");else switch(parseInt(M)){case 6:c.add("tac");break;case 7:c.add("tar");break;case 9:c.add("vam");break;case 10:c.add("tac","vam");break;case 11:c.add("tar","vam");break;case 13:c.add("vab");break;case 14:c.add("tac","vab");break;case 15:c.add("tar","vab")}};break;case l.CELL_COMMENT:y=function(e,t,a,l,i,n){switch(M){case"add":e.getDOM().classList.add("cellComment");break;case"remove":e.getDOM().classList.remove("cellComment")}};break;case l.WRAP:y=function(e,t,a,l,i,n){var o=e.getDOM().classList;0==M?o.remove("wrap"):o.add("wrap"),e.getDOM().classList=o};break;case l.CLEARALL:y=function(e,t,a,l,i,n){e.getDOM().innerHTML="",I.CELLUtil.clearCellStyles(e.getDOM(),s)};break;case l.CLEARCONTENTS:y=function(e,t,a,l,i,n){e.getDOM().innerHTML=""};break;case l.CLEARSTYLES:y=function(a,l,i,n,d,c){var C=new ZSClass.Range(d,c,d,c);I.CELLUtil.clearCellStyles(a.getDOM(),s);var g="";t.view.fetchCellData(r,s,S,d,c,F,B,function(e){g=e[d][c]},function(t){e.ZSClass.Logger.log("Cell Content couldnt be retrieved",t)});var L=o.getCellStyleDef(r,s,S,g,c);(L=o.getStyle(L,g))[0]="",L[11]=["","","",""],p.CFAStyleUtil(r,s,S,d,c,g,C,L)};break;case l.HYPERLINK:y=function(e,t,a,l,i,n){var o=e.getDOM().childNodes[0];o&&I.CELLUtil.setCellValue(e.getDOM(),o.textContent)};break;case l.CHECKBOX_ADD:y=function(e,t,a,l,i,n){"STRING"!=e.getData().CellType&&I.CELLUtil.drawCheckBox(r,s,S,i,n,e.getDOM(),e.getData().DisplayValue,e.getData())};break;case l.CHECKBOX_EDIT:y=function(e,t,a,l,i,n){var o=I.getCellRef(r,s,S,i,n);!(!o||!o.data)&&o.data.isCheckbox&&I.CELLUtil.drawCheckBox(r,s,S,i,n,e.getDOM(),0==M?"FALSE":"TRUE",e.getData())};break;case l.CHECKBOX_CLEAR:y=function(a,l,i,n,d,c){var R=I.getCellRef(r,s,S,d,c);if(!(!R||!R.data)&&R.data.isCheckbox){var h=a.getDOM();t.view.fetchCellData(r,s,S,d,c,F,B,function(e){var t=e[d][c],a=o.getCellStyleDef(r,s,S,t,c);a=o.getStyle(a,t.ConditionalFormat),h.innerHTML="",h.classList.remove("tac","tar","vam","vab");var l=!0===a[D],i=a[O],n=h;i&&(n=I.CELLUtil.setIconSet(h,i)),I.CELLUtil.setCellValue(n,t.DisplayValue),I.CELLUtil.setFontWeight(h,a[C]),I.CELLUtil.setFontStyle(h,a[g]),I.CELLUtil.setTextDecoration(h,a[L],a[v]),I.CELLUtil.setWrap(h,a[u]),I.CELLUtil.setHAlign(h,a[f],t,l),I.CELLUtil.setVAlign(h,a[b])},function(t){e.ZSClass.Logger.log("Cell Content couldnt be retrieved",t)})}};break;case"RESIZEROW":I.resizeRow(r,s,S,h,m+1-h,M),p.protectHolder.onResize(r,s,S,"ROW",h,m+1-h),p.PivotHolder.onResize(r,s,S,"ROW",h,m+1-h);break;case"RESIZECOL":I.resizeCol(r,s,S,E,k+1-E,M),p.protectHolder.onResize(r,s,S,"COLUMN",E,k+1-E),p.PivotHolder.onResize(r,s,S,"COLUMN",E,k+1-E)}if(y&&I.iterateRange(r,s,S,h,E,m,k,function(){},y.bind(I),function(e,t,a,l,i,n){t===i&&a===n&&y.call(I,e,null,null,null,i,n);var o,r=JSUtil.Object.clone(e.data,!0);r.rightBorder&&(1==(o=T.CellStyle.getStyleDef(r.rightBorder.Format)[11]).length&&(o[1]=o[0],o[2]=o[0],o[3]=o[0]),I.CELLUtil.setBorderRight(e.getDOM(),o[1],s)),r.bottomBorder&&(1==(o=T.CellStyle.getStyleDef(r.bottomBorder.Format)[11]).length&&(o[1]=o[0],o[2]=o[0],o[3]=o[0]),I.CELLUtil.setBorderBottom(e.getDOM(),o[3],s))}),"RESIZEROW"==w&&(p.PivotFilter&&p.PivotFilter.onResizeRow(r,s,S,M,h),p.DataFilter&&p.DataFilter.onResizeRow(r,s,S,M,h)),"RESIZECOL"==w&&(p.PivotFilter&&p.PivotFilter.onResizeCol(r,s,S,M,E),p.DataFilter&&p.DataFilter.onResizeCol(r,s,S,M,E)),w==l.BORDERS){var N=R.borderStyle;function H(e,t,a,l,i,n){I.CELLUtil.setBorderBottom(e.getDOM(),N,s)}function Z(e,t,a,l,i,n){I.CELLUtil.setBorderRight(e.getDOM(),N,s)}if(12==M||25==M||24==M){function P(e,t,a,l,i,n){24==M&&i==m||I.CELLUtil.setBorderBottom(e.getDOM(),N,s),24==M&&n==k||I.CELLUtil.setBorderRight(e.getDOM(),N,s)}12==M&&(N="none"),I.iterateRange(r,s,S,h,E,m,k,null,P.bind(I),P.bind(I)),24!=M&&I.iterateRange(r,s,S,h-1,E,h-1,k,null,H.bind(I),H.bind(I)),24!=M&&I.iterateRange(r,s,S,h,E-1,m,E-1,null,Z.bind(I),Z.bind(I))}13!=M&&19!=M&&20!=M&&23!=M||I.iterateRange(r,s,S,h,E-1,m,E-1,null,Z.bind(I),Z.bind(I)),14!=M&&19!=M&&23!=M||I.iterateRange(r,s,S,h,k,m,k,null,Z.bind(I),Z.bind(I)),16!=M&&18!=M&&19!=M&&22!=M&&23!=M&&27!=M&&28!=M||I.iterateRange(r,s,S,h-1,E,h-1,k,null,H.bind(I),H.bind(I)),17!=M&&18!=M&&19!=M&&26!=M&&27!=M&&28!=M&&29!=M||((26==M||27==M)&&(N="double 3px #000"),(28==M||29==M)&&(N="solid 2px #000"),I.iterateRange(r,s,S,m,E,m,k,null,H.bind(I),H.bind(I))),20==M&&I.iterateRange(r,s,S,h,E,m,k,null,Z.bind(I),Z.bind(I)),22!=M&&23!=M||I.iterateRange(r,s,S,h,E,m,k,null,H.bind(I),H.bind(I))}},s.CFAStyleUtil=function(e,l,i,o,r,s,d,c){var C=t.data.getWorkBook(e,i).getSheetObj(l),g=this.pane,L={},v={},u=g.pushDomUtility(e,l,i,o,r,s,L,v,d,c),f=g.getCellRef(e,l,i,o,r);if(u[11]&&g.CELLUtil.setCellBorder(o,r,f.getDOM(),u[11],l),C.Merge.isXists(o,r)){var b=C.Row,D=C.Column,O=b.Visibility.prevNonHidden(o),S=D.hidden.prevNonHidden(r),R=n.hash(O,r,a),h=n.hash(o,S,a);g.getBorderMergeLeft(e,l,i,d.endRow,d.endCol,v[h],o,r,v),g.getBorderMergeTop(e,l,i,d.endRow,d.endCol,L[R],o,r,L)}g.setBorderCache(e,l,i,L,v)},s.DVInterrupt=function(e,t,a,l){l&&(this.revokeLastAction=function(e,t,a,l,i){for(k in i)"INTERRUPT"==i[k].properties.messageType&&(r.revokeLastAction(e,t,a,l),this.revokeLastAction=void 0)})},s.highlightInvalidCells=function(e,a,l,i){t.data.getWorkBook(e,l).getSheetObj(a);var n=this.pane;for(var o in i){var r=i[o],s=n.getCellRef(e,a,l,r[0],r[1]);s&&s.getDOM().classList.add("highlightInvalid")}}}}(this);
!function(t){var i,e,s=t.sPlusPlus,n=3,a=t.ZSClass,h=a.Editors.FormulaEditor,o=""===document.createElement("detect").style.zoom;function l(a,h,o){var l=Math.max(this.getZoom(),1),r=Math.round(this.Container.offsetHeight-n*l),d=Math.round(this.Container.offsetWidth-n*l),c=function n(a,h,o,l){var r=this.getZoom();if("center"!=this.Editor.style.textAlign&&(this.minWidth<l||this.scrollX<0)){var d=s.data.getWorkBook(a,o),c=d.getSheetObj(h),C=s.view.getActiveGridID(),g=sPlusPlus.view.getGridComponent(C),u=!!t.isCanvasGrid&&g.getFlip(),m=g.interacter;if(u)switch(this.Editor.style.textAlign){case"left":t.isCanvasGrid?(e=m.getColX(this.range.endCol+1),i=m.getColX(this.range.startCol-this.expandedColCount)):(e=c.Column.auxiliaryAxis.getPos(this.range.endCol+1),i=c.Column.auxiliaryAxis.getPos(this.range.startCol-this.expandedColCount));break;case"right":t.isCanvasGrid?(e=m.getColX(this.range.endCol+1+this.expandedColCount),i=m.getColX(this.range.startCol)):(e=c.Column.auxiliaryAxis.getPos(this.range.endCol+1+this.expandedColCount),i=c.Column.auxiliaryAxis.getPos(this.range.startCol))}else switch(this.Editor.style.textAlign){case"right":t.isCanvasGrid?(e=m.getColX(this.range.endCol+1),i=m.getColX(this.range.startCol-this.expandedColCount)):(e=c.Column.auxiliaryAxis.getPos(this.range.endCol+1),i=c.Column.auxiliaryAxis.getPos(this.range.startCol-this.expandedColCount));break;case"left":t.isCanvasGrid?(e=m.getColX(this.range.endCol+1+this.expandedColCount),i=m.getColX(this.range.startCol)):(e=c.Column.auxiliaryAxis.getPos(this.range.endCol+1+this.expandedColCount),i=c.Column.auxiliaryAxis.getPos(this.range.startCol))}var p=Math.ceil((e-i)*r);return p<=this.maxWidth?(this.minWidth=p,this.expandedColCount++,n.call(this,a,h,o,l)):this.minWidth=this.maxWidth,!0}}.call(this,a,h,o,d);((function i(e,n,a,h){var o=this.getZoom();if("center"!=this.Editor.style.textAlign&&this.minHeight<h){var l=s.view.getActiveGridID(),r=sPlusPlus.view.getGridComponent(l),d=r.interacter,c=s.data.getWorkBook(e,a),C=c.getSheetObj(n);if(t.isCanvasGrid)var g=d.getRowY(this.range.endRow+this.expandedRowCount),u=d.getRowY(this.range.startRow);else var g=C.Row.auxiliaryAxis.getPos(this.range.endRow+this.expandedRowCount),u=C.Row.auxiliaryAxis.getPos(this.range.startRow);var m=Math.ceil((g-u)*o);return m<this.maxHeight?(this.minHeight=m,this.expandedRowCount++,i.call(this,e,n,a,h)):this.minHeight=this.maxHeight,!0}}).call(this,a,h,o,r)||c)&&this.setDimension(this.minWidth,this.minHeight,this.maxWidth,this.maxHeight)}function r(i,e){(function(i){var e=document.createElement("div"),s=t.document.createElement("div");s.className="cFC",e.appendChild(s),i.appendChild(e);var n=t.document.createElement("div");n.className="cF ZsWrdBreak",s.appendChild(n);var a=t.document.createElement("div");a.textContent="A1",a.className="cFL",s.appendChild(a);var h=t.document.createElement("div");h.className="suggestBox",s.appendChild(h);var o=t.document.createElement("div");o.classList.add("picklistBox","suggestBox"),s.appendChild(o);var l=t.document.createElement("div");l.id="datePickerContainer",l.classList.add("datePickerContainer"),s.appendChild(l);var r=t.document.createElement("div");r.className="formulaSyntax",r.style.display="none",s.appendChild(r),this.Label=a,this.Editor=n,this.Container=s,this.parent1=e,this.SuggestContainer=h,this.PicklistContainer=o,this.ToolTipContainer=r,this.DatePickerContainer=l,this.isEnabled=!0,this.inView=!0,this.turnOff(),this.hideLabel()}).call(this,i),h.call(this,this.Editor,!0),this.addListeners(e)}r.prototype=new h;var d={place:function(i,e,n,a,h,o,l,r,d,c){a-=e,h-=n;var C,g,u=s.view.getActiveGridID(),m=s.view.getGridComponent(u),p=!!t.isCanvasGrid&&m.getFlip();switch(this.Editor.style.textAlign){case"right":var x=r-(C=p?r-a:a+o);break;case"center":C=2*Math.min(a,r-(a+o))+o,a=p?r-(a+o/2):a+o/2;break;case"left":default:a=r-(C=p?a+o:r-a)}(function(t,i,e,s,n,a,h,o,l){this.scrollX=i,this.scrollY=e,this.range=t,this.minWidth=a,this.minHeight=h,this.maxWidth=o,this.maxHeight=l,this.left=s,this.top=n,this.expandedRowCount=0,this.expandedColCount=0}).call(this,i,e,n,a,h,o,l,C=c?o:C,g=d-h),this.setPosition(a,h,x),this.setDimension(o,l,C,g),this.hideLabel()},remove:function(){this.Container.classList.add("hide");var t=this.Editor;setTimeout(function(){t.focus()},0)},turnOn:function(){this.isEnabled||(this.show(),this.isEnabled=!0,this.focus())},turnOff:function(){if(this.isEnabled){this.hide(),this.value="";var t=this.Editor;setTimeout(function(){t.focus()},0),this.isEnabled=!1}},show:function(){this.inView||(this.Container.classList.remove("hide"),this.inView=!0)},hide:function(){this.inView&&(this.Container.classList.add("hide"),this.inView=!1)},setDimension:function(t,i,e,s){var a=this.Container.style;a.minWidth=t+n+"px",a.minHeight=i+n+"px",a.maxWidth=e+2+"px",a.maxHeight=s+2+"px"},setValue:function(t){this.value=t},getValue:function(){return this.value},showLabel:function(t){this.Label.style.display="",this.Label.textContent=t,this.labelInView=!0},hideLabel:function(){this.Label.style.display="none",this.labelInView=!1},setStyle:function(i,e){var s=this.Editor.style;s.background=e[0]?e[0]:"",s.color=e[1]?e[1]:"",s.fontSize=e[2]?e[2]+"pt":"",s.fontFamily=e[3]?e[3]:"",s.fontWeight=e[4]?e[4]:"",s.fontStyle=e[5]?e[5]:"",s.textDecoration=(e[6]?"line-through":"")+(e[7]?" underline":"");var n=!!t.isCanvasGrid&&t.checkRTL(i.DisplayValue);switch(e[9]){case"start":s.textAlign="left";break;case"center":s.textAlign="center";break;case"end":s.textAlign="right";break;default:"FLOAT"===i.CellType||"NUMBER"===i.CellType||"CURRENCY"===i.CellType||"DATE"===i.CellType||"TIME"===i.CellType||"DATETIME"===i.CellType||"PERCENTAGE"===i.CellType||"FRACTION"===i.CellType||"SCIENTIFIC"===i.CellType||n?s.textAlign="right":s.textAlign="left"}"center"==e[9]?(this.Editor.parentElement.classList.add("center"),this.parent1.classList.add("cFCC")):(this.Editor.parentElement.classList.remove("center"),this.parent1.classList.remove("cFCC")),n?this.Editor.classList.add("rtl"):this.Editor.classList.remove("rtl")},setZoom:function(t,i){this.zoomVal=t;var e=this.Editor.style;if(o)e.zoom=t;else{var s="center"===i?"translateX(-50%)":"";e.transform=s+"scale("+t+")",e.transformOrigin="0 0"}},getZoom:function(){return this.zoomVal},setLeft:function(t){var i=this.Container.style;i.right="",i.left=t-2+"px"},setRight:function(t){var i=this.Container.style;i.left="",i.right=t-2+"px"},setTop:function(t){this.Container.style.top=t-2+"px"},setPosition:function(t,i,e){"right"==this.Editor.style.textAlign?this.setRight(e):this.setLeft(t),this.setTop(i)},adjustDimensions:function(t,i,e){!this.labelInView&&l.call(this,t,i,e)},updateMaxWidthHeight:function(t,i){(this.left>t||this.top>i)&&(this.left>t&&(this.left=t-this.minWidth),this.top>i&&(this.top=i-this.minHeight),this.setPosition(this.left,this.top,this.right),this.showLabel(this.range.getLabel())),this.maxWidth=t-this.left,this.maxHeight=i-this.top,this.minWidth=this.minWidth>this.maxWidth?this.maxWidth:this.minWidth,this.minHeight=this.minHeight>this.maxHeight?this.maxHeight:this.minHeight,this.setDimension(this.minWidth,this.minHeight,this.maxWidth,this.maxHeight)},appendTo:function(t){this.parent!==t&&(t.appendChild(this.parent1),this.parent=t)}};for(var c in d)r.prototype[c]=d[c];a.CellEditor=r}(this);
!function(e){var t=e.sPlusPlus,i=e.sPlusPlus.view.Events.Key.Entry.RangeEdit.Context.keyDown,a=e.ZSConstants.JSKeyCode;function r(e,i,a,r){if(!e.repeat){e.preventDefault();var s=t.view.getActiveGridID(),n=t.view.getSelectedSheets(s);UserAction.CLEARCONTENTS(i,n,r)}}function s(i,a,r,s){if(!i.repeat){var n=t.view.getActiveGridID(),o=(a=t.view.getResourceID(n),r=t.view.getSheetID(n),t.data.getWorkBook(a,s).getSheetObj(r)),g=t.view.getSheetState(n,r),l=g.getActiveRange(),v=t.view.getSelectedSheets(n),c=o.Merge.getInfo(l.startRow,l.startCol),S=c&&l.equals(c);if(!l.isSingle()&&!S){i.preventDefault();var w=new ZSClass.Range(l.startRow,l.startCol,l.startRow,l.endCol);e.UserAction.CalcFillDetails(a,v,s,g.getActiveRange(),w,!1,"copy")}}}function n(i,a,r,s){if(!i.repeat){var n=t.view.getActiveGridID(),o=(a=t.view.getResourceID(n),r=t.view.getSheetID(n),t.data.getWorkBook(a,s).getSheetObj(r)),g=t.view.getSheetState(n,r),l=g.getActiveRange(),v=t.view.getSelectedSheets(n),c=o.Merge.getInfo(l.startRow,l.startCol),S=c&&l.equals(c);if(!l.isSingle()&&!S){i.preventDefault();var w=new ZSClass.Range(l.startRow,l.startCol,l.endRow,l.startCol);return e.UserAction.CalcFillDetails(a,v,s,g.getActiveRange(),w,!1,"copy"),!1}}}i[a.DELETE]=r,i[a.BACKSPACE]=r,i[a.SUPER+"+"+a.D]=s,i[a.CTRL+"+"+a.D]=s,i[a.SUPER+"+"+a.R]=n,i[a.CTRL+"+"+a.R]=n,i[a.F4]=function(e){return!1}}(this);
!function(e){var t,r=e.sPlusPlus,i=e.ZSEvents,o=i.topic,n=i.Groups,E=i.Names,l=e.UserAction,S=e.ZSConstants.JSKeyCode,a=e.ZSClass,s=e.sPlusPlus.view.Events.Key,c=s.Entry.CellEditor.Context.keyDown;function u(e,t,i,l){var S=r.view.CellEditor,a=S&&S.getEditCell();if(!a)return!0;var s=t===a.getRID()&&i===a.getSheetID()&&l===a.getVersion();return o.publish(n.Gesture.Selector.CellEdit,E.GESTURE.ACTION.ENUMERATE,{RID:t,SHEETID:i,VERSION:l,isSubmittable:1}),s}function R(e,t,r,i){o.publish(n.Gesture.Selector.CellEdit,E.GESTURE.ACTION.ENUMERATE,{RID:t,SHEETID:r,VERSION:i,isSubmittable:1,ISCSE:!0})}function C(e,t,i){return r.view.CellEditor.getEditStatus()}function T(e,t,r,i){return!C()}function g(e,t,i,o){return r.data.getWorkBook(t,o).getSheetObj(i).activeCellData.isCheckbox}function I(t,i,o,n){var E=t.keyCode||t.which,a=r.view.getActiveGridID(),s=r.view.getSelectedSheets(a),c=r.view.getSheetState(a,o).getActiveCellRange();switch(E=E.toString()){case S.T:case S.Y:case S.ONE:l.CHECKBOX_EDIT(i,s,n,1),l.ScrollCellIntoView(i,o,n,c.startRow,c.startCol);break;case S.F:case S.N:case S.ZERO:l.CHECKBOX_EDIT(i,s,n,0),l.ScrollCellIntoView(i,o,n,c.startRow,c.startCol);break;case S.SPACE:!function(t,i,o,n){r.data.getWorkBook(i,n).getSheetObj(o);var E=r.view.getActiveGridID(),S=r.view.getSheetState(E,o),a=r.view.getSelectedSheets(E),s=S.getActiveCellRange(),c=r.view.getGridComponent(E).getCellRef(i,o,n,s.startRow,s.startCol);!(!c||!c.data)&&c.data.isCheckbox,r.view.fetchCellData(i,o,n,s.startRow,s.startCol,["DisplayValue"],E,function(e){var t="TRUE"===e[s.startRow][s.startCol].DisplayValue;l.CHECKBOX_EDIT(i,a,n,~~!t)},function(t){e.ZSClass.Logger.log("Cell content couldn't be retrieved",t)})}(0,i,s,n),l.ScrollCellIntoView(i,o,n,c.startRow,c.startCol)}}function v(e,t,r){o.publish(n.Gesture.Selector.CellEdit,E.GESTURE.ACTION.ACTUATE,{RID:e,SHEETID:t,VERSION:r})}function D(i,l,S,a){i.preventDefault(),v(l,S,a);var s,c=r.view.getActiveGridID(),u=r.view.getSheetState(c,S).getActiveCellRange();a=r.view.getVersionID(c);return r.view.fetchCellData(l,S,a,u.startRow,u.startCol,["DisplayValue","ActualValue","Format","Formula","CellComment","Hyperlink","CellType"],c,function(e){s=e[u.startRow][u.startCol],o.publish(n.Listener,E.CellAction.VALUE.SET,{RID:l,SHEETID:S,VERSION:a,ROW:u.startRow,COL:u.startCol,VALUE:s,FOCUS:!0})},function(t){e.ZSClass.Logger.log("Couldnt retrieve cell content",t)}),t=!1,!1}function A(e,t,i,o,n){e=r.view.getActiveGridID();var E=r.data.getWorkBook(t,o),l=(E.getSheetObj(i),r.view.getGridComponent(e).getCellRef(t,i,o,n.startRow,n.startCol));return!E.showFormulas&&"hide"==l.data.Formula}function d(e,t,i,o){return r.data.getWorkBook(e,i).getSheetObj(t).Pivot.isXists(o.startRow,o.startCol)}function O(e,t,i,l){var S=function(e,t,i,o){var n=r.data.getWorkBook(e,i),E=n.getSheetObj(t),l=n.ProtectedSheets.isSheetLocked(t),S=E.ProtectedRanges.isIntersecting(o);return l||S}(e,t,i,l),a=d(e,t,i,l),s=function(e,t,i,o){return r.data.getWorkBook(e,i).getSheetObj(t).activeCellData.isCheckbox}(e,t,i);return!A(r.view.getActiveGridID(),e,t,i,l)&&(!s&&(!S&&!a||(function(e){o.publish(n.Listener,E.ERROR.SHOW,{ERRORMSG:e})}(S?"ProtectedRange.alert.ProtectRangeMessage":a?"Error.Pivot.Table.Part.Change":""),!1)))}function P(e,i,o,n){var E=C();return!E&&(t=!1),l.flushSuggest(),E?u(0,i,o,n):function(e,t,i,o){if(g(0,t,i,o))return;var n=r.view.getActiveGridID(),E=r.view.getSheetState(n,i),l=E.getActiveRange(),S=E.getActiveCellRange();return!!(!l.isSingle()&&!l.equals(S)||function(e,t,i,o){var n=r.data.getWorkBook(e,i),E=n.getSheetObj(t),l=n.ProtectedSheets.isSheetLocked(t),S=E.ProtectedRanges.isIntersecting(o);return l||S}(t,i,o,S)||d(t,i,o,S)||A(n,t,i,o,S))||D(e,t,i,o)}(e,i,o,n)}function U(e,r,i,o){var n=C();if(l.flushSuggest(),!n||!t)return!n;u(0,r,i,o)}function f(e,t,r,i){return o.publish(n.Listener,E.CellAction.CELLSUGGESTION.RESET_MATCH),T()}function h(e,r,i){C()&&(t=!1)}function H(e,t,r,i){return h(),T()}o.register(n.Gesture.Selector.CellEdit,E.GESTURE.ACTION.DOWNINSIDE,h,"RID","SHEETID","VERSION"),c[S.ESC]=function(e,t,r,i){o.publish(n.Selector.BoundUpdate.CellEdit,E.Selection.BOUND_UPDATE.REMOVE,{RID:t,SHEETID:r,VERSION:i}),o.publish(n.Selector.BoundUpdate.Cell,E.Selection.BOUND_UPDATE.SHOW,{RID:t,SHEETID:r,VERSION:i}),o.publish(n.Selector.BoundUpdate.Range,E.Selection.BOUND_UPDATE.SHOW,{RID:t,SHEETID:r,VERSION:i})},c[S.CTRL+"+"+S.ENTER]=T,c[S.SUPER+"+"+S.A]=T,c[S.SUPER+"+"+S.C]=T,c[S.SUPER+"+"+S.V]=T,c[S.SUPER+"+"+S.SHIFT+"+"+S.V]=T,c[S.SUPER+"+"+S.X]=T,c[S.SUPER+"+"+S.DELETE]=T,c[S.SUPER+"+"+S.BACKSPACE]=T,c[S.SHIFT+"+"+S.SPACE]=T,c[S.SHIFT+"+"+S.DELETE]=T,c[S.SHIFT+"+"+S.BACKSPACE]=T,c[S.ALT+"+"+S.ENTER]=T,c[S.ALT+"+"+S.LEFT]=T,c[S.ALT+"+"+S.RIGHT]=T,c[S.ALT+"+"+S.UP]=T,c[S.ALT+"+"+S.DOWN]=T,c[S.LEFT]=U,c[S.UP]=U,c[S.RIGHT]=U,c[S.DOWN]=U,c[S.SHIFT+"+"+S.LEFT]=U,c[S.SHIFT+"+"+S.UP]=U,c[S.SHIFT+"+"+S.RIGHT]=U,c[S.SHIFT+"+"+S.DOWN]=U,c[S.SUPER+"+"+S.LEFT]=U,c[S.SUPER+"+"+S.UP]=U,c[S.SUPER+"+"+S.RIGHT]=U,c[S.SUPER+"+"+S.DOWN]=U,c[S.SUPER+"+"+S.SHIFT+"+"+S.LEFT]=U,c[S.SUPER+"+"+S.SHIFT+"+"+S.UP]=U,c[S.SUPER+"+"+S.SHIFT+"+"+S.RIGHT]=U,c[S.SUPER+"+"+S.SHIFT+"+"+S.DOWN]=U,c[S.TAB]=u,c[S.SHIFT+"+"+S.TAB]=u,c[S.SUPER+"+"+S.SHIFT+"+"+S.ENTER]=R,c[S.CTRL+"+"+S.SHIFT+"+"+S.ENTER]=R,c[S.PURE_PRINTABLE_CHAR]=function(e,i,o,n){if(g(0,i,o,n))return I(e,i,o,n),void e.preventDefault();var E=r.view.getActiveGridID();if(!A(E,i,o,n,r.view.getSheetState(E,o).getActiveCellRange())){if(!C()){v(i,o,n);var l=e.keyCode||e.which;t=S.EQUAL!==l}return!1}e.preventDefault()},c[S.F2]=function(e,i,o,n){var E=C();E&&(t=!1);var l=r.view.getActiveGridID(),S=r.view.getSheetState(l,o).getActiveCellRange();return!(E||!O(i,o,n,S))&&D(e,i,o,n)},c[S.ENTER]=P,c[S.SHIFT+"+"+S.ENTER]=P,c[S.PAGEUP]=T,c[S.PAGEDOWN]=T,c[S.DELETE]=f,c[S.BACKSPACE]=f,c[S.F9]=T,c[S.HOME]=H,c[S.END]=H,c[S.CTRL+"+"+S.HOME]=H,c[S.CTRL+"+"+S.END]=H,c[S.SHIFT+"+"+S.HOME]=H,c[S.SHIFT+"+"+S.END]=H,c[S.SUPER+"+"+S.HOME]=H,c[S.SUPER+"+"+S.END]=H,o.register(n.Gesture.Selector.Range,E.GESTURE.ACTION.START,function(){!a.RangePicker.isSelection()&&s.focusContext(s.Entry.CellEditor.Context)}),o.register(n.Gesture.Selector.CellEdit,E.GESTURE.ACTION.DOWN,function(){t=!1}),s.focusContext(s.Entry.CellEditor.Context)}(this);
!function(e){var t,i,n,r,o,s,a=e.sPlusPlus,l=e.ZSEvents,g=e.JSUtil,u=l.topic,c=l.Groups,E=l.Names,v=a.view.measures,S=e.ZSClass,d=(S.Range,S.CellEditor),D=document.querySelector(".sheetPaneContainer")||document.createElement("div"),I=S.RangePicker,C=I.register,R=e.ZSConstants.JSKeyCode,f=e.ZSConstants.I18N,w=""===document.createElement("detect").style.zoom;function A(e,t,i,n){if(n!==s){if(n?r.setStyle({},[]):r.range&&W(e,t,i,r.range),r.range){var o=k(e,t,i,r.range);M(e,t,i,r.range,o)}s=n}}var h={valueChanged:function(){var e=a.view.getActiveGridID(),t=a.view.getResourceID(e),i=a.view.getSheetID(e),n=a.view.getVersionID(e);_();var o=a.view.CellEditor.getValue();A(t,i,n,r.valueCheck(o)),u.publish(c.Listener,E.FormulaBar.UPDATE,{RID:t,SHEETID:i,VERSION:n,VALUE:{Formula:o,DisplayValue:o}}),u.publish(c.Listener,E.FormulaBar.Dialog.Update,{value:o}),r.adjustDimensions(t,i,n)},focus:function(){var t=e.sPlusPlus.view.Events.Key;t.focusContext(t.Entry.CellEditor.Context)},keydown:function(e){if(r.isEnabled)if(e.isComposing)e.stopPropagation();else{if(13==e.keyCode){var n=a.view.getActiveGridID(),o=a.view.getResourceID(n),s=a.view.getVersionID(n),l=a.view.CellEditor.getEditCell(),u=a.data.getWorkBook(o,s),c=u.getSheetObj(l.getSheetID());if(c.Picklist.isXists(r.range.startRow,r.range.startCol)){var E=r.getValue(),v=c.Picklist.getInfo(r.range.startRow,r.range.startCol);return void(void 0==u.Picklist.getPicklistById(v.properties.id).getItemIdForDisplayString(E)&&e.stopPropagation())}}if(57==e.keyCode){var S,d=r.getValue(),D=y.getCategory("Functions"),I=y.getCategory("Deluge");if(d&&d.startsWith("=")){S=(S=function(e){var t=[",",";","+","-","*","/","%","&","^","<",">","<=",">="," "];e=e.contains(")")?e.replace(new RegExp("\\)","gi"),""):e;for(var i=0;i<t.length;i++){var n=t[i];if(e.contains(n))return e=e.substring(e.lastIndexOf(n)+1)}return e}(S=d.contains("(")?d.substring(d.lastIndexOf("(")+1):d.substring(1))).trim();var C=D.getEntry(S.toUpperCase());if(C)q(r,C.text,!1,!1,!0);else{var f=I.getEntry(S.toUpperCase());f&&q(r,f.text,!1,!0,!0)}}}switch(g.Key.getKeyCombination(e)){case R.SUPER+"+"+R.SEMICOLON:var w=g.Date.currentDate(i,t);L.call(r,e,w);break;case R.SUPER+"+"+R.SHIFT+"+"+R.SEMICOLON:var A=g.Date.currentTime();L.call(r,e,A);break;case R.SUPER+"+"+R.ALT+"+"+R.SEMICOLON:var h=g.Date.currentDate(i,t)+" "+g.Date.currentTime();L.call(r,e,h);break;case R.PURE_PRINTABLE_CHAR:r.addListeners(N)}}},input:function(){m=!0},compositionstart:function(e){if(!r.isEnabled){var t=a.view.getActiveGridID(),i=a.view.getResourceID(t),n=a.view.getSheetID(t),o=a.view.getVersionID(t);u.publish(c.Gesture.Selector.CellEdit,E.GESTURE.ACTION.ACTUATE,{RID:i,SHEETID:n,VERSION:o})}},mousedown:function(e){if(r.isEnabled){var t=a.view.getActiveGridID(),i=a.view.getResourceID(t),n=a.view.getSheetID(t),o=a.view.getVersionID(t);u.publish(c.Gesture.Selector.CellEdit,E.GESTURE.ACTION.DOWNINSIDE,{RID:i,SHEETID:n,VERSION:o})}}};a.view.CellEditor.setBackFocus=function(){r.isEnabled||r.focus()};var T,m=!1,N={valueChanged:function(){clearTimeout(T),T=setTimeout(function(){var e=r.getValue(),t=r.selectionStart;u.publish(c.Listener,E.CellAction.CELLSUGGESTION.GET,{VALUE:e,SELCTIONPOS:t}),r.removeListeners(N)},150)}};function L(e,t){e.preventDefault(),e.stopPropagation();var i=this.selectionStart,n=this.selectionEnd,o=this.value,s=o.substring(0,i),l=o.substring(n,o.length);this.value=s+t+l;var g=(s+t).length;this.setSelectionRange(g,g),this.valueChanged();var u=a.view.getActiveGridID(),c=a.view.getResourceID(u),E=a.view.getSheetID(u),v=a.view.getVersionID(u);r.adjustDimensions(c,E,v)}u.register(c.Listener,E.DocMeta.DOCUMENT_LOCALE,function(e,n){e&&(t=e,i=n)},"DATE_SEPARATOR","LOCALE_DATEFORMAT"),C(r=new d(D,h),!1,!1,0,!0),r.customPreventDefault=function(t){switch(g.Key.getKeyCombination(t)){case R.ENTER:case R.SHIFT+"+"+R.ENTER:case R.SUPER+"+"+R.SHIFT+"+"+R.ENTER:case R.CTRL+"+"+R.SHIFT+"+"+R.ENTER:return t.preventDefault(),!0;case R.LEFT:case R.UP:case R.RIGHT:case R.DOWN:case R.SHIFT+"+"+R.LEFT:case R.SHIFT+"+"+R.RIGHT:case R.SHIFT+"+"+R.UP:case R.SHIFT+"+"+R.DOWN:case R.SUPER+"+"+R.SHIFT+"+"+R.LEFT:case R.SUPER+"+"+R.SHIFT+"+"+R.RIGHT:case R.SUPER+"+"+R.SHIFT+"+"+R.UP:case R.SUPER+"+"+R.SHIFT+"+"+R.DOWN:case R.ALT+"+"+R.LEFT:case R.ALT+"+"+R.RIGHT:if(I.isSelection()){var i=e.sPlusPlus.view.Events.Key;return i.focusContext(i.Entry.RangePicker.Context),!0}}},S.InsertFunction.register(r);n=new S.AutoSuggest.Formulaselector(r.SuggestContainer,{active:29,inActive:29,container:202});var p,y=new S.AutoSuggest.Formula(r.SuggestContainer,r,n),O=new S.AutoSuggest.SuggestToolTip(r.ToolTipContainer,r),P=y.getCategory("Functions");u.register(c.Listener,E.DocAction.FUNCTIONS.FETCH,function(e){for(var t in y.flush(P),o=ZSConstants.Function.functions){var i=o[t],n=document.createElement("div"),r=(i=o[t])[0],s=new S.AutoSuggest.FormulaEntry(n,t,r,z);ee(n,s,r,i[2],"Functions"),P.addEntry(r,s)}},"JSON");var V=S.AutoSuggest.DataValidation&&new S.AutoSuggest.DataValidation({editor:r,container:r.SuggestContainer,height:{active:29,inActive:29,container:152},scrollLimit:50,onScroll:function(){u.publish(c.Listener,E.UserAction.DATA_VALIDATION.GET_SCROLL_LIST)},onInsert:function(e,t){var i=a.view.getActiveGridID(),n=a.view.getResourceID(i),r=a.view.getSheetID(i),o=a.view.getVersionID(i),s=e.text,l=a.view.CellEditor.getEditCell();a.view.CellEditor.setValue(s),l&&l.getRID()&&UserAction.SubmitCell(l.getRID(),[l.getSheetID()],l.getVersion(),s,l.getRow(),l.getCol(),!1),u.publish(c.Gesture.Selector.CellEdit,E.GESTURE.ACTION.ENUMERATE,{RID:n,SHEETID:r,VERSION:o,isSubmittable:0}),t&&a.view.Events.Key.Entry.RangeSelection.Context.keyDown[t]&&a.view.Events.Key.Entry.RangeSelection.Context.keyDown[t](new Event("keydown"),n,r,o),V.flush()},onMouseInsert:function(e){var t=a.view.getActiveGridID(),i=a.view.getResourceID(t),n=a.view.getSheetID(t),r=a.view.getVersionID(t),o=e.text,s=a.view.CellEditor.getEditCell();a.view.CellEditor.setValue(o),setTimeout(function(){u.publish(c.Gesture.Selector.CellEdit,E.GESTURE.ACTION.ENUMERATE,{RID:i,SHEETID:n,VERSION:r,isSubmittable:0})},0),UserAction.SubmitCell(s.getRID(),[s.getSheetID()],s.getVersion(),o,s.getRow(),s.getCol(),!1),V.flush()}});u.register(c.Listener,E.Browser.ScreenViewport,function(t,i){var n=sPlusPlus.view.getGridComponent("MainGrid");if(e.isCanvasGrid){n.getWidths(),n.getHeights();G=i-(n.getRowHeaderWidth()+n.getVSrollbarWidth()),U=t-(n.getColumnHeaderHeight()+n.getHSrollbarHeight())}else U=t-(v.Grid.ColHeader+v.Grid.HScrollBar),G=i-(v.Grid.RowHeader+v.Grid.VScrollBar);r.isEnabled&&r.updateMaxWidthHeight(G,U)},"Height","Width");var U=Math.max(window.innerHeight)-(v.Top.Height+v.Bottom.Height),G=(e.isCraftGrid?window.innerWidth:Math.max(800,window.innerWidth))-(v.Left.Width+v.Right.Width);function F(e,t,i){a.view.CellEditor.getEditCell();var n=b(e,t,i);r.showLabel(n)}function H(e,t,i){var n=b(e,t,i);r.showLabel(n)}function b(e,t,i){var n=a.view.CellEditor.getEditCell(),r="";if(n){if(n.getRID()!==e||n.getSheetID()!==t||n.getVersion()!==i){r=a.data.getWorkBook(e,i).getSheetObj(n.getSheetID()).Prop.Name;r=(/[-\s]/.test(r)?"'"+r+"'":r)+"."}var o=n.getCell();return r+new S.Range(o.startRow,o.startCol,o.startRow,o.startCol).getLabel()}}function k(t,i,n,r){var o,s=a.view.getActiveGridID();n=a.view.getVersionID(s);return a.view.fetchCellData(t,i,n,r.startRow,r.startCol,["DisplayValue","ActualValue","Format","Formula","CellComment","Hyperlink","CellType"],s,function(e){o=e[r.startRow][r.startCol]},function(t){e.ZSClass.Logger.log("Couldnt retrieve cell content",t)}),!(!o||!o.styleName||"wrap"!==o.styleName[8])}function x(e,t,i,n){r.turnOn();a.data.getWorkBook(e,i).getSheetObj(t);var o=k(e,t,i,n);W(e,t,i,n),M(e,t,i,n,o),u.register(c.Listener,E.GridAction.WheelXYPaneContainerScroll,F,"RID","SHEETID","VERSION"),u.register(c.Listener,E.DocAction.WORKSHEETS.SWITCHSHEET,H,"RID","NEWSHEETID","VERSION")}function M(t,i,n,o,s){var l=a.data.getWorkBook(t,n).getSheetObj(i),g=o.startRow,u=o.startCol,c=o.endRow,E=o.endCol,v=sPlusPlus.view.getGridComponent("MainGrid");if(e.isCanvasGrid)var S=v.interacter,d=S.getRowY(g),D=S.getColX(u),I=S.getColX(E+1)-D,C=S.getRowY(c+1)-d,R=v.getFreezedCol(),f=v.getFreezedRow(),A=v.getScrollX(u,R),h=v.getScrollY(g,f),T=v.getZoom();else h=function(e,t,i){var n=a.view.getActiveGridID(),r=a.view.getSheetID(n),o=a.view.getSheetState(n,r);o.getZoom();var s=B(o),l=e.Row.FreezedCount;return t<l?o.getScrollTops()[1]:o.getScrollTops()[0]-s}(l,g,l.Row.auxiliaryAxis.getPos(g)),A=function(e,t,i){var n=a.view.getActiveGridID(),r=a.view.getSheetID(n),o=a.view.getSheetState(n,r);o.getZoom();var s=Z(o),l=e.Column.FreezedCount;return t<l?o.getScrollLefts()[1]:o.getScrollLefts()[0]-s}(l,u,l.Column.auxiliaryAxis.getPos(u)),I=K(l,E,l.Column.auxiliaryAxis.getPos(E+1))-K(l,u,l.Column.auxiliaryAxis.getPos(u)),C=j(l,c,l.Row.auxiliaryAxis.getPos(c+1))-j(l,g,l.Row.auxiliaryAxis.getPos(g)),d=l.Row.auxiliaryAxis.getPos(g),D=l.Column.auxiliaryAxis.getPos(u),T=a.view.getSheetState("MainGrid",i).getZoom();D*=T,d*=T;var m=w?C*T:C,N=w?I*T:I;r.place(o,A,h,D,d,N,m,G,U,s),V&&V.suggest(r.value);var L=ZSConstants.CommandConstants;if(""!==r.value&&!isNaN(r.value)){var p=l.activeCellData;("PERCENTAGE"===p.CellType||p.Pattern&&1==r.value.length&&"PERCENTAGE"===p.Pattern[L.FORMATTYPE])&&(r.setValue(r.value+"%"),r.setSelectionRange(1,1),_())}}function W(t,i,n,o){var s,l=a.view.getActiveGridID(),u=a.data.getWorkBook(t,n),c=u.getSheetObj(i),E=a.view.getSheetState(l,i);n=a.view.getVersionID(l);a.view.fetchCellData(t,i,n,o.startRow,o.startCol,["DisplayValue","ActualValue","Format","Formula","CellComment","Hyperlink","CellType","ConditionalFormat","Picklist"],l,function(e){var i=(s=e[o.startRow][o.startCol]).Format||c.ColStyleNames.getStyle(o.startCol)||"Default";i=u.CellStyle.getStyleDef(i),i=g.Object.clone(i,!0),i=S.CellDecorator.getStyle(i,s),isCanvasGrid&&S.CellStyleDef.checkFontSupport(t,n,i),r.setStyle(s,i);var a=E.getZoom();r.setZoom(a,i[9])},function(t){e.ZSClass.Logger.log("Couldnt retrieve cell content",t)})}function _(){a.view.CellEditor.setValue(r.getValue())}function B(e){return e.getScreenHeights()[1]}function Z(e){return e.getScreenWidths()[1]}function K(e,t,i){var n=a.view.getActiveGridID(),r=a.view.getSheetID(n),o=a.view.getSheetState(n,r);i*=o.getZoom();var s=Z(o);return i-(t<e.Column.FreezedCount?o.getScrollLefts()[1]:o.getScrollLefts()[0]-s)}function j(e,t,i){var n=a.view.getActiveGridID(),r=a.view.getSheetID(n),o=a.view.getSheetState(n,r);i*=o.getZoom();var s=B(o);return i-(t<e.Row.FreezedCount?o.getScrollTops()[1]:o.getScrollTops()[0]-s)}var Y,X=function(e){var t=e.keyCode||e.which;r.isEnabled&&Y&&Y.enabled&&27==t&&(e.preventDefault(),e.stopPropagation(),Y.onClose())};function z(e){q(r,e.text,!0,!1,!0),n.flush()}function J(e){q(r,e.text,!1,!1,!1),n.flush()}function q(e,t,i,n,r){var o=n?"_"+t:t,s=e.value,a=function(e,t,i){var n=/[\/\-()-+=,~@%^*"|;<>'&}{\n ]/g,r=e.substring(0,t),o=e.substring(i,e.length),s=t-r.split(n).pop().length,a=i+o.split(n)[0].length;e.substring(0,s),e.substring(a,e.length);return{start:s,end:a}}(s,e.selectionStart,e.selectionEnd),l=s.substring(0,a.start),g=s.substring(a.end,s.length),u=l+o+(!i||!!g[0]&&"("===g[0]?"":"(")+g,c=i?1:0,E=a.start+o.length+c;if(e.value=u,e.setSelectionRange(E,E),Q(e.Editor,"input"),Q(e.Editor,"selectionChanged"),r){var v=y.getCategory("Functions");n?O.delugeHelp(t):O.constructHelp(t,v)}}function Q(e,t){t=new Event(t);e.dispatchEvent(t)}function $(e){n.flush(),q(r,e.text,!0,!0,!0)}function ee(e,t,i,n,r){return e.title=n,e.innerText=i,"Functions"==r?e.classList.add("shIconBefore","shSuggestFx"):"Deluge"==r?e.classList.add("shIconBefore","shSuggestDlg"):"NamedRange"==r&&e.classList.add("shIconBefore","shSuggestDfName"),e.addEventListener("mousedown",function(e){t.onInsert(t),e.preventDefault(),e.stopPropagation()}),e}function te(e,t,i){var n=y.getCategory("Deluge"),r=i[0],o=i[2];o||(o=f["Deluge.DefaultDescription"]);var s=document.createElement("div"),a=new S.AutoSuggest.FormulaEntry(s,r,r,$);ee(s,a,r,o,"Deluge"),n.addEntry(r,a)}function ie(e,t,i){for(var n=0;n<t.length;n++)ne(e,t[n],i)}function ne(e,t,i){var n=y.getCategory("NamedRange"),r=t[0],o=t[2],s=g.FormRange(o),a=document.createElement("div"),l=new S.AutoSuggest.FormulaEntry(a,r,r,J);(a=ee(a,l,r,"Refers to "+s,"NamedRange")).addEventListener("mouseover",function(){var e=g.FormRange(o);a.setAttribute("title","Refers to "+e)}),n.addEntry(r,l)}function re(e){r.appendTo(e)}e.UserAction.calcPosition=function(e,t,i,n,o,s){var l,g,u=a.view.getActiveGridID(),c=a.view.getSheetID(u),E=a.view.getSheetState(u,c),v=E.getScreenHeights(),S=E.getScreenWidths(),d=S[0]+S[1],D=v[0]+v[1],I=t.Editor,C=I.offsetHeight,R=I.offsetWidth,f=I.offsetParent.offsetTop,w=I.offsetParent.offsetLeft+R+o>=d,A=e.style,h=C+s;h>=D-f?h>=f-C?w?(l=-o,g=0):(l=R,g=0):(l=w?R-o:2,g=-s):(l=w?R-o:2,g=C),"center"==I.style.textAlign&&(l-=r.minWidth/2),A.left=l+"px",A.top=g+"px"},e.UserAction.flushSuggest=function(){O.flush()},e.UserAction.suggestHelp=function(e){var t=!1;e.startsWith("_")&&(t=!0,e=e.substring("1"));var i=y.getCategory("Functions");t?O.delugeHelp(e):O.constructHelp(e,i)},u.register(c.Listener,E.DocAction.DELUGE_FUNCTIONS.INSERT,te,"RID","VERSION","DELUGE"),u.register(c.Listener,E.DocAction.DELUGE_FUNCTIONS.REMOVE,function(e,t,i){for(var n=y.getCategory("Deluge"),r=0;r<i.length;r++)n.deleteEntry(i[r])},"RID","VERSION","DELUGE"),u.register(c.Listener,E.DocMeta.DELUGE_FUNCTIONS,function(e,t,i){for(var n=0;n<i.length;n++)te(0,0,i[n])},"RID","VERSION","DELUGE"),u.register(c.Listener,E.DocMeta.NAMED_RANGE,ie,"RID","NAMEDRANGE","VERSION"),u.register(c.Listener,E.DocAction.NAMED_RANGE.ADD,ie,"RID","NAMEDRANGE","VERSION"),u.register(c.Listener,E.DocAction.NAMED_RANGE.REMOVE,function(e,t,i){for(var n=y.getCategory("NamedRange"),r=0;r<t.length;r++)n.deleteEntry(t[r][0])},"RID","NAMEDRANGE","VERSION"),u.register(c.Listener,E.DocMeta.NAMED_RANGE,ie,"RID","NAMEDRANGE","VERSION"),u.register(c.Selector.DomUpdate.CellEdit,E.Selection.BOUND_UPDATE.ADD,x,"RID","SHEETID","VERSION","ActiveRange"),u.register(c.Selector.DomUpdate.CellEdit,E.Selection.BOUND_UPDATE.MODIFY,x,"RID","SHEETID","VERSION","ActiveRange"),u.register(c.Selector.DomUpdate.CellEdit,E.Selection.BOUND_UPDATE.REMOVE,function(){_(),r.turnOff(),s=void 0,m=!1,document.activeElement.blur(),V&&V.flush(),p&&p.flush(),Y=void 0,r.DatePickerContainer.style.display="none",u.unregister(c.Listener,E.GridAction.WheelXYPaneContainerScroll,F),u.unregister(c.Listener,E.DocAction.WORKSHEETS.SWITCHSHEET,H)}),u.register(c.Selector.DomUpdate.CellEdit,E.Selection.BOUND_UPDATE.APPLY,re,"CONTAINER"),u.register(c.Listener,E.CellAction.VALUE.SET,function(e,t,i,n,o,s,l){var g=a.data.getWorkBook(e,i).getSheetObj(t);if(!r.inView){var u=new S.Range(n,o,n,o),c=k(e,t,i,u);W(e,t,i,u),M(e,t,i,u,c),r.show()}var E=s?g.Picklist.isXists(n,o)?s.DisplayValue:s.Formula||s.DisplayValue:r.getValue();if(g.ArrayFormula.isXists(n,o)&&0==E.indexOf("{=")&&(E=E.substr(1,E.length-2)),a.view.CellEditor.setValue(E),r.setValue(E),V&&V.suggest(""),A(e,t,i,r.valueCheck(E)),r.adjustDimensions(e,t,i),l){var v=E.length;r.setSelectionRange(v,v),r.valueChanged(),r.selectionChanged()}},"RID","SHEETID","VERSION","ROW","COL","VALUE","FOCUS"),u.register(c.Listener,E.CellAction.CELLSUGGESTION.ADD,function(e,t,i,n,o){a.view.CellEditor.setValue(n),r.setValue(n),A(e,t,i,r.valueCheck(n)),r.adjustDimensions(e,t,i),r.setSelectionRange(o,n.length),r.selectionChanged(),u.publish(c.Listener,E.FormulaBar.UPDATE,{RID:e,SHEETID:t,VERSION:i,VALUE:{Formula:n,DisplayValue:n}})},"RID","SHEETID","VERSION","VALUE","POS"),u.register(c.Listener,E.UserAction.DATA_VALIDATION.SHOW_LIST,function(e){V.addEntries(e),V.suggest(m?r.value:"")},"LIST_ARRAY"),u.register(c.UI,E.Layout.DEFER_JS_LOADED,function(){var e=a.view.getActiveGridID(),t=a.view.getGridComponent(e);t&&re(t.fifthPane)}),u.register(c.Listener,E.UserAction.PICKLIST.SHOW_LIST,function(e){e&&!p&&(p=S.AutoSuggest.Picklist&&new S.AutoSuggest.Picklist({editor:r,container:r.PicklistContainer,height:{active:29,inActive:29,container:152},scrollLimit:50,onInsert:function(e,t){var i=a.view.getActiveGridID(),n=a.view.getResourceID(i),r=a.view.getSheetID(i),o=a.view.getVersionID(i),s=e.displayString,l=a.view.CellEditor.getEditCell();a.view.CellEditor.setValue(s),l&&l.getRID()&&UserAction.SubmitCell(l.getRID(),[l.getSheetID()],l.getVersion(),s,l.getRow(),l.getCol(),!0,e.id),t&&a.view.Events.Key.Entry.RangeSelection.Context.keyDown[t]&&a.view.Events.Key.Entry.RangeSelection.Context.keyDown[t](new Event("keydown"),n,r,o),p.flush(),setTimeout(function(){u.publish(c.Gesture.Selector.CellEdit,E.GESTURE.ACTION.ENUMERATE,{RID:n,SHEETID:r,VERSION:o,isSubmittable:0})},0)},onMouseInsert:function(e){var t=a.view.getActiveGridID(),i=a.view.getResourceID(t),n=a.view.getSheetID(t),r=a.view.getVersionID(t),o=e.displayString,s=a.view.CellEditor.getEditCell();a.view.CellEditor.setValue(o),setTimeout(function(){u.publish(c.Gesture.Selector.CellEdit,E.GESTURE.ACTION.ENUMERATE,{RID:i,SHEETID:n,VERSION:r,isSubmittable:0})},0),UserAction.SubmitCell(s.getRID(),[s.getSheetID()],s.getVersion(),o,s.getRow(),s.getCol(),!0,e.id),p.flush()}})),p.addEntries(e),r.value?m?p.suggest(r.value):p.suggestAndSelect(r.value):p.suggest("")},"LIST_ARRAY"),u.register(c.Listener,E.UserAction.DATEPICKER,function(e,t,i){r.DatePickerContainer.innerHTML="",r.Editor.addEventListener("keydown",X),Y=S.DatePicker.getPicker(r,r.DatePickerContainer,e,t,i)},"ACTUALVALUE","DATEFRMT","TIMEFRMT")}(this);
!function(e){if(!e.isCanvasGrid){var t=e.sPlusPlus,i=e.JSUtil,o=e.ZSClass,r=t.data.Defaults.MAX_COL,a=o.UIPaneComponent,l=o.CellDecorator,s=a.prototype,n={BACKGROUNDCOLOR:0,COLOR:1,FONTSIZE:2,FONTNAME:3,FONTWEIGHT:4,FONTSTYLE:5,TEXTLINETHROUGHTSTYLE:6,TEXTUNDERLINESTYLE:7,TEXTWRAP:8,HALLIGN:9,VALLIGN:10,BORDER:11,HIDETEXT:12,ICONSET:13};s.PlacePreview=function(e,i,r,a,l){var s=t.data.getWorkBook(e,r).getSheetObj(i),n=s.Row,R=s.Column;a=o.Range.prototype.getIntersectingRange.call(this.props,a);var E=t.view.getActiveGridID(),O=t.view.getSheetState(E,i).getZoom();this.Preview.setZoom(O);for(var g=a.startRow;g<=a.endRow;g=n.Visibility.nextNonHidden(g))for(var h=a.startCol;h<=a.endCol;h=R.hidden.nextNonHidden(h)){var d=s.Merge.isXists(g,h);d&&!d.isRoot||T.call(this,e,i,r,g,h,l)}},s.ClearPreview=function(e,t,o,a,l){var s=i.Math.hash(a,l,r);this.Preview&&this.Preview.remove(s)},s.ClearAllPreview=function(e,t,i){this.Preview&&this.Preview.removeAll()}}function T(e,a,s,T,R,E){var O=new o.Range(T,R,T,R),g=t.data.getWorkBook(e,s),h=g.getSheetObj(a);if(h.Merge.extendRange(O),o.Range.prototype.intersects.call(this.props.bound,O)&&o.Range.prototype.intersects.call(this.props,O)){var d=h.Row.auxiliaryAxis.getPos(O.startRow),v=h.Column.auxiliaryAxis.getPos(O.startCol),c=h.Row.auxiliaryAxis.getPos(O.endRow+1),C=h.Column.auxiliaryAxis.getPos(O.endCol+1)-v,N=c-d,S=h.sparklines.isXists(T,R)?{row:T,col:R}:void 0,p=h.Picklist.isXists(T,R),u=i.Math.hash(T,R,r),w=this.getCellRef(e,a,s,T,R),y=!(!w||!w.data)&&w.data.isCheckbox;if(!w)return;var L=i.Object.clone(w.data,!0),P=L.Format||h.ColStyleNames.getStyle(R)||"Default",D=i.Object.clone(g.CellStyle.getStyleDef(P),!0),I=D[n.BORDER];if(1==I.length&&(I[1]=I[0],I[2]=I[0],I[3]=I[0]),L.rightBorder){var A=g.CellStyle.getStyleDef(L.rightBorder.Format)[11];1==A.length&&(A[1]=A[0],A[2]=A[0],A[3]=A[0]),I[1]=A[1]}if(L.bottomBorder){var F=g.CellStyle.getStyleDef(L.bottomBorder.Format)[11];1==F.length&&(F[1]=F[0],F[2]=F[0],F[3]=F[0]),I[3]=F[3]}var f=this.Preview.getDom(u);this.Preview.flush(u),this.Preview&&this.Preview.place(u,d,v,N,C),E&&(D=E.call(this,T,R,f,L,D)),function(e,t,i,o,r,a,s,T,R,E,O){a.classList.add("cell"),l.setBGColor(a,T[n.BACKGROUNDCOLOR]||""),l.setForeColor(a,T[n.COLOR]||""),l.setFontSize(a,T[n.FONTSIZE]?T[n.FONTSIZE]+"pt":"10pt"),l.setFontFamily(a,T[n.FONTNAME]||"");var g=!!T[n.HIDETEXT],h=T[n.ICONSET],d=T[n.COLOR]||"",v=a;h&&(v=l.setIconSet(a,h)),s.Hyperlink?l.addHyperlink(v,s.DisplayValue,s.Hyperlink,d):l.setNumberFormatValue(v,void 0,s,T[n.FONTSIZE],T[n.FONTNAME],!0)||!g&&l.setCellValue(v,s.DisplayValue),R?l.drawCheckBox(e,t,i,o,r,a,s.DisplayValue,s):(l.setFontWeight(a,T[n.FONTWEIGHT]),l.setFontStyle(a,T[n.FONTSTYLE]),l.setTextDecoration(a,T[n.TEXTLINETHROUGHTSTYLE],T[n.TEXTUNDERLINESTYLE]),l.setWrap(a,T[n.TEXTWRAP]),l.setHAlign(a,T[n.HALLIGN],s,g),l.setVAlign(a,T[n.VALLIGN]));E&&l.drawSparkline(t,a,E.row,E.col);O&&l.drawPicklist(e,t,i,a,o,r);T[n.BORDER]&&(l.setBorderRight(a,T[n.BORDER][1],t),l.setBorderBottom(a,T[n.BORDER][3],t))}(e,a,s,T,R,f,L,D,y,S,p)}}}(this);
!function(e,n){var t=e.ZSEvents,r=t.topic,s=t.Groups,o=t.Names,d=e.ZSDevTools.Logger;function i(e,n){return n||(n=document),n.getElementById(e)}function u(e,n){switch(n){case 0:e.innerHTML="Req Q:";break;case 1:e.innerHTML="Ur Qid:";break;case 2:e.innerHTML="Last Xid"}}function l(){var e=d.ReqResp.Requests.length-1-d.ReqResp.currRequest;i("1").innerHTML=e}function a(e){i("2").innerHTML=e}function c(e){i("3").innerHTML=e}d.FixedConsole=!1,d.openFixedConsole=function(){this.FixedConsole||(document.querySelector(".dbug_body").style.display="",this.FixedConsole=!0)},d.closeFixedConsole=function(){d.FixedConsole&&(document.querySelector(".dbug_body").style.display="none",this.FixedConsole=!1)},r.register(s.Listener,o.ZSDebugger.logReqRespInit,a,"RECEIVED"),r.register(s.Listener,o.ZSDebugger.logReqRespInit,c,"EXCUTED"),r.register(s.Listener,o.ZSDebugger.logRequestAddedInQueue,l,"REQUEST"),r.register(s.Listener,o.ZSDebugger.logRequestSend,l),r.register(s.Listener,o.ZSDebugger.logQaidReceived,a,"QAID","REQUEST"),r.register(s.Listener,o.ZSDebugger.logResponseProcessed,c,"XAID"),r.register(s.Listener,o.ZSDebugger.logRefreshTileIndicator,function(e,n,t){""!=e?"WAITING_TIMER"===n?i("4").style.background="orange":"UN_ORDERED_TIMER"===n?i("4").style.background="green":"DELAY_TIMER"===n?i("4").style.background="red":"SYNC_CHECK_TIMER"===n&&(i("4").style.background="blue"):i("4").style.background="yellow",i("4").innerHTML=""!=e&&t?"refrsh for --"+t:""},"MSG","BY","LASTXAID"),function(){var e=document.createElement("DIV");e.className="dbug_body",e.draggable=!0,e.style.display="none";var n=document.createElement("DIV");n.className="dbug_holder";var t=document.createDocumentFragment(),r=0;do{var s,o=document.createElement("DIV");o.className="dbug_markup dbug_lable",u(o,r),(s=document.createElement("DIV")).className="dbug_markup dbug_content",r++,s.id=r,t.appendChild(o),t.appendChild(s)}while(r<3);(s=document.createElement("DIV")).className="dbug_markup dbug_textscreen",s.id=r+1,t.appendChild(s),n.appendChild(t),e.appendChild(n),document.body.appendChild(e)}()}(this,ZSEvents);
!function(e){var o=e.document,t=e.ZSConstants.I18N,n=e.sPlusPlus,i=e.ZSEvents,s=i.topic,a=i.Groups,r=i.Names,c=e.UIUtil.Component;var d=new function(){ZSClass.KeyMapping.call(this)},l=n.view.Events.Key;l.Entry.Dialog.Node.addChildNode(d);var u=!1;function p(){c.initFcomponents(),l.focusContext(l.Entry.Dialog.Context),u||(c.bind("#zfeedbackDialog","zdialogclose",function(e,o){l.focusContext(l.Entry.CellEditor.Context)}),u=!0);var e=t.SupportMailId;ZFeedback.open({formType:"feedback",sendTo:e,allowToAnnotateImages:!1})}n.view.Toolbar.transient[e.ZSConstants.ActionConstants.FEEDBACK]=p,UserAction.showFeedbackDialog=p,UserAction.reportError=function(){t.ReportTheError;var e=n.data.UserInfo.zuid,i=n.view.getActiveGridID(),s=n.view.getResourceID(i),a=o.domain,r=window.location.pathname,c={"Other details":e+" - "+a+" [ "+n.data.AppRegistry.buildVersion+" ] - "+s+" [ "+r+" ] - .. [ ... ] - [ .. ] [.. ] [.. ]"};ZFeedback.open({sendTo:"websheet-issues@zohocorp.com",customHeaders:c})},s.register(a.UI,r.Layout.DEFER_JS_LOADED,function(){c.addFComponentsFiles()})}(this);
!function(e){var i=e.sPlusPlus,s=(e.ZSClass,e.UserAction);e.ZSClass.Redirect=function(){var e=i.view.getActiveGridID(),t=i.view.getResourceID(e),r=i.view.getVersionID(e);s.doRedirect(t,r)}}(this);
!function(e){var t,n,r,a,o=e.sPlusPlus,i=e.ZSEvents,l=i.topic,s=i.Groups,c=i.Names,u=e.ZSClass,d=e.ZSConstants.JSKeyCode,g=e.ZSConstants.I18N;function D(n,r,a,i){var l,s=i.startRow,c=i.endRow,u=i.startCol,d=i.endCol,g=o.data.getWorkBook(n,a),D=g.getSheetObj(r).Merge.getInfo(i.startRow,i.startCol);l=D&&!i.equals(D)||!D&&(s!==c||u!==d)?i.getLabel():e.JSUtil.Cell.getReference(s,u),t.value=l;var S=g.NamedRange.getNameFromRange(l);S&&(t.value=S)}function S(n,r,i,l){a=l;var s,c=l.startRow,u=l.endRow,d=l.startCol,g=l.endCol,D=o.data.getWorkBook(n,i).getSheetObj(r).Merge.getInfo(l.startRow,l.startCol);s=D&&!l.equals(D)||!D&&(c!==u||d!==g)?u-c+1+"R X "+(g-d+1)+"C":e.JSUtil.Cell.getReference(c,d),t.value=s}function v(t){return function(e){var t=o.view.getActiveGridID(),n=o.view.getResourceID(t),r=(o.view.getSheetID(t),o.view.getVersionID(t));return o.data.getWorkBook(n,r).NamedRange.has(e)}(t)||function(t){return e.JSUtil.REGEXP.rangeRegex.test(t)}(t)}function R(t){if(function(e){return new RegExp("^[a-zA-Z0-9_\\u00A1-\\uFFFF]+$").test(e)}(t)){var n=o.view.getActiveGridID(),r=o.view.getResourceID(n),a=o.view.getSheetID(n),i=o.view.getVersionID(n),l=o.data.getWorkBook(r,i).getSheetObj(a).Prop.getName(),s=o.view.getSheetState(n,a).getRange(0),c=o.view.getSelectedSheets(n),d=l+"."+s.getLabel(1);UserAction.addNamedRange(r,c,i,t,e.JSUtil.Range.addApostrophe(d))}else{var D=g["InvalidName.AlertContent"],S=JSUtil.fn.replaceParams(g.InvalidCellName,new Array(t));u.ZSAlert(D,{title:S})}}function E(e){e.stopPropagation();var t=e.keyCode||e.which,n=this.value;switch(t){case 13:v(n)?(UserAction.Goto(n),l.publish(s.Listener,c.FormulaBar.CellIndicator.DropDown.Hide)):R(n);case 9:case 27:e.preventDefault(),this.blur()}}function I(){l.publish(s.Listener,c.FormulaBar.CellIndicator.DropDown.Update,{value:this.value})}function f(){r&&r.blur()}function p(){r=this,!n&&(n=document.querySelector("#MainGrid")),n.addEventListener("click",f),this.select()}function w(){!n&&(n=document.querySelector("#MainGrid")),n.removeEventListener("click",f),r=null,l.publish(s.Listener,c.FormulaBar.CellIndicator.DropDown.Hide)}function A(e,t,n){var r=o.view.getActiveGridID();D(e,t,n,o.view.getSheetState(r,t).getActiveRange())}function C(e,t,n){l.register(s.Selector.DomUpdate.Range,c.Selection.BOUND_UPDATE.ADD,D,"RID","SHEETID","VERSION","ActiveRange"),l.unregister(s.Selector.BoundUpdate.Range,c.Selection.BOUND_UPDATE.MODIFY,S),l.unregister(s.Gesture.Selector.Range,c.GESTURE.ACTION.END,C),D(e,t,n,a)}function N(e,t,n){l.unregister(s.Selector.DomUpdate.Range,c.Selection.BOUND_UPDATE.ADD,D),l.register(s.Selector.BoundUpdate.Range,c.Selection.BOUND_UPDATE.MODIFY,S,"RID","SHEETID","VERSION","RANGE"),l.register(s.Gesture.Selector.Range,c.GESTURE.ACTION.END,C,"RID","SHEETID","VERSION")}!function(e){e=document.querySelector(".fB");var n=document.createElement("div");n.className="fbCellAddr",e.appendChild(n),t=document.createElement("input"),n.appendChild(t),t.addEventListener("keydown",E),t.addEventListener("input",I),t.addEventListener("blur",w),t.addEventListener("focus",p),l.register(s.UI,c.Layout.DEFER_JS_LOADED,A,"RID","SHEETID","VERSION"),l.register(s.Gesture.Selector.Range,c.GESTURE.ACTION.DOWN,N),l.register(s.Selector.DomUpdate.Range,c.Selection.BOUND_UPDATE.ADD,D,"RID","SHEETID","VERSION","ActiveRange")}(),e.sPlusPlus.view.Events.Key.Entry.ShortCut.Context.keyDown[d.CTRL+"+"+d.SHIFT+"+"+d.N]=function(){t.select()}}(this);
!function(e){var t,n,r,i=e.sPlusPlus,o=e.ZSEvents,a=o.topic,s=o.Groups,c=o.Names;r=document.querySelector(".fB"),(t=document.createElement("div")).className="fBDrpIco",t.onclick=l,r.appendChild(t),(n=document.createElement("div")).className="dropList",r.appendChild(n);var d=!1;function l(){var e=i.view.getActiveGridID(),t=i.view.getResourceID(e),n=i.view.getVersionID(e);d?v():u(t,n)}function u(e,t){if(!d){var r=i.view.getActiveGridID();e=e||i.view.getResourceID(r),t=t||i.view.getVersionID(r);var o=i.data.getWorkBook(e,t),a=o.NamedRange.getKeys();if(!a.size)return;n.classList.add("show"),n.innerHTML="",a.forEach(function(e){var t=o.NamedRange.namedRangeMap.get(e),r=function(e,t){if(t.startsWith("#"))return;var n=document.createElement("div");return n.textContent=e,n.onclick=function(){UserAction.Goto(e),v()},n.className="dropEntry",n}(e,JSUtil.FormRange(t));r&&n.appendChild(r)}),d=!0}}function v(){d&&(n.classList.remove("show"),d=!1)}function g(e){return new RegExp(e.split(/(.|$)/g).join(".*"),"gi")}var m=c.FormulaBar.CellIndicator.DropDown;a.register(s.Listener,m.Update,function(e){!d&&u();for(var t=0;t<n.children.length;t++){var r=n.children[t],i=g(e);r.style.display=i.test(r.textContent)?"":"none"}},"value"),a.register(s.Listener,m.Hide,v),a.register(s.Listener,c.Mouse.RangeDown,v)}(this);
!function(e){var t=e.sPlusPlus,a=e.document,i=e.ZSEvents,n=i.topic,o=i.Groups,r=i.Names,s=e.UIUtil,l=e.ZSConstants.I18N,c=t.view.Toolbar.Feature.FormulaBar={};!function(){var e=a.querySelector(".fB"),i=a.createElement("div");i.className="fbCtn",e.appendChild(i);var u=a.createElement("div");u.className="fxs",u.setAttribute("data-shortcutkey","Shift+F3"),u.title=l["Formulas.Function"],i.appendChild(u),s.fn.addIcon(u,"formulaBarFxIcon"),u.addEventListener("click",function(){var e=t.view.getActiveGridID(),a=t.view.getResourceID(e),i=t.view.getVersionID(e);t.data.getWorkBook(a,i).isEditable()&&n.publish(o.UI,r.SidePanel.Function.toggle)}),c.fBElem=e}()}(this);
!function(e){var t,n,r,i,o,s=e.sPlusPlus,a=e.ZSEvents,u=a.topic,l=a.Groups,c=a.Names,E=e.ZSClass,g=e.ZSConstants,d=g.JSKeyCode,v=g.I18N,D=E.Editors.FormulaEditor,S=E.RangePicker;function I(e,t,n,r){var i=s.view.getActiveGridID(),o=s.view.getGridComponent(i).getCellRef(e,t,n,r.startRow,r.startCol);return!(!o||!o.data)&&o.data.isCheckbox}function R(e,t,n,r){var i=function(e,t,n,r){var i=s.data.getWorkBook(e,n),o=i.getSheetObj(t),a=i.ProtectedSheets.isSheetLocked(t),u=o.ProtectedRanges.isIntersecting(r);return a||u}(e,t,n,r),o=function(e,t,n,r){return s.data.getWorkBook(e,n).getSheetObj(t).Pivot.isXists(r.startRow,r.startCol)}(e,t,n,r),a=I(e,t,n,r);return!(i||o||a)}function f(e){var n=s.view.getActiveGridID(),r=s.view.getResourceID(n),i=s.view.getSheetID(n),o=s.view.getVersionID(n),a=s.view.getSheetState(n,i);u.publish(l.Listener,c.CellAction.VALUE.SET,{RID:r,SHEETID:i,VERSION:o,ROW:a.getActiveRow(),COL:a.getActiveCol(),VALUE:{DisplayValue:t.value}}),u.publish(l.Listener,c.FormulaBar.Dialog.Update,{value:t.value})}u.create(l.Listener,c.FormulaBar.Dialog.Open),u.register(l.Listener,c.FormulaBar.Dialog.Open,function(){u.publish(l.Listener,c.FormulaBar.Dialog.Update,{value:t.value})});var h={mousedown:function(t){var n=s.view.getActiveGridID();if(!s.view.CellEditor||!s.view.CellEditor.getEditStatus()){var r=s.view.getResourceID(n),i=s.view.getSheetID(n),o=s.view.getVersionID(n),a=s.view.getSheetState(n,i).getActiveCellRange();if(R(r,i,o,a)){var E=e.sPlusPlus.view.Events.Key;E.focusContext(E.Entry.CellEditor.Context),u.publish(l.Selector.BoundUpdate.CellEdit,c.Selection.BOUND_UPDATE.ADD,{RID:r,SHEETID:i,VERSION:o,RANGE:a,RANGEID:0,TYPE:void 0}),u.publish(l.Gesture.Selector.CellEdit,c.GESTURE.ACTION.DOWNINSIDE,{RID:r,SHEETID:i,VERSION:o})}else t.preventDefault()}},valueChanged:f,focus:f};function N(t){switch(t.keyCode||t.which){case 13:if(!t.altKey&&!t.ctrlKey&&!t.metaKey)return t.preventDefault(),!0;case 37:case 38:case 39:case 40:if(S.isSelection()){var n=e.sPlusPlus.view.Events.Key;return n.focusContext(n.Entry.RangePicker.Context),t.preventDefault(),!0}}}function C(e,n,r,i){var a=s.data.getWorkBook(e,r),u="";i.Formula?a.showFormulas||"hide"!=i.Formula?(u=i.Formula,o&&o.remove()):(u=i.DisplayValue,(o=new E.SBNotification(v["PublicView.ProtectedCell"],{type:"STD"})).show()):(u=i.DisplayValue,o&&o.remove()),t.value=u}function A(e){n.style.height=e+"px"}function m(e){n.style.width=e+"px"}function I(e,t,n,r){return s.data.getWorkBook(e,n).getSheetObj(t).activeCellData.isCheckbox}function R(e,t,n,r){var i=s.data.getWorkBook(e,n),o=i.getSheetObj(t),a=o.ProtectedRanges.isXists(r.startRow,r.startCol),u=o.Pivot.isXists(r.startRow,r.startCol),l=i.ProtectedSheets.isSheetLocked(t),c=i.isEditable(),E=I(e,t,n);return!(a||u||l||E||!c)}function L(e,t,n,r,i){return e.innerText=n,e.title=r,"Functions"==i?(e.classList.add("shIconBefore","shSuggestFx"),e.title=r):"Deluge"==i?(e.classList.add("shIconBefore","shSuggestDlg"),e.title=r):"NamedRange"==i&&e.classList.add("shIconBefore","shSuggestDfName"),e.addEventListener("mousedown",function(e){t.onInsert(t),e.preventDefault()}),e}function w(e,t,n){var r=i.getCategory("Deluge"),o=n[0],s=n[2]||"my test description",a=document.createElement("div"),u=new E.AutoSuggest.FormulaEntry(a,o,o,y);L(a,u,o,s,"Deluge"),r.addEntry(o,u)}function O(e,t,n){for(var r=i.getCategory("Deluge"),o=0;o<n.length;o++)r.deleteEntry(n[o])}function p(e){r.flush(),U(t,e.text,!0)}function F(e){r.flush(),U(t,e.text,!1)}function y(e){r.flush(),U(t,"_"+e.text,!0)}function U(e,t,n){var r=e.value,i=function(e,t,n){var r=/[\/\-()-+=,~@%^*"|;<>'&}{\n ]/g,i=e.substring(0,t),o=e.substring(n,e.length),s=t-i.split(r).pop().length,a=n+o.split(r)[0].length;e.substring(0,s),e.substring(a,e.length);return{start:s,end:a}}(r,e.selectionStart,e.selectionEnd),o=r.substring(0,i.start),s=r.substring(i.end,r.length),a=o+t+(!n||!!s[0]&&"("===s[0]?"":"(")+s,u=n?1:0,l=i.start+t.length+u;e.value=a,e.setSelectionRange(l,l),T(e.Editor,"input"),T(e.Editor,"selectionChanged")}function T(e,t){t=new Event(t);e.dispatchEvent(t)}function V(e,t,n){for(var r=0;r<t.length;r++)G(e,t[r],n)}function G(e,t,n){var r=i.getCategory("NamedRange"),o=t[0],s=t[2],a=JSUtil.FormRange(s),u=document.createElement("div"),l=new E.AutoSuggest.FormulaEntry(u,o,o,F);(u=L(u,l,o,"Refers to "+a,"NamedRange")).addEventListener("mouseover",function(){var e=JSUtil.FormRange(s);u.setAttribute("title","Refers to "+e)}),r.addEntry(o,l)}!function(){n=document.querySelector(".fB");var e=document.createElement("div");e.className="fBAutoCmplt",n.appendChild(e);var o=document.createElement("div");o.className="fBEdit",e.appendChild(o);var s=document.createElement("div");s.className="suggestBox",e.appendChild(s),t=new D(o,!0),S.register(t,!1,!1,0,!0),t.customPreventDefault=N,r=new E.AutoSuggest.Formulaselector(s,{active:29,inActive:29,container:202});var a="Functions",d=(i=new E.AutoSuggest.Formula(s,t,r)).getCategory(a);u.register(l.Listener,c.DocAction.FUNCTIONS.FETCH,function(e){i.flush(d),function(e){var t=e.functions;for(var n in t){var r=t[n],i=document.createElement("div"),o=r[0],s=new E.AutoSuggest.FormulaEntry(i,o,o,p);L(i,s,o,r[2],a),d.addEntry(o,s)}}(g.Function)}),t.addListeners(h),E.InsertFunction&&E.InsertFunction.register(t),u.register(l.Listener,c.SheetAction.ACTIVE_CELL.INFO,C,"RID","SHEETID","VERSION","VALUE"),u.register(l.Listener,c.FormulaBar.UPDATE,C,"RID","SHEETID","VERSION","VALUE"),u.register(l.Listener,c.FormulaBar.RESIZE,A,"height"),u.register(l.Listener,c.Browser.ScreenViewport,m,"Width")}(),u.register(l.Listener,c.DocAction.DELUGE_FUNCTIONS.INSERT,w,"RID","VERSION","DELUGE"),u.register(l.Listener,c.DocAction.DELUGE_FUNCTIONS.REMOVE,O,"RID","VERSION","DELUGE"),u.register(l.Listener,c.DocMeta.DELUGE_FUNCTIONS,function(e,t,n){for(var r=0;r<n.length;r++)w(0,0,n[r])},"RID","VERSION","DELUGE"),u.register(l.Listener,c.DocMeta.NAMED_RANGE,V,"RID","NAMEDRANGE","VERSION"),u.register(l.Listener,c.DocAction.NAMED_RANGE.ADD,V,"RID","NAMEDRANGE","VERSION"),u.register(l.Listener,c.DocAction.NAMED_RANGE.REMOVE,function(e,t,n){for(var r=i.getCategory("NamedRange"),o=0;o<t.length;o++)r.deleteEntry(t[o][0])},"RID","NAMEDRANGE","VERSION"),u.register(l.Listener,c.SheetAction.ACTIVE_CELL.INFO,function(e,n,r,i,o){var a=s.data.getWorkBook(e,r),u=new E.Range(i,o,i,o);a.isEditable()&&R(e,n,r,u)?t.enable():t.disable()},"RID","SHEETID","VERSION","ROW","COLUMN"),u.register(l.Listener,c.DocAction.DELUGE_FUNCTIONS.INSERT,w,"RID","VERSION","DELUGE"),u.register(l.Listener,c.DocAction.DELUGE_FUNCTIONS.REMOVE,O,"RID","VERSION","DELUGE"),e.sPlusPlus.view.Events.Key.Entry.ShortCut.Context.keyDown[d.SUPER+"+"+d.SHIFT+"+"+d.F]=function(e,n,r,i){var o=s.view.getActiveGridID(),a=s.view.getSheetState(o,r).getActiveCellRange();if(R(n,r,i,a)){u.publish(l.Gesture.Selector.CellEdit,c.GESTURE.ACTION.ACTUATE,{RID:n,SHEETID:r,VERSION:i}),t.focus();var E=t.value.length;t.setSelectionRange(E,E)}}}(this);
!function(e){var t,r=e.sPlusPlus,s=r.view.measures,a=e.ZSEvents,o=a.topic,i=a.Groups,n=a.Names,u=e.ZSConstants.I18N,l=e.ZSConstants.JSKeyCode,c=80,v=23,m=" (Ctrl+Shift+U)";!function(){var e=document.querySelector(".fB");(t=document.createElement("div")).className="fBExp",t.title=u.ExpandFormula+m,e.appendChild(t),t.addEventListener("click",f,!1),s.Top.formulaBar=e.offsetHeight}();var d=!1;function f(){var e,a=r.view.getActiveGridID(),l=r.view.getResourceID(a),f=r.view.getSheetID(a),p=r.view.getVersionID(a),E=d?v:c;o.publish(i.Listener,n.FormulaBar.RESIZE,{height:E}),(d=!d)?(e=u.CollapseFormula+m,formulaBar.classList.add("fBExpTru")):(e=u.ExpandFormula+m,formulaBar.classList.remove("fBExpTru")),t.title=e,s.Top.formulaBar=E,UserAction.UpdateScreenViewPort(l,f,p)}e.sPlusPlus.view.Events.Key.Entry.ShortCut.Context.keyDown[l.SUPER+"+"+l.SHIFT+"+"+l.U]=f}(this);
!function(e){var t=e.sPlusPlus,r=e.ZSClass,a=(t.view.Defaults.fontMap,e.ZSConstants.wCC,document.createElement("table")),o=document.createElement("a"),n=document.createElement("tr"),l=document.createElement("td");function i(e,t,r){var a=function(e){return document.createTextNode(e)}(e),n=o.cloneNode(!0);return n.setAttribute("href",t),n.appendChild(a),n.style.color=r&&"#000000"!=r?"inherit":"blue",n.style.textDecoration="underline",n}function s(e,a,o,n,l){var i=t.data.getWorkBook(e,o),s=i.getSheetObj(a),d=n.Format?n.Format:s.ColStyleNames.getStyle(l)?s.ColStyleNames.getStyle(l):"Default",c=JSUtil.Object.clone(i.CellStyle.getStyleDef(d),!0);return c=r.CellDecorator.getStyle(c,n)}function d(){return n.cloneNode(!0)}function c(r,a,o,n,l,i,s,d,c,p,u){var h=t.data.getWorkBook(r,n),y=h.getSheetObj(a).Merge.isXists(parseInt(l),parseInt(i));if(y&&y.isRoot){var m=y.root.getRowSpan(),C=y.root.getColSpan();s.setAttribute("rowspan",m),s.setAttribute("colspan",C);for(var f=0,v=0,g=y.root,b=g.startRow;b<=g.endRow;b++){y.root.getRowSpan()>1?f+=h.getSheetObj(a).Row.auxiliaryAxis.getDim(parseInt(b)):y.root.getColSpan()>1&&(f=h.getSheetObj(a).Row.auxiliaryAxis.getDim(parseInt(b))),v=0;for(var S=g.startCol;S<=g.endCol;S++)(y.root.getRowSpan()>1||y.root.getColSpan()>1)&&(v+=h.getSheetObj(a).Column.auxiliaryAxis.getDim(parseInt(S)))}s.style.height=f+"px",s.style.width=v+"px",e.UserAction.applyCellStyle(r,a,o,n,c,s,p.CellType,u),d.appendChild(s)}y||(e.UserAction.applyCellStyle(r,a,o,n,c,s,p.CellType,u),s.style.height=h.getSheetObj(a).Row.auxiliaryAxis.getDim(parseInt(l))+"px",s.style.width=h.getSheetObj(a).Column.auxiliaryAxis.getDim(parseInt(i))+"px",d.appendChild(s))}function p(e,r,a,o,n,l){var i=t.view.getGridComponent(e).getCellRef(r,a,o,n,l);return!(!i||!i.data)&&i.data.isCheckbox}e.UserAction.TableGeneratorUtility=function(e,r,o,n,u){t.data.getWorkBook(e,n).getSheetObj(r);var h,y=(a.style.borderCollapse="collapse","-1"!==t.data.UserInfo.zuid&&(t.data.UserInfo.Permission.isDownloadOff?a.setAttribute("source",t.data.AppRegistry.NO_DOWNLOAD_COPY_SOURCE):a.setAttribute("source",t.data.AppRegistry.COPY_SOURCE)),a.cloneNode(!0));if(sPlusPlus.data.UserInfo.Permission.isDownloadOff){var m=d();y.appendChild(m)}else for(var C in u){m=d();var f=u[C];for(var v in f){var g=f[v],b=(h=g)&&h.DisplayValue||" ",S=s(e,r,n,g,v),x=l.cloneNode(!0);if(g.Hyperlink){var A=i(b,g.Hyperlink,S[1]);x.appendChild(A)}else x.innerText=b;c(e,r,o,n,C,v,x,m,S,g,p(o,e,r,n,C,v))}y.appendChild(m)}return y}}(this),function(e){var t=document.createElement("table"),r=(document.createElement("th"),0),a=(ZSConstants.I18N,e.sPlusPlus),o=ZSConstants.FeatureConstants;a.view.Toolbar.Feature[o.TEXT_TO_COLUMN];function n(e,r,a){this.parent=e,this.options=r,this.pattern=a,function(){var e=document.createDocumentFragment();this.table=t.cloneNode(!1),e.appendChild(this.table),this.parent.appendChild(e)}.call(this),this.parseArray()}function l(){var e=document.querySelector("#tbody");document.querySelector("#thead").scrollLeft=e.scrollLeft}function i(e,t,a,o){t.style.opacity?(s(a,"remove",o,r),r=o):s(a,"add",1,o),e(o)}function s(e,t,a,o){for(var n=a;n<o;n++){for(var l=e.querySelectorAll("tr")[n].querySelectorAll("td"),i=0;i<l.length;i++)"add"==t?l[i].style.opacity="0.4":l[i].style.removeProperty("opacity");r=o}}n.prototype={parseArray:function(){var e=this.pattern,t=function(e){var t=e.map(function(e){return e.length});return Math.max.apply(Math,t)}(e),r=e.length;this.options.colHeader&&this.options.colHeader;this.table.classList.add("txtColtable");var a=document.createElement("thead");a.setAttribute("id","thead"),a.classList.add("txtColthead"),this.table.appendChild(a);for(var o=a.insertRow(-1),n=[],s=[],d=0;d<t;d++){var c=document.createElement("TH");c.setAttribute("index",d);var p=document.createElement("span");p.innerText="General";var u=document.createElement("i");u.id="dropDownArrowID",u.setAttribute("data-menu-id","TTCtype"),u.className="txtColTheadDownArrow",c.appendChild(p),c.appendChild(u),c.classList.add("txtColTDTH"),c.style.height=this.options.height+"px",n.push(c),o.appendChild(c)}var h=document.createElement("tbody");h.setAttribute("id","tbody"),h.classList.add("txtColtbody"),this.table.appendChild(h),h.addEventListener("mousewheel",l),h.addEventListener("scroll",l);for(d=0;d<r;d++)for(var y=h.insertRow(-1),m=0;m<t;m++){var C=y.insertCell(-1);void 0!=e[d][m]?C.innerText=e[d][m]:C.innerText="",this.options.rowClick&&C.addEventListener("click",i.bind(null,this.options.rowClick,C,this.table,y.rowIndex)),C.className="zTCell txtColTDTH",C.style.minWidth=this.options.width+"px",C.style.height=this.options.height+"px",0==d&&s.push(C)}for(var f=0;f<t;f++){var v=s[f].clientWidth;n[f].style.minWidth=v-10+"px"}},setActiveCol:function(e){!function(e,t,r,a){var o="number"==typeof t?t:a.target.cellIndex,n=e.querySelectorAll("tr");0!=e.querySelectorAll(".zTActive").length&&function(e,t){for(var r=t.querySelectorAll(".zTActive"),a=0;a<r.length;a++){var o=r[a];"zTActive"==o.className&&(o.removeClass="zTActive",o.className="zTCell")}}(0,e);for(var l=1;l<n.length;l++){var i=n[l].children[o];i.classList.add("zTCell")}"number"!=typeof t&&null!=r&&t(o,r)}(this.table,e,null,null)},setStartRow:function(e){e>=r?s(this.table,"add",1,e):(s(this.table,"remove",e,r),r=e)},resetTempValue:function(){r=0}},e.UserAction.ZSTable=n}(this);
!function(t){var e=t.sPlusPlus,n=(t.ZSClass,e.view.Defaults.fontMap);function o(t,e,n,o,r,i){var a=function(t,e){t.contains("double-thin")?t=t.replace("double-thin","double"):(t.contains("dash-dot-dot")||t.contains("dash-dot")||t.contains("fine-dashed"))&&(t=e);return t}(o,r),s=!t.IsShowGrid,l=e.getZoom();if(a.contains("in")||a.contains("pt")){var d=a.split(" ");for(var c in d)if(d[c].contains("in")||d[c].contains("pt"))var p=d[c];var u=(parseFloat(p)/l).toFixed(3)+(a.contains("in")?"in":"pt");a=a.replace(p,u)}return""!==a&&"none"!==a?"transparent"===a?i:a:s?"":r}t.UserAction.applyCellStyle=function(t,r,i,a,s,l,d,c){var p,u=e.data.Defaults.VIEW;l.style.backgroundColor=s[0],l.style.color=s[1],l.style.fontSize=(p=s[2])?p+"pt":"10pt",l.style.fontFamily=function(t){return n&&n[t]&&(t=n[t]),t}(s[3]),l.style.fontWeight=s[4],l.style.fontStyle=s[5],l.style.textDecoration=(f=s[6],y=s[7],b="","solid"==f&&"solid"==y?b="line-through underline":"solid"==f?b="line-through":"solid"==y&&(b="underline"),b),l.style.textAlign=function(t,e){var n;switch(t){case"start":n="left";break;case"center":n="center";break;case"end":n="right";break;default:"FLOAT"!==e&&"NUMBER"!==e&&"PERCENTAGE"!==e&&"CURRENCY"!==e&&"DATE"!==e&&"TIME"!==e&&"DATETIME"!==e&&"FRACTION"!==e&&"SCIENTIFIC"!==e&&"BOOLEAN"!==e&&"SSN"!==e&&"ZIPCODE"!==e&&"ZIPCODE4"!==e&&"PHONENUMBER"!==e||(n="right")}return n}(s[9],d),l.style.verticalAlign=function(t){var e;switch(t){case"vtop":case"top":e="top";break;case"vcenter":case"middle":e="middle";break;case"vbottom":case"bottom":e="bottom";break;default:e="top"}return e}(s[10]),u===sPlusPlus.data.View.CLASSIC?l.style.padding="0px 2px":u===e.data.View.COZY?l.style.padding="2px 4px":u===e.data.View.COMFORT&&(l.style.padding="4px 6px"),function(t,n,r,i,a,s){for(var l=e.data.getWorkBook(t,i).getSheetObj(n),d=e.view.getSheetState(r,n),c="solid "+l.Border_Size+"px #D5D5D5",p="solid "+l.Border_Size+"px transparent",u=a.length-1,f=0;f<=u;f++){var y=o(l,d,0,a[f],c,p);0===f?0===u?(s.style.borderLeft=y,s.style.borderRight=y,s.style.borderTop=y,s.style.borderBottom=y):s.style.borderLeft=y:1===f?s.style.borderRight=y:2===f?s.style.borderTop=y:3===f&&(s.style.borderBottom=y)}}(t,r,i,a,s[11],l),function(t,e){"wrap"!==t&&(e.style.overflow="hidden",e.noWrap="true")}(s[8],l),function(t,e,n){if(t){var o=document.createElement("input");o.setAttribute("type","checkbox");var r=n.innerText;"TRUE"==r&&o.setAttribute("checked",!0),n.style.verticalAlign="middle",n.style.textAlign="center",n.innerText="",n.appendChild(o)}}(c,0,l);var f,y,b}}(this);
!function(e){var a;a={":smile:":"smile",":happy:":"happy",":joy:":"joy",":grinning:":"grinning",":cool:":"cool",":love:":"love",":curious:":"curious",":awe:":"awe",":thinking:":"thinking",":search:":"search",":idea:":"idea",":wink:":"wink",":razz:":"razz",":relaxed:":"relaxed",":peace:":"peace",":blush:":"blush",":yummy:":"yummy",":yuck:":"yuck",":sad:":"sad",":upset:":"upset",":anxious:":"anxious",":worry:":"worry",":stressed-out:":"stressed-out",":angry:":"angry",":tensed:":"tensed",":tired:":"tired",":bored:":"bored",":sleepy:":"sleepy",":jealous:":"jealous",":evil:":"evil",":facepalm:":"facepalm",":doubt:":"doubt",":surprise:":"surprise",":faint:":"faint",":headache:":"headache",":sick:":"sick",":injured:":"injured",":neutral:":"neutral",":smirk:":"smirk",":keep-quiet:":"keep-quiet",":feeling-warm:":"feeling-warm",":feeling-cold:":"feeling-cold",":thumbsup:":"thumbsup",":thumbsdown:":"thumbsdown",":namaste:":"namaste",":super:":"super",":victory:":"victory",":yoyo:":"yoyo",":raising-hand:":"raising-hand",":clap:":"clap",":bye-bye:":"bye-bye",":fist:":"fist",":biceps:":"biceps",":birthday:":"birthday",":champagne:":"champagne",":chicken:":"chicken",":christmas-tree:":"christmas-tree",":coffee-cup:":"coffee-cup",":eid-mubarak:":"eid-mubarak",":fireworks:":"fireworks",":food:":"food",":gift-box:":"gift-box",":kaaba:":"kaaba",":new-year:":"new-year",":party:":"party",":peanuts:":"peanuts",":santa-hat:":"santa-hat",":fire:":"fire",":fire-extinguisher:":"fire-extinguisher",":first-aid-box:":"first-aid-box",":medicine:":"medicine",":poop:":"poop",":gold-medal:":"gold-medal",":silver-medal:":"silver-medal",":bronze-medal:":"bronze-medal",":refugee-olympic-team:":"refugee-olympic-team",":archer:":"archer",":badminton-player:":"badminton-player",":baseball:":"baseball",":basketball-player:":"basketball-player",":boxer:":"boxer",":canoeing:":"canoeing",":chess:":"chess",":cricket:":"cricket",":discus-throw:":"discus-throw",":diver:":"diver",":equestrian:":"equestrian",":fencer:":"fencer",":flag:":"flag",":foosball:":"foosball",":football:":"football",":golf:":"golf",":hammer-throw:":"hammer-throw",":high-jump:":"high-jump",":hockey:":"hockey",":hurdler:":"hurdler",":javelin-throw:":"javelin-throw",":aeroplane:":"aeroplane",":ambulance:":"ambulance",":americas:":"americas",":asia-pacific:":"asia-pacific",":athlete:":"athlete",":auditorium:":"auditorium",":badminton:":"badminton",":basketball:":"basketball",":batsman:":"batsman",":batter:":"batter",":bicycle:":"bicycle",":bowler:":"bowler",":break-boy:":"break-boy",":break-girl:":"break-girl",":bug:":"bug",":bus:":"bus",":cafeteria:":"cafeteria",":calendar:":"calendar",":car:":"car",":chess-player:":"chess-player",":cruiser-bike:":"cruiser-bike",":europe-africa:":"europe-africa",":female-tabletennis-player:":"female-tabletennis-player",":female-tennis-player:":"female-tennis-player",":female-volleyball-player:":"female-volleyball-player",":fire-engine:":"fire-engine",":football-player:":"football-player",":garden:":"garden",":golfer:":"golfer",":gym:":"gym",":gymnast:":"gymnast",":hockey-player:":"hockey-player",":home:":"home",":judo:":"judo",":karate:":"karate",":laptop:":"laptop",":library:":"library",":long-jump:":"long-jump",":mail-room:":"mail-room",":male-tabletennis-player:":"male-tabletennis-player",":male-tennis-player:":"male-tennis-player",":male-volleyball-player:":"male-volleyball-player",":man-cycling:":"man-cycling",":man-dancing:":"man-dancing",":man-running:":"man-running",":man-swimming:":"man-swimming",":milestone:":"milestone",":motor-scooter:":"motor-scooter",":office:":"office",":parking:":"parking",":passenger-ship:":"passenger-ship",":pharmacy:":"pharmacy",":pitcher:":"pitcher",":playground:":"playground",":pole-vault:":"pole-vault",":police-car:":"police-car",":processor:":"processor",":report:":"report",":rhythmic-gymnastics:":"rhythmic-gymnastics",":security:":"security",":server:":"server",":shooter:":"shooter",":shotput-throw:":"shotput-throw",":singing:":"singing",":snooker-player:":"snooker-player",":snooker:":"snooker",":sports-bike:":"sports-bike",":store:":"store",":table-tennis:":"table-tennis",":target:":"target",":task:":"task",":taxi:":"taxi",":tennis:":"tennis",":train:":"train",":volleyball:":"volleyball",":weightlifting:":"weightlifting",":woman-cycling:":"woman-cycling",":woman-dancing:":"woman-dancing",":woman-running:":"woman-running",":woman-swimming:":"woman-swimming",":wrestling:":"wrestling",":yoga:":"yoga"},e.ZSConstants.Smiley=a}(this);
!function(e){var t,s=e.sPlusPlus.data.AppRegistry.WMS_CSS_URL;(t=document.createElement("link")).rel="stylesheet",t.type="text/css",t.href=s,document.body.appendChild(t),JSUtil.LinkMaker.loadSmiley()}(this);
!function(e){var t,i,n,a=e.sPlusPlus,l=e.ZSClass,s=e.UserAction,c=e.document,d=e.UIUtil.Component,o=e.ZSConstants.I18N,r=a.view.Toolbar.Feature.FEEDBACK,u=e.ZSEvents,f=u.topic,v=u.Groups,p=u.Names,b=new function(){l.KeyMapping.call(this)},h=a.view.Events.Key;h.Entry.Dialog.Node.addChildNode(b);var k,m,E,F,y,g,C,A,L=0,S=!1,B=[],D=0,I=0;function x(){i.disabled=!0,d.zcombo("#feedbackOpt","setValue","Need help"),t.placeholder=o["Feedback.TextArea.Needhelp"],t.value="",L=0;for(var e=0;e<n.length;e++)n[e].classList.remove("checked");B=[],I=0,D=0,m.querySelector("#fileList").innerHTML="",h.focusContext(h.Entry.Dialog.Context)}function T(){if(k.close(),h.focusContext(h.Entry.CellEditor.Context),!S){N(void 0,"fbClose")}a.data.AppRegistry.allowSPFeedbackIcon&&f.publish(v.UI,p.SidePanel.FEEDBACKICON.REMOVE)}function w(e,t){if(L=parseInt(this.id),t[e].classList.contains("checked"))for(var n=e+1;n<5;n++)void 0!=t[n]&&t[n].classList.remove("checked");else for(n=e;n>=0;n--)void 0!=t[n]&&(t[n].classList.add("checked"),1==i.disabled&&(i.disabled=!1))}function N(e,i){S=!0;var n=a.view.getActiveGridID(),l=a.view.getResourceID(n),c=a.view.getVersionID(n),d=t.value,o=m.querySelector("#feedbackOpt").value,r=L,u="fbClose"==i?i:"fbSubmit";s.SendFeedback(l,c,d,"switchBackFeedback",o,r,u,B),"fbSubmit"==u&&(y.style.display="none",g.style.display="",C=setTimeout(function(){E.classList.add("sPFdBckAnimate"),A=setTimeout(function(){k.close(),O()},500)},3e3))}function O(){clearTimeout(C),E.classList.remove("sPFdBckAnimate"),y.style.display="",g.style.display="none"}function q(){var e=F.files;if(B.length+e.length>5)z(!0);else{if(e.length>0)for(var t=m.querySelector("#fileList"),i=0;i<e.length;i++){var n=e[i].name,a=n.substring(0,n.lastIndexOf(".")),l=n.substring(n.lastIndexOf(".")+1),s=e[i].size;if(!((I+=s)<=15e6))return I-=s,void z(!1);e[i].id=D,B.push(e[i]);var d=c.createElement("li");d.setAttribute("id",D),d.title=n,D++;var o=c.createElement("span");o.className="sPFdBckFlName",o.innerText=a;var r=c.createElement("span");r.innerText="."+l;var u=c.createElement("span");u.className="sPFdBckFlCls",u.innerHTML="&times;",u.addEventListener("click",P.bind(d,D,s)),d.appendChild(o),d.appendChild(r),d.appendChild(u),t.appendChild(d)}F.value=""}}function P(e,t){var i,n=m.getElementsByTagName("li");I-=t;for(var a=0;a<n.length;a++)this===n[a]&&(i=a);this.remove(),B.splice(i,1)}function z(e){var t=k&&k.getDialog(),i=e?o["Feedback.NotifyBanner.FileLimitExceeded"]:o["Feedback.NotifyBanner.FileSizeExceeded"],n=new l.TBNotification(i,{type:"info",parent:t});t&&n.show(),F.value=""}r.showFeedBackDialog=function(){S=!1,k?(O(),clearTimeout(A)):function(){var a=window.innerWidth,l={width:410,left:a-410-68,title:o.Feedback,closeOnEsc:T,close:T,open:x},r=s.getTemplate(["FEEDBACK_DIALOG"]);(m=c.createElement("div")).id="DI_FEEDBACK_DIALOG",m.appendChild(r.FEEDBACK_DIALOG),k=new e.ZSClass.Dialog(m,l),(E=k.Dom).classList.add("topAdjust"),y=m.querySelector("#feedbackForm"),g=m.querySelector("#feedbackResponse"),i=m.querySelector("#zsFeedbackSubmitBtn"),t=m.querySelector("#zsFeedbackMsg");var u=[o["Feedback.TextArea.Love"],o["Feedback.TextArea.Idea"],o["Feedback.TextArea.Needhelp"],o["Feedback.TextArea.FoundBug"]];d.bind("#feedbackOpt","zselectboxchange",function(e,i){t.placeholder=u[i.selectedIndex]}),function(){m.querySelector("#zsFeedbackCnclBtn").addEventListener("click",T),i.addEventListener("click",N),n=m.querySelectorAll(".shRateStar");for(var e=0;e<n.length;e++){var a=n[e];a.addEventListener("click",w.bind(a,e,n))}t.addEventListener("keyup",function(){i.disabled=""==t.value&&0==L}),(F=m.querySelector("#fileUploadId")).addEventListener("change",q)}()}(),!k.isAlive()&&k.open()}}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSEvents,s=i.topic,r=i.Groups,n=i.Names,o=e.UserAction,g=e.ZSDevTools.Logger;s.register(r.Listener,n.GridAction.WAKEUPCALL,function(){var e=t.view.getActiveGridID(),i=t.view.getResourceID(e),s=t.view.getVersionID(e),r=t.view.getSheetID(e);g.log("getStatus : startGetStatus"),o.doGetStatus(i,r,s,!1)}),s.register(r.Listener,n.ServerAction.GET_STATUS_RESPONSE,function(e){var i=t.view.getActiveGridID(),s=t.view.getResourceID(i),r=t.view.getVersionID(i),n=t.view.getSheetID(i);e&&e.isengineless&&(g.log("getStatus : checkGetStatusResponse is EngineLess: "+e.isengineless),o.doGetStatus(s,n,r,!0))},"RESPONSE"),s.register(r.Listener,n.Browser.WINDOW.VISIBILITY_CHANGE,function(e){var i=t.view.getActiveGridID(),s=t.view.getResourceID(i),r=t.view.getVersionID(i),n=t.view.getSheetID(i);o.doGetStatus(s,n,r,e)},"visible")}(this);
!function(e){var n,t,r,u,E,l=e.sPlusPlus,i=e.ZSEvents,S=i.topic,f=i.Groups,s=i.Names,o=e.sPlusPlus.view.Events.Key.Entry.Ole.Context.keyDown,D=e.ZSConstants.JSKeyCode,I=ZSClass.Layer.Modules.Move,R=I.Helper,a=I.StickyHelper,c=500;function T(){clearTimeout(n),n=setTimeout(function(){S.publish(f.Listener,s.Layers.Ole.MoveEnd,{RID:t,SHEETID:r,VERSION:u,HELPER:E})},c)}function v(e,n,l,i){t=e,r=n,u=l,E=i,S.publish(f.Listener,s.Layers.Ole.Move,{RID:e,SHEETID:n,VERSION:l,HELPER:i})}var p=new R(-1,0,T),H=new R(1,0,T),P=new R(0,1,T),L=new R(0,-1,T);var O=new R(-10,0,T),w=new R(10,0,T),y=new R(0,10,T),N=new R(0,-10,T);var U=0,C=1,F=2,A=3,h=new a(U,!1,T),b=new a(C,!1,T),V=new a(F,!1,T),B=new a(A,!1,T),G=new a(U,!0,T),K=new a(C,!0,T),d=new a(F,!0,T),x=new a(A,!0,T);function M(e,n,t,r){return e.preventDefault(),S.publish(f.Listener,s.Layers.Ole.Delete,{RID:n,SHEETID:t,VERSION:r}),!1}function W(){return!1}o[D.PURE_PRINTABLE_CHAR]=W,o[D.ESC]=function(e,n,t,r){S.publish(f.Listener,s.Layers.Ole.Blur,{RID:n,SHEETID:t,VERSION:r});var u=l.view.Events.Key;u.focusContext(u.Entry.CellEditor.Context)},o[D.SUPER+"+"+D.A]=function(e,n,t,r){return e.preventDefault(),S.publish(f.Listener,s.Layers.Ole.SelectAll,{RID:n,SHEETID:t,VERSION:r}),!1},o[D.DELETE]=M,o[D.BACKSPACE]=M,o[D.SUPER+"+"+D.DELETE]=M,o[D.SUPER+"+"+D.BACKSPACE]=M,o[D.TAB]=function(e,n,t,r){return e.preventDefault(),S.publish(f.Listener,s.Layers.Ole.SelectNext,{RID:n,SHEETID:t,VERSION:r}),!1},o[D.SHIFT+"+"+D.TAB]=function(e,n,t,r){return e.preventDefault(),S.publish(f.Listener,s.Layers.Ole.SelectPrev,{RID:n,SHEETID:t,VERSION:r}),!1},o[D.ENTER]=W,o[D.SHIFT+"+"+D.ENTER]=W,o[D.LEFT]=function(e,n,t,r){return e.preventDefault(),v(n,t,r,p),!1},o[D.RIGHT]=function(e,n,t,r){return e.preventDefault(),v(n,t,r,H),!1},o[D.UP]=function(e,n,t,r){return e.preventDefault(),v(n,t,r,L),!1},o[D.DOWN]=function(e,n,t,r){return e.preventDefault(),v(n,t,r,P),!1},o[D.SHIFT+"+"+D.LEFT]=function(e,n,t,r){return e.preventDefault(),v(n,t,r,O),!1},o[D.SHIFT+"+"+D.RIGHT]=function(e,n,t,r){return e.preventDefault(),v(n,t,r,w),!1},o[D.SHIFT+"+"+D.UP]=function(e,n,t,r){return e.preventDefault(),v(n,t,r,N),!1},o[D.SHIFT+"+"+D.DOWN]=function(e,n,t,r){return e.preventDefault(),v(n,t,r,y),!1},o[D.SUPER+"+"+D.LEFT]=function(e,n,t,r){return e.preventDefault(),v(n,t,r,h),!1},o[D.SUPER+"+"+D.RIGHT]=function(e,n,t,r){return e.preventDefault(),v(n,t,r,b),!1},o[D.SUPER+"+"+D.UP]=function(e,n,t,r){return e.preventDefault(),v(n,t,r,V),!1},o[D.SUPER+"+"+D.DOWN]=function(e,n,t,r){return e.preventDefault(),v(n,t,r,B),!1},o[D.SUPER+"+"+D.SHIFT+"+"+D.LEFT]=function(e,n,t,r){return e.preventDefault(),v(n,t,r,G),!1},o[D.SUPER+"+"+D.SHIFT+"+"+D.RIGHT]=function(e,n,t,r){return e.preventDefault(),v(n,t,r,K),!1},o[D.SUPER+"+"+D.SHIFT+"+"+D.UP]=function(e,n,t,r){return e.preventDefault(),v(n,t,r,d),!1},o[D.SUPER+"+"+D.SHIFT+"+"+D.DOWN]=function(e,n,t,r){return e.preventDefault(),v(n,t,r,x),!1},o[D.SUPER+"+"+D.C]=function(e,n,t,r){return S.publish(f.Listener,s.Layers.Ole.Copy,{RID:n,SHEETID:t,VERSION:r}),!1}}(this);
!function(t){if(t.isCanvasGrid){var e=t.sPlusPlus,r=t.ZSEvents,n=(r.topic,r.Groups,r.Names,t.ZSGrid),i=n.Print||(n.Print={}),o="rl-tb",a=document.createElement("div");a.className="main_div";var s=document.querySelector("#PrintContainer");c.prototype={showPreview:function(t,e,r,n){s.appendChild(a),!this.Printer.dummyPagesLoaded&&this.Printer.loadDummyPages(this.PrintInteractor.pgCnt);var i=this.PrintInteractor.getBufferAry(t,e,this.Printer);if(i.length>0){var o=this;this.PrintInteractor.loadBufferArray(i,function(t){o.renderPreview(t,r)},function(){o.printMetaLoaded||(o.printMetaLoaded=!0,o.PrintInteractor.findPagesWithSparkline())},this.printMetaLoaded,n)}else r&&r()},renderPreview:function(t,e){this.Printer.load(t,e)},flushPrinter:function(){this.PrintInteractor&&this.PrintInteractor.lmtExcdNtf.remove(),this.Printer&&this.Printer.flush(),a.innerHTML="",a.parentElement&&s.removeChild(a)},getTotalPageCount:function(){return this.PrintInteractor.pgCnt},refresh:function(){var t=this.PrintInteractor.pgsWithSparklines;if(t&&t.length>0)for(var e=0;e<t.length;e++)this.Printer.refreshPage(t[e])},goToPage:function(t,e){this.showPreview(t-2,t+2,e,!0)},print:function(t){var e=this.PrintInteractor.pgCnt,r=this;this.showPreview(0,e,function(){var n=r.Printer.pages;r.proceedPrint=!0;for(var i=0;i<e;i++)if(""===n[i].image.getAttribute("src")){r.proceedPrint=!1;break}r.doPrint(),t&&t()},!0)},doPrint:function(){if(a&&this.proceedPrint){this.proceedPrint=!1;var t=document.querySelector("#printFrame");t.contentDocument.body.querySelector("#printDataContainer").innerHTML=a.outerHTML,setTimeout(function(){t.contentWindow.print()},2e3)}}},i.Preview=c}function c(t,r,n,s,c,d,h,P){var u=e.data.getWorkBook(r,s).getSheetObj(n);c.maxRow=h,c.maxCol=P,c.fixedWidth=0,c.fixedHeight=0,c.headerHeight=0,c.footerHeight=0,c.freezedRow=0,c.freezedCol=0,c.printRange=d,c.isFlip=u.gridDirection==o,this.printDetails=c,this.PrintInteractor=new i.PrintInteractor(t,r,n,s,c),a.innerHTML="",this.Printer=new i.Printer(this.PrintInteractor,a),this.printMetaLoaded=!1,function(t){var r=(i=e.data.AppRegistry.CSSPath,"<link rel='stylesheet' type='text/css' href='"+i+"defer/print.css'/><style type='text/css'> @page {margin: 0cm;} </style>"),n=document.querySelector("#printFrame");var i;n.contentDocument.body.innerHTML="",n.contentDocument.body.innerHTML=r;var o=document.createElement(o);o.id="printDataContainer",n.appendChild(o),n.contentDocument.body.appendChild(o)}(c.Orientation)}}(this);
!function(t){if(t.isCanvasGrid){t.sPlusPlus;var e=t.ZSGrid,i=(t.ZSClass,e.Print||(e.Print={}));n.prototype={push:function(t){for(var e=0;e<t.length;e++)this.bufferArray[this.bufferArray.length]=t[e]},getContentImage:function(t,e){var i=this.printInteractor,n=i.onComputeCoordinates(t,this.contentWidth,this.contentHeight,i.getRowLimit(),i.getColLimit());n.isOutOfBounds||(this.PrintWindow.setPageDimension(n.width,n.height,i),this.PrintWindow.setPosition(t,n.setX,n.setY),this.PrintWindow.getImage(i,function(t){e(t)}))},getPage:function(t,e){var n=this.printInteractor;return new i.Page(t,this.pageWidth,this.pageHeight,n,function(){n.onPageCreate(t,this,"")})},load:function(t,e){e&&0==this.bufferArray.length?this.refreshPage(t,e):this.refreshPage(t)},loadDummyPages:function(t){this.dummyPagesLoaded=!0;for(var e=0;e<t;e++)this.pages[e]=this.getPage(e),this.outputContainer.appendChild(this.pages[e].getPage())},appendTo:function(t){var e=this;Object.keys(this.pages).forEach(function(i){t.appendChild(e.pages[i])})},refreshPage:function(t,e){var i=this.pages[t];if(i){var n=this.printInteractor;this.getContentImage(t,function(t){n.imgSource(i.image,t),e&&e()})}},print:function(){window.print()},flush:function(){this.printInteractor.clearData(),this.pages={},this.outputContainer=""}},i.Printer=n}function n(t,e){this.outputContainer=e,this.container=document.createElement("div"),this.container.className="printContainerCanvas",this.bufferArray=[],this.pages={},this.printInteractor=t,function(t){var e,i,n;n="@page { size:"+t.pageSize+"  "+t.layout+" ; } ",e=document.head||document.getElementsByTagName("head")[0],(i=document.createElement("style")).type="text/css",i.media="print",i.styleSheet?i.styleSheet.cssText=n:i.appendChild(document.createTextNode(n)),e.appendChild(i)}.call(this,t),function(t){var e=i.getPageSize(t.layout,t.pageSize);this.pageHeight=e.height,this.pageWidth=e.width,this.contentHeight=this.pageHeight-t.marginTop-t.marginBottom,this.contentWidth=this.pageWidth-t.marginLeft-t.marginRight}.call(this,t),this.PrintWindow=new i.PrintWindow(t.viewPortWidth,t.viewPortHeight,t.isHideHeaders(),t.isHideScrollBars())}}(this);
!function(t){if(t.isCanvasGrid){t.sPlusPlus;var e=t.ZSGrid,s=e.UIPaneManager,i=e.Print||(e.Print={});h.prototype={setPosition:function(t,e,s){var i=this.xAxles[0].getWidth();this.xAxles[2].setScrollX(e-t*i),this.yAxles[2].setScrollY(s)},setPageDimension:function(t,e,s){var i=s.freezedRow,h=s.freezedCol,n=s.scaleX,a=s.scaleY,l=s.isFlip;(function(t,e,s,i,h,n,a,l){(function(t,e,s,i,h){this.setFlip(h),this.scale(s,i),this.canvas.style.width=t+"px",this.canvas.style.height=e+"px",function(t,e,s){if(!(t.width>=3*e&&t.height>=3*s)){var i=t.getContext("2d");t.width=3*e,t.height=3*s,t.style.width=e+"px",t.style.height=s+"px",i.scale(3,3)}}(this.canvas,t,e)}).call(this,e,s,n,a,l);var o=l,x=this.xAxles[0].getWidth(),r=this.yAxles[0].getHeight(),c=this.xAxles[3].getWidth(),g=this.yAxles[3].getHeight(),A=0,d=x,y=A+d,v=t.getColX(h)*n,p=y+v,u=e-p-c,w=p+u,C=c,f=r,P=0+f,m=t.getRowY(i)*a,X=P+m,V=s-X-g,M=X+V,R=g;o&&(A=this.translateX(e,A,d),y=this.translateX(e,y,v),p=this.translateX(e,p,u),w=this.translateX(e,w,C)),this.xAxles[0].set(A,d),this.xAxles[1].set(y,v),this.xAxles[2].set(p,u),this.xAxles[3].set(w,C),this.yAxles[0].set(0,f),this.yAxles[1].set(P,m),this.yAxles[2].set(X,V),this.yAxles[3].set(M,R),this.xAxles[0].setContentViewPort(A,d),this.xAxles[1].setContentViewPort(y,v);var S=t.getColX(t.getMaxColumn()-1),W=t.getColWidth(t.getMaxColumn()-1);this.xAxles[2].setContentViewPort(v,Math.max(v+u,(S+W)*n+400)),this.xAxles[3].setContentViewPort(w,R),this.yAxles[0].setContentViewPort(0,f),this.yAxles[1].setContentViewPort(0,m);var H=t.getRowY(t.getMaxRow()-1),Y=t.getRowHeight(t.getMaxRow()-1);this.yAxles[2].setContentViewPort(m,Math.max(m+V,(H+Y)*a+400)),this.yAxles[3].setContentViewPort(M,C)}).call(this,s,t+2,e+2,i,h,n,a,l)},getImage:function(t,e){var s=this,i=0;this.apply(function(t){i++}),this.apply(function(h){h.onBeforeFill(t),h.updateScroll(t,function(){if(0==--i){var t=s.canvas.toDataURL("image/svg");e(t)}})})},nextPage:function(t,e){this.setPosition(this.xAxles[3].getX(),this.yAxles[2].getY()),this.getImage(t,e)},hideScrollBars:function(){this.xAxles[3].width=this.xAxles[3].CWidth=0,this.yAxles[3].height=this.yAxles[3].CHeight=0}},h.prototype=Object.assign({},s.prototype,h.prototype),i.PrintWindow=h}function h(t,e,i,h){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.container=document.createElement("div"),this.container.appendChild(this.canvas),s.call(this,this.canvas,this.container,void 0),i&&this.hideHeaders(),h&&this.hideScrollBars()}}(this);
!function(t){if(t.isCanvasGrid){var e=t.ZSGrid,i=e.Print||(e.Print={}),s=""===document.createElement("detect").style.zoom;n.prototype={getContentDom:function(){return this.content},getImgDom:function(){return this.image},getPage:function(){return this.page},setContentStyle:function(){this.content=document.createElement("div"),this.content.className="content",this.content.style.left=this.interactor.marginLeft+"px",this.content.style.right=this.interactor.marginRight+"px",this.content.style.top=this.interactor.marginTop+"px",this.content.style.bottom=this.interactor.marginBottom+"px",this.content.style.height="auto",this.content.style.width="auto"},setContentDim:function(t,e,i){this.content.style.height=t+"px",this.content.style.width=e+"px",i&&(s?this.content.style.zoom=i:(this.content.style.transform="scale("+i+")",this.content.style.transformOrigin="0 0"))},setImgStyle:function(){this.image=document.createElement("img"),this.image.className="image";s?this.image.style.zoom=.333:(this.image.style.transform="scale(0.333)",this.image.style.transformOrigin="0 0")},setPageSize:function(){this.page.style.height=this.pageHeight+"px",this.page.style.width=this.pageWidth+"px",this.page.style.pageBreakAfter="always",this.page.style.pageBreakInside="avoid"},setOLEs:function(){for(var t=this.interactor.getOLEs(this.pageId),e=t.length,i=0;i<e;i++)t[i].dom.id="prev_"+t[i].id,this.content.appendChild(t[i].dom)}},i.Page=n}function n(t,e,i,s,n){this.pageId=t,this.pageWidth=e,this.pageHeight=i,this.interactor=s,this.setPage=n,this.page=document.createElement("div"),this.page.className="page_divCanvas",this.page.id="pg"+t,s.isFlip&&(this.page.style.direction="rtl"),this.setPageSize(),this.setContentStyle(),this.setImgStyle(),n.call(this,t),this.page.appendChild(this.content),this.content.appendChild(this.image),this.setOLEs()}}(this);
!function(i){if(i.isCanvasGrid){var t=i.ZSGrid,h=t.Print||(t.Print={}),e={a3:{width:n("11.69in"),height:n("16.54in")},a4:{width:n("8.27in"),height:n("11.69in")},a5:{width:n("5.83in"),height:n("8.27in")},b4:{width:n("9.84in"),height:n("13.90in")},b5:{width:n("6.93in"),height:n("9.84in")},letter:{width:n("8.5in"),height:n("11in")},legal:{width:n("8.5in"),height:n("14in")},executive:{width:n("7.25in"),height:n("10.5in")},envelope10:{width:n("4.13n"),height:n("9.5in")}};h.getPageSize=function(i,t){var h,n;return e[t]||(t="a4"),"portrait"===i?(h=e[t].height,n=e[t].width):(h=e[t].width,n=e[t].height),{width:parseFloat(n.toFixed(2)),height:parseFloat(h.toFixed(2))}},h.addPageSize=function(i,t,h){e[i]={},e[i].height=n(t),e[i].width=n(h)}}function n(i){return 96*parseFloat(i)}}(this);
!function(t){if(t.isCanvasGrid){var e=t.sPlusPlus,s=t.ZSGrid,n=t.ZSClass,i=s.Print||(s.Print={}),a=n.DataCacheClasses.Page,l=(n.Range,e.data.Defaults);l.MAX_COL,l.MAX_ROW,t.JSUtil,new s.Cell(-1,0,0,null,null,null,null,"transparent",0);r.prototype={load:function(t,e,s,n,i,l,r,o){var h=this,u=[];for(var g in i){var C=i[g];u.push(i[g]),this.Pages[g]=new a(C.startRow,C.endRow,C.startCol,C.endCol)}this.printRangeCallBack(t,e,s,n,u,o,function(){r(),h.getPages(e,s,n,i,l,o)})},getPages:function(t,e,s,n,i,a){for(var l in n){var r=n[l],o=l;this.fetcher(t,e,s,this.gridID,r,this.setCell.bind(this,o),i.bind(null,o),a)}},setCell:function(t,e,s,n){this.Pages[t].setCell(e,s,n)},getCell:function(t,e,s){return this.Pages[t]?this.Pages[t].getCell(e,s):null},isRowExists:function(t,e){return!!this.Pages[t]&&this.Pages[t].isRowAvailable(e)},getRow:function(t,e){return this.Pages[t]?this.Pages[t].getRow(e):null},getNextContentIndex:function(t,e,s){return this.isRowExists(t,e)?this.getRow(t,e).getNextContentIndex(s):null},getPrevContentIndex:function(t,e,s){return this.isRowExists(t,e)?this.getRow(t,e).getPrevContentIndex(s):null}},i.DataCache=r}function r(t,e,s,n,i,a){this.gridID=t,this.rID=e,this.sheetID=s,this.version=n,this.printRangeCallBack=i,this.fetcher=a,this.Pages={}}}(this);
!function(t){if(t.isCanvasGrid){var a=t.sPlusPlus,e=t.ZSClass,n=t.ZSGrid,i=t.ZSEvents,r=i.topic,l=i.Groups,o=i.Names,s=n.Print||(n.Print={}),c=a.data.Defaults,u=(c.MAX_ROW,c.MAX_COL,{});s.getDataCache=function(t,a,e,n){return u[a]||(u[a]={}),u[a][n]||(u[a][n]={}),u[a][n][e]?u[a][n][e]:(u[a][n][e]=new s.DataCache(t,a,e,n,C,h),u[a][n][e])},s.clearDataCache=function(t,a,e){(u[t]&&u[t][e]?Object.keys(u[t][e]):[]).length&&delete u[t][e][a]}}function C(t,e,n,i,s,c,u){var C=function(t){var a=t.metaList;r.publish(l.Listener,o.ViewPortMeta.LIST_RESPONSE,{RID:e,SHEETID:n,VERSION:i,LIST:a})}.bind(this),h=function(){u()}.bind(this),f=function(){}.bind(this);a.view.fetchPrintRangeData(e,n,i,s,["ActualValue","DisplayValue","Format","Formula","ConditionalFormat","CellComment","Hyperlink","CellType","patternColor","Pattern","IsContentValid","hasLink","isCheckbox","Picklist","repeatIndex","repeatChar"],t,c,h,f,C)}function h(t,n,i,r,l,o,s,c){var u=function(a){for(var r in a){var l=a[r];for(var c in l){var u=l[c],C=e.getPrintCellObject(t,n,i,~~r,~~c,u);o(r,c,C)}}s()}.bind(this),C=function(t){}.bind(this);a.view.fetchRangeData(t,n,i,l,["ActualValue","DisplayValue","Format","Formula","ConditionalFormat","CellComment","Hyperlink","CellType","patternColor","Pattern","IsContentValid","hasLink","isCheckbox","Picklist","repeatIndex","repeatChar"],!0,r,u,C)}}(this);
!function(t,e){"object"==typeof module&&module.exports?(e.default=e,module.exports=t.document?e(t):e):"function"==typeof define&&define.amd?define("highcharts/highstock",function(){return e(t)}):(t.Highcharts&&t.Highcharts.error(16,!0),t.Highcharts=e(t))}("undefined"!=typeof window?window:this,function(t){var e={};function i(t,e,i,s){t.hasOwnProperty(e)||(t[e]=s.apply(null,i))}return i(e,"parts/Globals.js",[],function(){var e=void 0!==t?t:"undefined"!=typeof window?window:{},i=e.document,s="http://www.w3.org/2000/svg",o=e.navigator&&e.navigator.userAgent||"",n=i&&i.createElementNS&&!!i.createElementNS(s,"svg").createSVGRect,r=/(edge|msie|trident)/i.test(o)&&!e.opera,a=-1!==o.indexOf("Firefox"),h=-1!==o.indexOf("Chrome"),l=a&&parseInt(o.split("Firefox/")[1],10)<4;return{product:"Highcharts",version:"8.0.0",deg2rad:2*Math.PI/360,doc:i,hasBidiBug:l,hasTouch:!!e.TouchEvent,isMS:r,isWebKit:-1!==o.indexOf("AppleWebKit"),isFirefox:a,isChrome:h,isSafari:!h&&-1!==o.indexOf("Safari"),isTouchDevice:/(Mobile|Android|Windows Phone)/.test(o),SVG_NS:s,chartCount:0,seriesTypes:{},symbolSizes:{},svg:n,win:e,marginNames:["plotTop","marginRight","marginBottom","plotLeft"],noop:function(){},charts:[],dateFormats:{}}}),i(e,"parts/Utilities.js",[e["parts/Globals.js"]],function(t){t.timers=[];var e,i,s=t.charts,o=t.doc,n=t.win;function r(t,e){return parseInt(t,e||10)}function a(t){return"string"==typeof t}function h(t){var e=Object.prototype.toString.call(t);return"[object Array]"===e||"[object Array Iterator]"===e}function l(t,e){return!(!t||"object"!=typeof t||e&&h(t))}function c(t){return l(t)&&"number"==typeof t.nodeType}function d(t){var e=t&&t.constructor;return!(!l(t,!0)||c(t)||!e||!e.name||"Object"===e.name)}function p(t){return"number"==typeof t&&!isNaN(t)&&t<1/0&&t>-1/0}function u(t){return void 0!==t&&null!==t}function f(t,e,i){var s;return a(e)?u(i)?t.setAttribute(e,i):t&&t.getAttribute&&((s=t.getAttribute(e))||"class"!==e||(s=t.getAttribute(e+"Name"))):b(e,function(e,i){t.setAttribute(i,e)}),s}function g(t,e){var i;for(i in t||(t={}),e)t[i]=e[i];return t}function m(){for(var t=arguments,e=t.length,i=0;i<e;i++){var s=t[i];if(void 0!==s&&null!==s)return s}}function x(t,e){var i=function(){};return g(i.prototype=new t,e),i}function v(t,e){return parseFloat(t.toPrecision(e||14))}function y(e,i,s,o){e=+e||0,i=+i;var n,a,h,l,c,d=t.defaultOptions.lang,u=(e.toString().split(".")[1]||"").split("e")[0].length,f=e.toString().split("e");return-1===i?i=Math.min(u,20):p(i)?i&&f[1]&&f[1]<0&&((c=i+ +f[1])>=0?(f[0]=(+f[0]).toExponential(c).split("e")[0],i=c):(f[0]=f[0].split(".")[0]||0,e=i<20?(f[0]*Math.pow(10,f[1])).toFixed(i):0,f[1]=0)):i=2,l=(Math.abs(f[1]?f[0]:e)+Math.pow(10,-Math.max(i,u)-1)).toFixed(i),a=(n=String(r(l))).length>3?n.length%3:0,s=m(s,d.decimalPoint),o=m(o,d.thousandsSep),h=e<0?"-":"",h+=a?n.substr(0,a)+o:"",h+=n.substr(a).replace(/(\d{3})(?=\d)/g,"$1"+o),i&&(h+=s+l.slice(-i)),f[1]&&0!=+h&&(h+="e"+f[1]),h}function b(t,e,i){for(var s in t)Object.hasOwnProperty.call(t,s)&&e.call(i||t[s],t[s],s,t)}return t.error=function(e,i,s,o){var r=p(e),a=r?"Highcharts error #"+e+": www.highcharts.com/errors/"+e+"/":e.toString(),h=function(){if(i)throw new Error(a);n.console};if(void 0!==o){var l="";r&&(a+="?"),t.objectEach(o,function(t,e){l+="\n"+e+": "+t,r&&(a+=encodeURI(e)+"="+encodeURI(t))}),a+=l}s?t.fireEvent(s,"displayError",{code:e,message:a,params:o},h):h()},t.Fx=function(t,e,i){this.options=e,this.elem=t,this.prop=i},t.Fx.prototype={dSetter:function(){var t,e=this.paths[0],i=this.paths[1],s=[],o=this.now,n=e.length;if(1===o)s=this.toD;else if(n===i.length&&o<1)for(;n--;)t=parseFloat(e[n]),s[n]=isNaN(t)||"A"===i[n-4]||"A"===i[n-5]?i[n]:o*parseFloat(""+(i[n]-t))+t;else s=i;this.elem.attr("d",s,null,!0)},update:function(){var t=this.elem,e=this.prop,i=this.now,s=this.options.step;this[e+"Setter"]?this[e+"Setter"]():t.attr?t.element&&t.attr(e,i,null,!0):t.style[e]=i+this.unit,s&&s.call(t,i,this)},run:function(e,i,s){var o=this,r=o.options,a=function(t){return!a.stopped&&o.step(t)},h=n.requestAnimationFrame||function(t){setTimeout(t,13)},l=function(){for(var e=0;e<t.timers.length;e++)t.timers[e]()||t.timers.splice(e--,1);t.timers.length&&h(l)};e!==i||this.elem["forceAnimate:"+this.prop]?(this.startTime=+new Date,this.start=e,this.end=i,this.unit=s,this.now=this.start,this.pos=0,a.elem=this.elem,a.prop=this.prop,a()&&1===t.timers.push(a)&&h(l)):(delete r.curAnim[this.prop],r.complete&&0===Object.keys(r.curAnim).length&&r.complete.call(this.elem))},step:function(t){var e,i,s=+new Date,o=this.options,n=this.elem,r=o.complete,a=o.duration,h=o.curAnim;return n.attr&&!n.element?e=!1:t||s>=a+this.startTime?(this.now=this.end,this.pos=1,this.update(),h[this.prop]=!0,i=!0,b(h,function(t){!0!==t&&(i=!1)}),i&&r&&r.call(n),e=!1):(this.pos=o.easing((s-this.startTime)/a),this.now=this.start+(this.end-this.start)*this.pos,this.update(),e=!0),e},initPath:function(t,e,i){e=e||"";var s,o,n,r,a,h=t.startX,l=t.endX,c=e.indexOf("C")>-1,d=c?7:3,u=e.split(" "),f=i.slice(),g=t.isArea,m=g?2:1;function x(t){var e,i;for(r=t.length;r--;)e="M"===t[r]||"L"===t[r],i=/[a-zA-Z]/.test(t[r+3]),e&&i&&t.splice(r+1,0,t[r+1],t[r+2],t[r+1],t[r+2])}function v(t,e,i){[].splice.apply(t,[i,0].concat(e))}function y(t,e){for(;t.length<o;)t[0]=e[o-t.length],v(t,t.slice(0,d),0),g&&(v(t,t.slice(t.length-d),t.length),r--);t[0]="M"}function b(t,e){for(var i=(o-t.length)/d;i>0&&i--;)(n=t.slice().splice(t.length/m-d,d*m))[0]=e[o-d-i*d],c&&(n[d-6]=n[d-2],n[d-5]=n[d-1]),v(t,n,t.length/m),g&&i--}if(c&&(x(u),x(f)),h&&l){for(r=0;r<h.length;r++){if(h[r]===l[0]){s=r;break}if(h[0]===l[l.length-h.length+r]){s=r,a=!0;break}if(h[h.length-1]===l[l.length-h.length+r]){s=h.length-r;break}}void 0===s&&(u=[])}return u.length&&p(s)&&(o=f.length+s*m*d,a?(y(u,f),b(f,u)):(y(f,u),b(u,f))),[u,f]},fillSetter:function(){t.Fx.prototype.strokeSetter.apply(this,arguments)},strokeSetter:function(){this.elem.attr(this.prop,t.color(this.start).tweenTo(t.color(this.end),this.pos),null,!0)}},t.merge=function(){var t,e,i=arguments,s={},o=function(t,e){return"object"!=typeof t&&(t={}),b(e,function(i,s){!l(i,!0)||d(i)||c(i)?t[s]=e[s]:t[s]=o(t[s]||{},i)}),t};for(!0===i[0]&&(s=i[1],i=Array.prototype.slice.call(i,2)),e=i.length,t=0;t<e;t++)s=o(s,i[t]);return s},t.clearTimeout=function(t){u(t)&&clearTimeout(t)},t.css=function(e,i){t.isMS&&!t.svg&&i&&void 0!==i.opacity&&(i.filter="alpha(opacity="+100*i.opacity+")"),g(e.style,i)},t.createElement=function(e,i,s,n,r){var a=o.createElement(e),h=t.css;return i&&g(a,i),r&&h(a,{padding:"0",border:"none",margin:"0"}),s&&h(a,s),n&&n.appendChild(a),a},t.datePropsToTimestamps=function(e){b(e,function(i,s){l(i)&&"function"==typeof i.getTime?e[s]=i.getTime():(l(i)||h(i))&&t.datePropsToTimestamps(i)})},t.formatSingle=function(e,i,s){var o,n=t.defaultOptions.lang,r=s&&s.time||t.time,a=s&&s.numberFormatter||y;return/f$/.test(e)?(o=(o=e.match(/\.([0-9])/))?o[1]:-1,null!==i&&(i=a(i,o,n.decimalPoint,e.indexOf(",")>-1?n.thousandsSep:""))):i=r.dateFormat(e,i),i},t.format=function(e,i,s){for(var o,n,r,a,h,l,c,d="{",p=!1,u=[];e&&-1!==(c=e.indexOf(d));){if(o=e.slice(0,c),p){for(h=(r=(n=o.split(":")).shift().split(".")).length,l=i,a=0;a<h;a++)l&&(l=l[r[a]]);n.length&&(l=t.formatSingle(n.join(":"),l,s)),u.push(l)}else u.push(o);e=e.slice(c+1),d=(p=!p)?"}":"{"}return u.push(e),u.join("")},t.getMagnitude=function(t){return Math.pow(10,Math.floor(Math.log(t)/Math.LN10))},t.normalizeTickInterval=function(t,e,i,s,o){var n,r,a=t;for(n=t/(i=m(i,1)),e||(e=o?[1,1.2,1.5,2,2.5,3,4,5,6,8,10]:[1,2,2.5,5,10],!1===s&&(1===i?e=e.filter(function(t){return t%1==0}):i<=.1&&(e=[1/i]))),r=0;r<e.length&&(a=e[r],!(o&&a*i>=t||!o&&n<=(e[r]+(e[r+1]||e[r]))/2));r++);return a=v(a*i,-Math.round(Math.log(.001)/Math.LN10))},t.stableSort=function(t,e){var i,s,o=t.length;for(s=0;s<o;s++)t[s].safeI=s;for(t.sort(function(t,s){return 0===(i=e(t,s))?t.safeI-s.safeI:i}),s=0;s<o;s++)delete t[s].safeI},t.timeUnits={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:24192e5,year:314496e5},Math.easeInOutSine=function(t){return-.5*(Math.cos(Math.PI*t)-1)},t.getStyle=function(e,i,s){var o;if("width"===i){var a=Math.min(e.offsetWidth,e.scrollWidth),h=e.getBoundingClientRect&&e.getBoundingClientRect().width;return h<a&&h>=a-1&&(a=Math.floor(h)),Math.max(0,a-t.getStyle(e,"padding-left")-t.getStyle(e,"padding-right"))}return"height"===i?Math.max(0,Math.min(e.offsetHeight,e.scrollHeight)-t.getStyle(e,"padding-top")-t.getStyle(e,"padding-bottom")):(n.getComputedStyle||t.error(27,!0),(o=n.getComputedStyle(e,void 0))&&(o=o.getPropertyValue(i),m(s,"opacity"!==i)&&(o=r(o))),o)},t.inArray=function(t,e,i){return e.indexOf(t,i)},t.find=Array.prototype.find?function(t,e){return t.find(e)}:function(t,e){var i,s=t.length;for(i=0;i<s;i++)if(e(t[i],i))return t[i]},t.keys=Object.keys,t.stop=function(e,i){for(var s=t.timers.length;s--;)t.timers[s].elem!==e||i&&i!==t.timers[s].prop||(t.timers[s].stopped=!0)},b({map:"map",each:"forEach",grep:"filter",reduce:"reduce",some:"some"},function(e,i){t[i]=function(t){return Array.prototype[e].apply(t,[].slice.call(arguments,1))}}),t.addEvent=function(e,i,s,o){void 0===o&&(o={});var n,r=e.addEventListener||t.addEventListenerPolyfill;n="function"==typeof e&&e.prototype?e.prototype.protoEvents=e.prototype.protoEvents||{}:e.hcEvents=e.hcEvents||{},t.Point&&e instanceof t.Point&&e.series&&e.series.chart&&(e.series.chart.runTrackerClick=!0),r&&r.call(e,i,s,!1),n[i]||(n[i]=[]);var a={fn:s,order:"number"==typeof o.order?o.order:1/0};return n[i].push(a),n[i].sort(function(t,e){return t.order-e.order}),function(){t.removeEvent(e,i,s)}},t.removeEvent=function(e,i,s){var o;function n(i,s){var o=e.removeEventListener||t.removeEventListenerPolyfill;o&&o.call(e,i,s,!1)}function r(t){var s,o;e.nodeName&&(i?(s={})[i]=!0:s=t,b(s,function(e,i){if(t[i])for(o=t[i].length;o--;)n(i,t[i][o].fn)}))}["protoEvents","hcEvents"].forEach(function(t,a){var h=a?e:e.prototype,l=h&&h[t];l&&(i?(o=l[i]||[],s?(l[i]=o.filter(function(t){return s!==t.fn}),n(i,s)):(r(l),l[i]=[])):(r(l),h[t]={}))})},t.fireEvent=function(t,e,i,s){var n,r;if(i=i||{},o.createEvent&&(t.dispatchEvent||t.fireEvent))(n=o.createEvent("Events")).initEvent(e,!0,!0),g(n,i),t.dispatchEvent?t.dispatchEvent(n):t.fireEvent(e,n);else{i.target||g(i,{preventDefault:function(){i.defaultPrevented=!0},target:t,type:e});!function(e,s){void 0===e&&(e=[]),void 0===s&&(s=[]);var o=0,n=0,a=e.length+s.length;for(r=0;r<a;r++)!1===(e[o]?s[n]?e[o].order<=s[n].order?e[o++]:s[n++]:e[o++]:s[n++]).fn.call(t,i)&&i.preventDefault()}(t.protoEvents&&t.protoEvents[e],t.hcEvents&&t.hcEvents[e])}s&&!i.defaultPrevented&&s.call(t,i)},t.animate=function(e,i,s){var o,n,r,a,h="";l(s)||(s={duration:(a=arguments)[2],easing:a[3],complete:a[4]}),p(s.duration)||(s.duration=400),s.easing="function"==typeof s.easing?s.easing:Math[s.easing]||Math.easeInOutSine,s.curAnim=t.merge(i),b(i,function(a,l){t.stop(e,l),r=new t.Fx(e,s,l),n=null,"d"===l?(r.paths=r.initPath(e,e.d,i.d),r.toD=i.d,o=0,n=1):e.attr?o=e.attr(l):(o=parseFloat(t.getStyle(e,l))||0,"opacity"!==l&&(h="px")),n||(n=a),n&&n.match&&n.match("px")&&(n=n.replace(/px/g,"")),r.run(o,n,h)})},t.seriesType=function(e,i,s,o,n){var r=t.getOptions(),a=t.seriesTypes;return r.plotOptions[e]=t.merge(r.plotOptions[i],s),a[e]=x(a[i]||function(){},o),a[e].prototype.type=e,n&&(a[e].prototype.pointClass=x(t.Point,n)),a[e]},t.uniqueKey=(e=Math.random().toString(36).substring(2,9),i=0,function(){return"highcharts-"+e+"-"+i++}),t.isFunction=function(t){return"function"==typeof t},n.jQuery&&(n.jQuery.fn.highcharts=function(){var e=[].slice.call(arguments);if(this[0])return e[0]?(new(t[a(e[0])?e.shift():"Chart"])(this[0],e[0],e[1]),this):s[f(this[0],"data-highcharts-chart")]}),{animObject:function(e){return l(e)?t.merge(e):{duration:e?500:0}},arrayMax:function(t){for(var e=t.length,i=t[0];e--;)t[e]>i&&(i=t[e]);return i},arrayMin:function(t){for(var e=t.length,i=t[0];e--;)t[e]<i&&(i=t[e]);return i},attr:f,clamp:function(t,e,i){return t>e?t<i?t:i:e},correctFloat:v,defined:u,destroyObjectProperties:function(t,e){b(t,function(i,s){i&&i!==e&&i.destroy&&i.destroy(),delete t[s]})},discardElement:function(e){var i=t.garbageBin;i||(i=t.createElement("div")),e&&i.appendChild(e),i.innerHTML=""},erase:function(t,e){for(var i=t.length;i--;)if(t[i]===e){t.splice(i,1);break}},extend:g,extendClass:x,isArray:h,isClass:d,isDOMElement:c,isNumber:p,isObject:l,isString:a,numberFormat:y,objectEach:b,offset:function(t){var e=o.documentElement,i=t.parentElement||t.parentNode?t.getBoundingClientRect():{top:0,left:0};return{top:i.top+(n.pageYOffset||e.scrollTop)-(e.clientTop||0),left:i.left+(n.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}},pad:function(t,e,i){return new Array((e||2)+1-String(t).replace("-","").length).join(i||"0")+t},pick:m,pInt:r,relativeLength:function(t,e,i){return/%$/.test(t)?e*parseFloat(t)/100+(i||0):parseFloat(t)},setAnimation:function(t,e){e.renderer.globalAnimation=m(t,e.options.chart.animation,!0)},splat:function(t){return h(t)?t:[t]},syncTimeout:function(t,e,i){return e>0?setTimeout(t,e,i):(t.call(0,i),-1)},wrap:function(t,e,i){var s=t[e];t[e]=function(){var t,e=Array.prototype.slice.call(arguments),o=arguments,n=this;return n.proceed=function(){s.apply(n,arguments.length?arguments:o)},e.unshift(s),t=i.apply(this,e),n.proceed=null,t}}}}),i(e,"parts/Color.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.isNumber,s=e.pInt,o=t.merge;t.Color=function(e){if(!(this instanceof t.Color))return new t.Color(e);this.init(e)},t.Color.prototype={parsers:[{regex:/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,parse:function(t){return[s(t[1]),s(t[2]),s(t[3]),parseFloat(t[4],10)]}},{regex:/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,parse:function(t){return[s(t[1]),s(t[2]),s(t[3]),1]}}],names:{white:"#ffffff",black:"#000000"},init:function(e){var i,s,o,n,r;if(this.input=e=this.names[e&&e.toLowerCase?e.toLowerCase():""]||e,e&&e.stops)this.stops=e.stops.map(function(e){return new t.Color(e[1])});else if(e&&e.charAt&&"#"===e.charAt()&&(r=e.length,e=parseInt(e.substr(1),16),7===r?s=[(16711680&e)>>16,(65280&e)>>8,255&e,1]:4===r&&(s=[(3840&e)>>4|(3840&e)>>8,(240&e)>>4|240&e,(15&e)<<4|15&e,1])),!s)for(o=this.parsers.length;o--&&!s;)(i=(n=this.parsers[o]).regex.exec(e))&&(s=n.parse(i));this.rgba=s||[]},get:function(t){var e,s=this.input,n=this.rgba;return this.stops?((e=o(s)).stops=[].concat(e.stops),this.stops.forEach(function(i,s){e.stops[s]=[e.stops[s][0],i.get(t)]})):e=n&&i(n[0])?"rgb"===t||!t&&1===n[3]?"rgb("+n[0]+","+n[1]+","+n[2]+")":"a"===t?n[3]:"rgba("+n.join(",")+")":s,e},brighten:function(t){var e,o=this.rgba;if(this.stops)this.stops.forEach(function(e){e.brighten(t)});else if(i(t)&&0!==t)for(e=0;e<3;e++)o[e]+=s(255*t),o[e]<0&&(o[e]=0),o[e]>255&&(o[e]=255);return this},setOpacity:function(t){return this.rgba[3]=t,this},tweenTo:function(t,e){var i,s=this.rgba,o=t.rgba;return o.length&&s&&s.length?((i=1!==o[3]||1!==s[3])?"rgba(":"rgb(")+Math.round(o[0]+(s[0]-o[0])*(1-e))+","+Math.round(o[1]+(s[1]-o[1])*(1-e))+","+Math.round(o[2]+(s[2]-o[2])*(1-e))+(i?","+(o[3]+(s[3]-o[3])*(1-e)):"")+")":t.input||"none"}},t.color=function(e){return new t.Color(e)}}),i(e,"parts/SvgRenderer.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i,s,o=e.animObject,n=e.attr,r=e.defined,a=e.destroyObjectProperties,h=e.erase,l=e.extend,c=e.isArray,d=e.isNumber,p=e.isObject,u=e.isString,f=e.objectEach,g=e.pick,m=e.pInt,x=e.splat,v=t.addEvent,y=t.animate,b=t.charts,M=t.color,k=t.css,w=t.createElement,S=t.deg2rad,A=t.doc,T=t.hasTouch,P=t.isFirefox,L=t.isMS,C=t.isWebKit,E=t.merge,O=t.noop,D=t.removeEvent,B=t.stop,I=t.svg,z=t.SVG_NS,R=t.symbolSizes,W=t.win;i=t.SVGElement=function(){return this},l(i.prototype,{opacity:1,SVG_NS:z,textProps:["direction","fontSize","fontWeight","fontFamily","fontStyle","color","lineHeight","width","textAlign","textDecoration","textOverflow","textOutline","cursor"],init:function(e,i){this.element="span"===i?w(i):A.createElementNS(this.SVG_NS,i),this.renderer=e,t.fireEvent(this,"afterInit")},animate:function(t,e,i){var s=o(g(e,this.renderer.globalAnimation,!0));return g(A.hidden,A.msHidden,A.webkitHidden,!1)&&(s.duration=0),0!==s.duration?(i&&(s.complete=i),y(this,t,s)):(this.attr(t,void 0,i),f(t,function(t,e){s.step&&s.step.call(this,t,{prop:e,pos:1})},this)),this},complexColor:function(e,i,s){var o,n,a,h,l,d,p,u,g,m,x,v,y=this.renderer,b=[];t.fireEvent(this.renderer,"complexColor",{args:arguments},function(){e.radialGradient?n="radialGradient":e.linearGradient&&(n="linearGradient"),n&&(a=e[n],l=y.gradients,p=e.stops,m=s.radialReference,c(a)&&(e[n]=a={x1:a[0],y1:a[1],x2:a[2],y2:a[3],gradientUnits:"userSpaceOnUse"}),"radialGradient"===n&&m&&!r(a.gradientUnits)&&(h=a,a=E(a,y.getRadialAttr(m,h),{gradientUnits:"userSpaceOnUse"})),f(a,function(t,e){"id"!==e&&b.push(e,t)}),f(p,function(t){b.push(t)}),b=b.join(","),l[b]?x=l[b].attr("id"):(a.id=x=t.uniqueKey(),l[b]=d=y.createElement(n).attr(a).add(y.defs),d.radAttr=h,d.stops=[],p.forEach(function(e){var i;0===e[1].indexOf("rgba")?(o=t.color(e[1]),u=o.get("rgb"),g=o.get("a")):(u=e[1],g=1),i=y.createElement("stop").attr({offset:e[0],"stop-color":u,"stop-opacity":g}).add(d),d.stops.push(i)})),v="url("+y.url+"#"+x+")",s.setAttribute(i,v),s.gradient=b,e.toString=function(){return v})})},applyTextOutline:function(e){var i,s,o,r,a=this.element;-1!==e.indexOf("contrast")&&(e=e.replace(/contrast/g,this.renderer.getContrast(a.style.fill))),e=e.split(" "),s=e[e.length-1],(o=e[0])&&"none"!==o&&t.svg&&(this.fakeTS=!0,i=[].slice.call(a.getElementsByTagName("tspan")),this.ySetter=this.xSetter,o=o.replace(/(^[\d\.]+)(.*?)$/g,function(t,e,i){return 2*e+i}),this.removeTextOutline(i),r=a.firstChild,i.forEach(function(t,e){var i;0===e&&(t.setAttribute("x",a.getAttribute("x")),e=a.getAttribute("y"),t.setAttribute("y",e||0),null===e&&a.setAttribute("y",0)),i=t.cloneNode(1),n(i,{class:"highcharts-text-outline",fill:s,stroke:s,"stroke-width":o,"stroke-linejoin":"round"}),a.insertBefore(i,r)}))},removeTextOutline:function(t){for(var e,i=t.length;i--;)"highcharts-text-outline"===(e=t[i]).getAttribute("class")&&h(t,this.element.removeChild(e))},symbolCustomAttribs:["x","y","width","height","r","start","end","innerR","anchorX","anchorY","rounded"],attr:function(e,i,s,o){var n,r,a,h,l=this.element,c=this,d=this.symbolCustomAttribs;return"string"==typeof e&&void 0!==i&&(n=e,(e={})[n]=i),"string"==typeof e?c=(this[e+"Getter"]||this._defaultGetter).call(this,e,l):(f(e,function(i,s){a=!1,o||B(this,s),this.symbolName&&-1!==t.inArray(s,d)&&(r||(this.symbolAttr(e),r=!0),a=!0),!this.rotation||"x"!==s&&"y"!==s||(this.doTransform=!0),a||((h=this[s+"Setter"]||this._defaultSetter).call(this,i,s,l),!this.styledMode&&this.shadows&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(s)&&this.updateShadows(s,i,h))},this),this.afterSetters()),s&&s.call(this),c},afterSetters:function(){this.doTransform&&(this.updateTransform(),this.doTransform=!1)},updateShadows:function(t,e,i){for(var s=this.shadows,o=s.length;o--;)i.call(s[o],"height"===t?Math.max(e-(s[o].cutHeight||0),0):"d"===t?this.d:e,t,s[o])},addClass:function(t,e){var i=e?"":this.attr("class")||"";return(t=(t||"").split(/ /g).reduce(function(t,e){return-1===i.indexOf(e)&&t.push(e),t},i?[i]:[]).join(" "))!==i&&this.attr("class",t),this},hasClass:function(t){return-1!==(this.attr("class")||"").split(" ").indexOf(t)},removeClass:function(t){return this.attr("class",(this.attr("class")||"").replace(u(t)?new RegExp(" ?"+t+" ?"):t,""))},symbolAttr:function(t){var e=this;["x","y","r","start","end","width","height","innerR","anchorX","anchorY","clockwise"].forEach(function(i){e[i]=g(t[i],e[i])}),e.attr({d:e.renderer.symbols[e.symbolName](e.x,e.y,e.width,e.height,e)})},clip:function(t){return this.attr("clip-path",t?"url("+this.renderer.url+"#"+t.id+")":"none")},crisp:function(t,e){var i;return e=e||t.strokeWidth||0,i=Math.round(e)%2/2,t.x=Math.floor(t.x||this.x||0)+i,t.y=Math.floor(t.y||this.y||0)+i,t.width=Math.floor((t.width||this.width||0)-2*i),t.height=Math.floor((t.height||this.height||0)-2*i),r(t.strokeWidth)&&(t.strokeWidth=e),t},css:function(t){var e,i,s=this.styles,o={},r=this.element,a="",h=!s,c=["textOutline","textOverflow","width"];return t&&t.color&&(t.fill=t.color),s&&f(t,function(t,e){t!==s[e]&&(o[e]=t,h=!0)}),h&&(s&&(t=l(s,o)),t&&(null===t.width||"auto"===t.width?delete this.textWidth:"text"===r.nodeName.toLowerCase()&&t.width&&(e=this.textWidth=m(t.width))),this.styles=t,e&&!I&&this.renderer.forExport&&delete t.width,r.namespaceURI===this.SVG_NS?(i=function(t,e){return"-"+e.toLowerCase()},f(t,function(t,e){-1===c.indexOf(e)&&(a+=e.replace(/([A-Z])/g,i)+":"+t+";")}),a&&n(r,"style",a)):k(r,t),this.added&&("text"===this.element.nodeName&&this.renderer.buildText(this),t&&t.textOutline&&this.applyTextOutline(t.textOutline))),this},getStyle:function(t){return W.getComputedStyle(this.element||this,"").getPropertyValue(t)},strokeWidth:function(){if(!this.renderer.styledMode)return this["stroke-width"]||0;var t,e=this.getStyle("stroke-width"),i=0;return e.indexOf("px")===e.length-2?i=m(e):""!==e&&(t=A.createElementNS(z,"rect"),n(t,{width:e,"stroke-width":0}),this.element.parentNode.appendChild(t),i=t.getBBox().width,t.parentNode.removeChild(t)),i},on:function(t,e){var i=this,s=i.element;return T&&"click"===t?(s.ontouchstart=function(t){i.touchEventFired=Date.now(),t.preventDefault(),e.call(s,t)},s.onclick=function(t){(-1===W.navigator.userAgent.indexOf("Android")||Date.now()-(i.touchEventFired||0)>1100)&&e.call(s,t)}):s["on"+t]=e,this},setRadialReference:function(t){var e=this.renderer.gradients[this.element.gradient];return this.element.radialReference=t,e&&e.radAttr&&e.animate(this.renderer.getRadialAttr(t,e.radAttr)),this},translate:function(t,e){return this.attr({translateX:t,translateY:e})},invert:function(t){return this.inverted=t,this.updateTransform(),this},updateTransform:function(){var t,e=this.translateX||0,i=this.translateY||0,s=this.scaleX,o=this.scaleY,n=this.inverted,a=this.rotation,h=this.matrix,l=this.element;n&&(e+=this.width,i+=this.height),t=["translate("+e+","+i+")"],r(h)&&t.push("matrix("+h.join(",")+")"),n?t.push("rotate(90) scale(-1,1)"):a&&t.push("rotate("+a+" "+g(this.rotationOriginX,l.getAttribute("x"),0)+" "+g(this.rotationOriginY,l.getAttribute("y")||0)+")"),(r(s)||r(o))&&t.push("scale("+g(s,1)+" "+g(o,1)+")"),t.length&&l.setAttribute("transform",t.join(" "))},toFront:function(){var t=this.element;return t.parentNode.appendChild(t),this},align:function(t,e,i){var s,o,n,r,a,l,c,d={},p=this.renderer,f=p.alignedObjects;return t?(this.alignOptions=t,this.alignByTranslate=e,i&&!u(i)||(this.alignTo=a=i||"renderer",h(f,this),f.push(this),i=null)):(t=this.alignOptions,e=this.alignByTranslate,a=this.alignTo),i=g(i,p[a],p),s=t.align,o=t.verticalAlign,n=(i.x||0)+(t.x||0),r=(i.y||0)+(t.y||0),"right"===s?l=1:"center"===s&&(l=2),l&&(n+=(i.width-(t.width||0))/l),d[e?"translateX":"x"]=Math.round(n),"bottom"===o?c=1:"middle"===o&&(c=2),c&&(r+=(i.height-(t.height||0))/c),d[e?"translateY":"y"]=Math.round(r),this[this.placed?"animate":"attr"](d),this.placed=!0,this.alignAttr=d,this},getBBox:function(t,e){var s,o,n,a,h,c,d=this.renderer,p=this.element,u=this.styles,f=this.textStr,m=d.cache,x=d.cacheKeys,v=p.namespaceURI===this.SVG_NS,y=g(e,this.rotation,0);if(a=d.styledMode?p&&i.prototype.getStyle.call(p,"font-size"):u&&u.fontSize,r(f)&&(-1===(c=f.toString()).indexOf("<")&&(c=c.replace(/[0-9]/g,"0")),c+=["",y,a,this.textWidth,u&&u.textOverflow].join(",")),c&&!t&&(s=m[c]),!s){if(v||d.forExport){try{(h=this.fakeTS&&function(t){[].forEach.call(p.querySelectorAll(".highcharts-text-outline"),function(e){e.style.display=t})})&&h("none"),s=p.getBBox?l({},p.getBBox()):{width:p.offsetWidth,height:p.offsetHeight},h&&h("")}catch(t){}(!s||s.width<0)&&(s={width:0,height:0})}else s=this.htmlGetBBox();if(d.isSVG&&(o=s.width,n=s.height,v&&(s.height=n={"11px,17":14,"13px,20":16}[u&&u.fontSize+","+Math.round(n)]||n),y)){var b=y*S;s.width=Math.abs(n*Math.sin(b))+Math.abs(o*Math.cos(b)),s.height=Math.abs(n*Math.cos(b))+Math.abs(o*Math.sin(b))}if(c&&s.height>0){for(;x.length>250;)delete m[x.shift()];m[c]||x.push(c),m[c]=s}}return s},show:function(t){return this.attr({visibility:t?"inherit":"visible"})},hide:function(t){return t?this.attr({y:-9999}):this.attr({visibility:"hidden"}),this},fadeOut:function(t){var e=this;e.animate({opacity:0},{duration:t||150,complete:function(){e.attr({y:-9999})}})},add:function(t){var e,i=this.renderer,s=this.element;return t&&(this.parentGroup=t),this.parentInverted=t&&t.inverted,void 0!==this.textStr&&i.buildText(this),this.added=!0,(!t||t.handleZ||this.zIndex)&&(e=this.zIndexSetter()),e||(t?t.element:i.box).appendChild(s),this.onAdd&&this.onAdd(),this},safeRemoveChild:function(t){var e=t.parentNode;e&&e.removeChild(t)},destroy:function(){var t,e,i=this,s=i.element||{},o=i.renderer,n=o.isSVG&&"SPAN"===s.nodeName&&i.parentGroup,r=s.ownerSVGElement,a=i.clipPath;if(s.onclick=s.onmouseout=s.onmouseover=s.onmousemove=s.point=null,B(i),a&&r&&([].forEach.call(r.querySelectorAll("[clip-path],[CLIP-PATH]"),function(t){t.getAttribute("clip-path").indexOf(a.element.id)>-1&&t.removeAttribute("clip-path")}),i.clipPath=a.destroy()),i.stops){for(e=0;e<i.stops.length;e++)i.stops[e]=i.stops[e].destroy();i.stops=null}for(i.safeRemoveChild(s),o.styledMode||i.destroyShadows();n&&n.div&&0===n.div.childNodes.length;)t=n.parentGroup,i.safeRemoveChild(n.div),delete n.div,n=t;i.alignTo&&h(o.alignedObjects,i),f(i,function(t,e){i[e]&&i[e].parentGroup===i&&i[e].destroy&&i[e].destroy(),delete i[e]})},shadow:function(t,e,i){var s,o,r,a,h,l,c=[],d=this.element;if(t){if(!this.shadows){for(a=g(t.width,3),h=(t.opacity||.15)/a,l=this.parentInverted?"(-1,-1)":"("+g(t.offsetX,1)+", "+g(t.offsetY,1)+")",s=1;s<=a;s++)o=d.cloneNode(0),r=2*a+1-2*s,n(o,{stroke:t.color||"#000000","stroke-opacity":h*s,"stroke-width":r,transform:"translate"+l,fill:"none"}),o.setAttribute("class",(o.getAttribute("class")||"")+" highcharts-shadow"),i&&(n(o,"height",Math.max(n(o,"height")-r,0)),o.cutHeight=r),e?e.element.appendChild(o):d.parentNode&&d.parentNode.insertBefore(o,d),c.push(o);this.shadows=c}}else this.destroyShadows();return this},destroyShadows:function(){(this.shadows||[]).forEach(function(t){this.safeRemoveChild(t)},this),this.shadows=void 0},xGetter:function(t){return"circle"===this.element.nodeName&&("x"===t?t="cx":"y"===t&&(t="cy")),this._defaultGetter(t)},_defaultGetter:function(t){var e=g(this[t+"Value"],this[t],this.element?this.element.getAttribute(t):null,0);return/^[\-0-9\.]+$/.test(e)&&(e=parseFloat(e)),e},dSetter:function(t,e,i){t&&t.join&&(t=t.join(" ")),/(NaN| {2}|^$)/.test(t)&&(t="M 0 0"),this[e]!==t&&(i.setAttribute(e,t),this[e]=t)},dashstyleSetter:function(t){var e,i=this["stroke-width"];if("inherit"===i&&(i=1),t=t&&t.toLowerCase()){for(e=(t=t.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",")).length;e--;)t[e]=m(t[e])*i;t=t.join(",").replace(/NaN/g,"none"),this.element.setAttribute("stroke-dasharray",t)}},alignSetter:function(t){var e={left:"start",center:"middle",right:"end"};e[t]&&(this.alignValue=t,this.element.setAttribute("text-anchor",e[t]))},opacitySetter:function(t,e,i){this[e]=t,i.setAttribute(e,t)},titleSetter:function(t){var e=this.element.getElementsByTagName("title")[0];e||(e=A.createElementNS(this.SVG_NS,"title"),this.element.appendChild(e)),e.firstChild&&e.removeChild(e.firstChild),e.appendChild(A.createTextNode(String(g(t,"")).replace(/<[^>]*>/g,"").replace(/&lt;/g,"<").replace(/&gt;/g,">")))},textSetter:function(t){t!==this.textStr&&(delete this.bBox,delete this.textPxLength,this.textStr=t,this.added&&this.renderer.buildText(this))},setTextPath:function(e,i){var s,o,n,a,h=this.element,l={textAnchor:"text-anchor"},c=!1,p=this.textPathWrapper,u=!p;if(s=(i=E(!0,{enabled:!0,attributes:{dy:-5,startOffset:"50%",textAnchor:"middle"}},i)).attributes,e&&i&&i.enabled){if(p&&null===p.element.parentNode?(u=!0,p=p.destroy()):p&&this.removeTextOutline.call(p.parentGroup,[].slice.call(h.getElementsByTagName("tspan"))),this.options&&this.options.padding&&(s.dx=-this.options.padding),p||(this.textPathWrapper=p=this.renderer.createElement("textPath"),c=!0),o=p.element,(n=e.element.getAttribute("id"))||e.element.setAttribute("id",n=t.uniqueKey()),u)for(a=h.getElementsByTagName("tspan");a.length;)a[0].setAttribute("y",0),d(s.dx)&&a[0].setAttribute("x",-s.dx),o.appendChild(a[0]);c&&p.add({element:this.text?this.text.element:h}),o.setAttributeNS("http://www.w3.org/1999/xlink","href",this.renderer.url+"#"+n),r(s.dy)&&(o.parentNode.setAttribute("dy",s.dy),delete s.dy),r(s.dx)&&(o.parentNode.setAttribute("dx",s.dx),delete s.dx),f(s,function(t,e){o.setAttribute(l[e]||e,t)}),h.removeAttribute("transform"),this.removeTextOutline.call(p,[].slice.call(h.getElementsByTagName("tspan"))),this.text&&!this.renderer.styledMode&&this.attr({fill:"none","stroke-width":0}),this.updateTransform=O,this.applyTextOutline=O}else p&&(delete this.updateTransform,delete this.applyTextOutline,this.destroyTextPath(h,e),this.updateTransform(),this.options.rotation&&this.applyTextOutline(this.options.style.textOutline));return this},destroyTextPath:function(t,e){var i,s=t.getElementsByTagName("text")[0];if(s){if(s.removeAttribute("dx"),s.removeAttribute("dy"),e.element.setAttribute("id",""),s.getElementsByTagName("textPath").length){for(i=this.textPathWrapper.element.childNodes;i.length;)s.appendChild(i[0]);s.removeChild(this.textPathWrapper.element)}}else(t.getAttribute("dx")||t.getAttribute("dy"))&&(t.removeAttribute("dx"),t.removeAttribute("dy"));this.textPathWrapper=this.textPathWrapper.destroy()},fillSetter:function(t,e,i){"string"==typeof t?i.setAttribute(e,t):t&&this.complexColor(t,e,i)},visibilitySetter:function(t,e,i){"inherit"===t?i.removeAttribute(e):this[e]!==t&&i.setAttribute(e,t),this[e]=t},zIndexSetter:function(t,e){var i,s,o,n,a,h=this.renderer,l=this.parentGroup,c=(l||h).element||h.box,d=this.element,p=!1,u=c===h.box,f=this.added;if(r(t)?(d.setAttribute("data-z-index",t),t=+t,this[e]===t&&(f=!1)):r(this[e])&&d.removeAttribute("data-z-index"),this[e]=t,f){for((t=this.zIndex)&&l&&(l.handleZ=!0),a=(i=c.childNodes).length-1;a>=0&&!p;a--)o=(s=i[a]).getAttribute("data-z-index"),n=!r(o),s!==d&&(t<0&&n&&!u&&!a?(c.insertBefore(d,i[a]),p=!0):(m(o)<=t||n&&(!r(t)||t>=0))&&(c.insertBefore(d,i[a+1]||null),p=!0));p||(c.insertBefore(d,i[u?3:0]||null),p=!0)}return p},_defaultSetter:function(t,e,i){i.setAttribute(e,t)}}),i.prototype.yGetter=i.prototype.xGetter,i.prototype.translateXSetter=i.prototype.translateYSetter=i.prototype.rotationSetter=i.prototype.verticalAlignSetter=i.prototype.rotationOriginXSetter=i.prototype.rotationOriginYSetter=i.prototype.scaleXSetter=i.prototype.scaleYSetter=i.prototype.matrixSetter=function(t,e){this[e]=t,this.doTransform=!0},i.prototype["stroke-widthSetter"]=i.prototype.strokeSetter=function(t,e,s){this[e]=t,this.stroke&&this["stroke-width"]?(i.prototype.fillSetter.call(this,this.stroke,"stroke",s),s.setAttribute("stroke-width",this["stroke-width"]),this.hasStroke=!0):"stroke-width"===e&&0===t&&this.hasStroke?(s.removeAttribute("stroke"),this.hasStroke=!1):this.renderer.styledMode&&this["stroke-width"]&&(s.setAttribute("stroke-width",this["stroke-width"]),this.hasStroke=!0)},s=t.SVGRenderer=function(){this.init.apply(this,arguments)},l(s.prototype,{Element:i,SVG_NS:z,init:function(t,e,i,s,o,r,a){var h,l,c,d;h=this.createElement("svg").attr({version:"1.1",class:"highcharts-root"}),a||h.css(this.getStyle(s)),l=h.element,t.appendChild(l),n(t,"dir","ltr"),-1===t.innerHTML.indexOf("xmlns")&&n(l,"xmlns",this.SVG_NS),this.isSVG=!0,this.box=l,this.boxWrapper=h,this.alignedObjects=[],this.url=(P||C)&&A.getElementsByTagName("base").length?W.location.href.split("#")[0].replace(/<[^>]*>/g,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20"):"",this.createElement("desc").add().element.appendChild(A.createTextNode("Created with Highcharts 8.0.0")),this.defs=this.createElement("defs").add(),this.allowHTML=r,this.forExport=o,this.styledMode=a,this.gradients={},this.cache={},this.cacheKeys=[],this.imgCount=0,this.setSize(e,i,!1),P&&t.getBoundingClientRect&&((c=function(){k(t,{left:0,top:0}),d=t.getBoundingClientRect(),k(t,{left:Math.ceil(d.left)-d.left+"px",top:Math.ceil(d.top)-d.top+"px"})})(),this.unSubPixelFix=v(W,"resize",c))},definition:function(t){var e=this;return function t(i,s){var o;return x(i).forEach(function(i){var n=e.createElement(i.tagName),r={};f(i,function(t,e){"tagName"!==e&&"children"!==e&&"textContent"!==e&&(r[e]=t)}),n.attr(r),n.add(s||e.defs),i.textContent&&n.element.appendChild(A.createTextNode(i.textContent)),t(i.children||[],n),o=n}),o}(t)},getStyle:function(t){return this.style=l({fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, sans-serif',fontSize:"12px"},t),this.style},setStyle:function(t){this.boxWrapper.css(this.getStyle(t))},isHidden:function(){return!this.boxWrapper.getBBox().width},destroy:function(){var t=this.defs;return this.box=null,this.boxWrapper=this.boxWrapper.destroy(),a(this.gradients||{}),this.gradients=null,t&&(this.defs=t.destroy()),this.unSubPixelFix&&this.unSubPixelFix(),this.alignedObjects=null,null},createElement:function(t){var e=new this.Element;return e.init(this,t),e},draw:O,getRadialAttr:function(t,e){return{cx:t[0]-t[2]/2+e.cx*t[2],cy:t[1]-t[2]/2+e.cy*t[2],r:e.r*t[2]}},truncate:function(t,e,i,s,o,n,r){var a,h,l,c=this,d=t.rotation,p=s?1:0,u=(i||s).length,f=u,g=[],m=function(t){e.firstChild&&e.removeChild(e.firstChild),t&&e.appendChild(A.createTextNode(t))},x=function(n,a){var h=a||n;if(void 0===g[h])if(e.getSubStringLength)try{g[h]=o+e.getSubStringLength(0,s?h+1:h)}catch(t){}else c.getSpanWidth&&(m(r(i||s,n)),g[h]=o+c.getSpanWidth(t,e));return g[h]};if(t.rotation=0,h=x(e.textContent.length),l=o+h>n){for(;p<=u;)f=Math.ceil((p+u)/2),s&&(a=r(s,f)),h=x(f,a&&a.length-1),p===u?p=u+1:h>n?u=f-1:p=f;0===u?m(""):i&&u===i.length-1||m(a||r(i||s,f))}return s&&s.splice(0,f),t.actualWidth=h,t.rotation=d,l},escapes:{"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},buildText:function(t){var e,i,s,o=t.element,r=this,a=r.forExport,h=g(t.textStr,"").toString(),l=-1!==h.indexOf("<"),c=o.childNodes,d=n(o,"x"),p=t.styles,u=t.textWidth,x=p&&p.lineHeight,v=p&&p.textOutline,y=p&&"ellipsis"===p.textOverflow,b=p&&"nowrap"===p.whiteSpace,M=p&&p.fontSize,w=c.length,S=u&&!t.added&&this.box,T=function(t){var e;return r.styledMode||(e=/(px|em)$/.test(t&&t.style.fontSize)?t.style.fontSize:M||r.style.fontSize||12),x?m(x):r.fontMetrics(e,t.getAttribute("style")?t:o).h},P=function(t,e){return f(r.escapes,function(i,s){e&&-1!==e.indexOf(i)||(t=t.toString().replace(new RegExp(i,"g"),s))}),t},L=function(t,e){var i,s;if(i=t.indexOf("<"),-1!==(i=(t=t.substring(i,t.indexOf(">")-i)).indexOf(e+"="))&&(i=i+e.length+1,'"'===(s=t.charAt(i))||"'"===s))return(t=t.substring(i+1)).substring(0,t.indexOf(s))},C=/<br.*?>/g;if((i=[h,y,b,x,v,M,u].join(","))!==t.textCache){for(t.textCache=i;w--;)o.removeChild(c[w]);l||v||y||u||-1!==h.indexOf(" ")&&(!b||C.test(h))?(S&&S.appendChild(o),(l?(r.styledMode?h.replace(/<(b|strong)>/g,'<span class="highcharts-strong">').replace(/<(i|em)>/g,'<span class="highcharts-emphasized">'):h.replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">')).replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(C):[h]).filter(function(t){return""!==t}).forEach(function(i,h){var l,c=0,p=0;i=i.replace(/^\s+|\s+$/g,"").replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||"),(l=i.split("|||")).forEach(function(i){if(""!==i||1===l.length){var f,g,m,x={},v=A.createElementNS(r.SVG_NS,"tspan");if((f=L(i,"class"))&&n(v,"class",f),(g=L(i,"style"))&&(g=g.replace(/(;| |^)color([ :])/,"$1fill$2"),n(v,"style",g)),(m=L(i,"href"))&&!a&&(n(v,"onclick",'location.href="'+m+'"'),n(v,"class","highcharts-anchor"),r.styledMode||k(v,{cursor:"pointer"}))," "!==(i=P(i.replace(/<[a-zA-Z\/](.|\n)*?>/g,"")||" "))){if(v.appendChild(A.createTextNode(i)),c?x.dx=0:h&&null!==d&&(x.x=d),n(v,x),o.appendChild(v),!c&&s&&(!I&&a&&k(v,{display:"block"}),n(v,"dy",T(v))),u){var w=i.replace(/([^\^])-/g,"$1- ").split(" "),S=!b&&(l.length>1||h||w.length>1),C=0,E=T(v);if(y)e=r.truncate(t,v,i,void 0,0,Math.max(0,u-parseInt(M||12,10)),function(t,e){return t.substring(0,e)+""});else if(S)for(;w.length;)w.length&&!b&&C>0&&(v=A.createElementNS(z,"tspan"),n(v,{dy:E,x:d}),g&&n(v,"style",g),v.appendChild(A.createTextNode(w.join(" ").replace(/- /g,"-"))),o.appendChild(v)),r.truncate(t,v,null,w,0===C?p:0,u,function(t,e){return w.slice(0,e).join(" ").replace(/- /g,"-")}),p=t.actualWidth,C++}c++}}}),s=s||o.childNodes.length}),y&&e&&t.attr("title",P(t.textStr,["&lt;","&gt;"])),S&&S.removeChild(o),v&&t.applyTextOutline&&t.applyTextOutline(v)):o.appendChild(A.createTextNode(P(h)))}},getContrast:function(t){return(t=M(t).rgba)[0]*=1,t[1]*=1.2,t[2]*=.5,t[0]+t[1]+t[2]>459?"#000000":"#FFFFFF"},button:function(t,e,i,s,o,n,r,a,h,c){var d,p,u,f,g=this.label(t,e,i,h,null,null,c,null,"button"),m=0,x=this.styledMode;(g.attr(E({padding:8,r:2},o)),x)||(o=E({fill:"#f7f7f7",stroke:"#cccccc","stroke-width":1,style:{color:"#333333",cursor:"pointer",fontWeight:"normal"}},o),d=o.style,delete o.style,n=E(o,{fill:"#e6e6e6"},n),p=n.style,delete n.style,r=E(o,{fill:"#e6ebf5",style:{color:"#000000",fontWeight:"bold"}},r),u=r.style,delete r.style,a=E(o,{style:{color:"#cccccc"}},a),f=a.style,delete a.style);return v(g.element,L?"mouseover":"mouseenter",function(){3!==m&&g.setState(1)}),v(g.element,L?"mouseout":"mouseleave",function(){3!==m&&g.setState(m)}),g.setState=function(t){1!==t&&(g.state=m=t),g.removeClass(/highcharts-button-(normal|hover|pressed|disabled)/).addClass("highcharts-button-"+["normal","hover","pressed","disabled"][t||0]),x||g.attr([o,n,r,a][t||0]).css([d,p,u,f][t||0])},x||g.attr(o).css(l({cursor:"default"},d)),g.on("click",function(t){3!==m&&s.call(g,t)})},crispLine:function(t,e){return t[1]===t[4]&&(t[1]=t[4]=Math.round(t[1])-e%2/2),t[2]===t[5]&&(t[2]=t[5]=Math.round(t[2])+e%2/2),t},path:function(t){var e=this.styledMode?{}:{fill:"none"};return c(t)?e.d=t:p(t)&&l(e,t),this.createElement("path").attr(e)},circle:function(t,e,i){var s=p(t)?t:void 0===t?{}:{x:t,y:e,r:i},o=this.createElement("circle");return o.xSetter=o.ySetter=function(t,e,i){i.setAttribute("c"+e,t)},o.attr(s)},arc:function(t,e,i,s,o,n){var r,a;return p(t)?(e=(a=t).y,i=a.r,s=a.innerR,o=a.start,n=a.end,t=a.x):a={innerR:s,start:o,end:n},(r=this.symbol("arc",t,e,i,i,a)).r=i,r},rect:function(t,e,i,s,o,r){o=p(t)?t.r:o;var a=this.createElement("rect"),h=p(t)?t:void 0===t?{}:{x:t,y:e,width:Math.max(i,0),height:Math.max(s,0)};return this.styledMode||(void 0!==r&&(h.strokeWidth=r,h=a.crisp(h)),h.fill="none"),o&&(h.r=o),a.rSetter=function(t,e,i){a.r=t,n(i,{rx:t,ry:t})},a.rGetter=function(){return a.r},a.attr(h)},setSize:function(t,e,i){var s=this.alignedObjects,o=s.length;for(this.width=t,this.height=e,this.boxWrapper.animate({width:t,height:e},{step:function(){this.attr({viewBox:"0 0 "+this.attr("width")+" "+this.attr("height")})},duration:g(i,!0)?void 0:0});o--;)s[o].align()},g:function(t){var e=this.createElement("g");return t?e.attr({class:"highcharts-"+t}):e},image:function(t,e,i,s,o,n){var r,a,h={preserveAspectRatio:"none"},c=function(t,e){t.setAttributeNS?t.setAttributeNS("http://www.w3.org/1999/xlink","href",e):t.setAttribute("hc-svg-href",e)},d=function(e){c(r.element,t),n.call(r,e)};return arguments.length>1&&l(h,{x:e,y:i,width:s,height:o}),r=this.createElement("image").attr(h),n?(c(r.element,"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),a=new W.Image,v(a,"load",d),a.src=t,a.complete&&d({})):c(r.element,t),r},symbol:function(t,e,i,s,o,n){var a,h,c,d=this,p=/^url\((.*?)\)$/,u=p.test(t),f=!u&&(this.symbols[t]?t:"circle"),m=f&&this.symbols[f],x=r(e)&&m&&m.call(this.symbols,Math.round(e),Math.round(i),s,o,n);return m?(a=this.path(x),d.styledMode||a.attr("fill","none"),l(a,{symbolName:f,x:e,y:i,width:s,height:o}),n&&l(a,n)):u&&(h=t.match(p)[1],(a=this.image(h)).imgwidth=g(R[h]&&R[h].width,n&&n.width),a.imgheight=g(R[h]&&R[h].height,n&&n.height),c=function(){a.attr({width:a.width,height:a.height})},["width","height"].forEach(function(t){a[t+"Setter"]=function(t,e){var i={},s=this["img"+e],o="width"===e?"translateX":"translateY";this[e]=t,r(s)&&(n&&"within"===n.backgroundSize&&this.width&&this.height&&(s=Math.round(s*Math.min(this.width/this.imgwidth,this.height/this.imgheight))),this.element&&this.element.setAttribute(e,s),this.alignByTranslate||(i[o]=((this[e]||0)-s)/2,this.attr(i)))}}),r(e)&&a.attr({x:e,y:i}),a.isImg=!0,r(a.imgwidth)&&r(a.imgheight)?c():(a.attr({width:0,height:0}),w("img",{onload:function(){var t=b[d.chartIndex];0===this.width&&(k(this,{position:"absolute",top:"-999em"}),A.body.appendChild(this)),R[h]={width:this.width,height:this.height},a.imgwidth=this.width,a.imgheight=this.height,a.element&&c(),this.parentNode&&this.parentNode.removeChild(this),d.imgCount--,!d.imgCount&&t&&t.onload&&t.onload()},src:h}),this.imgCount++)),a},symbols:{circle:function(t,e,i,s){return this.arc(t+i/2,e+s/2,i/2,s/2,{start:.5*Math.PI,end:2.5*Math.PI,open:!1})},square:function(t,e,i,s){return["M",t,e,"L",t+i,e,t+i,e+s,t,e+s,"Z"]},triangle:function(t,e,i,s){return["M",t+i/2,e,"L",t+i,e+s,t,e+s,"Z"]},"triangle-down":function(t,e,i,s){return["M",t,e,"L",t+i,e,t+i/2,e+s,"Z"]},diamond:function(t,e,i,s){return["M",t+i/2,e,"L",t+i,e+s/2,t+i/2,e+s,t,e+s/2,"Z"]},arc:function(t,e,i,s,o){var n,a=o.start,h=o.r||i,l=o.r||s||i,c=Math.abs(o.end-o.start-2*Math.PI)<.001,d=o.end-.001,p=o.innerR,u=g(o.open,c),f=Math.cos(a),m=Math.sin(a),x=Math.cos(d),v=Math.sin(d),y=g(o.longArc,o.end-a-Math.PI<.001?0:1);return n=["M",t+h*f,e+l*m,"A",h,l,0,y,g(o.clockwise,1),t+h*x,e+l*v],r(p)&&n.push(u?"M":"L",t+p*x,e+p*v,"A",p,p,0,y,r(o.clockwise)?1-o.clockwise:0,t+p*f,e+p*m),n.push(u?"":"Z"),n},callout:function(t,e,i,s,o){var n,r=Math.min(o&&o.r||0,i,s),a=r+6,h=o&&o.anchorX,l=o&&o.anchorY;return n=["M",t+r,e,"L",t+i-r,e,"C",t+i,e,t+i,e,t+i,e+r,"L",t+i,e+s-r,"C",t+i,e+s,t+i,e+s,t+i-r,e+s,"L",t+r,e+s,"C",t,e+s,t,e+s,t,e+s-r,"L",t,e+r,"C",t,e,t,e,t+r,e],h&&h>i?l>e+a&&l<e+s-a?n.splice(13,3,"L",t+i,l-6,t+i+6,l,t+i,l+6,t+i,e+s-r):n.splice(13,3,"L",t+i,s/2,h,l,t+i,s/2,t+i,e+s-r):h&&h<0?l>e+a&&l<e+s-a?n.splice(33,3,"L",t,l+6,t-6,l,t,l-6,t,e+r):n.splice(33,3,"L",t,s/2,h,l,t,s/2,t,e+r):l&&l>s&&h>t+a&&h<t+i-a?n.splice(23,3,"L",h+6,e+s,h,e+s+6,h-6,e+s,t+r,e+s):l&&l<0&&h>t+a&&h<t+i-a&&n.splice(3,3,"L",h-6,e,h,e-6,h+6,e,i-r,e),n}},clipRect:function(e,i,s,o){var n,r=t.uniqueKey()+"-",a=this.createElement("clipPath").attr({id:r}).add(this.defs);return(n=this.rect(e,i,s,o,0).add(a)).id=r,n.clipPath=a,n.count=0,n},text:function(t,e,i,s){var o,n={};return!s||!this.allowHTML&&this.forExport?(n.x=Math.round(e||0),i&&(n.y=Math.round(i)),r(t)&&(n.text=t),o=this.createElement("text").attr(n),s||(o.xSetter=function(t,e,i){var s,o,n=i.getElementsByTagName("tspan"),r=i.getAttribute(e);for(o=0;o<n.length;o++)(s=n[o]).getAttribute(e)===r&&s.setAttribute(e,t);i.setAttribute(e,t)}),o):this.html(t,e,i)},fontMetrics:function(t,e){var s;return t=!this.styledMode&&/px/.test(t)||!W.getComputedStyle?t||e&&e.style&&e.style.fontSize||this.style&&this.style.fontSize:e&&i.prototype.getStyle.call(e,"font-size"),{h:s=(t=/px/.test(t)?m(t):12)<24?t+3:Math.round(1.2*t),b:Math.round(.8*s),f:t}},rotCorr:function(t,e,i){var s=t;return e&&i&&(s=Math.max(s*Math.cos(e*S),4)),{x:-t/3*Math.sin(e*S),y:s}},label:function(t,e,s,o,n,a,h,c,p){var u,f,g,m,x,v,y,b,M,k,w,S,A=this,T=A.styledMode,P=A.g("button"!==p&&"label"),L=P.text=A.text("",0,0,h).attr({zIndex:1}),C=0,O=3,B=0,I={},z=/^url\((.*?)\)$/.test(o),R=T||z,W=function(){return T?u.strokeWidth()%2/2:(b?parseInt(b,10):0)%2/2};p&&P.addClass("highcharts-"+p),k=function(){var t,e=L.element.style,i={};f=(void 0===g||void 0===m||y)&&r(L.textStr)&&L.getBBox(),P.width=(g||f.width||0)+2*O+B,P.height=(m||f.height||0)+2*O,M=O+Math.min(A.fontMetrics(e&&e.fontSize,L).b,f?f.height:1/0),R&&(u||(P.box=u=A.symbols[o]||z?A.symbol(o):A.rect(),u.addClass(("button"===p?"":"highcharts-label-box")+(p?" highcharts-"+p+"-box":"")),u.add(P),t=W(),i.x=t,i.y=(c?-M:0)+t),i.width=Math.round(P.width),i.height=Math.round(P.height),u.attr(l(i,I)),I={})},w=function(){var t,e=B+O;t=c?0:M,r(g)&&f&&("center"===y||"right"===y)&&(e+={center:.5,right:1}[y]*(g-f.width)),e===L.x&&t===L.y||(L.attr("x",e),L.hasBoxWidthChanged&&(f=L.getBBox(!0),k()),void 0!==t&&L.attr("y",t)),L.x=e,L.y=t},S=function(t,e){u?u.attr(t,e):I[t]=e},P.onAdd=function(){L.add(P),P.attr({text:t||0===t?t:"",x:e,y:s}),u&&r(n)&&P.attr({anchorX:n,anchorY:a})},P.widthSetter=function(t){g=d(t)?t:null},P.heightSetter=function(t){m=t},P["text-alignSetter"]=function(t){y=t},P.paddingSetter=function(t){r(t)&&t!==O&&(O=P.padding=t,w())},P.paddingLeftSetter=function(t){r(t)&&t!==B&&(B=t,w())},P.alignSetter=function(t){(t={left:0,center:.5,right:1}[t])!==C&&(C=t,f&&P.attr({x:x}))},P.textSetter=function(t){void 0!==t&&L.attr({text:t}),k(),w()},P["stroke-widthSetter"]=function(t,e){t&&(R=!0),b=this["stroke-width"]=t,S(e,t)},T?P.rSetter=function(t,e){S(e,t)}:P.strokeSetter=P.fillSetter=P.rSetter=function(t,e){"r"!==e&&("fill"===e&&t&&(R=!0),P[e]=t),S(e,t)},P.anchorXSetter=function(t,e){n=P.anchorX=t,S(e,Math.round(t)-W()-x)},P.anchorYSetter=function(t,e){a=P.anchorY=t,S(e,t-v)},P.xSetter=function(t){P.x=t,C&&(t-=C*((g||f.width)+2*O),P["forceAnimate:x"]=!0),x=Math.round(t),P.attr("translateX",x)},P.ySetter=function(t){v=P.y=Math.round(t),P.attr("translateY",v)};var G=P.css,X={css:function(t){if(t){var e={};t=E(t),P.textProps.forEach(function(i){void 0!==t[i]&&(e[i]=t[i],delete t[i])}),L.css(e),"width"in e&&k(),"fontSize"in e&&(k(),w())}return G.call(P,t)},getBBox:function(){return{width:f.width+2*O,height:f.height+2*O,x:f.x-O,y:f.y-O}},destroy:function(){D(P.element,"mouseenter"),D(P.element,"mouseleave"),L&&(L=L.destroy()),u&&(u=u.destroy()),i.prototype.destroy.call(P),P=A=k=w=S=null}};return T||(X.shadow=function(t){return t&&(k(),u&&u.shadow(t)),P}),l(P,X)}}),t.Renderer=s}),i(e,"parts/Html.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.attr,s=e.defined,o=e.extend,n=e.pick,r=e.pInt,a=t.createElement,h=t.css,l=t.isFirefox,c=t.isMS,d=t.isWebKit,p=t.SVGElement,u=t.SVGRenderer,f=t.win;o(p.prototype,{htmlCss:function(t){var e,i="SPAN"===this.element.tagName&&t&&"width"in t,s=n(i&&t.width,void 0);return i&&(delete t.width,this.textWidth=s,e=!0),t&&"ellipsis"===t.textOverflow&&(t.whiteSpace="nowrap",t.overflow="hidden"),this.styles=o(this.styles,t),h(this.element,t),e&&this.htmlUpdateTransform(),this},htmlGetBBox:function(){var t=this.element;return{x:t.offsetLeft,y:t.offsetTop,width:t.offsetWidth,height:t.offsetHeight}},htmlUpdateTransform:function(){if(this.added){var t=this.renderer,e=this.element,i=this.translateX||0,o=this.translateY||0,n=this.x||0,a=this.y||0,l=this.textAlign||"left",c={left:0,center:.5,right:1}[l],d=this.styles,p=d&&d.whiteSpace;if(h(e,{marginLeft:i,marginTop:o}),!t.styledMode&&this.shadows&&this.shadows.forEach(function(t){h(t,{marginLeft:i+1,marginTop:o+1})}),this.inverted&&[].forEach.call(e.childNodes,function(i){t.invertChild(i,e)}),"SPAN"===e.tagName){var u,f=this.rotation,g=this.textWidth&&r(this.textWidth),m=[f,l,e.innerHTML,this.textWidth,this.textAlign].join(",");g!==this.oldTextWidth&&(g>this.oldTextWidth||(this.textPxLength||(h(e,{width:"",whiteSpace:p||"nowrap"}),e.offsetWidth))>g)&&(/[ \-]/.test(e.textContent||e.innerText)||"ellipsis"===e.style.textOverflow)?(h(e,{width:g+"px",display:"block",whiteSpace:p||"normal"}),this.oldTextWidth=g,this.hasBoxWidthChanged=!0):this.hasBoxWidthChanged=!1,m!==this.cTT&&(u=t.fontMetrics(e.style.fontSize,e).b,!s(f)||f===(this.oldRotation||0)&&l===this.oldAlign||this.setSpanRotation(f,c,u),this.getSpanCorrection(!s(f)&&this.textPxLength||e.offsetWidth,u,c,f,l)),h(e,{left:n+(this.xCorr||0)+"px",top:a+(this.yCorr||0)+"px"}),this.cTT=m,this.oldRotation=f,this.oldAlign=l}}else this.alignOnAdd=!0},setSpanRotation:function(t,e,i){var s={},o=this.renderer.getTransformKey();s[o]=s.transform="rotate("+t+"deg)",s[o+(l?"Origin":"-origin")]=s.transformOrigin=100*e+"% "+i+"px",h(this.element,s)},getSpanCorrection:function(t,e,i){this.xCorr=-t*i,this.yCorr=-e}}),o(u.prototype,{getTransformKey:function(){return c&&!/Edge/.test(f.navigator.userAgent)?"-ms-transform":d?"-webkit-transform":l?"MozTransform":f.opera?"-o-transform":""},html:function(t,e,s){var r=this.createElement("span"),h=r.element,l=r.renderer,c=l.isSVG,d=function(t,e){["opacity","visibility"].forEach(function(i){t[i+"Setter"]=function(s,o,n){var r=t.div?t.div.style:e;p.prototype[i+"Setter"].call(this,s,o,n),r&&(r[o]=s)}}),t.addedSetters=!0};return r.textSetter=function(t){t!==h.innerHTML&&(delete this.bBox,delete this.oldTextWidth),this.textStr=t,h.innerHTML=n(t,""),r.doTransform=!0},c&&d(r,r.element.style),r.xSetter=r.ySetter=r.alignSetter=r.rotationSetter=function(t,e){"align"===e&&(e="textAlign"),r[e]=t,r.doTransform=!0},r.afterSetters=function(){this.doTransform&&(this.htmlUpdateTransform(),this.doTransform=!1)},r.attr({text:t,x:Math.round(e),y:Math.round(s)}).css({position:"absolute"}),l.styledMode||r.css({fontFamily:this.style.fontFamily,fontSize:this.style.fontSize}),h.style.whiteSpace="nowrap",r.css=r.htmlCss,c&&(r.add=function(t){var e,s,n=l.box.parentNode,c=[];if(this.parentGroup=t,t){if(!(e=t.div)){for(s=t;s;)c.push(s),s=s.parentGroup;c.reverse().forEach(function(t){var s,h=i(t.element,"class");function l(e,i){t[i]=e,"translateX"===i?s.left=e+"px":s.top=e+"px",t.doTransform=!0}e=t.div=t.div||a("div",h?{className:h}:void 0,{position:"absolute",left:(t.translateX||0)+"px",top:(t.translateY||0)+"px",display:t.display,opacity:t.opacity,pointerEvents:t.styles&&t.styles.pointerEvents},e||n),s=e.style,o(t,{classSetter:function(t){return function(e){this.element.setAttribute("class",e),t.className=e}}(e),on:function(){return c[0].div&&r.on.apply({element:c[0].div},arguments),t},translateXSetter:l,translateYSetter:l}),t.addedSetters||d(t)})}}else e=n;return e.appendChild(h),r.added=!0,r.alignOnAdd&&r.htmlUpdateTransform(),r}),r}})}),i(e,"parts/Time.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.defined,s=e.extend,o=e.isObject,n=e.objectEach,r=e.pad,a=e.pick,h=e.splat,l=t,c=l.merge,d=l.timeUnits,p=l.win;t.Time=function(t){this.update(t,!1)},t.Time.prototype={defaultOptions:{Date:void 0,getTimezoneOffset:void 0,timezone:void 0,timezoneOffset:0,useUTC:!0},update:function(t){var e=a(t&&t.useUTC,!0),i=this;this.options=t=c(!0,this.options||{},t),this.Date=t.Date||p.Date||Date,this.useUTC=e,this.timezoneOffset=e&&t.timezoneOffset,this.getTimezoneOffset=this.timezoneOffsetFunction(),this.variableTimezone=!(e&&!t.getTimezoneOffset&&!t.timezone),this.variableTimezone||this.timezoneOffset?(this.get=function(t,e){var s,o=e.getTime(),n=o-i.getTimezoneOffset(e);return e.setTime(n),s=e["getUTC"+t](),e.setTime(o),s},this.set=function(t,e,s){var o,n,r;"Milliseconds"===t||"Seconds"===t||"Minutes"===t&&e.getTimezoneOffset()%60==0?e["set"+t](s):(n=i.getTimezoneOffset(e),o=e.getTime()-n,e.setTime(o),e["setUTC"+t](s),r=i.getTimezoneOffset(e),o=e.getTime()+r,e.setTime(o))}):e?(this.get=function(t,e){return e["getUTC"+t]()},this.set=function(t,e,i){return e["setUTC"+t](i)}):(this.get=function(t,e){return e["get"+t]()},this.set=function(t,e,i){return e["set"+t](i)})},makeTime:function(t,e,i,s,o,n){var r,h,c;return this.useUTC?(r=this.Date.UTC.apply(0,arguments),r+=h=this.getTimezoneOffset(r),h!==(c=this.getTimezoneOffset(r))?r+=c-h:h-36e5!==this.getTimezoneOffset(r-36e5)||l.isSafari||(r-=36e5)):r=new this.Date(t,e,a(i,1),a(s,0),a(o,0),a(n,0)).getTime(),r},timezoneOffsetFunction:function(){var t=this,e=this.options,i=p.moment;if(!this.useUTC)return function(t){return 6e4*new Date(t).getTimezoneOffset()};if(e.timezone){if(i)return function(t){return 6e4*-i.tz(t,e.timezone).utcOffset()};l.error(25)}return this.useUTC&&e.getTimezoneOffset?function(t){return 6e4*e.getTimezoneOffset(t)}:function(){return 6e4*(t.timezoneOffset||0)}},dateFormat:function(t,e,o){if(!i(e)||isNaN(e))return l.defaultOptions.lang.invalidDate||"";t=a(t,"%Y-%m-%d %H:%M:%S");var h=this,c=new this.Date(e),d=this.get("Hours",c),p=this.get("Day",c),u=this.get("Date",c),f=this.get("Month",c),g=this.get("FullYear",c),m=l.defaultOptions.lang,x=m.weekdays,v=m.shortWeekdays,y=s({a:v?v[p]:x[p].substr(0,3),A:x[p],d:r(u),e:r(u,2," "),w:p,b:m.shortMonths[f],B:m.months[f],m:r(f+1),o:f+1,y:g.toString().substr(2,2),Y:g,H:r(d),k:d,I:r(d%12||12),l:d%12||12,M:r(h.get("Minutes",c)),p:d<12?"AM":"PM",P:d<12?"am":"pm",S:r(c.getSeconds()),L:r(Math.floor(e%1e3),3)},l.dateFormats);return n(y,function(i,s){for(;-1!==t.indexOf("%"+s);)t=t.replace("%"+s,"function"==typeof i?i.call(h,e):i)}),o?t.substr(0,1).toUpperCase()+t.substr(1):t},resolveDTLFormat:function(t){return o(t,!0)?t:{main:(t=h(t))[0],from:t[1],to:t[2]}},getTimeTicks:function(t,e,o,n){var r,h,l,c,p=this,u=[],f={},g=new(0,p.Date)(e),m=t.unitRange,x=t.count||1;if(n=a(n,1),i(e)){p.set("Milliseconds",g,m>=d.second?0:x*Math.floor(p.get("Milliseconds",g)/x)),m>=d.second&&p.set("Seconds",g,m>=d.minute?0:x*Math.floor(p.get("Seconds",g)/x)),m>=d.minute&&p.set("Minutes",g,m>=d.hour?0:x*Math.floor(p.get("Minutes",g)/x)),m>=d.hour&&p.set("Hours",g,m>=d.day?0:x*Math.floor(p.get("Hours",g)/x)),m>=d.day&&p.set("Date",g,m>=d.month?1:Math.max(1,x*Math.floor(p.get("Date",g)/x))),m>=d.month&&(p.set("Month",g,m>=d.year?0:x*Math.floor(p.get("Month",g)/x)),h=p.get("FullYear",g)),m>=d.year&&(h-=h%x,p.set("FullYear",g,h)),m===d.week&&(c=p.get("Day",g),p.set("Date",g,p.get("Date",g)-c+n+(c<n?-7:0))),h=p.get("FullYear",g);var v=p.get("Month",g),y=p.get("Date",g),b=p.get("Hours",g);e=g.getTime(),p.variableTimezone&&(l=o-e>4*d.month||p.getTimezoneOffset(e)!==p.getTimezoneOffset(o));var M=g.getTime();for(r=1;M<o;)u.push(M),m===d.year?M=p.makeTime(h+r*x,0):m===d.month?M=p.makeTime(h,v+r*x):!l||m!==d.day&&m!==d.week?l&&m===d.hour&&x>1?M=p.makeTime(h,v,y,b+r*x):M+=m*x:M=p.makeTime(h,v,y+r*x*(m===d.day?1:7)),r++;u.push(M),m<=d.hour&&u.length<1e4&&u.forEach(function(t){t%18e5==0&&"000000000"===p.dateFormat("%H%M%S%L",t)&&(f[t]="day")})}return u.info=s(t,{higherRanks:f,totalRange:m*x}),u}}}),i(e,"parts/Options.js",[e["parts/Globals.js"]],function(t){var e=t.color,i=t.isTouchDevice,s=t.merge,o=t.svg;t.defaultOptions={colors:"#7cb5ec #434348 #90ed7d #f7a35c #8085e9 #f15c80 #e4d354 #2b908f #f45b5b #91e8e1".split(" "),symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],decimalPoint:".",numericSymbols:["k","M","G","T","P","E"],resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:" "},global:{},time:t.Time.prototype.defaultOptions,chart:{styledMode:!1,borderRadius:0,colorCount:10,defaultSeriesType:"line",ignoreHiddenSeries:!0,spacing:[10,10,15,10],resetZoomButton:{theme:{zIndex:6},position:{align:"right",x:-10,y:10}},width:null,height:null,borderColor:"#335cad",backgroundColor:"#ffffff",plotBorderColor:"#cccccc"},title:{text:"Chart title",align:"center",margin:15,widthAdjust:-44},subtitle:{text:"",align:"center",widthAdjust:-44},caption:{margin:15,text:"",align:"left",verticalAlign:"bottom"},plotOptions:{},labels:{style:{position:"absolute",color:"#333333"}},legend:{enabled:!0,align:"center",alignColumns:!0,layout:"horizontal",labelFormatter:function(){return this.name},borderColor:"#999999",borderRadius:0,navigation:{activeColor:"#003399",inactiveColor:"#cccccc"},itemStyle:{color:"#333333",cursor:"pointer",fontSize:"12px",fontWeight:"bold",textOverflow:"ellipsis"},itemHoverStyle:{color:"#000000"},itemHiddenStyle:{color:"#cccccc"},shadow:!1,itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},squareSymbol:!0,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"#ffffff",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:o,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},footerFormat:"",padding:8,snap:i?25:10,headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{point.color}"></span> {series.name}: <b>{point.y}</b><br/>',backgroundColor:e("#f7f7f7").setOpacity(.85).get(),borderWidth:1,shadow:!0,style:{color:"#333333",cursor:"default",fontSize:"12px",pointerEvents:"none",whiteSpace:"nowrap"}},credits:{enabled:!0,href:"https://www.highcharts.com?credits",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#999999",fontSize:"9px"},text:"Highcharts.com"}},t.setOptions=function(e){return t.defaultOptions=s(!0,t.defaultOptions,e),(e.time||e.global)&&t.time.update(s(t.defaultOptions.global,t.defaultOptions.time,e.global,e.time)),t.defaultOptions},t.getOptions=function(){return t.defaultOptions},t.defaultPlotOptions=t.defaultOptions.plotOptions,t.time=new t.Time(s(t.defaultOptions.global,t.defaultOptions.time)),t.dateFormat=function(e,i,s){return t.time.dateFormat(e,i,s)}}),i(e,"parts/Tick.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.clamp,s=e.correctFloat,o=e.defined,n=e.destroyObjectProperties,r=e.extend,a=e.isNumber,h=e.objectEach,l=e.pick,c=t.fireEvent,d=t.merge,p=t.deg2rad;t.Tick=function(t,e,i,s,o){this.axis=t,this.pos=e,this.type=i||"",this.isNew=!0,this.isNewLabel=!0,this.parameters=o||{},this.tickmarkOffset=this.parameters.tickmarkOffset,this.options=this.parameters.options,i||s||this.addLabel()},t.Tick.prototype={addLabel:function(){var t,e,i,n,a,h=this,c=h.axis,d=c.options,p=c.chart,u=c.categories,f=c.names,g=h.pos,m=l(h.options&&h.options.labels,d.labels),x=c.tickPositions,v=g===x[0],y=g===x[x.length-1],b=this.parameters.category||(u?l(u[g],f[g],g):g),M=h.label,k=(!m.step||1===m.step)&&1===c.tickInterval,w=x.info;c.isDatetimeAxis&&w&&(e=(i=p.time.resolveDTLFormat(d.dateTimeLabelFormats[!d.grid&&w.higherRanks[g]||w.unitName])).main),h.isFirst=v,h.isLast=y,h.formatCtx={axis:c,chart:p,isFirst:v,isLast:y,dateTimeLabelFormat:e,tickPositionInfo:w,value:c.isLog?s(c.lin2log(b)):b,pos:g},t=c.labelFormatter.call(h.formatCtx,this.formatCtx),(a=i&&i.list)&&(h.shortenLabel=function(){for(n=0;n<a.length;n++)if(M.attr({text:c.labelFormatter.call(r(h.formatCtx,{dateTimeLabelFormat:a[n]}))}),M.getBBox().width<c.getSlotWidth(h)-2*l(m.padding,5))return;M.attr({text:""})}),k&&c._addedPlotLB&&c.isXAxis&&h.moveLabel(t,m),o(M)||h.movedLabel?M&&M.textStr!==t&&!k&&(!M.textWidth||m.style&&m.style.width||M.styles.width||M.css({width:null}),M.attr({text:t}),M.textPxLength=M.getBBox().width):(h.label=M=h.createLabel({x:0,y:0},t,m),h.rotation=0)},moveLabel:function(t,e){var i,s,o,n=this,r=n.label,a=!1,l=n.axis,c=l.chart,d=l.reversed,p=c.inverted;r&&r.textStr===t?(n.movedLabel=r,a=!0,delete n.label):h(l.ticks,function(e){a||e.isNew||e===n||!e.label||e.label.textStr!==t||(n.movedLabel=e.label,a=!0,e.labelPos=n.movedLabel.xy,delete e.label)}),a||!n.labelPos&&!r||(i=n.labelPos||r.xy,s=p?i.x:d?0:l.width+l.left,o=p?d?l.width+l.left:0:i.y,n.movedLabel=n.createLabel({x:s,y:o},t,e),n.movedLabel&&n.movedLabel.attr({opacity:0}))},createLabel:function(t,e,i){var s=this.axis,n=s.chart,r=o(e)&&i.enabled?n.renderer.text(e,t.x,t.y,i.useHTML).add(s.labelGroup):null;return r&&(n.styledMode||r.css(d(i.style)),r.textPxLength=r.getBBox().width),r},replaceMovedLabel:function(){var t,e,i=this.label,s=this.axis,o=s.reversed,n=this.axis.chart.inverted;i&&!this.isNew&&(t=n?i.xy.x:o?s.left:s.width+s.left,e=n?o?s.width+s.top:s.top:i.xy.y,i.animate({x:t,y:e,opacity:0},void 0,i.destroy),delete this.label),s.isDirty=!0,this.label=this.movedLabel,delete this.movedLabel},getLabelSize:function(){return this.label?this.label.getBBox()[this.axis.horiz?"height":"width"]:0},handleOverflow:function(t){var e,i,s=this.axis,o=s.options.labels,n=t.x,r=s.chart.chartWidth,a=s.chart.spacing,h=l(s.labelLeft,Math.min(s.pos,a[3])),c=l(s.labelRight,Math.max(s.isRadial?0:s.pos+s.len,r-a[1])),d=this.label,u=this.rotation,f={left:0,center:.5,right:1}[s.labelAlign||d.attr("align")],g=d.getBBox().width,m=s.getSlotWidth(this),x=m,v=f,y=1,b={};u||"justify"!==l(o.overflow,"justify")?u<0&&n-f*g<h?i=Math.round(n/Math.cos(u*p)-h):u>0&&n+f*g>c&&(i=Math.round((r-n)/Math.cos(u*p))):(e=n+(1-f)*g,n-f*g<h?x=t.x+x*(1-f)-h:e>c&&(x=c-t.x+x*f,y=-1),(x=Math.min(m,x))<m&&"center"===s.labelAlign&&(t.x+=y*(m-x-v*(m-Math.min(g,x)))),(g>x||s.autoRotation&&(d.styles||{}).width)&&(i=x)),i&&(this.shortenLabel?this.shortenLabel():(b.width=Math.floor(i),(o.style||{}).textOverflow||(b.textOverflow="ellipsis"),d.css(b)))},getPosition:function(t,e,o,n){var r,a=this.axis,h=a.chart,l=n&&h.oldChartHeight||h.chartHeight;return(r={x:t?s(a.translate(e+o,null,null,n)+a.transB):a.left+a.offset+(a.opposite?(n&&h.oldChartWidth||h.chartWidth)-a.right-a.left:0),y:t?l-a.bottom+a.offset-(a.opposite?a.height:0):s(l-a.translate(e+o,null,null,n)-a.transB)}).y=i(r.y,-1e5,1e5),c(this,"afterGetPosition",{pos:r}),r},getLabelPosition:function(t,e,i,s,n,r,a,h){var l,d=this.axis,u=d.transA,f=d.isLinked&&d.linkedParent?d.linkedParent.reversed:d.reversed,g=d.staggerLines,m=d.tickRotCorr||{x:0,y:0},x=n.y,v=s||d.reserveSpaceDefault?0:-d.labelOffset*("center"===d.labelAlign?.5:1),y={};return o(x)||(x=0===d.side?i.rotation?-8:-i.getBBox().height:2===d.side?m.y+8:Math.cos(i.rotation*p)*(m.y-i.getBBox(!1,0).height/2)),t=t+n.x+v+m.x-(r&&s?r*u*(f?-1:1):0),e=e+x-(r&&!s?r*u*(f?1:-1):0),g&&(l=a/(h||1)%g,d.opposite&&(l=g-l-1),e+=l*(d.labelOffset/g)),y.x=t,y.y=Math.round(e),c(this,"afterGetLabelPosition",{pos:y,tickmarkOffset:r,index:a}),y},getMarkPath:function(t,e,i,s,o,n){return n.crispLine(["M",t,e,"L",t+(o?0:-i),e+(o?i:0)],s)},renderGridLine:function(t,e,i){var s,o=this.axis,n=o.options,r=this.gridLine,a={},h=this.pos,c=this.type,d=l(this.tickmarkOffset,o.tickmarkOffset),p=o.chart.renderer,u=c?c+"Grid":"grid",f=n[u+"LineWidth"],g=n[u+"LineColor"],m=n[u+"LineDashStyle"];r||(o.chart.styledMode||(a.stroke=g,a["stroke-width"]=f,m&&(a.dashstyle=m)),c||(a.zIndex=1),t&&(e=0),this.gridLine=r=p.path().attr(a).addClass("highcharts-"+(c?c+"-":"")+"grid-line").add(o.gridGroup)),r&&(s=o.getPlotLinePath({value:h+d,lineWidth:r.strokeWidth()*i,force:"pass",old:t}))&&r[t||this.isNew?"attr":"animate"]({d:s,opacity:e})},renderMark:function(t,e,i){var s=this.axis,o=s.options,n=s.chart.renderer,r=this.type,a=r?r+"Tick":"tick",h=s.tickSize(a),c=this.mark,d=!c,p=t.x,u=t.y,f=l(o[a+"Width"],!r&&s.isXAxis?1:0),g=o[a+"Color"];h&&(s.opposite&&(h[0]=-h[0]),d&&(this.mark=c=n.path().addClass("highcharts-"+(r?r+"-":"")+"tick").add(s.axisGroup),s.chart.styledMode||c.attr({stroke:g,"stroke-width":f})),c[d?"attr":"animate"]({d:this.getMarkPath(p,u,h[0],c.strokeWidth()*i,s.horiz,n),opacity:e}))},renderLabel:function(t,e,i,s){var o=this.axis,n=o.horiz,r=o.options,h=this.label,c=r.labels,d=c.step,p=l(this.tickmarkOffset,o.tickmarkOffset),u=!0,f=t.x,g=t.y;h&&a(f)&&(h.xy=t=this.getLabelPosition(f,g,h,n,c,p,s,d),this.isFirst&&!this.isLast&&!l(r.showFirstLabel,1)||this.isLast&&!this.isFirst&&!l(r.showLastLabel,1)?u=!1:!n||c.step||c.rotation||e||0===i||this.handleOverflow(t),d&&s%d&&(u=!1),u&&a(t.y)?(t.opacity=i,h[this.isNewLabel?"attr":"animate"](t),this.isNewLabel=!1):(h.attr("y",-9999),this.isNewLabel=!0))},render:function(e,i,s){var o=this.axis,n=o.horiz,r=this.pos,a=l(this.tickmarkOffset,o.tickmarkOffset),h=this.getPosition(n,r,a,i),c=h.x,d=h.y,p=n&&c===o.pos+o.len||!n&&d===o.pos?-1:1;s=l(s,1),this.isActive=!0,this.renderGridLine(i,s,p),this.renderMark(h,s,p),this.renderLabel(h,i,s,e),this.isNew=!1,t.fireEvent(this,"afterRender")},destroy:function(){n(this,this.axis)}}}),i(e,"parts/Axis.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.animObject,s=e.arrayMax,o=e.arrayMin,n=e.clamp,r=e.correctFloat,a=e.defined,h=e.destroyObjectProperties,l=e.extend,c=e.isArray,d=e.isNumber,p=e.isString,u=e.objectEach,f=e.pick,g=e.relativeLength,m=e.splat,x=e.syncTimeout,v=t.addEvent,y=t.color,b=t.defaultOptions,M=t.deg2rad,k=t.fireEvent,w=t.format,S=t.getMagnitude,A=t.merge,T=t.normalizeTickInterval,P=t.removeEvent,L=t.seriesTypes,C=t.Tick,E=function(){this.init.apply(this,arguments)};return l(E.prototype,{defaultOptions:{dateTimeLabelFormats:{millisecond:{main:"%H:%M:%S.%L",range:!1},second:{main:"%H:%M:%S",range:!1},minute:{main:"%H:%M",range:!1},hour:{main:"%H:%M",range:!1},day:{main:"%e. %b"},week:{main:"%e. %b"},month:{main:"%b '%y"},year:{main:"%Y"}},endOnTick:!1,labels:{enabled:!0,indentation:10,x:0,style:{color:"#666666",cursor:"default",fontSize:"11px"}},maxPadding:.01,minorTickLength:2,minorTickPosition:"outside",minPadding:.01,showEmpty:!0,startOfWeek:1,startOnTick:!1,tickLength:10,tickPixelInterval:100,tickmarkPlacement:"between",tickPosition:"outside",title:{align:"middle",style:{color:"#666666"}},type:"linear",minorGridLineColor:"#f2f2f2",minorGridLineWidth:1,minorTickColor:"#999999",lineColor:"#ccd6eb",lineWidth:1,gridLineColor:"#e6e6e6",tickColor:"#ccd6eb"},defaultYAxisOptions:{endOnTick:!0,maxPadding:.05,minPadding:.05,tickPixelInterval:72,showLastLabel:!0,labels:{x:-8},startOnTick:!0,title:{rotation:270,text:"Values"},stackLabels:{allowOverlap:!1,enabled:!1,crop:!0,overflow:"justify",formatter:function(){return(0,this.axis.chart.numberFormatter)(this.total,-1)},style:{color:"#000000",fontSize:"11px",fontWeight:"bold",textOutline:"1px contrast"}},gridLineWidth:1,lineWidth:0},defaultLeftAxisOptions:{labels:{x:-15},title:{rotation:270}},defaultRightAxisOptions:{labels:{x:15},title:{rotation:90}},defaultBottomAxisOptions:{labels:{autoRotation:[-45],x:0},margin:15,title:{rotation:0}},defaultTopAxisOptions:{labels:{autoRotation:[-45],x:0},margin:15,title:{rotation:0}},init:function(e,i){var s=i.isX,o=this;o.chart=e,o.horiz=e.inverted&&!o.isZAxis?!s:s,o.isXAxis=s,o.coll=o.coll||(s?"xAxis":"yAxis"),k(this,"init",{userOptions:i}),o.opposite=i.opposite,o.side=i.side||(o.horiz?o.opposite?0:2:o.opposite?1:3),o.setOptions(i);var n=this.options,r=n.type,h="datetime"===r;o.labelFormatter=n.labels.formatter||o.defaultLabelFormatter,o.userOptions=i,o.minPixelPadding=0,o.reversed=n.reversed,o.visible=!1!==n.visible,o.zoomEnabled=!1!==n.zoomEnabled,o.hasNames="category"===r||!0===n.categories,o.categories=n.categories||o.hasNames,o.names||(o.names=[],o.names.keys={}),o.plotLinesAndBandsGroups={},o.isLog="logarithmic"===r,o.isDatetimeAxis=h,o.positiveValuesOnly=o.isLog&&!o.allowNegativeLog,o.isLinked=a(n.linkedTo),o.ticks={},o.labelEdge=[],o.minorTicks={},o.plotLinesAndBands=[],o.alternateBands={},o.len=0,o.minRange=o.userMinRange=n.minRange||n.maxZoom,o.range=n.range,o.offset=n.offset||0,o.stacks={},o.oldStacks={},o.stacksTouched=0,o.max=null,o.min=null,o.crosshair=f(n.crosshair,m(e.options.tooltip.crosshairs)[s?0:1],!1);var l=o.options.events;-1===e.axes.indexOf(o)&&(s?e.axes.splice(e.xAxis.length,0,o):e.axes.push(o),e[o.coll].push(o)),o.series=o.series||[],e.inverted&&!o.isZAxis&&s&&void 0===o.reversed&&(o.reversed=!0),u(l,function(e,i){t.isFunction(e)&&v(o,i,e)}),o.lin2log=n.linearToLogConverter||o.lin2log,o.isLog&&(o.val2lin=o.log2lin,o.lin2val=o.lin2log),k(this,"afterInit")},setOptions:function(t){this.options=A(this.defaultOptions,"yAxis"===this.coll&&this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],A(b[this.coll],t)),k(this,"afterSetOptions",{userOptions:t})},defaultLabelFormatter:function(){var t,e,i=this.axis,s=this.value,o=i.chart.time,n=i.categories,r=this.dateTimeLabelFormat,a=b.lang,h=a.numericSymbols,l=a.numericSymbolMagnitude||1e3,c=h&&h.length,d=i.options.labels.format,p=i.isLog?Math.abs(s):i.tickInterval,u=this.chart,f=u.numberFormatter;if(d)e=w(d,this,u);else if(n)e=s;else if(r)e=o.dateFormat(r,s);else if(c&&p>=1e3)for(;c--&&void 0===e;)p>=(t=Math.pow(l,c+1))&&10*s%t==0&&null!==h[c]&&0!==s&&(e=f(s/t,-1)+h[c]);return void 0===e&&(e=Math.abs(s)>=1e4?f(s,-1):f(s,-1,void 0,"")),e},getSeriesExtremes:function(){var t,e=this,i=e.chart;k(this,"getSeriesExtremes",null,function(){e.hasVisibleSeries=!1,e.dataMin=e.dataMax=e.threshold=null,e.softThreshold=!e.isXAxis,e.buildStacks&&e.buildStacks(),e.series.forEach(function(s){if(s.visible||!i.options.chart.ignoreHiddenSeries){var o,n,r,h=s.options,l=h.threshold;e.hasVisibleSeries=!0,e.positiveValuesOnly&&l<=0&&(l=null),e.isXAxis?(o=s.xData).length&&(n=(t=s.getXExtremes(o)).min,r=t.max,d(n)||n instanceof Date||(o=o.filter(d),n=(t=s.getXExtremes(o)).min,r=t.max),o.length&&(e.dataMin=Math.min(f(e.dataMin,n),n),e.dataMax=Math.max(f(e.dataMax,r),r))):(s.getExtremes(),r=s.dataMax,n=s.dataMin,a(n)&&a(r)&&(e.dataMin=Math.min(f(e.dataMin,n),n),e.dataMax=Math.max(f(e.dataMax,r),r)),a(l)&&(e.threshold=l),h.softThreshold&&!e.positiveValuesOnly||(e.softThreshold=!1))}})}),k(this,"afterGetSeriesExtremes")},translate:function(t,e,i,s,o,n){var r=this.linkedParent||this,a=1,h=0,l=s?r.oldTransA:r.transA,c=s?r.oldMin:r.min,p=0,u=r.minPixelPadding,f=(r.isOrdinal||r.isBroken||r.isLog&&o)&&r.lin2val;return l||(l=r.transA),i&&(a*=-1,h=r.len),r.reversed&&(h-=(a*=-1)*(r.sector||r.len)),e?(t=t*a+h,p=(t-=u)/l+c,f&&(p=r.lin2val(p))):(f&&(t=r.val2lin(t)),p=d(c)?a*(t-c)*l+h+a*u+(d(n)?l*n:0):void 0),p},toPixels:function(t,e){return this.translate(t,!1,!this.horiz,null,!0)+(e?0:this.pos)},toValue:function(t,e){return this.translate(t-(e?0:this.pos),!0,!this.horiz,null,!0)},getPlotLinePath:function(t){var e,i,s,o,r,a,h=this,l=h.chart,c=h.left,p=h.top,u=t.old,g=t.value,m=t.translatedValue,x=t.lineWidth,v=t.force,y=u&&l.oldChartHeight||l.chartHeight,b=u&&l.oldChartWidth||l.chartWidth,M=h.transB,w=function(t,e,i){return("pass"!==v&&t<e||t>i)&&(v?t=n(t,e,i):r=!0),t};return a={value:g,lineWidth:x,old:u,force:v,acrossPanes:t.acrossPanes,translatedValue:m},k(this,"getPlotLinePath",a,function(t){m=f(m,h.translate(g,null,null,u)),m=n(m,-1e5,1e5),e=s=Math.round(m+M),i=o=Math.round(y-m-M),d(m)?h.horiz?(i=p,o=y-h.bottom,e=s=w(e,c,c+h.width)):(e=c,s=b-h.right,i=o=w(i,p,p+h.height)):(r=!0,v=!1),t.path=r&&!v?null:l.renderer.crispLine(["M",e,i,"L",s,o],x||1)}),a.path},getLinearTickPositions:function(t,e,i){var s,o,n,a=r(Math.floor(e/t)*t),h=r(Math.ceil(i/t)*t),l=[];if(r(a+t)===a&&(n=20),this.single)return[e];for(s=a;s<=h&&(l.push(s),(s=r(s+t,n))!==o);)o=s;return l},getMinorTickInterval:function(){var t=this.options;return!0===t.minorTicks?f(t.minorTickInterval,"auto"):!1===t.minorTicks?null:t.minorTickInterval},getMinorTickPositions:function(){var t,e=this,i=e.options,s=e.tickPositions,o=e.minorTickInterval,n=[],r=e.pointRangePadding||0,a=e.min-r,h=e.max+r,l=h-a;if(l&&l/o<e.len/3)if(e.isLog)this.paddedTicks.forEach(function(t,i,s){i&&n.push.apply(n,e.getLogTickPositions(o,s[i-1],s[i],!0))});else if(e.isDatetimeAxis&&"auto"===this.getMinorTickInterval())n=n.concat(e.getTimeTicks(e.normalizeTimeTickInterval(o),a,h,i.startOfWeek));else for(t=a+(s[0]-a)%o;t<=h&&t!==n[0];t+=o)n.push(t);return 0!==n.length&&e.trimTicks(n),n},adjustForMinRange:function(){var t,e,i,n,r,h,l,c,d,p,u=this.options,g=this.min,m=this.max;this.isXAxis&&void 0===this.minRange&&!this.isLog&&(a(u.min)||a(u.max)?this.minRange=null:(this.series.forEach(function(t){for(h=t.xData,l=t.xIncrement?1:h.length-1,n=l;n>0;n--)r=h[n]-h[n-1],(void 0===i||r<i)&&(i=r)}),this.minRange=Math.min(5*i,this.dataMax-this.dataMin))),m-g<this.minRange&&(e=this.dataMax-this.dataMin>=this.minRange,c=[g-(t=((p=this.minRange)-m+g)/2),f(u.min,g-t)],e&&(c[2]=this.isLog?this.log2lin(this.dataMin):this.dataMin),d=[(g=s(c))+p,f(u.max,g+p)],e&&(d[2]=this.isLog?this.log2lin(this.dataMax):this.dataMax),(m=o(d))-g<p&&(c[0]=m-p,c[1]=f(u.min,m-p),g=s(c))),this.min=g,this.max=m},getClosest:function(){var t;return this.categories?t=1:this.series.forEach(function(e){var i=e.closestPointRange,s=e.visible||!e.chart.options.chart.ignoreHiddenSeries;!e.noSharedTooltip&&a(i)&&s&&(t=a(t)?Math.min(t,i):i)}),t},nameToX:function(t){var e,i=c(this.categories),s=i?this.categories:this.names,o=t.options.x;return t.series.requireSorting=!1,a(o)||(o=!1===this.options.uniqueNames?t.series.autoIncrement():i?s.indexOf(t.name):f(s.keys[t.name],-1)),-1===o?i||(e=s.length):e=o,void 0!==e&&(this.names[e]=t.name,this.names.keys[t.name]=e),e},updateNames:function(){var t=this,e=this.names;e.length>0&&(Object.keys(e.keys).forEach(function(t){delete e.keys[t]}),e.length=0,this.minRange=this.userMinRange,(this.series||[]).forEach(function(e){e.xIncrement=null,e.points&&!e.isDirtyData||(t.max=Math.max(t.max,e.xData.length-1),e.processData(),e.generatePoints()),e.data.forEach(function(i,s){var o;i&&i.options&&void 0!==i.name&&void 0!==(o=t.nameToX(i))&&o!==i.x&&(i.x=o,e.xData[s]=o)})}))},setAxisTranslation:function(t){var e,i,s=this,o=s.max-s.min,n=s.axisPointRange||0,r=0,a=0,h=s.linkedParent,l=!!s.categories,c=s.transA,d=s.isXAxis;(d||l||n)&&(e=s.getClosest(),h?(r=h.minPointOffset,a=h.pointRangePadding):s.series.forEach(function(t){var i=l?1:d?f(t.options.pointRange,e,0):s.axisPointRange||0,o=t.options.pointPlacement;if(n=Math.max(n,i),!s.single||l){var h=L.xrange&&t instanceof L.xrange?!d:d;r=Math.max(r,h&&p(o)?0:i/2),a=Math.max(a,h&&"on"===o?0:i)}}),i=s.ordinalSlope&&e?s.ordinalSlope/e:1,s.minPointOffset=r*=i,s.pointRangePadding=a*=i,s.pointRange=Math.min(n,s.single&&l?1:o),d&&(s.closestPointRange=e)),t&&(s.oldTransA=c),s.translationSlope=s.transA=c=s.staticScale||s.len/(o+a||1),s.transB=s.horiz?s.left:s.bottom,s.minPixelPadding=c*r,k(this,"afterSetAxisTranslation")},minFromRange:function(){return this.max-this.range},setTickInterval:function(e){var i,s,o,n,h,l,c,p=this,u=p.chart,g=p.options,m=p.isLog,x=p.isDatetimeAxis,v=p.isXAxis,y=p.isLinked,b=g.maxPadding,M=g.minPadding,w=g.tickInterval,A=g.tickPixelInterval,P=p.categories,L=d(p.threshold)?p.threshold:null,C=p.softThreshold;x||P||y||this.getTickAmount(),l=f(p.userMin,g.min),c=f(p.userMax,g.max),y?(p.linkedParent=u[p.coll][g.linkedTo],s=p.linkedParent.getExtremes(),p.min=f(s.min,s.dataMin),p.max=f(s.max,s.dataMax),g.type!==p.linkedParent.options.type&&t.error(11,1,u)):(!C&&a(L)&&(p.dataMin>=L?(n=L,M=0):p.dataMax<=L&&(h=L,b=0)),p.min=f(l,n,p.dataMin),p.max=f(c,h,p.dataMax)),m&&(p.positiveValuesOnly&&!e&&Math.min(p.min,f(p.dataMin,p.min))<=0&&t.error(10,1,u),p.min=r(p.log2lin(p.min),16),p.max=r(p.log2lin(p.max),16)),p.range&&a(p.max)&&(p.userMin=p.min=l=Math.max(p.dataMin,p.minFromRange()),p.userMax=c=p.max,p.range=null),k(p,"foundExtremes"),p.beforePadding&&p.beforePadding(),p.adjustForMinRange(),P||p.axisPointRange||p.usePercentage||y||!a(p.min)||!a(p.max)||(i=p.max-p.min)&&(!a(l)&&M&&(p.min-=i*M),!a(c)&&b&&(p.max+=i*b)),d(p.userMin)||(d(g.softMin)&&g.softMin<p.min&&(p.min=l=g.softMin),d(g.floor)&&(p.min=Math.max(p.min,g.floor))),d(p.userMax)||(d(g.softMax)&&g.softMax>p.max&&(p.max=c=g.softMax),d(g.ceiling)&&(p.max=Math.min(p.max,g.ceiling))),C&&a(p.dataMin)&&(L=L||0,!a(l)&&p.min<L&&p.dataMin>=L?p.min=p.options.minRange?Math.min(L,p.max-p.minRange):L:!a(c)&&p.max>L&&p.dataMax<=L&&(p.max=p.options.minRange?Math.max(L,p.min+p.minRange):L)),p.min===p.max||void 0===p.min||void 0===p.max?p.tickInterval=1:y&&!w&&A===p.linkedParent.options.tickPixelInterval?p.tickInterval=w=p.linkedParent.tickInterval:p.tickInterval=f(w,this.tickAmount?(p.max-p.min)/Math.max(this.tickAmount-1,1):void 0,P?1:(p.max-p.min)*A/Math.max(p.len,A)),v&&!e&&p.series.forEach(function(t){t.processData(p.min!==p.oldMin||p.max!==p.oldMax)}),p.setAxisTranslation(!0),p.beforeSetTickPositions&&p.beforeSetTickPositions(),p.postProcessTickInterval&&(p.tickInterval=p.postProcessTickInterval(p.tickInterval)),p.pointRange&&!w&&(p.tickInterval=Math.max(p.pointRange,p.tickInterval)),o=f(g.minTickInterval,p.isDatetimeAxis&&p.closestPointRange),!w&&p.tickInterval<o&&(p.tickInterval=o),x||m||w||(p.tickInterval=T(p.tickInterval,null,S(p.tickInterval),f(g.allowDecimals,!(p.tickInterval>.5&&p.tickInterval<5&&p.max>1e3&&p.max<9999)),!!this.tickAmount)),this.tickAmount||(p.tickInterval=p.unsquish()),this.setTickPositions()},setTickPositions:function(){var e,i=this.options,s=i.tickPositions,o=this.getMinorTickInterval(),n=i.tickPositioner,r=i.startOnTick,h=i.endOnTick;this.tickmarkOffset=this.categories&&"between"===i.tickmarkPlacement&&1===this.tickInterval?.5:0,this.minorTickInterval="auto"===o&&this.tickInterval?this.tickInterval/5:o,this.single=this.min===this.max&&a(this.min)&&!this.tickAmount&&(parseInt(this.min,10)===this.min||!1!==i.allowDecimals),this.tickPositions=e=s&&s.slice(),e||(!this.ordinalPositions&&(this.max-this.min)/this.tickInterval>Math.max(2*this.len,200)?(e=[this.min,this.max],t.error(19,!1,this.chart)):e=this.isDatetimeAxis?this.getTimeTicks(this.normalizeTimeTickInterval(this.tickInterval,i.units),this.min,this.max,i.startOfWeek,this.ordinalPositions,this.closestPointRange,!0):this.isLog?this.getLogTickPositions(this.tickInterval,this.min,this.max):this.getLinearTickPositions(this.tickInterval,this.min,this.max),e.length>this.len&&(e=[e[0],e.pop()])[0]===e[1]&&(e.length=1),this.tickPositions=e,n&&(n=n.apply(this,[this.min,this.max]))&&(this.tickPositions=e=n)),this.paddedTicks=e.slice(0),this.trimTicks(e,r,h),this.isLinked||(this.single&&e.length<2&&!this.categories&&(this.min-=.5,this.max+=.5),s||n||this.adjustTickAmount()),k(this,"afterSetTickPositions")},trimTicks:function(t,e,i){var s=t[0],o=t[t.length-1],n=this.minPointOffset||0;if(k(this,"trimTicks"),!this.isLinked){if(e&&s!==-1/0)this.min=s;else for(;this.min-n>t[0];)t.shift();if(i)this.max=o;else for(;this.max+n<t[t.length-1];)t.pop();0===t.length&&a(s)&&!this.options.tickPositions&&t.push((o+s)/2)}},alignToOthers:function(){var t,e={},i=this.options;return!1===this.chart.options.chart.alignTicks||!1===i.alignTicks||!1===i.startOnTick||!1===i.endOnTick||this.isLog||this.chart[this.coll].forEach(function(i){var s=i.options,o=[i.horiz?s.left:s.top,s.width,s.height,s.pane].join(",");i.series.length&&(e[o]?t=!0:e[o]=1)}),t},getTickAmount:function(){var t=this.options,e=t.tickAmount,i=t.tickPixelInterval;!a(t.tickInterval)&&this.len<i&&!this.isRadial&&!this.isLog&&t.startOnTick&&t.endOnTick&&(e=2),!e&&this.alignToOthers()&&(e=Math.ceil(this.len/i)+1),e<4&&(this.finalTickAmt=e,e=5),this.tickAmount=e},adjustTickAmount:function(){var t,e,i,s=this.options,o=this.tickInterval,n=this.tickPositions,h=this.tickAmount,l=this.finalTickAmt,c=n&&n.length,d=f(this.threshold,this.softThreshold?0:null);if(this.hasData()){if(c<h){for(t=this.min;n.length<h;)n.length%2||t===d?n.push(r(n[n.length-1]+o)):n.unshift(r(n[0]-o));this.transA*=(c-1)/(h-1),this.min=s.startOnTick?n[0]:Math.min(this.min,n[0]),this.max=s.endOnTick?n[n.length-1]:Math.max(this.max,n[n.length-1])}else c>h&&(this.tickInterval*=2,this.setTickPositions());if(a(l)){for(i=e=n.length;i--;)(3===l&&i%2==1||l<=2&&i>0&&i<e-1)&&n.splice(i,1);this.finalTickAmt=void 0}}},setScale:function(){var t,e=this.series.some(function(t){return t.isDirtyData||t.isDirty||t.xAxis&&t.xAxis.isDirty});this.oldMin=this.min,this.oldMax=this.max,this.oldAxisLength=this.len,this.setAxisSize(),(t=this.len!==this.oldAxisLength)||e||this.isLinked||this.forceRedraw||this.userMin!==this.oldUserMin||this.userMax!==this.oldUserMax||this.alignToOthers()?(this.resetStacks&&this.resetStacks(),this.forceRedraw=!1,this.getSeriesExtremes(),this.setTickInterval(),this.oldUserMin=this.userMin,this.oldUserMax=this.userMax,this.isDirty||(this.isDirty=t||this.min!==this.oldMin||this.max!==this.oldMax)):this.cleanStacks&&this.cleanStacks(),k(this,"afterSetScale")},setExtremes:function(t,e,i,s,o){var n=this,r=n.chart;i=f(i,!0),n.series.forEach(function(t){delete t.kdTree}),o=l(o,{min:t,max:e}),k(n,"setExtremes",o,function(){n.userMin=t,n.userMax=e,n.eventArgs=o,i&&r.redraw(s)})},zoom:function(t,e){var i=this.dataMin,s=this.dataMax,o=this.options,n=Math.min(i,f(o.min,i)),r=Math.max(s,f(o.max,s)),h={newMin:t,newMax:e};return k(this,"zoom",h,function(t){var e=t.newMin,o=t.newMax;e===this.min&&o===this.max||(this.allowZoomOutside||(a(i)&&(e<n&&(e=n),e>r&&(e=r)),a(s)&&(o<n&&(o=n),o>r&&(o=r))),this.displayBtn=void 0!==e||void 0!==o,this.setExtremes(e,o,!1,void 0,{trigger:"zoom"})),t.zoomed=!0}),h.zoomed},setAxisSize:function(){var t=this.chart,e=this.options,i=e.offsets||[0,0,0,0],s=this.horiz,o=this.width=Math.round(g(f(e.width,t.plotWidth-i[3]+i[1]),t.plotWidth)),n=this.height=Math.round(g(f(e.height,t.plotHeight-i[0]+i[2]),t.plotHeight)),r=this.top=Math.round(g(f(e.top,t.plotTop+i[0]),t.plotHeight,t.plotTop)),a=this.left=Math.round(g(f(e.left,t.plotLeft+i[3]),t.plotWidth,t.plotLeft));this.bottom=t.chartHeight-n-r,this.right=t.chartWidth-o-a,this.len=Math.max(s?o:n,0),this.pos=s?a:r},getExtremes:function(){var t=this.isLog;return{min:t?r(this.lin2log(this.min)):this.min,max:t?r(this.lin2log(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}},getThreshold:function(t){var e=this.isLog,i=e?this.lin2log(this.min):this.min,s=e?this.lin2log(this.max):this.max;return null===t||t===-1/0?t=i:t===1/0?t=s:i>t?t=i:s<t&&(t=s),this.translate(t,0,1,0,1)},autoLabelAlign:function(t){var e=(f(t,0)-90*this.side+720)%360,i={align:"center"};return k(this,"autoLabelAlign",i,function(t){e>15&&e<165?t.align="right":e>195&&e<345&&(t.align="left")}),i.align},tickSize:function(t){var e,i,s=this.options,o=s[t+"Length"],n=f(s[t+"Width"],"tick"===t&&this.isXAxis&&!this.categories?1:0);return n&&o&&("inside"===s[t+"Position"]&&(o=-o),i=[o,n]),k(this,"afterTickSize",e={tickSize:i}),e.tickSize},labelMetrics:function(){var t=this.tickPositions&&this.tickPositions[0]||0;return this.chart.renderer.fontMetrics(this.options.labels.style&&this.options.labels.style.fontSize,this.ticks[t]&&this.ticks[t].label)},unsquish:function(){var t,e,i,s=this.options.labels,o=this.horiz,n=this.tickInterval,h=n,l=this.len/(((this.categories?1:0)+this.max-this.min)/n),c=s.rotation,d=this.labelMetrics(),p=Number.MAX_VALUE,u=this.max-this.min,g=function(t){var e=t/(l||1);return(e=e>1?Math.ceil(e):1)*n>u&&t!==1/0&&l!==1/0&&u&&(e=Math.ceil(u/n)),r(e*n)};return o?(i=!s.staggerLines&&!s.step&&(a(c)?[c]:l<f(s.autoRotationLimit,80)&&s.autoRotation))&&i.forEach(function(i){var s;(i===c||i&&i>=-90&&i<=90)&&(s=(e=g(Math.abs(d.h/Math.sin(M*i))))+Math.abs(i/360))<p&&(p=s,t=i,h=e)}):s.step||(h=g(d.h)),this.autoRotation=i,this.labelRotation=f(t,c),h},getSlotWidth:function(t){var e=this.chart,i=this.horiz,s=this.options.labels,o=Math.max(this.tickPositions.length-(this.categories?0:1),1),n=e.margin[3];return t&&t.slotWidth||i&&(s.step||0)<2&&!s.rotation&&(this.staggerLines||1)*this.len/o||!i&&(s.style&&parseInt(s.style.width,10)||n&&n-e.spacing[3]||.33*e.chartWidth)},renderUnsquish:function(){var t,e,i,s,o,n=this.chart,r=n.renderer,a=this.tickPositions,h=this.ticks,l=this.options.labels,c=l&&l.style||{},d=this.horiz,u=this.getSlotWidth(),f=Math.max(1,Math.round(u-2*(l.padding||5))),g={},m=this.labelMetrics(),x=l.style&&l.style.textOverflow,v=0;if(p(l.rotation)||(g.rotation=l.rotation||0),a.forEach(function(t){(t=h[t]).movedLabel&&t.replaceMovedLabel(),t&&t.label&&t.label.textPxLength>v&&(v=t.label.textPxLength)}),this.maxLabelLength=v,this.autoRotation)v>f&&v>m.h?g.rotation=this.labelRotation:this.labelRotation=0;else if(u&&(t=f,!x))for(e="clip",s=a.length;!d&&s--;)o=a[s],(i=h[o].label)&&(i.styles&&"ellipsis"===i.styles.textOverflow?i.css({textOverflow:"clip"}):i.textPxLength>u&&i.css({width:u+"px"}),i.getBBox().height>this.len/a.length-(m.h-m.f)&&(i.specificTextOverflow="ellipsis"));g.rotation&&(t=v>.5*n.chartHeight?.33*n.chartHeight:v,x||(e="ellipsis")),this.labelAlign=l.align||this.autoLabelAlign(this.labelRotation),this.labelAlign&&(g.align=this.labelAlign),a.forEach(function(i){var s=h[i],o=s&&s.label,n=c.width,r={};o&&(o.attr(g),s.shortenLabel?s.shortenLabel():t&&!n&&"nowrap"!==c.whiteSpace&&(t<o.textPxLength||"SPAN"===o.element.tagName)?(r.width=t,x||(r.textOverflow=o.specificTextOverflow||e),o.css(r)):o.styles&&o.styles.width&&!r.width&&!n&&o.css({width:null}),delete o.specificTextOverflow,s.rotation=g.rotation)},this),this.tickRotCorr=r.rotCorr(m.b,this.labelRotation||0,0!==this.side)},hasData:function(){return this.series.some(function(t){return t.hasData()})||this.options.showEmpty&&a(this.min)&&a(this.max)},addTitle:function(t){var e,i=this.chart.renderer,s=this.horiz,o=this.opposite,n=this.options.title,r=this.chart.styledMode;this.axisTitle||((e=n.textAlign)||(e=(s?{low:"left",middle:"center",high:"right"}:{low:o?"right":"left",middle:"center",high:o?"left":"right"})[n.align]),this.axisTitle=i.text(n.text,0,0,n.useHTML).attr({zIndex:7,rotation:n.rotation||0,align:e}).addClass("highcharts-axis-title"),r||this.axisTitle.css(A(n.style)),this.axisTitle.add(this.axisGroup),this.axisTitle.isNew=!0),r||n.style.width||this.isRadial||this.axisTitle.css({width:this.len}),this.axisTitle[t?"show":"hide"](t)},generateTick:function(t){var e=this.ticks;e[t]?e[t].addLabel():e[t]=new C(this,t)},getOffset:function(){var t,e,i,s,o,n,r,h=this,l=h.chart,c=l.renderer,d=h.options,p=h.tickPositions,g=h.ticks,m=h.horiz,x=h.side,v=l.inverted&&!h.isZAxis?[1,0,3,2][x]:x,y=0,b=0,M=d.title,w=d.labels,S=0,A=l.axisOffset,T=l.clipOffset,P=[-1,1,1,-1][x],L=d.className,C=h.axisParent;t=h.hasData(),h.showAxis=e=t||f(d.showEmpty,!0),h.staggerLines=h.horiz&&w.staggerLines,h.axisGroup||(h.gridGroup=c.g("grid").attr({zIndex:d.gridZIndex||1}).addClass("highcharts-"+this.coll.toLowerCase()+"-grid "+(L||"")).add(C),h.axisGroup=c.g("axis").attr({zIndex:d.zIndex||2}).addClass("highcharts-"+this.coll.toLowerCase()+" "+(L||"")).add(C),h.labelGroup=c.g("axis-labels").attr({zIndex:w.zIndex||7}).addClass("highcharts-"+h.coll.toLowerCase()+"-labels "+(L||"")).add(C)),t||h.isLinked?(p.forEach(function(t,e){h.generateTick(t,e)}),h.renderUnsquish(),h.reserveSpaceDefault=0===x||2===x||{1:"left",3:"right"}[x]===h.labelAlign,f(w.reserveSpace,"center"===h.labelAlign||null,h.reserveSpaceDefault)&&p.forEach(function(t){S=Math.max(g[t].getLabelSize(),S)}),h.staggerLines&&(S*=h.staggerLines),h.labelOffset=S*(h.opposite?-1:1)):u(g,function(t,e){t.destroy(),delete g[e]}),M&&M.text&&!1!==M.enabled&&(h.addTitle(e),e&&!1!==M.reserveSpace&&(h.titleOffset=y=h.axisTitle.getBBox()[m?"height":"width"],i=M.offset,b=a(i)?0:f(M.margin,m?5:10))),h.renderLine(),h.offset=P*f(d.offset,A[x]?A[x]+(d.margin||0):0),h.tickRotCorr=h.tickRotCorr||{x:0,y:0},n=0===x?-h.labelMetrics().h:2===x?h.tickRotCorr.y:0,s=Math.abs(S)+b,S&&(s-=n,s+=P*(m?f(w.y,h.tickRotCorr.y+8*P):w.x)),h.axisTitleMargin=f(i,s),h.getMaxLabelDimensions&&(h.maxLabelDimensions=h.getMaxLabelDimensions(g,p)),r=this.tickSize("tick"),A[x]=Math.max(A[x],h.axisTitleMargin+y+P*h.offset,s,p&&p.length&&r?r[0]+P*h.offset:0),o=d.offset?0:2*Math.floor(h.axisLine.strokeWidth()/2),T[v]=Math.max(T[v],o),k(this,"afterGetOffset")},getLinePath:function(t){var e=this.chart,i=this.opposite,s=this.offset,o=this.horiz,n=this.left+(i?this.width:0)+s,r=e.chartHeight-this.bottom-(i?this.height:0)+s;return i&&(t*=-1),e.renderer.crispLine(["M",o?this.left:n,o?r:this.top,"L",o?e.chartWidth-this.right:n,o?r:e.chartHeight-this.bottom],t)},renderLine:function(){this.axisLine||(this.axisLine=this.chart.renderer.path().addClass("highcharts-axis-line").add(this.axisGroup),this.chart.styledMode||this.axisLine.attr({stroke:this.options.lineColor,"stroke-width":this.options.lineWidth,zIndex:7}))},getTitlePosition:function(){var t=this.horiz,e=this.left,i=this.top,s=this.len,o=this.options.title,n=t?e:i,r=this.opposite,a=this.offset,h=o.x||0,l=o.y||0,c=this.axisTitle,d=this.chart.renderer.fontMetrics(o.style&&o.style.fontSize,c),p=Math.max(c.getBBox(null,0).height-d.h-1,0),u={low:n+(t?0:s),middle:n+s/2,high:n+(t?s:0)}[o.align],f=(t?i+this.height:e)+(t?1:-1)*(r?-1:1)*this.axisTitleMargin+[-p,p,d.f,-p][this.side],g={x:t?u+h:f+(r?this.width:0)+a+h,y:t?f+l-(r?this.height:0)+a:u+l};return k(this,"afterGetTitlePosition",{titlePosition:g}),g},renderMinorTick:function(t){var e=this.chart.hasRendered&&d(this.oldMin),i=this.minorTicks;i[t]||(i[t]=new C(this,t,"minor")),e&&i[t].isNew&&i[t].render(null,!0),i[t].render(null,!1,1)},renderTick:function(t,e){var i=this.isLinked,s=this.ticks,o=this.chart.hasRendered&&d(this.oldMin);(!i||t>=this.min&&t<=this.max)&&(s[t]||(s[t]=new C(this,t)),o&&s[t].isNew&&s[t].render(e,!0,-1),s[t].render(e))},render:function(){var e,s,o=this,n=o.chart,r=n.renderer,a=o.options,h=o.isLog,l=o.isLinked,c=o.tickPositions,p=o.axisTitle,f=o.ticks,g=o.minorTicks,m=o.alternateBands,v=a.stackLabels,y=a.alternateGridColor,b=o.tickmarkOffset,M=o.axisLine,w=o.showAxis,S=i(r.globalAnimation);if(o.labelEdge.length=0,o.overlap=!1,[f,g,m].forEach(function(t){u(t,function(t){t.isActive=!1})}),(o.hasData()||l)&&(o.minorTickInterval&&!o.categories&&o.getMinorTickPositions().forEach(function(t){o.renderMinorTick(t)}),c.length&&(c.forEach(function(t,e){o.renderTick(t,e)}),b&&(0===o.min||o.single)&&(f[-1]||(f[-1]=new C(o,-1,null,!0)),f[-1].render(-1))),y&&c.forEach(function(i,r){s=void 0!==c[r+1]?c[r+1]+b:o.max-b,r%2==0&&i<o.max&&s<=o.max+(n.polar?-b:b)&&(m[i]||(m[i]=new t.PlotLineOrBand(o)),e=i+b,m[i].options={from:h?o.lin2log(e):e,to:h?o.lin2log(s):s,color:y},m[i].render(),m[i].isActive=!0)}),o._addedPlotLB||((a.plotLines||[]).concat(a.plotBands||[]).forEach(function(t){o.addPlotBandOrLine(t)}),o._addedPlotLB=!0)),[f,g,m].forEach(function(t){var e,i=[],s=S.duration;u(t,function(t,e){t.isActive||(t.render(e,!1,0),t.isActive=!1,i.push(e))}),x(function(){for(e=i.length;e--;)t[i[e]]&&!t[i[e]].isActive&&(t[i[e]].destroy(),delete t[i[e]])},t!==m&&n.hasRendered&&s?s:0)}),M&&(M[M.isPlaced?"animate":"attr"]({d:this.getLinePath(M.strokeWidth())}),M.isPlaced=!0,M[w?"show":"hide"](w)),p&&w){var A=o.getTitlePosition();d(A.y)?(p[p.isNew?"attr":"animate"](A),p.isNew=!1):(p.attr("y",-9999),p.isNew=!0)}v&&v.enabled&&o.renderStackTotals(),o.isDirty=!1,k(this,"afterRender")},redraw:function(){this.visible&&(this.render(),this.plotLinesAndBands.forEach(function(t){t.render()})),this.series.forEach(function(t){t.isDirty=!0})},keepProps:["extKey","hcEvents","names","series","userMax","userMin"],destroy:function(t){var e,i,s=this,o=s.stacks,n=s.plotLinesAndBands;if(k(this,"destroy",{keepEvents:t}),t||P(s),u(o,function(t,e){h(t),o[e]=null}),[s.ticks,s.minorTicks,s.alternateBands].forEach(function(t){h(t)}),n)for(i=n.length;i--;)n[i].destroy();for(e in["stackTotalGroup","axisLine","axisTitle","axisGroup","gridGroup","labelGroup","cross","scrollbar"].forEach(function(t){s[t]&&(s[t]=s[t].destroy())}),s.plotLinesAndBandsGroups)s.plotLinesAndBandsGroups[e]=s.plotLinesAndBandsGroups[e].destroy();u(s,function(t,e){-1===s.keepProps.indexOf(e)&&delete s[e]})},drawCrosshair:function(t,e){var i,s,o,n,r=this.crosshair,h=f(r.snap,!0),c=this.cross;if(k(this,"drawCrosshair",{e:t,point:e}),t||(t=this.cross&&this.cross.e),this.crosshair&&!1!==(a(e)||!h)){if(h?a(e)&&(s=f("colorAxis"!==this.coll?e.crosshairPos:null,this.isXAxis?e.plotX:this.len-e.plotY)):s=t&&(this.horiz?t.chartX-this.pos:this.len-t.chartY+this.pos),a(s)&&(n={value:e&&(this.isXAxis?e.x:f(e.stackY,e.y)),translatedValue:s},this.chart.polar&&l(n,{isCrosshair:!0,chartX:t&&t.chartX,chartY:t&&t.chartY,point:e}),i=this.getPlotLinePath(n)||null),!a(i))return void this.hideCrosshair();o=this.categories&&!this.isRadial,c||(this.cross=c=this.chart.renderer.path().addClass("highcharts-crosshair highcharts-crosshair-"+(o?"category ":"thin ")+r.className).attr({zIndex:f(r.zIndex,2)}).add(),this.chart.styledMode||(c.attr({stroke:r.color||(o?y("#ccd6eb").setOpacity(.25).get():"#cccccc"),"stroke-width":f(r.width,1)}).css({"pointer-events":"none"}),r.dashStyle&&c.attr({dashstyle:r.dashStyle}))),c.show().attr({d:i}),o&&!r.width&&c.attr({"stroke-width":this.transA}),this.cross.e=t}else this.hideCrosshair();k(this,"afterDrawCrosshair",{e:t,point:e})},hideCrosshair:function(){this.cross&&this.cross.hide(),k(this,"afterHideCrosshair")}}),t.Axis=E,E}),i(e,"parts/DateTimeAxis.js",[e["parts/Globals.js"]],function(t){var e=t.Axis,i=t.getMagnitude,s=t.normalizeTickInterval,o=t.timeUnits;e.prototype.getTimeTicks=function(){return this.chart.time.getTimeTicks.apply(this.chart.time,arguments)},e.prototype.normalizeTimeTickInterval=function(t,e){var n,r=e||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],a=r[r.length-1],h=o[a[0]],l=a[1];for(n=0;n<r.length;n++){if(a=r[n],h=o[a[0]],l=a[1],r[n+1])if(t<=(h*l[l.length-1]+o[r[n+1][0]])/2)break}return h===o.year&&t<5*h&&(l=[1,2,5]),{unitRange:h,count:s(t/h,l,"year"===a[0]?Math.max(i(t/h),1):1),unitName:a[0]}}}),i(e,"parts/LogarithmicAxis.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.pick,s=t.Axis,o=t.getMagnitude,n=t.normalizeTickInterval;s.prototype.getLogTickPositions=function(t,e,s,r){var a=this.options,h=this.len,l=[];if(r||(this._minorAutoInterval=null),t>=.5)t=Math.round(t),l=this.getLinearTickPositions(t,e,s);else if(t>=.08){var c,d,p,u,f,g,m,x=Math.floor(e);for(c=t>.3?[1,2,4]:t>.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9],d=x;d<s+1&&!m;d++)for(u=c.length,p=0;p<u&&!m;p++)(f=this.log2lin(this.lin2log(d)*c[p]))>e&&(!r||g<=s)&&void 0!==g&&l.push(g),g>s&&(m=!0),g=f}else{var v=this.lin2log(e),y=this.lin2log(s),b=r?this.getMinorTickInterval():a.tickInterval,M="auto"===b?null:b,k=a.tickPixelInterval/(r?5:1),w=r?h/this.tickPositions.length:h;t=i(M,this._minorAutoInterval,(y-v)*k/(w||1)),t=n(t,null,o(t)),l=this.getLinearTickPositions(t,v,y).map(this.log2lin),r||(this._minorAutoInterval=t/5)}return r||(this.tickInterval=t),l},s.prototype.log2lin=function(t){return Math.log(t)/Math.LN10},s.prototype.lin2log=function(t){return Math.pow(10,t)}}),i(e,"parts/PlotLineOrBand.js",[e["parts/Globals.js"],e["parts/Axis.js"],e["parts/Utilities.js"]],function(t,e,i){var s=i.arrayMax,o=i.arrayMin,n=i.defined,r=i.destroyObjectProperties,a=i.erase,h=i.extend,l=i.objectEach,c=i.pick,d=t.merge;t.PlotLineOrBand=function(t,e){this.axis=t,e&&(this.options=e,this.id=e.id)},t.PlotLineOrBand.prototype={render:function(){t.fireEvent(this,"render");var e,i=this,s=i.axis,o=s.horiz,r=i.options,a=r.label,h=i.label,p=r.to,u=r.from,f=r.value,g=n(u)&&n(p),m=n(f),x=i.svgElem,v=!x,y=[],b=r.color,M=c(r.zIndex,0),k=r.events,w={class:"highcharts-plot-"+(g?"band ":"line ")+(r.className||"")},S={},A=s.chart.renderer,T=g?"bands":"lines";if(s.isLog&&(u=s.log2lin(u),p=s.log2lin(p),f=s.log2lin(f)),s.chart.styledMode||(m?(w.stroke=b||"#999999",w["stroke-width"]=c(r.width,1),r.dashStyle&&(w.dashstyle=r.dashStyle)):g&&(w.fill=b||"#e6ebf5",r.borderWidth&&(w.stroke=r.borderColor,w["stroke-width"]=r.borderWidth))),S.zIndex=M,T+="-"+M,(e=s.plotLinesAndBandsGroups[T])||(s.plotLinesAndBandsGroups[T]=e=A.g("plot-"+T).attr(S).add()),v&&(i.svgElem=x=A.path().attr(w).add(e)),m)y=s.getPlotLinePath({value:f,lineWidth:x.strokeWidth(),acrossPanes:r.acrossPanes});else{if(!g)return;y=s.getPlotBandPath(u,p,r)}return(v||!x.d)&&y&&y.length?(x.attr({d:y}),k&&l(k,function(t,e){x.on(e,function(t){k[e].apply(i,[t])})})):x&&(y?(x.show(!0),x.animate({d:y})):x.d&&(x.hide(),h&&(i.label=h=h.destroy()))),a&&(n(a.text)||n(a.formatter))&&y&&y.length&&s.width>0&&s.height>0&&!y.isFlat?(a=d({align:o&&g&&"center",x:o?!g&&4:10,verticalAlign:!o&&g&&"middle",y:o?g?16:10:g?6:-4,rotation:o&&!g&&90},a),this.renderLabel(a,y,g,M)):h&&h.hide(),i},renderLabel:function(t,e,i,n){var r,a,h,l,c,d,p=this.label,u=this.axis.chart.renderer;p||((r={align:t.textAlign||t.align,rotation:t.rotation,class:"highcharts-plot-"+(i?"band":"line")+"-label "+(t.className||"")}).zIndex=n,d=this.getLabelText(t),this.label=p=u.text(d,0,0,t.useHTML).attr(r).add(),this.axis.chart.styledMode||p.css(t.style)),a=e.xBounds||[e[1],e[4],i?e[6]:e[1]],h=e.yBounds||[e[2],e[5],i?e[7]:e[2]],l=o(a),c=o(h),p.align(t,!1,{x:l,y:c,width:s(a)-l,height:s(h)-c}),p.show(!0)},getLabelText:function(t){return n(t.formatter)?t.formatter.call(this):t.text},destroy:function(){a(this.axis.plotLinesAndBands,this),delete this.axis,r(this)}},h(e.prototype,{getPlotBandPath:function(t,e){var i,s,o=this.getPlotLinePath({value:e,force:!0,acrossPanes:this.options.acrossPanes}),n=this.getPlotLinePath({value:t,force:!0,acrossPanes:this.options.acrossPanes}),r=[],a=this.horiz,h=1,l=t<this.min&&e<this.min||t>this.max&&e>this.max;if(n&&o)for(l&&(s=n.toString()===o.toString(),h=0),i=0;i<n.length;i+=6)a&&o[i+1]===n[i+1]?(o[i+1]+=h,o[i+4]+=h):a||o[i+2]!==n[i+2]||(o[i+2]+=h,o[i+5]+=h),r.push("M",n[i+1],n[i+2],"L",n[i+4],n[i+5],o[i+4],o[i+5],o[i+1],o[i+2],"z"),r.isFlat=s;else n=null;return r},addPlotBand:function(t){return this.addPlotBandOrLine(t,"plotBands")},addPlotLine:function(t){return this.addPlotBandOrLine(t,"plotLines")},addPlotBandOrLine:function(e,i){var s=new t.PlotLineOrBand(this,e).render(),o=this.userOptions;if(s){if(i){var n=o[i]||[];n.push(e),o[i]=n}this.plotLinesAndBands.push(s)}return s},removePlotBandOrLine:function(t){for(var e=this.plotLinesAndBands,i=this.options,s=this.userOptions,o=e.length;o--;)e[o].id===t&&e[o].destroy();[i.plotLines||[],s.plotLines||[],i.plotBands||[],s.plotBands||[]].forEach(function(e){for(o=e.length;o--;)e[o].id===t&&a(e,e[o])})},removePlotBand:function(t){this.removePlotBandOrLine(t)},removePlotLine:function(t){this.removePlotBandOrLine(t)}})}),i(e,"parts/Tooltip.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.clamp,s=e.defined,o=e.discardElement,n=e.extend,r=e.isNumber,a=e.isString,h=e.pick,l=e.splat,c=e.syncTimeout,d=t.doc,p=t.format,u=t.merge,f=t.timeUnits;t.Tooltip=function(){this.init.apply(this,arguments)},t.Tooltip.prototype={init:function(t,e){this.chart=t,this.options=e,this.crosshairs=[],this.now={x:0,y:0},this.isHidden=!0,this.split=e.split&&!t.inverted&&!t.polar,this.shared=e.shared||this.split,this.outside=h(e.outside,Boolean(t.scrollablePixelsX||t.scrollablePixelsY))},cleanSplit:function(t){this.chart.series.forEach(function(e){var i=e&&e.tt;i&&(!i.isActive||t?e.tt=i.destroy():i.isActive=!1)})},applyFilter:function(){var t=this.chart;t.renderer.definition({tagName:"filter",id:"drop-shadow-"+t.index,opacity:.5,children:[{tagName:"feGaussianBlur",in:"SourceAlpha",stdDeviation:1},{tagName:"feOffset",dx:1,dy:1},{tagName:"feComponentTransfer",children:[{tagName:"feFuncA",type:"linear",slope:.3}]},{tagName:"feMerge",children:[{tagName:"feMergeNode"},{tagName:"feMergeNode",in:"SourceGraphic"}]}]}),t.renderer.definition({tagName:"style",textContent:".highcharts-tooltip-"+t.index+"{filter:url(#drop-shadow-"+t.index+")}"})},getLabel:function(){var e,i,o=this,n=this.chart.renderer,r=this.chart.styledMode,a=this.options,h="tooltip"+(s(a.className)?" "+a.className:"");return this.label||(this.outside&&(this.container=e=t.doc.createElement("div"),e.className="highcharts-tooltip-container",t.css(e,{position:"absolute",top:"1px",pointerEvents:a.style&&a.style.pointerEvents,zIndex:3}),t.doc.body.appendChild(e),this.renderer=n=new t.Renderer(e,0,0,{},void 0,void 0,n.styledMode)),this.split?this.label=n.g(h):(this.label=n.label("",0,0,a.shape||"callout",null,null,a.useHTML,null,h).attr({padding:a.padding,r:a.borderRadius}),r||this.label.attr({fill:a.backgroundColor,"stroke-width":a.borderWidth}).css(a.style).shadow(a.shadow)),r&&(this.applyFilter(),this.label.addClass("highcharts-tooltip-"+this.chart.index)),o.outside&&!o.split&&(i={x:this.label.xSetter,y:this.label.ySetter},this.label.xSetter=function(t,s){i[s].call(this.label,o.distance),e.style.left=t+"px"},this.label.ySetter=function(t,s){i[s].call(this.label,o.distance),e.style.top=t+"px"}),this.label.attr({zIndex:8}).add()),this.label},update:function(t){this.destroy(),u(!0,this.chart.options.tooltip.userOptions,t),this.init(this.chart,u(!0,this.options,t))},destroy:function(){this.label&&(this.label=this.label.destroy()),this.split&&this.tt&&(this.cleanSplit(this.chart,!0),this.tt=this.tt.destroy()),this.renderer&&(this.renderer=this.renderer.destroy(),o(this.container)),t.clearTimeout(this.hideTimer),t.clearTimeout(this.tooltipTimeout)},move:function(e,i,s,o){var r=this,a=r.now,h=!1!==r.options.animation&&!r.isHidden&&(Math.abs(e-a.x)>1||Math.abs(i-a.y)>1),l=r.followPointer||r.len>1;n(a,{x:h?(2*a.x+e)/3:e,y:h?(a.y+i)/2:i,anchorX:l?void 0:h?(2*a.anchorX+s)/3:s,anchorY:l?void 0:h?(a.anchorY+o)/2:o}),r.getLabel().attr(a),h&&(t.clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){r&&r.move(e,i,s,o)},32))},hide:function(e){var i=this;t.clearTimeout(this.hideTimer),e=h(e,this.options.hideDelay,500),this.isHidden||(this.hideTimer=c(function(){i.getLabel()[e?"fadeOut":"hide"](),i.isHidden=!0},e))},getAnchor:function(t,e){var i,s,o,n=this.chart,r=n.pointer,a=n.inverted,h=n.plotTop,c=n.plotLeft,d=0,p=0;return t=l(t),this.followPointer&&e?(void 0===e.chartX&&(e=r.normalize(e)),i=[e.chartX-n.plotLeft,e.chartY-h]):t[0].tooltipPos?i=t[0].tooltipPos:(t.forEach(function(t){s=t.series.yAxis,o=t.series.xAxis,d+=t.plotX+(!a&&o?o.left-c:0),p+=(t.plotLow?(t.plotLow+t.plotHigh)/2:t.plotY)+(!a&&s?s.top-h:0)}),d/=t.length,p/=t.length,i=[a?n.plotWidth-p:d,this.shared&&!a&&t.length>1&&e?e.chartY-h:a?n.plotHeight-d:p]),i.map(Math.round)},getPosition:function(t,e,i){var s,o=this.chart,n=this.distance,r={},a=o.inverted&&i.h||0,l=this.outside,c=l?d.documentElement.clientWidth-2*n:o.chartWidth,p=l?Math.max(d.body.scrollHeight,d.documentElement.scrollHeight,d.body.offsetHeight,d.documentElement.offsetHeight,d.documentElement.clientHeight):o.chartHeight,u=o.pointer.getChartPosition(),f=o.containerScaling,g=function(t){return f?t*f.scaleX:t},m=function(t){return f?t*f.scaleY:t},x=function(s){var r="x"===s;return[s,r?c:p,r?t:e].concat(l?[r?g(t):m(e),r?u.left-n+g(i.plotX+o.plotLeft):u.top-n+m(i.plotY+o.plotTop),0,r?c:p]:[r?t:e,r?i.plotX+o.plotLeft:i.plotY+o.plotTop,r?o.plotLeft:o.plotTop,r?o.plotLeft+o.plotWidth:o.plotTop+o.plotHeight])},v=x("y"),y=x("x"),b=!this.followPointer&&h(i.ttBelow,!o.inverted==!!i.negative),M=function(t){var e=v;v=y,y=e,s=t},k=function(){!1!==function(t,e,i,s,o,h,l){var c="y"===t?m(n):g(n),d=(i-s)/2,p=s<o-n,u=o+n+s<e,f=o-c-i+d,x=o+c-d;if(b&&u)r[t]=x;else if(!b&&p)r[t]=f;else if(p)r[t]=Math.min(l-s,f-a<0?f:f-a);else{if(!u)return!1;r[t]=Math.max(h,x+a+i>e?x:x+a)}}.apply(0,v)?!1!==function(t,e,i,s,o){var a;return o<n||o>e-n?a=!1:r[t]=o<i/2?1:o>e-s/2?e-s-2:o-i/2,a}.apply(0,y)||s||(M(!0),k()):s?r.x=r.y=0:(M(!0),k())};return(o.inverted||this.len>1)&&M(),k(),r},defaultFormatter:function(t){var e,i=this.points||l(this);return(e=(e=[t.tooltipFooterHeaderFormatter(i[0])]).concat(t.bodyFormatter(i))).push(t.tooltipFooterHeaderFormatter(i[0],!0)),e},refresh:function(e,i){var s,o,n,r,a,c=this.chart,d=this.options,p=e,u={},f=[],g=d.formatter||this.defaultFormatter,m=this.shared,x=c.styledMode;if(d.enabled){if(t.clearTimeout(this.hideTimer),this.followPointer=l(p)[0].series.tooltipOptions.followPointer,s=(n=this.getAnchor(p,i))[0],o=n[1],!m||p.series&&p.series.noSharedTooltip?u=p.getLabelConfig():(c.pointer.applyInactiveState(p),p.forEach(function(t){t.setState("hover"),f.push(t.getLabelConfig())}),(u={x:p[0].category,y:p[0].y}).points=f,p=p[0]),this.len=f.length,r=g.call(u,this),a=p.series,this.distance=h(a.tooltipOptions.distance,16),!1===r)this.hide();else{if(this.split)this.renderSplit(r,l(e));else{var v=this.getLabel();d.style.width&&!x||v.css({width:this.chart.spacingBox.width}),v.attr({text:r&&r.join?r.join(""):r}),v.removeClass(/highcharts-color-[\d]+/g).addClass("highcharts-color-"+h(p.colorIndex,a.colorIndex)),x||v.attr({stroke:d.borderColor||p.color||a.color||"#666666"}),this.updatePosition({plotX:s,plotY:o,negative:p.negative,ttBelow:p.ttBelow,h:n[2]||0})}this.isHidden&&this.label&&this.label.attr({opacity:1}).show(),this.isHidden=!1}t.fireEvent(this,"refresh")}},renderSplit:function(e,s){var o=this,r=o.chart,l=o.chart,c=l.chartWidth,d=l.chartHeight,p=l.plotHeight,u=l.plotLeft,f=l.plotTop,g=l.plotWidth,m=l.pointer,x=l.renderer,v=l.scrollablePixelsX,y=void 0===v?0:v,b=l.scrollablePixelsY,M=void 0===b?0:b,k=l.scrollingContainer,w=void 0===k?{scrollLeft:0,scrollTop:0}:k,S=w.scrollLeft,A=w.scrollTop,T=l.styledMode,P=o.distance,L=o.options,C=o.options.positioner,E={left:y?u:0,right:y?u+g-y:c,top:M?f:0,bottom:M?f+p-M:d},O=o.getLabel(),D=Boolean(r.xAxis[0]&&r.xAxis[0].opposite),B=f,I=0,z=p-M;function R(t,e,s,o,n){var r,a;return void 0===n&&(n=!0),s?(r=D?0:z,a=i(t-o/2,E.left,E.right-o)):(r=e-B,a=i(a=n?t-o-P:t+P,n?a:E.left,E.right)),{x:a,y:r}}a(e)&&(e=[!1,e]);var W=e.slice(0,s.length+1).reduce(function(t,e,n){if(!1!==e&&""!==e){var r=s[n-1]||{isHeader:!0,plotX:s[0].plotX,plotY:p,series:{}},a=r.isHeader,l=a?o:r.series,c=l.tt=function(t,e,i){var s=t,o=e.isHeader,n=e.series,r="highcharts-color-"+h(e.colorIndex,n.colorIndex,"none");if(!s){var a={padding:L.padding,r:L.borderRadius};T||(a.fill=L.backgroundColor,a["stroke-width"]=L.borderWidth),s=x.label(null,null,null,L[o?"headerShape":"shape"]||"callout",null,null,L.useHTML).addClass(o?"highcharts-tooltip-header ":"highcharts-tooltip-box "+r).attr(a).add(O)}return s.isActive=!0,s.attr({text:i}),T||s.css(L.style).shadow(L.shadow).attr({stroke:L.borderColor||e.color||n.color||"#333333"}),s}(l.tt,r,e),d=c.getBBox(),g=d.width+c.strokeWidth();a&&(I=d.height,z+=I,D&&(B-=I));var m=function(t){var e,s,o=t.isHeader,n=t.plotX,r=void 0===n?0:n,a=t.plotY,h=void 0===a?0:a,l=t.series;if(o)e=u+r-S,s=f+(p-M)/2;else{var c=l.xAxis,d=l.yAxis;e=c.pos+i(r,-P,c.len+P)-S,s=d.pos+i(h,0,d.len)-A}return{anchorX:e=i(e,E.left-P,E.right+P),anchorY:s=i(s,E.top,E.bottom)}}(r),v=m.anchorX,y=m.anchorY,b=d.height+1,k=C?C.call(o,g,b,r):R(v,y,a,g);t.push({align:C?0:void 0,anchorX:v,anchorY:y,boxWidth:g,point:r,rank:h(k.rank,a?1:0),size:b,target:k.y,tt:c,x:k.x})}return t},[]);!C&&W.some(function(t){return t.x<0})&&(W=W.map(function(t){var e=R(t.anchorX,t.anchorY,t.point.isHeader,t.boxWidth,!1),i=e.x,s=e.y;return n(t,{target:s,x:i})})),o.cleanSplit(),t.distribute(W,z,void 0),W.forEach(function(t){var e=t.anchorX,i=t.anchorY,s=t.pos,o=t.x;t.tt.attr({visibility:void 0===s?"hidden":"inherit",x:o,y:s+B,anchorX:e,anchorY:i})});var G=o.container,X=o.outside,N=o.renderer;if(X&&G&&N){var H=O.getBBox(),j=H.width,Y=H.height,F=H.x,U=H.y;N.setSize(j+F,Y+U,!1);var V=m.getChartPosition();G.style.left=V.left+"px",G.style.top=V.top+"px"}},updatePosition:function(e){var i,s,o=this.chart,n=o.pointer,r=this.getLabel(),a=e.plotX+o.plotLeft,h=e.plotY+o.plotTop,l=n.getChartPosition();if(i=(this.options.positioner||this.getPosition).call(this,r.width,r.height,e),this.outside){s=(this.options.borderWidth||0)+2*this.distance,this.renderer.setSize(r.width+s,r.height+s,!1);var c=o.containerScaling;c&&(t.css(this.container,{transform:"scale("+c.scaleX+", "+c.scaleY+")"}),a*=c.scaleX,h*=c.scaleY),a+=l.left-i.x,h+=l.top-i.y}this.move(Math.round(i.x),Math.round(i.y||0),a,h)},getDateFormat:function(t,e,i,s){var o,n,r=this.chart.time,a=r.dateFormat("%m-%d %H:%M:%S.%L",e),h="01-01 00:00:00.000",l={millisecond:15,second:12,minute:9,hour:6,day:3},c="millisecond";for(n in f){if(t===f.week&&+r.dateFormat("%w",e)===i&&a.substr(6)===h.substr(6)){n="week";break}if(f[n]>t){n=c;break}if(l[n]&&a.substr(l[n])!==h.substr(l[n]))break;"week"!==n&&(c=n)}return n&&(o=r.resolveDTLFormat(s[n]).main),o},getXDateFormat:function(t,e,i){var s=e.dateTimeLabelFormats,o=i&&i.closestPointRange;return(o?this.getDateFormat(o,t.x,i.options.startOfWeek,s):s.day)||s.year},tooltipFooterHeaderFormatter:function(e,i){var s=i?"footer":"header",o=e.series,n=o.tooltipOptions,a=n.xDateFormat,h=o.xAxis,l=h&&"datetime"===h.options.type&&r(e.key),c=n[s+"Format"],d={isFooter:i,labelConfig:e};return t.fireEvent(this,"headerFormatter",d,function(t){l&&!a&&(a=this.getXDateFormat(e,n,h)),l&&a&&(e.point&&e.point.tooltipDateKeys||["key"]).forEach(function(t){c=c.replace("{point."+t+"}","{point."+t+":"+a+"}")}),o.chart.styledMode&&(c=this.styledModeFormat(c)),t.text=p(c,{point:e,series:o},this.chart)}),d.text},bodyFormatter:function(t){return t.map(function(t){var e=t.series.tooltipOptions;return(e[(t.point.formatPrefix||"point")+"Formatter"]||t.point.tooltipFormatter).call(t.point,e[(t.point.formatPrefix||"point")+"Format"]||"")})},styledModeFormat:function(t){return t.replace('style="font-size: 10px"','class="highcharts-header"').replace(/style="color:{(point|series)\.color}"/g,'class="highcharts-color-{$1.colorIndex}"')}}}),i(e,"parts/Pointer.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.attr,s=e.defined,o=e.extend,n=e.isNumber,r=e.isObject,a=e.objectEach,h=e.offset,l=e.pick,c=e.splat,d=t,p=d.addEvent,u=d.charts,f=d.color,g=d.css,m=d.find,x=d.fireEvent,v=d.Tooltip;t.Pointer=function(t,e){this.init(t,e)},t.Pointer.prototype={init:function(t,e){this.options=e,this.chart=t,this.runChartClick=e.chart.events&&!!e.chart.events.click,this.pinchDown=[],this.lastValidTouch={},v&&(t.tooltip=new v(t,e.tooltip),this.followTouchMove=l(e.tooltip.followTouchMove,!0)),this.setDOMEvents()},zoomOption:function(t){var e,i,s=this.chart,o=s.options.chart,n=o.zoomType||"",r=s.inverted;/touch/.test(t.type)&&(n=l(o.pinchType,n)),this.zoomX=e=/x/.test(n),this.zoomY=i=/y/.test(n),this.zoomHor=e&&!r||i&&r,this.zoomVert=i&&!r||e&&r,this.hasZoom=e||i},getChartPosition:function(){var t=this.chart,e=t.scrollingContainer||t.container;return this.chartPosition||(this.chartPosition=h(e))},normalize:function(t,e){var i;i=t.touches?t.touches.length?t.touches.item(0):t.changedTouches[0]:t,e||(e=this.getChartPosition());var s=i.pageX-e.left,n=i.pageY-e.top,r=this.chart.containerScaling;return r&&(s/=r.scaleX,n/=r.scaleY),o(t,{chartX:Math.round(s),chartY:Math.round(n)})},getCoordinates:function(t){var e={xAxis:[],yAxis:[]};return this.chart.axes.forEach(function(i){e[i.isXAxis?"xAxis":"yAxis"].push({axis:i,value:i.toValue(t[i.horiz?"chartX":"chartY"])})}),e},findNearestKDPoint:function(t,e,i){var s;return t.forEach(function(t){var o,n,a,h,l,c=!(t.noSharedTooltip&&e)&&t.options.findNearestPointBy.indexOf("y")<0,d=t.searchPoint(i,c);r(d,!0)&&(!r(s,!0)||(n=d,a=(o=s).distX-n.distX,h=o.dist-n.dist,l=(n.series.group&&n.series.group.zIndex)-(o.series.group&&o.series.group.zIndex),(0!==a&&e?a:0!==h?h:0!==l?l:o.series.index>n.series.index?-1:1)>0))&&(s=d)}),s},getPointFromEvent:function(t){for(var e,i=t.target;i&&!e;)e=i.point,i=i.parentNode;return e},getChartCoordinatesFromPoint:function(t,e){var i=t.series,s=i.xAxis,o=i.yAxis,n=l(t.clientX,t.plotX),r=t.shapeArgs;return s&&o?e?{chartX:s.len+s.pos-n,chartY:o.len+o.pos-t.plotY}:{chartX:n+s.pos,chartY:t.plotY+o.pos}:r&&r.x&&r.y?{chartX:r.x,chartY:r.y}:void 0},getHoverData:function(t,e,i,s,o,n){var a,h=[],c=e,d=!(!s||!t),p=function(t){return t.visible&&!(!o&&t.directTouch)&&l(t.options.enableMouseTracking,!0)},u=c&&!c.stickyTracking?[c]:i.filter(function(t){return p(t)&&t.stickyTracking});return c=(a=d||!n?t:this.findNearestKDPoint(u,o,n))&&a.series,a&&(o&&!c.noSharedTooltip?(u=i.filter(function(t){return p(t)&&!t.noSharedTooltip})).forEach(function(t){var e=m(t.points,function(t){return t.x===a.x&&!t.isNull});r(e)&&(t.chart.isBoosting&&(e=t.getPoint(e)),h.push(e))}):h.push(a)),{hoverPoint:a,hoverSeries:c,hoverPoints:h}},runPointActions:function(t,e){var i,s,o,n,r=this.chart,a=r.series,h=r.tooltip&&r.tooltip.options.enabled?r.tooltip:void 0,c=!!h&&h.shared,f=e||r.hoverPoint,g=f&&f.series||r.hoverSeries,m=(!t||"touchmove"!==t.type)&&(!!e||g&&g.directTouch&&this.isDirectTouch),x=this.getHoverData(f,g,a,m,c,t);if(f=x.hoverPoint,n=x.hoverPoints,s=(g=x.hoverSeries)&&g.tooltipOptions.followPointer,i=c&&g&&!g.noSharedTooltip,f&&(f!==r.hoverPoint||h&&h.isHidden)){if((r.hoverPoints||[]).forEach(function(t){-1===n.indexOf(t)&&t.setState()}),r.hoverSeries!==g&&g.onMouseOver(),this.applyInactiveState(n),(n||[]).forEach(function(t){t.setState("hover")}),r.hoverPoint&&r.hoverPoint.firePointEvent("mouseOut"),!f.series)return;f.firePointEvent("mouseOver"),r.hoverPoints=n,r.hoverPoint=f,h&&h.refresh(i?n:f,t)}else s&&h&&!h.isHidden&&(o=h.getAnchor([{}],t),h.updatePosition({plotX:o[0],plotY:o[1]}));this.unDocMouseMove||(this.unDocMouseMove=p(r.container.ownerDocument,"mousemove",function(t){var e=u[d.hoverChartIndex];e&&e.pointer.onDocumentMouseMove(t)})),r.axes.forEach(function(e){var i=l(e.crosshair.snap,!0),s=i?d.find(n,function(t){return t.series[e.coll]===e}):void 0;s||!i?e.drawCrosshair(t,s):e.hideCrosshair()})},applyInactiveState:function(t){var e,i=[];(t||[]).forEach(function(t){e=t.series,i.push(e),e.linkedParent&&i.push(e.linkedParent),e.linkedSeries&&(i=i.concat(e.linkedSeries)),e.navigatorSeries&&i.push(e.navigatorSeries)}),this.chart.series.forEach(function(t){-1===i.indexOf(t)?t.setState("inactive",!0):t.options.inactiveOtherPoints&&t.setAllPointsToState("inactive")})},reset:function(t,e){var i=this.chart,s=i.hoverSeries,o=i.hoverPoint,n=i.hoverPoints,r=i.tooltip,a=r&&r.shared?n:o;t&&a&&c(a).forEach(function(e){e.series.isCartesian&&void 0===e.plotX&&(t=!1)}),t?r&&a&&c(a).length&&(r.refresh(a),r.shared&&n?n.forEach(function(t){t.setState(t.state,!0),t.series.isCartesian&&(t.series.xAxis.crosshair&&t.series.xAxis.drawCrosshair(null,t),t.series.yAxis.crosshair&&t.series.yAxis.drawCrosshair(null,t))}):o&&(o.setState(o.state,!0),i.axes.forEach(function(t){t.crosshair&&o.series[t.coll]===t&&t.drawCrosshair(null,o)}))):(o&&o.onMouseOut(),n&&n.forEach(function(t){t.setState()}),s&&s.onMouseOut(),r&&r.hide(e),this.unDocMouseMove&&(this.unDocMouseMove=this.unDocMouseMove()),i.axes.forEach(function(t){t.hideCrosshair()}),this.hoverX=i.hoverPoints=i.hoverPoint=null)},scaleGroups:function(t,e){var i,s=this.chart;s.series.forEach(function(o){i=t||o.getPlotBox(),o.xAxis&&o.xAxis.zoomEnabled&&o.group&&(o.group.attr(i),o.markerGroup&&(o.markerGroup.attr(i),o.markerGroup.clip(e?s.clipRect:null)),o.dataLabelsGroup&&o.dataLabelsGroup.attr(i))}),s.clipRect.attr(e||s.clipBox)},dragStart:function(t){var e=this.chart;e.mouseIsDown=t.type,e.cancelClick=!1,e.mouseDownX=this.mouseDownX=t.chartX,e.mouseDownY=this.mouseDownY=t.chartY},drag:function(t){var e,i,s=this.chart,o=s.options.chart,n=t.chartX,a=t.chartY,h=this.zoomHor,l=this.zoomVert,c=s.plotLeft,d=s.plotTop,p=s.plotWidth,u=s.plotHeight,g=this.selectionMarker,m=this.mouseDownX,x=this.mouseDownY,v=r(o.panning)?o.panning&&o.panning.enabled:o.panning,y=o.panKey&&t[o.panKey+"Key"];g&&g.touch||(n<c?n=c:n>c+p&&(n=c+p),a<d?a=d:a>d+u&&(a=d+u),this.hasDragged=Math.sqrt(Math.pow(m-n,2)+Math.pow(x-a,2)),this.hasDragged>10&&(e=s.isInsidePlot(m-c,x-d),s.hasCartesianSeries&&(this.zoomX||this.zoomY)&&e&&!y&&(g||(this.selectionMarker=g=s.renderer.rect(c,d,h?1:p,l?1:u,0).attr({class:"highcharts-selection-marker",zIndex:7}).add(),s.styledMode||g.attr({fill:o.selectionMarkerFill||f("#335cad").setOpacity(.25).get()}))),g&&h&&(i=n-m,g.attr({width:Math.abs(i),x:(i>0?0:i)+m})),g&&l&&(i=a-x,g.attr({height:Math.abs(i),y:(i>0?0:i)+x})),e&&!g&&v&&s.pan(t,o.panning)))},drop:function(t){var e=this,i=this.chart,r=this.hasPinched;if(this.selectionMarker){var a,h={originalEvent:t,xAxis:[],yAxis:[]},l=this.selectionMarker,c=l.attr?l.attr("x"):l.x,d=l.attr?l.attr("y"):l.y,p=l.attr?l.attr("width"):l.width,u=l.attr?l.attr("height"):l.height;(this.hasDragged||r)&&(i.axes.forEach(function(i){if(i.zoomEnabled&&s(i.min)&&(r||e[{xAxis:"zoomX",yAxis:"zoomY"}[i.coll]])){var o=i.horiz,n="touchend"===t.type?i.minPixelPadding:0,l=i.toValue((o?c:d)+n),f=i.toValue((o?c+p:d+u)-n);h[i.coll].push({axis:i,min:Math.min(l,f),max:Math.max(l,f)}),a=!0}}),a&&x(i,"selection",h,function(t){i.zoom(o(t,r?{animation:!1}:null))})),n(i.index)&&(this.selectionMarker=this.selectionMarker.destroy()),r&&this.scaleGroups()}i&&n(i.index)&&(g(i.container,{cursor:i._cursor}),i.cancelClick=this.hasDragged>10,i.mouseIsDown=this.hasDragged=this.hasPinched=!1,this.pinchDown=[])},onContainerMouseDown:function(t){2!==(t=this.normalize(t)).button&&(this.zoomOption(t),t.preventDefault&&t.preventDefault(),this.dragStart(t))},onDocumentMouseUp:function(t){u[d.hoverChartIndex]&&u[d.hoverChartIndex].pointer.drop(t)},onDocumentMouseMove:function(t){var e=this.chart,i=this.chartPosition;t=this.normalize(t,i),!i||this.inClass(t.target,"highcharts-tracker")||e.isInsidePlot(t.chartX-e.plotLeft,t.chartY-e.plotTop)||this.reset()},onContainerMouseLeave:function(t){var e=u[d.hoverChartIndex];e&&(t.relatedTarget||t.toElement)&&(e.pointer.reset(),e.pointer.chartPosition=void 0)},onContainerMouseMove:function(t){var e=this.chart;s(d.hoverChartIndex)&&u[d.hoverChartIndex]&&u[d.hoverChartIndex].mouseIsDown||(d.hoverChartIndex=e.index),(t=this.normalize(t)).preventDefault||(t.returnValue=!1),"mousedown"===e.mouseIsDown&&this.drag(t),!this.inClass(t.target,"highcharts-tracker")&&!e.isInsidePlot(t.chartX-e.plotLeft,t.chartY-e.plotTop)||e.openMenu||this.runPointActions(t)},inClass:function(t,e){for(var s;t;){if(s=i(t,"class")){if(-1!==s.indexOf(e))return!0;if(-1!==s.indexOf("highcharts-container"))return!1}t=t.parentNode}},onTrackerMouseOut:function(t){var e=this.chart.hoverSeries,i=t.relatedTarget||t.toElement;this.isDirectTouch=!1,!e||!i||e.stickyTracking||this.inClass(i,"highcharts-tooltip")||this.inClass(i,"highcharts-series-"+e.index)&&this.inClass(i,"highcharts-tracker")||e.onMouseOut()},onContainerClick:function(t){var e=this.chart,i=e.hoverPoint,s=e.plotLeft,n=e.plotTop;t=this.normalize(t),e.cancelClick||(i&&this.inClass(t.target,"highcharts-tracker")?(x(i.series,"click",o(t,{point:i})),e.hoverPoint&&i.firePointEvent("click",t)):(o(t,this.getCoordinates(t)),e.isInsidePlot(t.chartX-s,t.chartY-n)&&x(e,"click",t)))},setDOMEvents:function(){var t=this,e=t.chart.container,i=e.ownerDocument;e.onmousedown=function(e){t.onContainerMouseDown(e)},e.onmousemove=function(e){t.onContainerMouseMove(e)},e.onclick=function(e){t.onContainerClick(e)},this.unbindContainerMouseLeave=p(e,"mouseleave",t.onContainerMouseLeave),d.unbindDocumentMouseUp||(d.unbindDocumentMouseUp=p(i,"mouseup",t.onDocumentMouseUp)),d.hasTouch&&(p(e,"touchstart",function(e){t.onContainerTouchStart(e)}),p(e,"touchmove",function(e){t.onContainerTouchMove(e)}),d.unbindDocumentTouchEnd||(d.unbindDocumentTouchEnd=p(i,"touchend",t.onDocumentTouchEnd)))},destroy:function(){var t=this;t.unDocMouseMove&&t.unDocMouseMove(),this.unbindContainerMouseLeave(),d.chartCount||(d.unbindDocumentMouseUp&&(d.unbindDocumentMouseUp=d.unbindDocumentMouseUp()),d.unbindDocumentTouchEnd&&(d.unbindDocumentTouchEnd=d.unbindDocumentTouchEnd())),clearInterval(t.tooltipTimeout),a(t,function(e,i){t[i]=null})}}}),i(e,"parts/TouchPointer.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.extend,s=e.pick,o=t.charts,n=t.noop,r=t.Pointer;i(r.prototype,{pinchTranslate:function(t,e,i,s,o,n){this.zoomHor&&this.pinchTranslateDirection(!0,t,e,i,s,o,n),this.zoomVert&&this.pinchTranslateDirection(!1,t,e,i,s,o,n)},pinchTranslateDirection:function(t,e,i,s,o,n,r,a){var h,l,c,d,p,u,f=this.chart,g=t?"x":"y",m=t?"X":"Y",x="chart"+m,v=t?"width":"height",y=f["plot"+(t?"Left":"Top")],b=a||1,M=f.inverted,k=f.bounds[t?"h":"v"],w=1===e.length,S=e[0][x],A=i[0][x],T=!w&&e[1][x],P=!w&&i[1][x],L=function(){!w&&Math.abs(S-T)>20&&(b=a||Math.abs(A-P)/Math.abs(S-T)),c=(y-A)/b+S,h=f["plot"+(t?"Width":"Height")]/b};L(),(l=c)<k.min?(l=k.min,d=!0):l+h>k.max&&(l=k.max-h,d=!0),d?(A-=.8*(A-r[g][0]),w||(P-=.8*(P-r[g][1])),L()):r[g]=[A,P],M||(n[g]=c-y,n[v]=h),u=M?t?"scaleY":"scaleX":"scale"+m,p=M?1/b:b,o[v]=h,o[g]=l,s[u]=b,s["translate"+m]=p*y+(A-p*S)},pinch:function(t){var e=this,o=e.chart,r=e.pinchDown,a=t.touches,h=a.length,l=e.lastValidTouch,c=e.hasZoom,d=e.selectionMarker,p={},u=1===h&&(e.inClass(t.target,"highcharts-tracker")&&o.runTrackerClick||e.runChartClick),f={};h>1&&(e.initiated=!0),c&&e.initiated&&!u&&t.preventDefault(),[].map.call(a,function(t){return e.normalize(t)}),"touchstart"===t.type?([].forEach.call(a,function(t,e){r[e]={chartX:t.chartX,chartY:t.chartY}}),l.x=[r[0].chartX,r[1]&&r[1].chartX],l.y=[r[0].chartY,r[1]&&r[1].chartY],o.axes.forEach(function(t){if(t.zoomEnabled){var e=o.bounds[t.horiz?"h":"v"],i=t.minPixelPadding,n=t.toPixels(Math.min(s(t.options.min,t.dataMin),t.dataMin)),r=t.toPixels(Math.max(s(t.options.max,t.dataMax),t.dataMax)),a=Math.min(n,r),h=Math.max(n,r);e.min=Math.min(t.pos,a-i),e.max=Math.max(t.pos+t.len,h+i)}}),e.res=!0):e.followTouchMove&&1===h?this.runPointActions(e.normalize(t)):r.length&&(d||(e.selectionMarker=d=i({destroy:n,touch:!0},o.plotBox)),e.pinchTranslate(r,a,p,d,f,l),e.hasPinched=c,e.scaleGroups(p,f),e.res&&(e.res=!1,this.reset(!1,0)))},touch:function(e,i){var o,n,r=this.chart;r.index!==t.hoverChartIndex&&this.onContainerMouseLeave({relatedTarget:!0}),t.hoverChartIndex=r.index,1===e.touches.length?(e=this.normalize(e),r.isInsidePlot(e.chartX-r.plotLeft,e.chartY-r.plotTop)&&!r.openMenu?(i&&this.runPointActions(e),"touchmove"===e.type&&(o=!!(n=this.pinchDown)[0]&&Math.sqrt(Math.pow(n[0].chartX-e.chartX,2)+Math.pow(n[0].chartY-e.chartY,2))>=4),s(o,!0)&&this.pinch(e)):i&&this.reset()):2===e.touches.length&&this.pinch(e)},onContainerTouchStart:function(t){this.zoomOption(t),this.touch(t,!0)},onContainerTouchMove:function(t){this.touch(t)},onDocumentTouchEnd:function(e){o[t.hoverChartIndex]&&o[t.hoverChartIndex].pointer.drop(e)}})}),i(e,"parts/MSPointer.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.extend,s=e.objectEach,o=e.wrap,n=t.addEvent,r=t.charts,a=t.css,h=t.doc,l=t.hasTouch,c=t.noop,d=t.Pointer,p=t.removeEvent,u=t.win;if(!l&&(u.PointerEvent||u.MSPointerEvent)){var f={},g=!!u.PointerEvent,m=function(e,i,o,n){var a;"touch"!==e.pointerType&&e.pointerType!==e.MSPOINTER_TYPE_TOUCH||!r[t.hoverChartIndex]||(n(e),r[t.hoverChartIndex].pointer[i]({type:o,target:e.currentTarget,preventDefault:c,touches:(a=[],a.item=function(t){return this[t]},s(f,function(t){a.push({pageX:t.pageX,pageY:t.pageY,target:t.target})}),a)}))};i(d.prototype,{onContainerPointerDown:function(t){m(t,"onContainerTouchStart","touchstart",function(t){f[t.pointerId]={pageX:t.pageX,pageY:t.pageY,target:t.currentTarget}})},onContainerPointerMove:function(t){m(t,"onContainerTouchMove","touchmove",function(t){f[t.pointerId]={pageX:t.pageX,pageY:t.pageY},f[t.pointerId].target||(f[t.pointerId].target=t.currentTarget)})},onDocumentPointerUp:function(t){m(t,"onDocumentTouchEnd","touchend",function(t){delete f[t.pointerId]})},batchMSEvents:function(t){t(this.chart.container,g?"pointerdown":"MSPointerDown",this.onContainerPointerDown),t(this.chart.container,g?"pointermove":"MSPointerMove",this.onContainerPointerMove),t(h,g?"pointerup":"MSPointerUp",this.onDocumentPointerUp)}}),o(d.prototype,"init",function(t,e,i){t.call(this,e,i),this.hasZoom&&a(e.container,{"-ms-touch-action":"none","touch-action":"none"})}),o(d.prototype,"setDOMEvents",function(t){t.apply(this),(this.hasZoom||this.followTouchMove)&&this.batchMSEvents(n)}),o(d.prototype,"destroy",function(t){this.batchMSEvents(p),t.call(this)})}}),i(e,"parts/Legend.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.defined,s=e.discardElement,o=e.isNumber,n=e.pick,r=e.relativeLength,a=e.setAnimation,h=e.syncTimeout,l=e.wrap,c=t,d=c.addEvent,p=c.css,u=c.fireEvent,f=c.isFirefox,g=c.marginNames,m=c.merge,x=c.stableSort,v=c.win;t.Legend=function(t,e){this.init(t,e)},t.Legend.prototype={init:function(t,e){this.chart=t,this.setOptions(e),e.enabled&&(this.render(),d(this.chart,"endResize",function(){this.legend.positionCheckboxes()}),this.proximate?this.unchartrender=d(this.chart,"render",function(){this.legend.proximatePositions(),this.legend.positionItems()}):this.unchartrender&&this.unchartrender())},setOptions:function(t){var e=n(t.padding,8);this.options=t,this.chart.styledMode||(this.itemStyle=t.itemStyle,this.itemHiddenStyle=m(this.itemStyle,t.itemHiddenStyle)),this.itemMarginTop=t.itemMarginTop||0,this.itemMarginBottom=t.itemMarginBottom||0,this.padding=e,this.initialItemY=e-5,this.symbolWidth=n(t.symbolWidth,16),this.pages=[],this.proximate="proximate"===t.layout&&!this.chart.inverted},update:function(t,e){var i=this.chart;this.setOptions(m(!0,this.options,t)),this.destroy(),i.isDirtyLegend=i.isDirtyBox=!0,n(e,!0)&&i.redraw(),u(this,"afterUpdate")},colorizeItem:function(t,e){if(t.legendGroup[e?"removeClass":"addClass"]("highcharts-legend-item-hidden"),!this.chart.styledMode){var i=this.options,s=t.legendItem,o=t.legendLine,n=t.legendSymbol,r=this.itemHiddenStyle.color,a=e?i.itemStyle.color:r,h=e&&t.color||r,l=t.options&&t.options.marker,c={fill:h};s&&s.css({fill:a,color:a}),o&&o.attr({stroke:h}),n&&(l&&n.isMarker&&(c=t.pointAttribs(),e||(c.stroke=c.fill=r)),n.attr(c))}u(this,"afterColorizeItem",{item:t,visible:e})},positionItems:function(){this.allItems.forEach(this.positionItem,this),this.chart.isResizing||this.positionCheckboxes()},positionItem:function(t){var e=this.options,s=e.symbolPadding,o=!e.rtl,n=t._legendItemPos,r=n[0],a=n[1],h=t.checkbox,l=t.legendGroup;l&&l.element&&l[i(l.translateY)?"animate":"attr"]({translateX:o?r:this.legendWidth-r-2*s-4,translateY:a}),h&&(h.x=r,h.y=a)},destroyItem:function(t){var e=t.checkbox;["legendItem","legendLine","legendSymbol","legendGroup"].forEach(function(e){t[e]&&(t[e]=t[e].destroy())}),e&&s(t.checkbox)},destroy:function(){function t(t){this[t]&&(this[t]=this[t].destroy())}this.getAllItems().forEach(function(e){["legendItem","legendGroup"].forEach(t,e)}),["clipRect","up","down","pager","nav","box","title","group"].forEach(t,this),this.display=null},positionCheckboxes:function(){var t,e=this.group&&this.group.alignAttr,i=this.clipHeight||this.legendHeight,s=this.titleHeight;e&&(t=e.translateY,this.allItems.forEach(function(o){var n,r=o.checkbox;r&&(n=t+s+r.y+(this.scrollOffset||0)+3,p(r,{left:e.translateX+o.checkboxOffset+r.x-20+"px",top:n+"px",display:this.proximate||n>t-6&&n<t+i-6?"":"none"}))},this))},renderTitle:function(){var t,e=this.options,i=this.padding,s=e.title,o=0;s.text&&(this.title||(this.title=this.chart.renderer.label(s.text,i-3,i-4,null,null,null,e.useHTML,null,"legend-title").attr({zIndex:1}),this.chart.styledMode||this.title.css(s.style),this.title.add(this.group)),s.width||this.title.css({width:this.maxLegendWidth+"px"}),o=(t=this.title.getBBox()).height,this.offsetWidth=t.width,this.contentGroup.attr({translateY:o})),this.titleHeight=o},setText:function(t){var e=this.options;t.legendItem.attr({text:e.labelFormat?c.format(e.labelFormat,t,this.chart):e.labelFormatter.call(t)})},renderItem:function(t){var e,i=this.chart,s=i.renderer,o=this.options,r="horizontal"===o.layout,a=this.symbolWidth,h=o.symbolPadding,l=this.itemStyle,c=this.itemHiddenStyle,d=r?n(o.itemDistance,20):0,p=!o.rtl,u=t.legendItem,f=!t.series,g=!f&&t.series.drawLegendSymbol?t.series:t,x=g.options,v=this.createCheckboxForItem&&x&&x.showCheckbox,y=a+h+d+(v?20:0),b=o.useHTML,M=t.options.className;u||(t.legendGroup=s.g("legend-item").addClass("highcharts-"+g.type+"-series highcharts-color-"+t.colorIndex+(M?" "+M:"")+(f?" highcharts-series-"+t.index:"")).attr({zIndex:1}).add(this.scrollGroup),t.legendItem=u=s.text("",p?a+h:-h,this.baseline||0,b),i.styledMode||u.css(m(t.visible?l:c)),u.attr({align:p?"left":"right",zIndex:2}).add(t.legendGroup),this.baseline||(this.fontMetrics=s.fontMetrics(i.styledMode?12:l.fontSize,u),this.baseline=this.fontMetrics.f+3+this.itemMarginTop,u.attr("y",this.baseline)),this.symbolHeight=o.symbolHeight||this.fontMetrics.f,g.drawLegendSymbol(this,t),this.setItemEvents&&this.setItemEvents(t,u,b)),v&&!t.checkbox&&this.createCheckboxForItem(t),this.colorizeItem(t,t.visible),!i.styledMode&&l.width||u.css({width:(o.itemWidth||this.widthOption||i.spacingBox.width)-y}),this.setText(t),e=u.getBBox(),t.itemWidth=t.checkboxOffset=o.itemWidth||t.legendItemWidth||e.width+y,this.maxItemWidth=Math.max(this.maxItemWidth,t.itemWidth),this.totalItemWidth+=t.itemWidth,this.itemHeight=t.itemHeight=Math.round(t.legendItemHeight||e.height||this.symbolHeight)},layoutItem:function(t){var e=this.options,i=this.padding,s="horizontal"===e.layout,o=t.itemHeight,r=this.itemMarginBottom,a=this.itemMarginTop,h=s?n(e.itemDistance,20):0,l=this.maxLegendWidth,c=e.alignColumns&&this.totalItemWidth>l?this.maxItemWidth:t.itemWidth;s&&this.itemX-i+c>l&&(this.itemX=i,this.lastLineHeight&&(this.itemY+=a+this.lastLineHeight+r),this.lastLineHeight=0),this.lastItemY=a+this.itemY+r,this.lastLineHeight=Math.max(o,this.lastLineHeight),t._legendItemPos=[this.itemX,this.itemY],s?this.itemX+=c:(this.itemY+=a+o+r,this.lastLineHeight=o),this.offsetWidth=this.widthOption||Math.max((s?this.itemX-i-(t.checkbox?0:h):c)+i,this.offsetWidth)},getAllItems:function(){var t=[];return this.chart.series.forEach(function(e){var s=e&&e.options;e&&n(s.showInLegend,!i(s.linkedTo)&&void 0,!0)&&(t=t.concat(e.legendItems||("point"===s.legendType?e.data:e)))}),u(this,"afterGetAllItems",{allItems:t}),t},getAlignment:function(){var t=this.options;return this.proximate?t.align.charAt(0)+"tv":t.floating?"":t.align.charAt(0)+t.verticalAlign.charAt(0)+t.layout.charAt(0)},adjustMargins:function(t,e){var s=this.chart,o=this.options,r=this.getAlignment();r&&[/(lth|ct|rth)/,/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/].forEach(function(a,h){a.test(r)&&!i(t[h])&&(s[g[h]]=Math.max(s[g[h]],s.legend[(h+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][h]*o[h%2?"x":"y"]+n(o.margin,12)+e[h]+(s.titleOffset[h]||0)))})},proximatePositions:function(){var t=this.chart,e=[],i="left"===this.options.align;this.allItems.forEach(function(s){var n,r,a,h,l=i;s.yAxis&&s.points&&(s.xAxis.options.reversed&&(l=!l),n=c.find(l?s.points:s.points.slice(0).reverse(),function(t){return o(t.plotY)}),r=this.itemMarginTop+s.legendItem.getBBox().height+this.itemMarginBottom,h=s.yAxis.top-t.plotTop,s.visible?(a=n?n.plotY:s.yAxis.height,a+=h-.3*r):a=h+s.yAxis.height,e.push({target:a,size:r,item:s}))},this),c.distribute(e,t.plotHeight),e.forEach(function(e){e.item._legendItemPos[1]=t.plotTop-t.spacing[0]+e.pos})},render:function(){var t,e,i,s,o,n=this.chart,a=n.renderer,h=this.group,l=this.box,c=this.options,d=this.padding;if(this.itemX=d,this.itemY=this.initialItemY,this.offsetWidth=0,this.lastItemY=0,this.widthOption=r(c.width,n.spacingBox.width-d),o=n.spacingBox.width-2*d-c.x,["rm","lm"].indexOf(this.getAlignment().substring(0,2))>-1&&(o/=2),this.maxLegendWidth=this.widthOption||o,h||(this.group=h=a.g("legend").attr({zIndex:7}).add(),this.contentGroup=a.g().attr({zIndex:1}).add(h),this.scrollGroup=a.g().add(this.contentGroup)),this.renderTitle(),t=this.getAllItems(),x(t,function(t,e){return(t.options&&t.options.legendIndex||0)-(e.options&&e.options.legendIndex||0)}),c.reversed&&t.reverse(),this.allItems=t,this.display=e=!!t.length,this.lastLineHeight=0,this.maxItemWidth=0,this.totalItemWidth=0,this.itemHeight=0,t.forEach(this.renderItem,this),t.forEach(this.layoutItem,this),i=(this.widthOption||this.offsetWidth)+d,s=this.lastItemY+this.lastLineHeight+this.titleHeight,s=this.handleOverflow(s),s+=d,l||(this.box=l=a.rect().addClass("highcharts-legend-box").attr({r:c.borderRadius}).add(h),l.isNew=!0),n.styledMode||l.attr({stroke:c.borderColor,"stroke-width":c.borderWidth||0,fill:c.backgroundColor||"none"}).shadow(c.shadow),i>0&&s>0&&(l[l.isNew?"attr":"animate"](l.crisp.call({},{x:0,y:0,width:i,height:s},l.strokeWidth())),l.isNew=!1),l[e?"show":"hide"](),n.styledMode&&"none"===h.getStyle("display")&&(i=s=0),this.legendWidth=i,this.legendHeight=s,e){var p=n.spacingBox,f=p.y;/(lth|ct|rth)/.test(this.getAlignment())&&n.titleOffset[0]>0?f+=n.titleOffset[0]:/(lbh|cb|rbh)/.test(this.getAlignment())&&n.titleOffset[2]>0&&(f-=n.titleOffset[2]),f!==p.y&&(p=m(p,{y:f})),h.align(m(c,{width:i,height:s,verticalAlign:this.proximate?"top":c.verticalAlign}),!0,p)}this.proximate||this.positionItems(),u(this,"afterRender")},handleOverflow:function(t){var e,i,s=this,o=this.chart,r=o.renderer,a=this.options,h=a.y,l="top"===a.verticalAlign,c=this.padding,d=o.spacingBox.height+(l?-h:h)-c,p=a.maxHeight,u=this.clipRect,f=a.navigation,g=n(f.animation,!0),m=f.arrowSize||12,x=this.nav,v=this.pages,y=this.allItems,b=function(t){"number"==typeof t?u.attr({height:t}):u&&(s.clipRect=u.destroy(),s.contentGroup.clip()),s.contentGroup.div&&(s.contentGroup.div.style.clip=t?"rect("+c+"px,9999px,"+(c+t)+"px,0)":"auto")},M=function(t){return s[t]=r.circle(0,0,1.3*m).translate(m/2,m/2).add(x),o.styledMode||s[t].attr("fill","rgba(0,0,0,0.0001)"),s[t]};return"horizontal"!==a.layout||"middle"===a.verticalAlign||a.floating||(d/=2),p&&(d=Math.min(d,p)),v.length=0,t>d&&!1!==f.enabled?(this.clipHeight=e=Math.max(d-20-this.titleHeight-c,0),this.currentPage=n(this.currentPage,1),this.fullHeight=t,y.forEach(function(t,s){var o=t._legendItemPos[1],n=Math.round(t.legendItem.getBBox().height),r=v.length;(!r||o-v[r-1]>e&&(i||o)!==v[r-1])&&(v.push(i||o),r++),t.pageIx=r-1,i&&(y[s-1].pageIx=r-1),s===y.length-1&&o+n-v[r-1]>e&&o!==i&&(v.push(o),t.pageIx=r),o!==i&&(i=o)}),u||(u=s.clipRect=r.clipRect(0,c,9999,0),s.contentGroup.clip(u)),b(e),x||(this.nav=x=r.g().attr({zIndex:1}).add(this.group),this.up=r.symbol("triangle",0,0,m,m).add(x),M("upTracker").on("click",function(){s.scroll(-1,g)}),this.pager=r.text("",15,10).addClass("highcharts-legend-navigation"),o.styledMode||this.pager.css(f.style),this.pager.add(x),this.down=r.symbol("triangle-down",0,0,m,m).add(x),M("downTracker").on("click",function(){s.scroll(1,g)})),s.scroll(0),t=d):x&&(b(),this.nav=x.destroy(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0),t},scroll:function(t,e){var i=this,s=this.chart,o=this.pages,r=o.length,l=this.currentPage+t,d=this.clipHeight,p=this.options.navigation,f=this.pager,g=this.padding;if(l>r&&(l=r),l>0){void 0!==e&&a(e,s),this.nav.attr({translateX:g,translateY:d+this.padding+7+this.titleHeight,visibility:"visible"}),[this.up,this.upTracker].forEach(function(t){t.attr({class:1===l?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})}),f.attr({text:l+"/"+r}),[this.down,this.downTracker].forEach(function(t){t.attr({x:18+this.pager.getBBox().width,class:l===r?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})},this),s.styledMode||(this.up.attr({fill:1===l?p.inactiveColor:p.activeColor}),this.upTracker.css({cursor:1===l?"default":"pointer"}),this.down.attr({fill:l===r?p.inactiveColor:p.activeColor}),this.downTracker.css({cursor:l===r?"default":"pointer"})),this.scrollOffset=-o[l-1]+this.initialItemY,this.scrollGroup.animate({translateY:this.scrollOffset}),this.currentPage=l,this.positionCheckboxes();var m=c.animObject(n(e,s.renderer.globalAnimation,!0));h(function(){u(i,"afterScroll",{currentPage:l})},m.duration||0)}}},c.LegendSymbolMixin={drawRectangle:function(t,e){var i=t.options,s=t.symbolHeight,o=i.squareSymbol,r=o?s:t.symbolWidth;e.legendSymbol=this.chart.renderer.rect(o?(t.symbolWidth-s)/2:0,t.baseline-s+1,r,s,n(t.options.symbolRadius,s/2)).addClass("highcharts-point").attr({zIndex:3}).add(e.legendGroup)},drawLineMarker:function(t){var e,i,s=this.options,o=s.marker,r=t.symbolWidth,a=t.symbolHeight,h=a/2,l=this.chart.renderer,c=this.legendGroup,d=t.baseline-Math.round(.3*t.fontMetrics.b),p={};this.chart.styledMode||(p={"stroke-width":s.lineWidth||0},s.dashStyle&&(p.dashstyle=s.dashStyle)),this.legendLine=l.path(["M",0,d,"L",r,d]).addClass("highcharts-graph").attr(p).add(c),o&&!1!==o.enabled&&r&&(e=Math.min(n(o.radius,h),h),0===this.symbol.indexOf("url")&&(o=m(o,{width:a,height:a}),e=0),this.legendSymbol=i=l.symbol(this.symbol,r/2-e,d-e,2*e,2*e,o).addClass("highcharts-point").add(c),i.isMarker=!0)}},(/Trident\/7\.0/.test(v.navigator&&v.navigator.userAgent)||f)&&l(t.Legend.prototype,"positionItem",function(t,e){var i=this,s=function(){e._legendItemPos&&t.call(i,e)};s(),i.bubbleLegend||setTimeout(s)})}),i(e,"parts/Chart.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.animObject,s=e.attr,o=e.defined,n=e.discardElement,r=e.erase,a=e.extend,h=e.isArray,l=e.isNumber,c=e.isObject,d=e.isString,p=e.numberFormat,u=e.objectEach,f=e.pick,g=e.pInt,m=e.relativeLength,x=e.setAnimation,v=e.splat,y=e.syncTimeout,b=t.addEvent,M=t.animate,k=t.doc,w=t.Axis,S=t.createElement,A=t.defaultOptions,T=t.charts,P=t.css,L=t.find,C=t.fireEvent,E=t.Legend,O=t.marginNames,D=t.merge,B=t.Pointer,I=t.removeEvent,z=t.seriesTypes,R=t.win,W=t.Chart=function(){this.getArgs.apply(this,arguments)};t.chart=function(t,e,i){return new W(t,e,i)},a(W.prototype,{callbacks:[],getArgs:function(){var t=[].slice.call(arguments);(d(t[0])||t[0].nodeName)&&(this.renderTo=t.shift()),this.init(t[0],t[1])},init:function(e,i){var s,o=e.series,n=e.plotOptions||{};C(this,"init",{args:arguments},function(){e.series=null,s=D(A,e),u(s.plotOptions,function(t,e){c(t)&&(t.tooltip=n[e]&&D(n[e].tooltip)||void 0)}),s.tooltip.userOptions=e.chart&&e.chart.forExport&&e.tooltip.userOptions||e.tooltip,s.series=e.series=o,this.userOptions=e;var r=s.chart,a=r.events;this.margin=[],this.spacing=[],this.bounds={h:{},v:{}},this.labelCollectors=[],this.callback=i,this.isResizing=0,this.options=s,this.axes=[],this.series=[],this.time=e.time&&Object.keys(e.time).length?new t.Time(e.time):t.time,this.numberFormatter=r.numberFormatter||p,this.styledMode=r.styledMode,this.hasCartesianSeries=r.showAxes;var h=this;h.index=T.length,T.push(h),t.chartCount++,a&&u(a,function(e,i){t.isFunction(e)&&b(h,i,e)}),h.xAxis=[],h.yAxis=[],h.pointCount=h.colorCounter=h.symbolCounter=0,C(h,"afterInit"),h.firstRender()})},initSeries:function(e){var i,s=this.options.chart,o=e.type||s.type||s.defaultSeriesType,n=z[o];return n||t.error(17,!0,this,{missingModuleFor:o}),(i=new n).init(this,e),i},setSeriesData:function(){this.getSeriesOrderByLinks().forEach(function(t){t.points||t.data||!t.enabledDataSorting||t.setData(t.options.data,!1)})},getSeriesOrderByLinks:function(){return this.series.concat().sort(function(t,e){return t.linkedSeries.length||e.linkedSeries.length?e.linkedSeries.length-t.linkedSeries.length:0})},orderSeries:function(t){for(var e=this.series,i=t||0;i<e.length;i++)e[i]&&(e[i].index=i,e[i].name=e[i].getName())},isInsidePlot:function(t,e,i){var s=i?e:t,o=i?t:e;return s>=0&&s<=this.plotWidth&&o>=0&&o<=this.plotHeight},redraw:function(t){C(this,"beforeRedraw");var e,i,s,o,n=this.axes,r=this.series,h=this.pointer,l=this.legend,c=this.userOptions.legend,d=this.isDirtyLegend,p=this.hasCartesianSeries,u=this.isDirtyBox,f=this.renderer,g=f.isHidden(),m=[];for(this.setResponsive&&this.setResponsive(!1),x(t,this),g&&this.temporaryDisplay(),this.layOutTitles(),s=r.length;s--;)if((o=r[s]).options.stacking&&(e=!0,o.isDirty)){i=!0;break}if(i)for(s=r.length;s--;)(o=r[s]).options.stacking&&(o.isDirty=!0);r.forEach(function(t){t.isDirty&&("point"===t.options.legendType?(t.updateTotals&&t.updateTotals(),d=!0):c&&(c.labelFormatter||c.labelFormat)&&(d=!0)),t.isDirtyData&&C(t,"updatedData")}),d&&l&&l.options.enabled&&(l.render(),this.isDirtyLegend=!1),e&&this.getStacks(),p&&n.forEach(function(t){t.updateNames(),t.setScale()}),this.getMargins(),p&&(n.forEach(function(t){t.isDirty&&(u=!0)}),n.forEach(function(t){var i=t.min+","+t.max;t.extKey!==i&&(t.extKey=i,m.push(function(){C(t,"afterSetExtremes",a(t.eventArgs,t.getExtremes())),delete t.eventArgs})),(u||e)&&t.redraw()})),u&&this.drawChartBox(),C(this,"predraw"),r.forEach(function(t){(u||t.isDirty)&&t.visible&&t.redraw(),t.isDirtyData=!1}),h&&h.reset(!0),f.draw(),C(this,"redraw"),C(this,"render"),g&&this.temporaryDisplay(!0),m.forEach(function(t){t.call()})},get:function(t){var e,i,s=this.series;function o(e){return e.id===t||e.options&&e.options.id===t}for(e=L(this.axes,o)||L(this.series,o),i=0;!e&&i<s.length;i++)e=L(s[i].points||[],o);return e},getAxes:function(){var t=this,e=this.options,i=e.xAxis=v(e.xAxis||{}),s=e.yAxis=v(e.yAxis||{});C(this,"getAxes"),i.forEach(function(t,e){t.index=e,t.isX=!0}),s.forEach(function(t,e){t.index=e}),i.concat(s).forEach(function(e){new w(t,e)}),C(this,"afterGetAxes")},getSelectedPoints:function(){var t=[];return this.series.forEach(function(e){t=t.concat((e[e.hasGroupedData?"points":"data"]||[]).filter(function(t){return f(t.selectedStaging,t.selected)}))}),t},getSelectedSeries:function(){return this.series.filter(function(t){return t.selected})},setTitle:function(t,e,i){this.applyDescription("title",t),this.applyDescription("subtitle",e),this.applyDescription("caption",void 0),this.layOutTitles(i)},applyDescription:function(t,e){var i=this,s="title"===t?{color:"#333333",fontSize:this.options.isStock?"16px":"18px"}:{color:"#666666"},o=this.options[t]=D(!this.styledMode&&{style:s},this.options[t],e),n=this[t];n&&e&&(this[t]=n=n.destroy()),o&&!n&&((n=this.renderer.text(o.text,0,0,o.useHTML).attr({align:o.align,class:"highcharts-"+t,zIndex:o.zIndex||4}).add()).update=function(e){i[{title:"setTitle",subtitle:"setSubtitle",caption:"setCaption"}[t]](e)},this.styledMode||n.css(o.style),this[t]=n)},layOutTitles:function(t){var e,i=[0,0,0],s=this.renderer,o=this.spacingBox;["title","subtitle","caption"].forEach(function(t){var e,n,r=this[t],h=this.options[t],l=h.verticalAlign||"top",c="title"===t?-3:"top"===l?i[0]+2:0;r&&(this.styledMode||(e=h.style.fontSize),e=s.fontMetrics(e,r).b,r.css({width:(h.width||o.width+(h.widthAdjust||0))+"px"}),n=Math.round(r.getBBox(h.useHTML).height),r.align(a({y:"bottom"===l?e:c+e,height:n},h),!1,"spacingBox"),h.floating||("top"===l?i[0]=Math.ceil(i[0]+n):"bottom"===l&&(i[2]=Math.ceil(i[2]+n))))},this),i[0]&&"top"===(this.options.title.verticalAlign||"top")&&(i[0]+=this.options.title.margin),i[2]&&"bottom"===this.options.caption.verticalAlign&&(i[2]+=this.options.caption.margin),e=!this.titleOffset||this.titleOffset.join(",")!==i.join(","),this.titleOffset=i,C(this,"afterLayOutTitles"),!this.isDirtyBox&&e&&(this.isDirtyBox=this.isDirtyLegend=e,this.hasRendered&&f(t,!0)&&this.isDirtyBox&&this.redraw())},getChartSize:function(){var e=this.options.chart,i=e.width,s=e.height,n=this.renderTo;o(i)||(this.containerWidth=t.getStyle(n,"width")),o(s)||(this.containerHeight=t.getStyle(n,"height")),this.chartWidth=Math.max(0,i||this.containerWidth||600),this.chartHeight=Math.max(0,m(s,this.chartWidth)||(this.containerHeight>1?this.containerHeight:400))},temporaryDisplay:function(e){var i,s=this.renderTo;if(e)for(;s&&s.style;)s.hcOrigStyle&&(t.css(s,s.hcOrigStyle),delete s.hcOrigStyle),s.hcOrigDetached&&(k.body.removeChild(s),s.hcOrigDetached=!1),s=s.parentNode;else for(;s&&s.style&&(k.body.contains(s)||s.parentNode||(s.hcOrigDetached=!0,k.body.appendChild(s)),("none"===t.getStyle(s,"display",!1)||s.hcOricDetached)&&(s.hcOrigStyle={display:s.style.display,height:s.style.height,overflow:s.style.overflow},i={display:"block",overflow:"hidden"},s!==this.renderTo&&(i.height=0),t.css(s,i),s.offsetWidth||s.style.setProperty("display","block","important")),(s=s.parentNode)!==k.body););},setClassName:function(t){this.container.className="highcharts-container "+(t||"")},getContainer:function(){var e,i,o,n,r,h,c,p=this.options,u=p.chart,f=this.renderTo,m=t.uniqueKey();if(f||(this.renderTo=f=u.renderTo),d(f)&&(this.renderTo=f=k.getElementById(f)),f||t.error(13,!0,this),n=g(s(f,"data-highcharts-chart")),l(n)&&T[n]&&T[n].hasRendered&&T[n].destroy(),s(f,"data-highcharts-chart",this.index),f.innerHTML="",u.skipClone||f.offsetWidth||this.temporaryDisplay(),this.getChartSize(),i=this.chartWidth,o=this.chartHeight,P(f,{overflow:"hidden"}),this.styledMode||(h=a({position:"relative",overflow:"hidden",width:i+"px",height:o+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)"},u.style)),e=S("div",{id:m},h,f),this.container=e,this._cursor=e.style.cursor,r=t[u.renderer]||t.Renderer,this.renderer=new r(e,i,o,null,u.forExport,p.exporting&&p.exporting.allowHTML,this.styledMode),this.setClassName(u.className),this.styledMode)for(c in p.defs)this.renderer.definition(p.defs[c]);else this.renderer.setStyle(u.style);this.renderer.chartIndex=this.index,C(this,"afterGetContainer")},getMargins:function(t){var e=this.spacing,i=this.margin,s=this.titleOffset;this.resetMargins(),s[0]&&!o(i[0])&&(this.plotTop=Math.max(this.plotTop,s[0]+e[0])),s[2]&&!o(i[2])&&(this.marginBottom=Math.max(this.marginBottom,s[2]+e[2])),this.legend&&this.legend.display&&this.legend.adjustMargins(i,e),C(this,"getMargins"),t||this.getAxisMargins()},getAxisMargins:function(){var t=this,e=t.axisOffset=[0,0,0,0],i=t.colorAxis,s=t.margin,n=function(t){t.forEach(function(t){t.visible&&t.getOffset()})};t.hasCartesianSeries?n(t.axes):i&&i.length&&n(i),O.forEach(function(i,n){o(s[n])||(t[i]+=e[n])}),t.setChartSize()},reflow:function(e){var i=this,s=i.options.chart,n=i.renderTo,r=o(s.width)&&o(s.height),a=s.width||t.getStyle(n,"width"),h=s.height||t.getStyle(n,"height"),l=e?e.target:R;r||i.isPrinting||!a||!h||l!==R&&l!==k||(a===i.containerWidth&&h===i.containerHeight||(t.clearTimeout(i.reflowTimeout),i.reflowTimeout=y(function(){i.container&&i.setSize(void 0,void 0,!1)},e?100:0)),i.containerWidth=a,i.containerHeight=h)},setReflow:function(t){var e=this;!1===t||this.unbindReflow?!1===t&&this.unbindReflow&&(this.unbindReflow=this.unbindReflow()):(this.unbindReflow=b(R,"resize",function(t){e.options&&e.reflow(t)}),b(this,"destroy",this.unbindReflow))},setSize:function(t,e,s){var o,n=this,r=n.renderer;n.isResizing+=1,x(s,n),n.oldChartHeight=n.chartHeight,n.oldChartWidth=n.chartWidth,void 0!==t&&(n.options.chart.width=t),void 0!==e&&(n.options.chart.height=e),n.getChartSize(),n.styledMode||((o=r.globalAnimation)?M:P)(n.container,{width:n.chartWidth+"px",height:n.chartHeight+"px"},o),n.setChartSize(!0),r.setSize(n.chartWidth,n.chartHeight,s),n.axes.forEach(function(t){t.isDirty=!0,t.setScale()}),n.isDirtyLegend=!0,n.isDirtyBox=!0,n.layOutTitles(),n.getMargins(),n.redraw(s),n.oldChartHeight=null,C(n,"resize"),y(function(){n&&C(n,"endResize",null,function(){n.isResizing-=1})},i(o).duration||0)},setChartSize:function(t){var e,i,s,o,n,r,a,h=this.inverted,l=this.renderer,c=this.chartWidth,d=this.chartHeight,p=this.options.chart,u=this.spacing,f=this.clipOffset;this.plotLeft=s=Math.round(this.plotLeft),this.plotTop=o=Math.round(this.plotTop),this.plotWidth=n=Math.max(0,Math.round(c-s-this.marginRight)),this.plotHeight=r=Math.max(0,Math.round(d-o-this.marginBottom)),this.plotSizeX=h?r:n,this.plotSizeY=h?n:r,this.plotBorderWidth=p.plotBorderWidth||0,this.spacingBox=l.spacingBox={x:u[3],y:u[0],width:c-u[3]-u[1],height:d-u[0]-u[2]},this.plotBox=l.plotBox={x:s,y:o,width:n,height:r},a=2*Math.floor(this.plotBorderWidth/2),e=Math.ceil(Math.max(a,f[3])/2),i=Math.ceil(Math.max(a,f[0])/2),this.clipBox={x:e,y:i,width:Math.floor(this.plotSizeX-Math.max(a,f[1])/2-e),height:Math.max(0,Math.floor(this.plotSizeY-Math.max(a,f[2])/2-i))},t||this.axes.forEach(function(t){t.setAxisSize(),t.setAxisTranslation()}),C(this,"afterSetChartSize",{skipAxes:t})},resetMargins:function(){C(this,"resetMargins");var t=this,e=t.options.chart;["margin","spacing"].forEach(function(i){var s=e[i],o=c(s)?s:[s,s,s,s];["Top","Right","Bottom","Left"].forEach(function(s,n){t[i][n]=f(e[i+s],o[n])})}),O.forEach(function(e,i){t[e]=f(t.margin[i],t.spacing[i])}),t.axisOffset=[0,0,0,0],t.clipOffset=[0,0,0,0]},drawChartBox:function(){var t,e,i,s=this.options.chart,o=this.renderer,n=this.chartWidth,r=this.chartHeight,a=this.chartBackground,h=this.plotBackground,l=this.plotBorder,c=this.styledMode,d=this.plotBGImage,p=s.backgroundColor,u=s.plotBackgroundColor,f=s.plotBackgroundImage,g=this.plotLeft,m=this.plotTop,x=this.plotWidth,v=this.plotHeight,y=this.plotBox,b=this.clipRect,M=this.clipBox,k="animate";a||(this.chartBackground=a=o.rect().addClass("highcharts-background").add(),k="attr"),c?t=e=a.strokeWidth():(e=(t=s.borderWidth||0)+(s.shadow?8:0),i={fill:p||"none"},(t||a["stroke-width"])&&(i.stroke=s.borderColor,i["stroke-width"]=t),a.attr(i).shadow(s.shadow)),a[k]({x:e/2,y:e/2,width:n-e-t%2,height:r-e-t%2,r:s.borderRadius}),k="animate",h||(k="attr",this.plotBackground=h=o.rect().addClass("highcharts-plot-background").add()),h[k](y),c||(h.attr({fill:u||"none"}).shadow(s.plotShadow),f&&(d?(f!==d.attr("href")&&d.attr("href",f),d.animate(y)):this.plotBGImage=o.image(f,g,m,x,v).add())),b?b.animate({width:M.width,height:M.height}):this.clipRect=o.clipRect(M),k="animate",l||(k="attr",this.plotBorder=l=o.rect().addClass("highcharts-plot-border").attr({zIndex:1}).add()),c||l.attr({stroke:s.plotBorderColor,"stroke-width":s.plotBorderWidth||0,fill:"none"}),l[k](l.crisp({x:g,y:m,width:x,height:v},-l.strokeWidth())),this.isDirtyBox=!1,C(this,"afterDrawChartBox")},propFromSeries:function(){var t,e,i,s=this,o=s.options.chart,n=s.options.series;["inverted","angular","polar"].forEach(function(r){for(t=z[o.type||o.defaultSeriesType],i=o[r]||t&&t.prototype[r],e=n&&n.length;!i&&e--;)(t=z[n[e].type])&&t.prototype[r]&&(i=!0);s[r]=i})},linkSeries:function(){var t=this,e=t.series;e.forEach(function(t){t.linkedSeries.length=0}),e.forEach(function(e){var i=e.options.linkedTo;d(i)&&(i=":previous"===i?t.series[e.index-1]:t.get(i))&&i.linkedParent!==e&&(i.linkedSeries.push(e),e.linkedParent=i,i.enabledDataSorting&&e.setDataSortingOptions(),e.visible=f(e.options.visible,i.options.visible,e.visible))}),C(this,"afterLinkSeries")},renderSeries:function(){this.series.forEach(function(t){t.translate(),t.render()})},renderLabels:function(){var t=this,e=t.options.labels;e.items&&e.items.forEach(function(i){var s=a(e.style,i.style),o=g(s.left)+t.plotLeft,n=g(s.top)+t.plotTop+12;delete s.left,delete s.top,t.renderer.text(i.html,o,n).attr({zIndex:2}).css(s).add()})},render:function(){var t,e,i,s,o=this.axes,n=this.colorAxis,r=this.renderer,a=this.options,h=0,l=function(t){t.forEach(function(t){t.visible&&t.render()})};this.setTitle(),this.legend=new E(this,a.legend),this.getStacks&&this.getStacks(),this.getMargins(!0),this.setChartSize(),t=this.plotWidth,o.some(function(t){if(t.horiz&&t.visible&&t.options.labels.enabled&&t.series.length)return h=21,!0}),this.plotHeight=Math.max(this.plotHeight-h,0),e=this.plotHeight,o.forEach(function(t){t.setScale()}),this.getAxisMargins(),i=t/this.plotWidth>1.1,s=e/this.plotHeight>1.05,(i||s)&&(o.forEach(function(t){(t.horiz&&i||!t.horiz&&s)&&t.setTickInterval(!0)}),this.getMargins()),this.drawChartBox(),this.hasCartesianSeries?l(o):n&&n.length&&l(n),this.seriesGroup||(this.seriesGroup=r.g("series-group").attr({zIndex:3}).add()),this.renderSeries(),this.renderLabels(),this.addCredits(),this.setResponsive&&this.setResponsive(),this.updateContainerScaling(),this.hasRendered=!0},addCredits:function(t){var e=this;(t=D(!0,this.options.credits,t)).enabled&&!this.credits&&(this.credits=this.renderer.text(t.text+(this.mapCredits||""),0,0).addClass("highcharts-credits").on("click",function(){t.href&&(R.location.href=t.href)}).attr({align:t.position.align,zIndex:8}),e.styledMode||this.credits.css(t.style),this.credits.add().align(t.position),this.credits.update=function(t){e.credits=e.credits.destroy(),e.addCredits(t)})},updateContainerScaling:function(){var t=this.container;if(t.offsetWidth&&t.offsetHeight&&t.getBoundingClientRect){var e=t.getBoundingClientRect(),i=e.width/t.offsetWidth,s=e.height/t.offsetHeight;1!==i||1!==s?this.containerScaling={scaleX:i,scaleY:s}:delete this.containerScaling}},destroy:function(){var e,i=this,s=i.axes,o=i.series,a=i.container,h=a&&a.parentNode;for(C(i,"destroy"),i.renderer.forExport?r(T,i):T[i.index]=void 0,t.chartCount--,i.renderTo.removeAttribute("data-highcharts-chart"),I(i),e=s.length;e--;)s[e]=s[e].destroy();for(this.scroller&&this.scroller.destroy&&this.scroller.destroy(),e=o.length;e--;)o[e]=o[e].destroy();["title","subtitle","chartBackground","plotBackground","plotBGImage","plotBorder","seriesGroup","clipRect","credits","pointer","rangeSelector","legend","resetZoomButton","tooltip","renderer"].forEach(function(t){var e=i[t];e&&e.destroy&&(i[t]=e.destroy())}),a&&(a.innerHTML="",I(a),h&&n(a)),u(i,function(t,e){delete i[e]})},firstRender:function(){var t=this,e=t.options;t.isReadyToRender&&!t.isReadyToRender()||(t.getContainer(),t.resetMargins(),t.setChartSize(),t.propFromSeries(),t.getAxes(),(h(e.series)?e.series:[]).forEach(function(e){t.initSeries(e)}),t.linkSeries(),t.setSeriesData(),C(t,"beforeRender"),B&&(t.pointer=new B(t,e)),t.render(),!t.renderer.imgCount&&t.onload&&t.onload(),t.temporaryDisplay(!0))},onload:function(){this.callbacks.concat([this.callback]).forEach(function(t){t&&void 0!==this.index&&t.apply(this,[this])},this),C(this,"load"),C(this,"render"),o(this.index)&&this.setReflow(this.options.chart.reflow),this.onload=null}})}),i(e,"parts/ScrollablePlotArea.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.pick,s=t.addEvent,o=t.Chart;s(o,"afterSetChartSize",function(e){var i,s,o,n=this.options.chart.scrollablePlotArea,r=n&&n.minWidth,a=n&&n.minHeight;this.renderer.forExport||(r?(this.scrollablePixelsX=i=Math.max(0,r-this.chartWidth),i&&(this.plotWidth+=i,this.inverted?(this.clipBox.height+=i,this.plotBox.height+=i):(this.clipBox.width+=i,this.plotBox.width+=i),o={1:{name:"right",value:i}})):a&&(this.scrollablePixelsY=s=Math.max(0,a-this.chartHeight),s&&(this.plotHeight+=s,this.inverted?(this.clipBox.width+=s,this.plotBox.width+=s):(this.clipBox.height+=s,this.plotBox.height+=s),o={2:{name:"bottom",value:s}})),o&&!e.skipAxes&&this.axes.forEach(function(e){o[e.side]?e.getPlotLinePath=function(){var i,s=o[e.side].name,n=o[e.side].value,r=this[s];return this[s]=r-n,i=t.Axis.prototype.getPlotLinePath.apply(this,arguments),this[s]=r,i}:(e.setAxisSize(),e.setAxisTranslation())}))}),s(o,"render",function(){this.scrollablePixelsX||this.scrollablePixelsY?(this.setUpScrolling&&this.setUpScrolling(),this.applyFixed()):this.fixedDiv&&this.applyFixed()}),o.prototype.setUpScrolling=function(){var e={WebkitOverflowScrolling:"touch",overflowX:"hidden",overflowY:"hidden"};this.scrollablePixelsX&&(e.overflowX="auto"),this.scrollablePixelsY&&(e.overflowY="auto"),this.scrollingContainer=t.createElement("div",{className:"highcharts-scrolling"},e,this.renderTo),this.innerContainer=t.createElement("div",{className:"highcharts-inner-container"},null,this.scrollingContainer),this.innerContainer.appendChild(this.container),this.setUpScrolling=null},o.prototype.moveFixedElements=function(){var t,e=this.container,i=this.fixedRenderer,s=[".highcharts-contextbutton",".highcharts-credits",".highcharts-legend",".highcharts-legend-checkbox",".highcharts-navigator-series",".highcharts-navigator-xaxis",".highcharts-navigator-yaxis",".highcharts-navigator",".highcharts-reset-zoom",".highcharts-scrollbar",".highcharts-subtitle",".highcharts-title"];this.scrollablePixelsX&&!this.inverted?t=".highcharts-yaxis":this.scrollablePixelsX&&this.inverted?t=".highcharts-xaxis":this.scrollablePixelsY&&!this.inverted?t=".highcharts-xaxis":this.scrollablePixelsY&&this.inverted&&(t=".highcharts-yaxis"),s.push(t,t+"-labels"),s.forEach(function(t){[].forEach.call(e.querySelectorAll(t),function(t){(t.namespaceURI===i.SVG_NS?i.box:i.box.parentNode).appendChild(t),t.style.pointerEvents="auto"})})},o.prototype.applyFixed=function(){var e,o,n,r=!this.fixedDiv,a=this.options.chart.scrollablePlotArea;r?(this.fixedDiv=t.createElement("div",{className:"highcharts-fixed"},{position:"absolute",overflow:"hidden",pointerEvents:"none",zIndex:2},null,!0),this.renderTo.insertBefore(this.fixedDiv,this.renderTo.firstChild),this.renderTo.style.overflow="visible",this.fixedRenderer=e=new t.Renderer(this.fixedDiv,this.chartWidth,this.chartHeight),this.scrollableMask=e.path().attr({fill:this.options.chart.backgroundColor||"#fff","fill-opacity":i(a.opacity,.85),zIndex:-1}).addClass("highcharts-scrollable-mask").add(),this.moveFixedElements(),s(this,"afterShowResetZoom",this.moveFixedElements),s(this,"afterLayOutTitles",this.moveFixedElements)):this.fixedRenderer.setSize(this.chartWidth,this.chartHeight),o=this.chartWidth+(this.scrollablePixelsX||0),n=this.chartHeight+(this.scrollablePixelsY||0),t.stop(this.container),this.container.style.width=o+"px",this.container.style.height=n+"px",this.renderer.boxWrapper.attr({width:o,height:n,viewBox:[0,0,o,n].join(" ")}),this.chartBackground.attr({width:o,height:n}),this.scrollablePixelsY&&(this.scrollingContainer.style.height=this.chartHeight+"px"),r&&(a.scrollPositionX&&(this.scrollingContainer.scrollLeft=this.scrollablePixelsX*a.scrollPositionX),a.scrollPositionY&&(this.scrollingContainer.scrollTop=this.scrollablePixelsY*a.scrollPositionY));var h,l=this.axisOffset,c=this.plotTop-l[0]-1,d=this.plotLeft-l[3]-1,p=this.plotTop+this.plotHeight+l[2]+1,u=this.plotLeft+this.plotWidth+l[1]+1,f=this.plotLeft+this.plotWidth-(this.scrollablePixelsX||0),g=this.plotTop+this.plotHeight-(this.scrollablePixelsY||0);h=this.scrollablePixelsX?["M",0,c,"L",this.plotLeft-1,c,"L",this.plotLeft-1,p,"L",0,p,"Z","M",f,c,"L",this.chartWidth,c,"L",this.chartWidth,p,"L",f,p,"Z"]:this.scrollablePixelsY?["M",d,0,"L",d,this.plotTop-1,"L",u,this.plotTop-1,"L",u,0,"Z","M",d,g,"L",d,this.chartHeight,"L",u,this.chartHeight,"L",u,g,"Z"]:["M",0,0],"adjustHeight"!==this.redrawTrigger&&this.scrollableMask.attr({d:h})}}),i(e,"parts/Point.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i,s=e.animObject,o=e.defined,n=e.erase,r=e.extend,a=e.isArray,h=e.isNumber,l=e.isObject,c=e.syncTimeout,d=e.pick,p=t,u=p.fireEvent,f=p.format,g=p.uniqueKey,m=p.removeEvent;t.Point=i=function(){},t.Point.prototype={init:function(t,e,i){return this.series=t,this.applyOptions(e,i),this.id=o(this.id)?this.id:g(),this.resolveColor(),t.chart.pointCount++,u(this,"afterInit"),this},resolveColor:function(){var t,e,i=this.series,s=i.chart.options.chart.colorCount,o=i.chart.styledMode;o||this.options.color||(this.color=i.color),i.options.colorByPoint?(o||(t=i.options.colors||i.chart.options.colors,this.color=this.color||t[i.colorCounter],s=t.length),e=i.colorCounter,i.colorCounter++,i.colorCounter===s&&(i.colorCounter=0)):e=i.colorIndex,this.colorIndex=d(this.colorIndex,e)},applyOptions:function(t,e){var s=this.series,o=s.options.pointValKey||s.pointValKey;return t=i.prototype.optionsToObject.call(this,t),r(this,t),this.options=this.options?r(this.options,t):t,t.group&&delete this.group,t.dataLabels&&delete this.dataLabels,o&&(this.y=this[o]),this.isNull=d(this.isValid&&!this.isValid(),null===this.x||!h(this.y)),this.formatPrefix=this.isNull?"null":"point",this.selected&&(this.state="select"),"name"in this&&void 0===e&&s.xAxis&&s.xAxis.hasNames&&(this.x=s.xAxis.nameToX(this)),void 0===this.x&&s&&(this.x=void 0===e?s.autoIncrement(this):e),this},setNestedProperty:function(t,e,i){return i.split(".").reduce(function(t,i,s,o){var n=o.length-1===s;return t[i]=n?e:l(t[i],!0)?t[i]:{},t[i]},t),t},optionsToObject:function(t){var e,i={},s=this.series,o=s.options.keys,n=o||s.pointArrayMap||["y"],r=n.length,l=0,c=0;if(h(t)||null===t)i[n[0]]=t;else if(a(t))for(!o&&t.length>r&&("string"===(e=typeof t[0])?i.name=t[0]:"number"===e&&(i.x=t[0]),l++);c<r;)o&&void 0===t[l]||(n[c].indexOf(".")>0?p.Point.prototype.setNestedProperty(i,t[l],n[c]):i[n[c]]=t[l]),l++,c++;else"object"==typeof t&&(i=t,t.dataLabels&&(s._hasPointLabels=!0),t.marker&&(s._hasPointMarkers=!0));return i},getClassName:function(){return"highcharts-point"+(this.selected?" highcharts-point-select":"")+(this.negative?" highcharts-negative":"")+(this.isNull?" highcharts-null-point":"")+(void 0!==this.colorIndex?" highcharts-color-"+this.colorIndex:"")+(this.options.className?" "+this.options.className:"")+(this.zone&&this.zone.className?" "+this.zone.className.replace("highcharts-negative",""):"")},getZone:function(){var t,e=this.series,i=e.zones,s=e.zoneAxis||"y",o=0;for(t=i[o];this[s]>=t.value;)t=i[++o];return this.nonZonedColor||(this.nonZonedColor=this.color),t&&t.color&&!this.options.color?this.color=t.color:this.color=this.nonZonedColor,t},hasNewShapeType:function(){return(this.graphic&&(this.graphic.symbolName||this.graphic.element.nodeName))!==this.shapeType},destroy:function(){var t,e=this,i=e.series,o=i.chart,r=i.options.dataSorting,a=o.hoverPoints,h=e.series.chart.renderer.globalAnimation,l=s(h);function d(){for(t in a&&(e.setState(),n(a,e),a.length||(o.hoverPoints=null)),e===o.hoverPoint&&e.onMouseOut(),(e.graphic||e.dataLabel||e.dataLabels)&&(m(e),e.destroyElements()),e)e[t]=null}r&&r.enabled?(this.animateBeforeDestroy(),c(d,l.duration)):d(),o.pointCount--,e.legendItem&&o.legend.destroyItem(e)},animateBeforeDestroy:function(){var t,e=this,i={x:e.startXPos,opacity:0},s=e.getGraphicalProps();s.singular.forEach(function(s){t="dataLabel"===s,e[s]=e[s].animate(t?{x:e[s].startXPos,y:e[s].startYPos,opacity:0}:i)}),s.plural.forEach(function(t){e[t].forEach(function(t){t.element&&t.animate(r({x:e.startXPos},t.startYPos?{x:t.startXPos,y:t.startYPos}:{}))})})},destroyElements:function(t){var e=this,i=e.getGraphicalProps(t);i.singular.forEach(function(t){e[t]=e[t].destroy()}),i.plural.forEach(function(t){e[t].forEach(function(t){t.element&&t.destroy()}),delete e[t]})},getGraphicalProps:function(t){var e,i,s=this,o=[],n={singular:[],plural:[]};for((t=t||{graphic:1,dataLabel:1}).graphic&&o.push("graphic","shadowGroup"),t.dataLabel&&o.push("dataLabel","dataLabelUpper","connector"),i=o.length;i--;)e=o[i],s[e]&&n.singular.push(e);return["dataLabel","connector"].forEach(function(e){var i=e+"s";t[e]&&s[i]&&n.plural.push(i)}),n},getLabelConfig:function(){return{x:this.category,y:this.y,color:this.color,colorIndex:this.colorIndex,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}},tooltipFormatter:function(t){var e=this.series,i=e.tooltipOptions,s=d(i.valueDecimals,""),o=i.valuePrefix||"",n=i.valueSuffix||"";return e.chart.styledMode&&(t=e.chart.tooltip.styledModeFormat(t)),(e.pointArrayMap||["y"]).forEach(function(e){e="{point."+e,(o||n)&&(t=t.replace(RegExp(e+"}","g"),o+e+"}"+n)),t=t.replace(RegExp(e+"}","g"),e+":,."+s+"f}")}),f(t,{point:this,series:this.series},e.chart)},firePointEvent:function(t,e,i){var s=this,o=this.series.options;(o.point.events[t]||s.options&&s.options.events&&s.options.events[t])&&this.importEvents(),"click"===t&&o.allowPointSelect&&(i=function(t){s.select&&s.select(null,t.ctrlKey||t.metaKey||t.shiftKey)}),u(this,t,e,i)},visible:!0}}),i(e,"parts/Series.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.animObject,s=e.arrayMax,o=e.arrayMin,n=e.clamp,r=e.correctFloat,a=e.defined,h=e.erase,l=e.extend,c=e.isArray,d=e.isNumber,p=e.isString,u=e.objectEach,f=e.pick,g=e.splat,m=e.syncTimeout,x=t.addEvent,v=t.defaultOptions,y=t.defaultPlotOptions,b=t.fireEvent,M=t.LegendSymbolMixin,k=t.merge,w=t.Point,S=t.removeEvent,A=t.SVGElement,T=t.win;t.Series=t.seriesType("line",null,{lineWidth:2,allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},marker:{enabledThreshold:2,lineColor:"#ffffff",lineWidth:0,radius:4,states:{normal:{animation:!0},hover:{animation:{duration:50},enabled:!0,radiusPlus:2,lineWidthPlus:1},select:{fillColor:"#cccccc",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{align:"center",formatter:function(){var t=this.series.chart.numberFormatter;return null===this.y?"":t(this.y,-1)},padding:5,style:{fontSize:"11px",fontWeight:"bold",color:"contrast",textOutline:"1px contrast"},verticalAlign:"bottom",x:0,y:0},cropThreshold:300,opacity:1,pointRange:0,softThreshold:!0,states:{normal:{animation:!0},hover:{animation:{duration:50},lineWidthPlus:1,marker:{},halo:{size:10,opacity:.25}},select:{animation:{duration:0}},inactive:{animation:{duration:50},opacity:.2}},stickyTracking:!0,turboThreshold:1e3,findNearestPointBy:"x"},{axisTypes:["xAxis","yAxis"],coll:"series",colorCounter:0,cropShoulder:1,directTouch:!1,eventsToUnbind:[],isCartesian:!0,parallelArrays:["x","y"],pointClass:w,requireSorting:!0,sorted:!0,init:function(e,i){b(this,"init",{options:i});var s,o,n=this,r=e.series;this.eventOptions=this.eventOptions||{},n.chart=e,n.options=i=n.setOptions(i),n.linkedSeries=[],n.bindAxes(),l(n,{name:i.name,state:"",visible:!1!==i.visible,selected:!0===i.selected}),s=i.events,u(s,function(e,i){t.isFunction(e)&&n.eventOptions[i]!==e&&(t.isFunction(n.eventOptions[i])&&S(n,i,n.eventOptions[i]),n.eventOptions[i]=e,x(n,i,e))}),(s&&s.click||i.point&&i.point.events&&i.point.events.click||i.allowPointSelect)&&(e.runTrackerClick=!0),n.getColor(),n.getSymbol(),n.parallelArrays.forEach(function(t){n[t+"Data"]||(n[t+"Data"]=[])}),n.isCartesian&&(e.hasCartesianSeries=!0),r.length&&(o=r[r.length-1]),n._i=f(o&&o._i,-1)+1,e.orderSeries(this.insert(r)),i.dataSorting&&i.dataSorting.enabled?n.setDataSortingOptions():n.points||n.data||n.setData(i.data,!1),b(this,"afterInit")},insert:function(t){var e,i=this.options.index;if(d(i)){for(e=t.length;e--;)if(i>=f(t[e].options.index,t[e]._i)){t.splice(e+1,0,this);break}-1===e&&t.unshift(this),e+=1}else t.push(this);return f(e,t.length-1)},bindAxes:function(){var e,i=this,s=i.options,o=i.chart;b(this,"bindAxes",null,function(){(i.axisTypes||[]).forEach(function(n){o[n].forEach(function(t){e=t.options,(s[n]===e.index||void 0!==s[n]&&s[n]===e.id||void 0===s[n]&&0===e.index)&&(i.insert(t.series),i[n]=t,t.isDirty=!0)}),i[n]||i.optionalAxis===n||t.error(18,!0,o)})})},updateParallelArrays:function(t,e){var i=t.series,s=arguments,o=d(e)?function(s){var o="y"===s&&i.toYData?i.toYData(t):t[s];i[s+"Data"][e]=o}:function(t){Array.prototype[e].apply(i[t+"Data"],Array.prototype.slice.call(s,2))};i.parallelArrays.forEach(o)},hasData:function(){return this.visible&&void 0!==this.dataMax&&void 0!==this.dataMin||this.visible&&this.yData&&this.yData.length>0},autoIncrement:function(){var t,e,i=this.options,s=this.xIncrement,o=i.pointIntervalUnit,n=this.chart.time;return s=f(s,i.pointStart,0),this.pointInterval=e=f(this.pointInterval,i.pointInterval,1),o&&(t=new n.Date(s),"day"===o?n.set("Date",t,n.get("Date",t)+e):"month"===o?n.set("Month",t,n.get("Month",t)+e):"year"===o&&n.set("FullYear",t,n.get("FullYear",t)+e),e=t.getTime()-s),this.xIncrement=s+e,s},setDataSortingOptions:function(){var t=this.options;l(this,{requireSorting:!1,sorted:!1,enabledDataSorting:!0,allowDG:!1}),a(t.pointRange)||(t.pointRange=1)},setOptions:function(t){var e,i,s,o=this.chart,n=o.options,r=n.plotOptions,h=o.userOptions||{},l=k(t),c=o.styledMode,d={plotOptions:r,userOptions:l};b(this,"setOptions",d);var p=d.plotOptions[this.type],u=h.plotOptions||{};return this.userOptions=d.userOptions,e=k(p,r.series,h.plotOptions&&h.plotOptions[this.type],l),this.tooltipOptions=k(v.tooltip,v.plotOptions.series&&v.plotOptions.series.tooltip,v.plotOptions[this.type].tooltip,n.tooltip.userOptions,r.series&&r.series.tooltip,r[this.type].tooltip,l.tooltip),this.stickyTracking=f(l.stickyTracking,u[this.type]&&u[this.type].stickyTracking,u.series&&u.series.stickyTracking,!(!this.tooltipOptions.shared||this.noSharedTooltip)||e.stickyTracking),null===p.marker&&delete e.marker,this.zoneAxis=e.zoneAxis,i=this.zones=(e.zones||[]).slice(),!e.negativeColor&&!e.negativeFillColor||e.zones||(s={value:e[this.zoneAxis+"Threshold"]||e.threshold||0,className:"highcharts-negative"},c||(s.color=e.negativeColor,s.fillColor=e.negativeFillColor),i.push(s)),i.length&&a(i[i.length-1].value)&&i.push(c?{}:{color:this.color,fillColor:this.fillColor}),b(this,"afterSetOptions",{options:e}),e},getName:function(){return f(this.options.name,"Series "+(this.index+1))},getCyclic:function(t,e,i){var s,o,n=this.chart,r=this.userOptions,h=t+"Index",l=t+"Counter",c=i?i.length:f(n.options.chart[t+"Count"],n[t+"Count"]);e||(o=f(r[h],r["_"+h]),a(o)?s=o:(n.series.length||(n[l]=0),r["_"+h]=s=n[l]%c,n[l]+=1),i&&(e=i[s])),void 0!==s&&(this[h]=s),this[t]=e},getColor:function(){this.chart.styledMode?this.getCyclic("color"):this.options.colorByPoint?this.options.color=null:this.getCyclic("color",this.options.color||y[this.type].color,this.chart.options.colors)},getSymbol:function(){var t=this.options.marker;this.getCyclic("symbol",t.symbol,this.chart.options.symbols)},findPointIndex:function(e,i){var s,o,n,r,a=e.id,h=e.x,l=this.points,c=this.options.dataSorting;if(a)s=this.chart.get(a);else if((this.linkedParent||this.enabledDataSorting)&&(r=c&&c.matchByName?"name":"index",!(s=t.find(l,function(t){return!t.touched&&t[r]===e[r]}))))return;return s&&void 0!==(n=s&&s.index)&&(o=!0),void 0===n&&d(h)&&(n=this.xData.indexOf(h,i)),-1!==n&&void 0!==n&&this.cropped&&(n=n>=this.cropStart?n-this.cropStart:n),!o&&l[n]&&l[n].touched&&(n=void 0),n},drawLegendSymbol:M.drawLineMarker,updateData:function(t,e){var i,o,n,r,h=this.options,l=h.dataSorting,c=this.points,p=[],u=this.requireSorting,f=t.length===c.length,g=!0;if(this.xIncrement=null,t.forEach(function(t,e){var s,o,n=a(t)&&this.pointClass.prototype.optionsToObject.call({series:this},t)||{};s=n.x,n.id||d(s)?(-1===(o=this.findPointIndex(n,r))||void 0===o?p.push(t):c[o]&&t!==h.data[o]?(c[o].update(t,!1,null,!1),c[o].touched=!0,u&&(r=o+1)):c[o]&&(c[o].touched=!0),(!f||e!==o||l&&l.enabled||this.hasDerivedData)&&(i=!0)):p.push(t)},this),i)for(o=c.length;o--;)(n=c[o])&&!n.touched&&n.remove&&n.remove(!1,e);else!f||l&&l.enabled?g=!1:(t.forEach(function(t,e){c[e].update&&t!==c[e].y&&c[e].update(t,!1,null,!1)}),p.length=0);return c.forEach(function(t){t&&(t.touched=!1)}),!!g&&(p.forEach(function(t){this.addPoint(t,!1,null,null,!1)},this),null===this.xIncrement&&this.xData&&this.xData.length&&(this.xIncrement=s(this.xData),this.autoIncrement()),!0)},setData:function(e,i,s,o){var n,r,a,h,l=this,u=l.points,g=u&&u.length||0,m=l.options,x=l.chart,v=m.dataSorting,y=null,b=l.xAxis,M=m.turboThreshold,k=this.xData,w=this.yData,S=l.pointArrayMap,A=S&&S.length,T=m.keys,P=0,L=1;if(n=(e=e||[]).length,i=f(i,!0),v&&v.enabled&&(e=this.sortData(e)),!1!==o&&n&&g&&!l.cropped&&!l.hasGroupedData&&l.visible&&!l.isSeriesBoosting&&(h=this.updateData(e,s)),!h){if(l.xIncrement=null,l.colorCounter=0,this.parallelArrays.forEach(function(t){l[t+"Data"].length=0}),M&&n>M)if(y=l.getFirstValidPoint(e),d(y))for(r=0;r<n;r++)k[r]=this.autoIncrement(),w[r]=e[r];else if(c(y))if(A)for(r=0;r<n;r++)a=e[r],k[r]=a[0],w[r]=a.slice(1,A+1);else for(T&&(P=T.indexOf("x"),L=T.indexOf("y"),P=P>=0?P:0,L=L>=0?L:1),r=0;r<n;r++)a=e[r],k[r]=a[P],w[r]=a[L];else t.error(12,!1,x);else for(r=0;r<n;r++)void 0!==e[r]&&(a={series:l},l.pointClass.prototype.applyOptions.apply(a,[e[r]]),l.updateParallelArrays(a,r));for(w&&p(w[0])&&t.error(14,!0,x),l.data=[],l.options.data=l.userOptions.data=e,r=g;r--;)u[r]&&u[r].destroy&&u[r].destroy();b&&(b.minRange=b.userMinRange),l.isDirty=x.isDirtyBox=!0,l.isDirtyData=!!u,s=!1}"point"===m.legendType&&(this.processData(),this.generatePoints()),i&&x.redraw(s)},sortData:function(t){var e=this,i=e.options.dataSorting.sortKey||"y",s=function(t,e){return a(e)&&t.pointClass.prototype.optionsToObject.call({series:t},e)||{}};return t.forEach(function(i,o){t[o]=s(e,i),t[o].index=o},this),t.concat().sort(function(t,e){return d(e[i])?e[i]-t[i]:-1}).forEach(function(t,e){t.x=e},this),e.linkedSeries&&e.linkedSeries.forEach(function(e){var i=e.options,o=i.data;i.dataSorting&&i.dataSorting.enabled||!o||(o.forEach(function(i,n){o[n]=s(e,i),t[n]&&(o[n].x=t[n].x,o[n].index=n)}),e.setData(o,!1))}),t},processData:function(e){var i,s,o,n,r,a,h,l,c=this.xData,d=this.yData,p=c.length,u=0,f=this.xAxis,g=this.options,m=g.cropThreshold,x=this.getExtremesFromAll||g.getExtremesFromAll,v=this.isCartesian,y=f&&f.val2lin,b=f&&f.isLog,M=this.requireSorting;if(v&&!this.isDirty&&!f.isDirty&&!this.yAxis.isDirty&&!e)return!1;for(f&&(h=(a=f.getExtremes()).min,l=a.max),v&&this.sorted&&!x&&(!m||p>m||this.forceCrop)&&(c[p-1]<h||c[0]>l?(c=[],d=[]):this.yData&&(c[0]<h||c[p-1]>l)&&(c=(i=this.cropData(this.xData,this.yData,h,l)).xData,d=i.yData,u=i.start,s=!0)),r=c.length||1;--r;)(o=b?y(c[r])-y(c[r-1]):c[r]-c[r-1])>0&&(void 0===n||o<n)?n=o:o<0&&M&&(t.error(15,!1,this.chart),M=!1);this.cropped=s,this.cropStart=u,this.processedXData=c,this.processedYData=d,this.closestPointRange=this.basePointRange=n},cropData:function(t,e,i,s,o){var n,r,a=t.length,h=0,l=a;for(o=f(o,this.cropShoulder),n=0;n<a;n++)if(t[n]>=i){h=Math.max(0,n-o);break}for(r=n;r<a;r++)if(t[r]>s){l=r+o;break}return{xData:t.slice(h,l),yData:e.slice(h,l),start:h,end:l}},generatePoints:function(){var t,e,i,s,o=this.options,n=o.data,r=this.data,a=this.processedXData,h=this.processedYData,c=this.pointClass,d=a.length,p=this.cropStart||0,u=this.hasGroupedData,f=o.keys,m=[];if(!r&&!u){var x=[];x.length=n.length,r=this.data=x}for(f&&u&&(this.options.keys=!1),s=0;s<d;s++)e=p+s,u?((i=(new c).init(this,[a[s]].concat(g(h[s])))).dataGroup=this.groupMap[s],i.dataGroup.options&&(i.options=i.dataGroup.options,l(i,i.dataGroup.options),delete i.dataLabels)):(i=r[e])||void 0===n[e]||(r[e]=i=(new c).init(this,n[e],a[s])),i&&(i.index=e,m[s]=i);if(this.options.keys=f,r&&(d!==(t=r.length)||u))for(s=0;s<t;s++)s!==p||u||(s+=d),r[s]&&(r[s].destroyElements(),r[s].plotX=void 0);this.data=r,this.points=m,b(this,"afterGeneratePoints")},getXExtremes:function(t){return{min:o(t),max:s(t)}},getExtremes:function(t){var e,i,n,r,a,h,l,p,u=this.xAxis,f=this.yAxis,g=this.processedXData||this.xData,m=[],x=0,v=0,y=0,M=this.requireSorting?this.cropShoulder:0,k=!!f&&f.positiveValuesOnly;for(e=(t=t||this.stackedYData||this.processedYData||[]).length,u&&(v=(i=u.getExtremes()).min,y=i.max),l=0;l<e;l++)if(a=g[l],h=t[l],n=(d(h)||c(h))&&(h.length||h>0||!k),r=this.getExtremesFromAll||this.options.getExtremesFromAll||this.cropped||!u||(g[l+M]||a)>=v&&(g[l-M]||a)<=y,n&&r)if(p=h.length)for(;p--;)d(h[p])&&(m[x++]=h[p]);else m[x++]=h;this.dataMin=o(m),this.dataMax=s(m),b(this,"afterGetExtremes")},getFirstValidPoint:function(t){for(var e=null,i=t.length,s=0;null===e&&s<i;)e=t[s],s++;return e},translate:function(){this.processedXData||this.processData(),this.generatePoints();var t,e,i,s,o,h=this.options,l=h.stacking,p=this.xAxis,u=p.categories,g=this.enabledDataSorting,m=this.yAxis,x=this.points,v=x.length,y=!!this.modifyValue,M=this.pointPlacementToXValue(),k=d(M),w=h.threshold,S=h.startFromThreshold?w:0,A=this.zoneAxis||"y",T=Number.MAX_VALUE;function P(t){return n(t,-1e5,1e5)}for(t=0;t<v;t++){var L,C,E=x[t],O=E.x,D=E.y,B=E.low,I=l&&m.stacks[(this.negStacks&&D<(S?0:w)?"-":"")+this.stackKey];m.positiveValuesOnly&&null!==D&&D<=0&&(E.isNull=!0),E.plotX=e=r(P(p.translate(O,0,0,0,1,M,"flags"===this.type))),l&&this.visible&&I&&I[O]&&(o=this.getStackIndicator(o,O,this.index),E.isNull||(C=(L=I[O]).points[o.key])),c(C)&&(B=C[0],D=C[1],B===S&&o.key===I[O].base&&(B=f(d(w)&&w,m.min)),m.positiveValuesOnly&&B<=0&&(B=null),E.total=E.stackTotal=L.total,E.percentage=L.total&&E.y/L.total*100,E.stackY=D,this.irregularWidths||L.setOffset(this.pointXOffset||0,this.barW||0)),E.yBottom=a(B)?P(m.translate(B,0,1,0,1)):null,y&&(D=this.modifyValue(D,E)),E.plotY=i="number"==typeof D&&D!==1/0?P(m.translate(D,0,1,0,1)):void 0,E.isInside=void 0!==i&&i>=0&&i<=m.len&&e>=0&&e<=p.len,E.clientX=k?r(p.translate(O,0,0,0,1,M)):e,E.negative=E[A]<(h[A+"Threshold"]||w||0),E.category=u&&void 0!==u[E.x]?u[E.x]:E.x,E.isNull||!1===E.visible||(void 0!==s&&(T=Math.min(T,Math.abs(e-s))),s=e),E.zone=this.zones.length&&E.getZone(),!E.graphic&&this.group&&g&&(E.isNew=!0)}this.closestPointRangePx=T,b(this,"afterTranslate")},getValidPoints:function(t,e,i){var s=this.chart;return(t||this.points||[]).filter(function(t){return!(e&&!s.isInsidePlot(t.plotX,t.plotY,s.inverted))&&(!1!==t.visible&&(i||!t.isNull))})},getClipBox:function(t,e){var i,s=this.options,o=this.chart,n=o.inverted,r=this.xAxis,a=r&&this.yAxis;return t&&!1===s.clip&&a?i=n?{y:-o.chartWidth+a.len+a.pos,height:o.chartWidth,width:o.chartHeight,x:-o.chartHeight+r.len+r.pos}:{y:-a.pos,height:o.chartHeight,width:o.chartWidth,x:-r.pos}:(i=this.clipBox||o.clipBox,e&&(i.width=o.plotSizeX,i.x=0)),e?{width:i.width,x:i.x}:i},setClip:function(t){var e=this.chart,i=this.options,s=e.renderer,o=e.inverted,n=this.clipBox,r=this.getClipBox(t),a=this.sharedClipKey||["_sharedClip",t&&t.duration,t&&t.easing,r.height,i.xAxis,i.yAxis].join(","),h=e[a],l=e[a+"m"];h||(t&&(r.width=0,o&&(r.x=e.plotSizeX+(!1!==i.clip?0:e.plotTop)),e[a+"m"]=l=s.clipRect(o?e.plotSizeX+99:-99,o?-e.plotLeft:-e.plotTop,99,o?e.chartWidth:e.chartHeight)),e[a]=h=s.clipRect(r),h.count={length:0}),t&&(h.count[this.index]||(h.count[this.index]=!0,h.count.length+=1)),(!1!==i.clip||t)&&(this.group.clip(t||n?h:e.clipRect),this.markerGroup.clip(l),this.sharedClipKey=a),t||(h.count[this.index]&&(delete h.count[this.index],h.count.length-=1),0===h.count.length&&a&&e[a]&&(n||(e[a]=e[a].destroy()),e[a+"m"]&&(e[a+"m"]=e[a+"m"].destroy())))},animate:function(t){var e,s,o,n=this.chart,r=i(this.options.animation);t?this.setClip(r):(e=n[s=this.sharedClipKey],o=this.getClipBox(r,!0),e&&e.animate(o,r),n[s+"m"]&&n[s+"m"].animate({width:o.width+99,x:o.x-(n.inverted?0:99)},r),this.animate=null)},afterAnimate:function(){this.setClip(),b(this,"afterAnimate"),this.finishedAnimating=!0},drawPoints:function(){var t,e,i,s,o,n,r,a=this.points,h=this.chart,l=this.options.marker,c=this[this.specialGroup]||this.markerGroup,d=this.xAxis,p=f(l.enabled,!(d&&!d.isRadial)||null,this.closestPointRangePx>=l.enabledThreshold*l.radius);if(!1!==l.enabled||this._hasPointMarkers)for(t=0;t<a.length;t++){if(s=(i=(e=a[t]).graphic)?"animate":"attr",o=e.marker||{},n=!!e.marker,(p&&void 0===o.enabled||o.enabled)&&!e.isNull&&!1!==e.visible){var u=f(o.symbol,this.symbol);r=this.markerAttribs(e,e.selected&&"select"),this.enabledDataSorting&&(e.startXPos=d.reversed?-r.width:d.width);var g=!1!==e.isInside;i?i[g?"show":"hide"](g).animate(r):g&&(r.width>0||e.hasImage)&&(e.graphic=i=h.renderer.symbol(u,r.x,r.y,r.width,r.height,n?o:l).add(c),this.enabledDataSorting&&h.hasRendered&&(i.attr({x:e.startXPos}),s="animate")),i&&"animate"===s&&i[g?"show":"hide"](g).animate(r),i&&!h.styledMode&&i[s](this.pointAttribs(e,e.selected&&"select")),i&&i.addClass(e.getClassName(),!0)}else i&&(e.graphic=i.destroy())}},markerAttribs:function(t,e){var i,s,o,n=this.options.marker,r=t.marker||{},a=r.symbol||n.symbol,h=f(r.radius,n.radius);return e&&(i=n.states[e],s=r.states&&r.states[e],h=f(s&&s.radius,i&&i.radius,h+(i&&i.radiusPlus||0))),t.hasImage=a&&0===a.indexOf("url"),t.hasImage&&(h=0),o={x:Math.floor(t.plotX)-h,y:t.plotY-h},h&&(o.width=o.height=2*h),o},pointAttribs:function(t,e){var i,s,o,n,r=this.options.marker,a=t&&t.options,h=a&&a.marker||{},l=this.color,c=a&&a.color,d=t&&t.color,p=f(h.lineWidth,r.lineWidth),u=t&&t.zone&&t.zone.color,g=1;return l=c||u||d||l,o=h.fillColor||r.fillColor||l,n=h.lineColor||r.lineColor||l,(e=e||"normal")&&(i=r.states[e],s=h.states&&h.states[e]||{},p=f(s.lineWidth,i.lineWidth,p+f(s.lineWidthPlus,i.lineWidthPlus,0)),o=s.fillColor||i.fillColor||o,n=s.lineColor||i.lineColor||n,g=f(s.opacity,i.opacity,g)),{stroke:n,"stroke-width":p,fill:o,opacity:g}},destroy:function(e){var i,s,o,n=this,r=n.chart,a=/AppleWebKit\/533/.test(T.navigator.userAgent),l=n.data||[];for(b(n,"destroy"),this.removeEvents(e),(n.axisTypes||[]).forEach(function(t){(o=n[t])&&o.series&&(h(o.series,n),o.isDirty=o.forceRedraw=!0)}),n.legendItem&&n.chart.legend.destroyItem(n),i=l.length;i--;)(s=l[i])&&s.destroy&&s.destroy();n.points=null,t.clearTimeout(n.animationTimeout),u(n,function(t,e){t instanceof A&&!t.survive&&t[a&&"group"===e?"hide":"destroy"]()}),r.hoverSeries===n&&(r.hoverSeries=null),h(r.series,n),r.orderSeries(),u(n,function(t,i){e&&"hcEvents"===i||delete n[i]})},getGraphPath:function(t,e,i){var s,o,n=this,r=n.options,h=r.step,l=[],c=[];return(s=(t=t||n.points).reversed)&&t.reverse(),(h={right:1,center:2}[h]||h&&3)&&s&&(h=4-h),(t=this.getValidPoints(t,!1,!(r.connectNulls&&!e&&!i))).forEach(function(s,d){var p,u=s.plotX,f=s.plotY,g=t[d-1];(s.leftCliff||g&&g.rightCliff)&&!i&&(o=!0),s.isNull&&!a(e)&&d>0?o=!r.connectNulls:s.isNull&&!e?o=!0:(0===d||o?p=["M",s.plotX,s.plotY]:n.getPointSpline?p=n.getPointSpline(t,s,d):h?(p=1===h?["L",g.plotX,f]:2===h?["L",(g.plotX+u)/2,g.plotY,"L",(g.plotX+u)/2,f]:["L",u,g.plotY]).push("L",u,f):p=["L",u,f],c.push(s.x),h&&(c.push(s.x),2===h&&c.push(s.x)),l.push.apply(l,p),o=!1)}),l.xMap=c,n.graphPath=l,l},drawGraph:function(){var t=this,e=this.options,i=(this.gappedPath||this.getGraphPath).call(this),s=this.chart.styledMode,o=[["graph","highcharts-graph"]];s||o[0].push(e.lineColor||this.color||"#cccccc",e.dashStyle),(o=t.getZonesGraphs(o)).forEach(function(o,n){var r,a=o[0],h=t[a],l=h?"animate":"attr";h?(h.endX=t.preventGraphAnimation?null:i.xMap,h.animate({d:i})):i.length&&(t[a]=h=t.chart.renderer.path(i).addClass(o[1]).attr({zIndex:1}).add(t.group)),h&&!s&&(r={stroke:o[2],"stroke-width":e.lineWidth,fill:t.fillGraph&&t.color||"none"},o[3]?r.dashstyle=o[3]:"square"!==e.linecap&&(r["stroke-linecap"]=r["stroke-linejoin"]="round"),h[l](r).shadow(n<2&&e.shadow)),h&&(h.startX=i.xMap,h.isArea=i.isArea)})},getZonesGraphs:function(t){return this.zones.forEach(function(e,i){var s=["zone-graph-"+i,"highcharts-graph highcharts-zone-graph-"+i+" "+(e.className||"")];this.chart.styledMode||s.push(e.color||this.color,e.dashStyle||this.options.dashStyle),t.push(s)},this),t},applyZones:function(){var t,e,i,s,o,r,a,h,l,c=this,d=this.chart,p=d.renderer,u=this.zones,g=this.clips||[],m=this.graph,x=this.area,v=Math.max(d.chartWidth,d.chartHeight),y=this[(this.zoneAxis||"y")+"Axis"],b=d.inverted,M=!1;u.length&&(m||x)&&y&&void 0!==y.min?(o=y.reversed,r=y.horiz,m&&!this.showLine&&m.hide(),x&&x.hide(),s=y.getExtremes(),u.forEach(function(u,k){t=o?r?d.plotWidth:0:r?0:y.toPixels(s.min)||0,t=n(f(e,t),0,v),e=n(Math.round(y.toPixels(f(u.value,s.max),!0)||0),0,v),M&&(t=e=y.toPixels(s.max)),a=Math.abs(t-e),h=Math.min(t,e),l=Math.max(t,e),y.isXAxis?(i={x:b?l:h,y:0,width:a,height:v},r||(i.x=d.plotHeight-i.x)):(i={x:0,y:b?l:h,width:v,height:a},r&&(i.y=d.plotWidth-i.y)),b&&p.isVML&&(i=y.isXAxis?{x:0,y:o?h:l,height:i.width,width:d.chartWidth}:{x:i.y-d.plotLeft-d.spacingBox.x,y:0,width:i.height,height:d.chartHeight}),g[k]?g[k].animate(i):g[k]=p.clipRect(i),m&&c["zone-graph-"+k].clip(g[k]),x&&c["zone-area-"+k].clip(g[k]),M=u.value>s.max,c.resetZones&&0===e&&(e=void 0)}),this.clips=g):c.visible&&(m&&m.show(!0),x&&x.show(!0))},invertGroups:function(t){var e=this,i=e.chart;function s(){["group","markerGroup"].forEach(function(s){e[s]&&(i.renderer.isVML&&e[s].attr({width:e.yAxis.len,height:e.xAxis.len}),e[s].width=e.yAxis.len,e[s].height=e.xAxis.len,e[s].invert(!e.isRadialSeries&&t))})}e.xAxis&&(e.eventsToUnbind.push(x(i,"resize",s)),s(),e.invertGroups=s)},plotGroup:function(t,e,i,s,o){var n=this[t],r=!n;return r&&(this[t]=n=this.chart.renderer.g().attr({zIndex:s||.1}).add(o)),n.addClass("highcharts-"+e+" highcharts-series-"+this.index+" highcharts-"+this.type+"-series "+(a(this.colorIndex)?"highcharts-color-"+this.colorIndex+" ":"")+(this.options.className||"")+(n.hasClass("highcharts-tracker")?" highcharts-tracker":""),!0),n.attr({visibility:i})[r?"attr":"animate"](this.getPlotBox()),n},getPlotBox:function(){var t=this.chart,e=this.xAxis,i=this.yAxis;return t.inverted&&(e=i,i=this.xAxis),{translateX:e?e.left:t.plotLeft,translateY:i?i.top:t.plotTop,scaleX:1,scaleY:1}},removeEvents:function(t){t?this.eventsToUnbind.length&&(this.eventsToUnbind.forEach(function(t){t()}),this.eventsToUnbind.length=0):S(this)},render:function(){var t,e=this,s=e.chart,o=e.options,n=!!e.animate&&s.renderer.isSVG&&i(o.animation).duration,r=e.visible?"inherit":"hidden",a=o.zIndex,h=e.hasRendered,l=s.seriesGroup,c=s.inverted;b(this,"render"),t=e.plotGroup("group","series",r,a,l),e.markerGroup=e.plotGroup("markerGroup","markers",r,a,l),n&&e.animate(!0),t.inverted=!(!e.isCartesian&&!e.invertable)&&c,e.drawGraph&&(e.drawGraph(),e.applyZones()),e.visible&&e.drawPoints(),e.drawDataLabels&&e.drawDataLabels(),e.redrawPoints&&e.redrawPoints(),e.drawTracker&&!1!==e.options.enableMouseTracking&&e.drawTracker(),e.invertGroups(c),!1===o.clip||e.sharedClipKey||h||t.clip(s.clipRect),n&&e.animate(),h||(e.animationTimeout=m(function(){e.afterAnimate()},n||0)),e.isDirty=!1,e.hasRendered=!0,b(e,"afterRender")},redraw:function(){var t=this.chart,e=this.isDirty||this.isDirtyData,i=this.group,s=this.xAxis,o=this.yAxis;i&&(t.inverted&&i.attr({width:t.plotWidth,height:t.plotHeight}),i.animate({translateX:f(s&&s.left,t.plotLeft),translateY:f(o&&o.top,t.plotTop)})),this.translate(),this.render(),e&&delete this.kdTree},kdAxisArray:["clientX","plotY"],searchPoint:function(t,e){var i=this.xAxis,s=this.yAxis,o=this.chart.inverted;return this.searchKDTree({clientX:o?i.len-t.chartY+i.pos:t.chartX-i.pos,plotY:o?s.len-t.chartX+s.pos:t.chartY-s.pos},e,t)},buildKDTree:function(t){this.buildingKdTree=!0;var e=this,i=e.options.findNearestPointBy.indexOf("y")>-1?2:1;delete e.kdTree,m(function(){e.kdTree=function t(i,s,o){var n,r,a=i&&i.length;if(a)return n=e.kdAxisArray[s%o],i.sort(function(t,e){return t[n]-e[n]}),{point:i[r=Math.floor(a/2)],left:t(i.slice(0,r),s+1,o),right:t(i.slice(r+1),s+1,o)}}(e.getValidPoints(null,!e.directTouch),i,i),e.buildingKdTree=!1},e.options.kdNow||t&&"touchstart"===t.type?0:1)},searchKDTree:function(t,e,i){var s=this,o=this.kdAxisArray[0],n=this.kdAxisArray[1],r=e?"distX":"dist",h=s.options.findNearestPointBy.indexOf("y")>-1?2:1;if(this.kdTree||this.buildingKdTree||this.buildKDTree(i),this.kdTree)return function t(e,i,h,l){var c,d,p,u,f,g,m,x,v,y,b=i.point,M=s.kdAxisArray[h%l],k=b;return m=b,x=a((g=e)[o])&&a(m[o])?Math.pow(g[o]-m[o],2):null,v=a(g[n])&&a(m[n])?Math.pow(g[n]-m[n],2):null,y=(x||0)+(v||0),m.dist=a(y)?Math.sqrt(y):Number.MAX_VALUE,m.distX=a(x)?Math.sqrt(x):Number.MAX_VALUE,d=(c=e[M]-b[M])<0?"left":"right",p=c<0?"right":"left",i[d]&&(k=(u=t(e,i[d],h+1,l))[r]<k[r]?u:b),i[p]&&Math.sqrt(c*c)<k[r]&&(k=(f=t(e,i[p],h+1,l))[r]<k[r]?f:k),k}(t,this.kdTree,h,h)},pointPlacementToXValue:function(){var t=this.xAxis,e=this.options.pointPlacement;return"between"===e&&(e=t.reversed?-.5:.5),d(e)&&(e*=f(this.options.pointRange||t.pointRange)),e}})}),i(e,"parts/Stacking.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.correctFloat,s=e.defined,o=e.destroyObjectProperties,n=e.objectEach,r=e.pick,a=t.Axis,h=t.Chart,l=t.format,c=t.Series;t.StackItem=function(t,e,i,s,o){var n=t.chart.inverted;this.axis=t,this.isNegative=i,this.options=e=e||{},this.x=s,this.total=null,this.points={},this.stack=o,this.leftCliff=0,this.rightCliff=0,this.alignOptions={align:e.align||(n?i?"left":"right":"center"),verticalAlign:e.verticalAlign||(n?"middle":i?"bottom":"top"),y:e.y,x:e.x},this.textAlign=e.textAlign||(n?i?"right":"left":"center")},t.StackItem.prototype={destroy:function(){o(this,this.axis)},render:function(t){var e=this.axis.chart,i=this.options,s=i.format,o={},n=s?l(s,this,e):i.formatter.call(this);this.label?this.label.attr({text:n,visibility:"hidden"}):(this.label=e.renderer.label(n,null,null,i.shape,null,null,i.useHTML,!1,"stack-labels"),o={text:n,align:this.textAlign,rotation:i.rotation,padding:r(i.padding,0),visibility:"hidden"},this.label.attr(o),e.styledMode||this.label.css(i.style),this.label.added||this.label.add(t)),this.label.labelrank=e.plotHeight},setOffset:function(t,e,i,o,n){var a,h=this.axis,l=h.chart,d=h.translate(h.usePercentage?100:o||this.total,0,0,0,1),p=h.translate(i||0),u=s(d)&&Math.abs(d-p),f=r(n,l.xAxis[0].translate(this.x))+t,g=s(d)&&this.getStackBox(l,this,f,d,e,u,h),m=this.label,x=this.isNegative,v="justify"===r(this.options.overflow,"justify");if(m&&g){var y=m.getBBox(),b=l.inverted?x?y.width:0:y.width/2,M=l.inverted?y.height/2:x?-4:y.height+4;this.alignOptions.x=r(this.options.x,0),m.align(this.alignOptions,null,g),a=m.alignAttr,m.show(),a.y-=M,v&&(a.x-=b,c.prototype.justifyDataLabel.call(this.axis,m,this.alignOptions,a,y,g),a.x+=b),a.x=m.alignAttr.x,m.attr({x:a.x,y:a.y}),r(!v&&this.options.crop,!0)&&(l.isInsidePlot(m.x+(l.inverted?0:-y.width/2),m.y)&&l.isInsidePlot(m.x+(l.inverted?x?-y.width:y.width:y.width/2),m.y+y.height)||m.hide())}},getStackBox:function(t,e,i,s,o,n,r){var a=e.axis.reversed,h=t.inverted,l=r.height+r.pos-(h?t.plotLeft:t.plotTop),c=e.isNegative&&!a||!e.isNegative&&a;return{x:h?c?s:s-n:i,y:h?l-i-o:c?l-s-n:l-s,width:h?n:o,height:h?o:n}}},h.prototype.getStacks=function(){var t=this,e=t.inverted;t.yAxis.forEach(function(t){t.stacks&&t.hasVisibleSeries&&(t.oldStacks=t.stacks)}),t.series.forEach(function(i){var s=i.xAxis&&i.xAxis.options||{};!i.options.stacking||!0!==i.visible&&!1!==t.options.chart.ignoreHiddenSeries||(i.stackKey=[i.type,r(i.options.stack,""),e?s.top:s.left,e?s.height:s.width].join(","))})},a.prototype.buildStacks=function(){var e,i=this.series,s=r(this.options.reversedStacks,!0),o=i.length;if(!this.isXAxis){for(this.usePercentage=!1,e=o;e--;)i[s?e:o-e-1].setStackedPoints();for(e=0;e<o;e++)i[e].modifyStacks();t.fireEvent(this,"afterBuildStacks")}},a.prototype.renderStackTotals=function(){var t=this.chart,e=t.renderer,i=this.stacks,s=this.stackTotalGroup;s||(this.stackTotalGroup=s=e.g("stack-labels").attr({visibility:"visible",zIndex:6}).add()),s.translate(t.plotLeft,t.plotTop),n(i,function(t){n(t,function(t){t.render(s)})})},a.prototype.resetStacks=function(){var t=this,e=t.stacks;t.isXAxis||n(e,function(e){n(e,function(i,s){i.touched<t.stacksTouched?(i.destroy(),delete e[s]):(i.total=null,i.cumulative=null)})})},a.prototype.cleanStacks=function(){var t;this.isXAxis||(this.oldStacks&&(t=this.stacks=this.oldStacks),n(t,function(t){n(t,function(t){t.cumulative=t.total})}))},c.prototype.setStackedPoints=function(){if(this.options.stacking&&(!0===this.visible||!1===this.chart.options.chart.ignoreHiddenSeries)){var e,o,n,a,h,l,c,d,p,u=this.processedXData,f=this.processedYData,g=[],m=f.length,x=this.options,v=x.threshold,y=r(x.startFromThreshold&&v,0),b=x.stack,M=x.stacking,k=this.stackKey,w="-"+k,S=this.negStacks,A=this.yAxis,T=A.stacks,P=A.oldStacks;for(A.stacksTouched+=1,c=0;c<m;c++)d=u[c],p=f[c],l=(e=this.getStackIndicator(e,d,this.index)).key,T[h=(o=S&&p<(y?0:v))?w:k]||(T[h]={}),T[h][d]||(P[h]&&P[h][d]?(T[h][d]=P[h][d],T[h][d].total=null):T[h][d]=new t.StackItem(A,A.options.stackLabels,o,d,b)),n=T[h][d],null!==p?(n.points[l]=n.points[this.index]=[r(n.cumulative,y)],s(n.cumulative)||(n.base=l),n.touched=A.stacksTouched,e.index>0&&!1===this.singleStacks&&(n.points[l][0]=n.points[this.index+","+d+",0"][0])):n.points[l]=n.points[this.index]=null,"percent"===M?(a=o?k:w,S&&T[a]&&T[a][d]?(a=T[a][d],n.total=a.total=Math.max(a.total,n.total)+Math.abs(p)||0):n.total=i(n.total+(Math.abs(p)||0))):n.total=i(n.total+(p||0)),n.cumulative=r(n.cumulative,y)+(p||0),null!==p&&(n.points[l].push(n.cumulative),g[c]=n.cumulative);"percent"===M&&(A.usePercentage=!0),this.stackedYData=g,A.oldStacks={}}},c.prototype.modifyStacks=function(){var t,e=this,i=e.stackKey,s=e.yAxis.stacks,o=e.processedXData,n=e.options.stacking;e[n+"Stacker"]&&[i,"-"+i].forEach(function(i){for(var r,a,h,l=o.length;l--;)r=o[l],t=e.getStackIndicator(t,r,e.index,i),(h=(a=s[i]&&s[i][r])&&a.points[t.key])&&e[n+"Stacker"](h,a,l)})},c.prototype.percentStacker=function(t,e,s){var o=e.total?100/e.total:0;t[0]=i(t[0]*o),t[1]=i(t[1]*o),this.stackedYData[s]=t[1]},c.prototype.getStackIndicator=function(t,e,i,o){return!s(t)||t.x!==e||o&&t.key!==o?t={x:e,index:0,key:o}:t.index++,t.key=[i,e,t.index].join(","),t}}),i(e,"parts/Dynamics.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.defined,s=e.erase,o=e.extend,n=e.isArray,r=e.isNumber,a=e.isObject,h=e.isString,l=e.objectEach,c=e.pick,d=e.relativeLength,p=e.setAnimation,u=e.splat,f=t.addEvent,g=t.animate,m=t.Axis,x=t.Chart,v=t.createElement,y=t.css,b=t.fireEvent,M=t.merge,k=t.Point,w=t.Series,S=t.seriesTypes;t.cleanRecursively=function(e,i){var s={};return l(e,function(o,n){var r;a(e[n],!0)&&!e.nodeType&&i[n]?(r=t.cleanRecursively(e[n],i[n]),Object.keys(r).length&&(s[n]=r)):(a(e[n])||e[n]!==i[n])&&(s[n]=e[n])}),s},o(x.prototype,{addSeries:function(t,e,i){var s,o=this;return t&&(e=c(e,!0),b(o,"addSeries",{options:t},function(){s=o.initSeries(t),o.isDirtyLegend=!0,o.linkSeries(),s.enabledDataSorting&&s.setData(t.data,!1),b(o,"afterAddSeries",{series:s}),e&&o.redraw(i)})),s},addAxis:function(t,e,i,s){return this.createAxis(e?"xAxis":"yAxis",{axis:t,redraw:i,animation:s})},addColorAxis:function(t,e,i){return this.createAxis("colorAxis",{axis:t,redraw:e,animation:i})},createAxis:function(e,i){var s,o=this.options,n="colorAxis"===e,r=i.axis,a=i.redraw,h=i.animation,l=M(r,{index:this[e].length,isX:"xAxis"===e});return s=n?new t.ColorAxis(this,l):new m(this,l),o[e]=u(o[e]||{}),o[e].push(l),n&&(this.isDirtyLegend=!0,this.axes.forEach(function(t){t.series=[]}),this.series.forEach(function(t){t.bindAxes(),t.isDirtyData=!0})),c(a,!0)&&this.redraw(h),s},showLoading:function(t){var e=this,i=e.options,s=e.loadingDiv,n=i.loading,r=function(){s&&y(s,{left:e.plotLeft+"px",top:e.plotTop+"px",width:e.plotWidth+"px",height:e.plotHeight+"px"})};s||(e.loadingDiv=s=v("div",{className:"highcharts-loading highcharts-loading-hidden"},null,e.container),e.loadingSpan=v("span",{className:"highcharts-loading-inner"},null,s),f(e,"redraw",r)),s.className="highcharts-loading",e.loadingSpan.innerHTML=c(t,i.lang.loading,""),e.styledMode||(y(s,o(n.style,{zIndex:10})),y(e.loadingSpan,n.labelStyle),e.loadingShown||(y(s,{opacity:0,display:""}),g(s,{opacity:n.style.opacity||.5},{duration:n.showDuration||0}))),e.loadingShown=!0,r()},hideLoading:function(){var t=this.options,e=this.loadingDiv;e&&(e.className="highcharts-loading highcharts-loading-hidden",this.styledMode||g(e,{opacity:0},{duration:t.loading.hideDuration||100,complete:function(){y(e,{display:"none"})}})),this.loadingShown=!1},propsRequireDirtyBox:["backgroundColor","borderColor","borderWidth","borderRadius","plotBackgroundColor","plotBackgroundImage","plotBorderColor","plotBorderWidth","plotShadow","shadow"],propsRequireReflow:["margin","marginTop","marginRight","marginBottom","marginLeft","spacing","spacingTop","spacingRight","spacingBottom","spacingLeft"],propsRequireUpdateSeries:["chart.inverted","chart.polar","chart.ignoreHiddenSeries","chart.type","colors","plotOptions","time","tooltip"],collectionsWithUpdate:["xAxis","yAxis","zAxis","series"],update:function(e,s,o,n){var a,p,f,g,m,x,v=this,y={credits:"addCredits",title:"setTitle",subtitle:"setSubtitle",caption:"setCaption"},k=e.isResponsiveOptions,w=[];b(v,"update",{options:e}),k||v.setResponsive(!1,!0),e=t.cleanRecursively(e,v.options),M(!0,v.userOptions,e),(a=e.chart)&&(M(!0,v.options.chart,a),"className"in a&&v.setClassName(a.className),"reflow"in a&&v.setReflow(a.reflow),("inverted"in a||"polar"in a||"type"in a)&&(v.propFromSeries(),p=!0),"alignTicks"in a&&(p=!0),l(a,function(t,e){-1!==v.propsRequireUpdateSeries.indexOf("chart."+e)&&(f=!0),-1!==v.propsRequireDirtyBox.indexOf(e)&&(v.isDirtyBox=!0),k||-1===v.propsRequireReflow.indexOf(e)||(x=!0)}),!v.styledMode&&"style"in a&&v.renderer.setStyle(a.style)),!v.styledMode&&e.colors&&(this.options.colors=e.colors),e.plotOptions&&M(!0,this.options.plotOptions,e.plotOptions),e.time&&this.time===t.time&&(this.time=new t.Time(e.time)),l(e,function(t,e){v[e]&&"function"==typeof v[e].update?v[e].update(t,!1):"function"==typeof v[y[e]]&&v[y[e]](t),"chart"!==e&&-1!==v.propsRequireUpdateSeries.indexOf(e)&&(f=!0)}),this.collectionsWithUpdate.forEach(function(t){var s;e[t]&&("series"===t&&(s=[],v[t].forEach(function(t,e){t.options.isInternal||s.push(c(t.options.index,e))})),u(e[t]).forEach(function(e,n){var r=i(e.id)&&v.get(e.id)||v[t][s?s[n]:n];r&&r.coll===t&&(r.update(e,!1),o&&(r.touched=!0)),!r&&o&&v.collectionsWithInit[t]&&(v.collectionsWithInit[t][0].apply(v,[e].concat(v.collectionsWithInit[t][1]||[]).concat([!1])).touched=!0)}),o&&v[t].forEach(function(t){t.touched||t.options.isInternal?delete t.touched:w.push(t)}))}),w.forEach(function(t){t.remove&&t.remove(!1)}),p&&v.axes.forEach(function(t){t.update({},!1)}),f&&v.getSeriesOrderByLinks().forEach(function(t){t.chart&&t.update({},!1)},this),e.loading&&M(!0,v.options.loading,e.loading),g=a&&a.width,m=a&&a.height,h(m)&&(m=d(m,g||v.chartWidth)),x||r(g)&&g!==v.chartWidth||r(m)&&m!==v.chartHeight?v.setSize(g,m,n):c(s,!0)&&v.redraw(n),b(v,"afterUpdate",{options:e,redraw:s,animation:n})},setSubtitle:function(t,e){this.applyDescription("subtitle",t),this.layOutTitles(e)},setCaption:function(t,e){this.applyDescription("caption",t),this.layOutTitles(e)}}),x.prototype.collectionsWithInit={xAxis:[x.prototype.addAxis,[!0]],yAxis:[x.prototype.addAxis,[!1]],series:[x.prototype.addSeries]},o(k.prototype,{update:function(t,e,i,s){var o,n=this,r=n.series,h=n.graphic,l=r.chart,d=r.options;function p(){n.applyOptions(t),null===n.y&&h&&(n.graphic=h.destroy()),a(t,!0)&&(h&&h.element&&t&&t.marker&&void 0!==t.marker.symbol&&(n.graphic=h.destroy()),t&&t.dataLabels&&n.dataLabel&&(n.dataLabel=n.dataLabel.destroy()),n.connector&&(n.connector=n.connector.destroy())),o=n.index,r.updateParallelArrays(n,o),d.data[o]=a(d.data[o],!0)||a(t,!0)?n.options:c(t,d.data[o]),r.isDirty=r.isDirtyData=!0,!r.fixedBox&&r.hasCartesianSeries&&(l.isDirtyBox=!0),"point"===d.legendType&&(l.isDirtyLegend=!0),e&&l.redraw(i)}e=c(e,!0),!1===s?p():n.firePointEvent("update",{options:t},p)},remove:function(t,e){this.series.removePoint(this.series.data.indexOf(this),t,e)}}),o(w.prototype,{addPoint:function(t,e,i,s,o){var n,r,a,h,l=this.options,d=this.data,p=this.chart,u=this.xAxis,f=u&&u.hasNames&&u.names,g=l.data,m=this.xData;if(e=c(e,!0),n={series:this},this.pointClass.prototype.applyOptions.apply(n,[t]),h=n.x,a=m.length,this.requireSorting&&h<m[a-1])for(r=!0;a&&m[a-1]>h;)a--;this.updateParallelArrays(n,"splice",a,0,0),this.updateParallelArrays(n,a),f&&n.name&&(f[h]=n.name),g.splice(a,0,t),r&&(this.data.splice(a,0,null),this.processData()),"point"===l.legendType&&this.generatePoints(),i&&(d[0]&&d[0].remove?d[0].remove(!1):(d.shift(),this.updateParallelArrays(n,"shift"),g.shift())),!1!==o&&b(this,"addPoint",{point:n}),this.isDirty=!0,this.isDirtyData=!0,e&&p.redraw(s)},removePoint:function(t,e,i){var s=this,o=s.data,n=o[t],r=s.points,a=s.chart,h=function(){r&&r.length===o.length&&r.splice(t,1),o.splice(t,1),s.options.data.splice(t,1),s.updateParallelArrays(n||{series:s},"splice",t,1),n&&n.destroy(),s.isDirty=!0,s.isDirtyData=!0,e&&a.redraw()};p(i,a),e=c(e,!0),n?n.firePointEvent("remove",null,h):h()},remove:function(t,e,i,s){var o=this,n=o.chart;function r(){o.destroy(s),o.remove=null,n.isDirtyLegend=n.isDirtyBox=!0,n.linkSeries(),c(t,!0)&&n.redraw(e)}!1!==i?b(o,"remove",null,r):r()},update:function(e,i){e=t.cleanRecursively(e,this.userOptions),b(this,"update",{options:e});var s,n,r=this,a=r.chart,h=r.userOptions,l=r.initialType||r.type,d=e.type||h.type||a.options.chart.type,p=!(this.hasDerivedData||e.dataGrouping||d&&d!==this.type||void 0!==e.pointStart||e.pointInterval||e.pointIntervalUnit||e.keys),u=S[l].prototype,f=["group","markerGroup","dataLabelsGroup","transformGroup"],g=["eventOptions","navigatorSeries","baseSeries"],m=r.finishedAnimating&&{animation:!1},x={};for(n in p&&(g.push("data","isDirtyData","points","processedXData","processedYData","xIncrement","_hasPointMarkers","_hasPointLabels","mapMap","mapData","minY","maxY","minX","maxX"),!1!==e.visible&&g.push("area","graph"),r.parallelArrays.forEach(function(t){g.push(t+"Data")}),e.data&&(e.dataSorting&&o(r.options.dataSorting,e.dataSorting),this.setData(e.data,!1))),e=M(h,m,{index:void 0===h.index?r.index:h.index,pointStart:c(h.pointStart,r.xData[0])},!p&&{data:r.options.data},e),p&&e.data&&(e.data=r.options.data),(g=f.concat(g)).forEach(function(t){g[t]=r[t],delete r[t]}),r.remove(!1,null,!1,!0),u)r[n]=void 0;if(S[d||l]?o(r,S[d||l].prototype):t.error(17,!0,a,{missingModuleFor:d||l}),g.forEach(function(t){r[t]=g[t]}),r.init(a,e),p&&this.points){if(!1===(s=r.options).visible)x.graphic=1,x.dataLabel=1;else if(!r._hasPointLabels){var v=s.marker,y=s.dataLabels;v&&(!1===v.enabled||"symbol"in v)&&(x.graphic=1),y&&!1===y.enabled&&(x.dataLabel=1)}this.points.forEach(function(t){t&&t.series&&(t.resolveColor(),Object.keys(x).length&&t.destroyElements(x),!1===s.showInLegend&&t.legendItem&&a.legend.destroyItem(t))},this)}e.zIndex!==h.zIndex&&f.forEach(function(t){r[t]&&r[t].attr({zIndex:e.zIndex})}),r.initialType=l,a.linkSeries(),b(this,"afterUpdate"),c(i,!0)&&a.redraw(!!p&&void 0)},setName:function(t){this.name=this.options.name=this.userOptions.name=t,this.chart.isDirtyLegend=!0}}),o(m.prototype,{update:function(t,e){var i=this.chart,s=t&&t.events||{};t=M(this.userOptions,t),i.options[this.coll].indexOf&&(i.options[this.coll][i.options[this.coll].indexOf(this.userOptions)]=t),l(i.options[this.coll].events,function(t,e){void 0===s[e]&&(s[e]=void 0)}),this.destroy(!0),this.init(i,o(t,{events:s})),i.isDirtyBox=!0,c(e,!0)&&i.redraw()},remove:function(t){for(var e=this.chart,i=this.coll,o=this.series,r=o.length;r--;)o[r]&&o[r].remove(!1);s(e.axes,this),s(e[i],this),n(e.options[i])?e.options[i].splice(this.options.index,1):delete e.options[i],e[i].forEach(function(t,e){t.options.index=t.userOptions.index=e}),this.destroy(),e.isDirtyBox=!0,c(t,!0)&&e.redraw()},setTitle:function(t,e){this.update({title:t},e)},setCategories:function(t,e){this.update({categories:t},e)}})}),i(e,"parts/AreaSeries.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.objectEach,s=e.pick,o=t.color,n=t.LegendSymbolMixin,r=t.Series;(0,t.seriesType)("area","line",{softThreshold:!1,threshold:0},{singleStacks:!1,getStackPoints:function(t){var e,o,n=[],r=[],a=this.xAxis,h=this.yAxis,l=h.stacks[this.stackKey],c={},d=this.index,p=h.series,u=p.length,f=s(h.options.reversedStacks,!0)?1:-1;if(t=t||this.points,this.options.stacking){for(o=0;o<t.length;o++)t[o].leftNull=t[o].rightNull=void 0,c[t[o].x]=t[o];i(l,function(t,e){null!==t.total&&r.push(e)}),r.sort(function(t,e){return t-e}),e=p.map(function(t){return t.visible}),r.forEach(function(t,i){var s,p,g=0;if(c[t]&&!c[t].isNull)n.push(c[t]),[-1,1].forEach(function(n){var a=1===n?"rightNull":"leftNull",h=1===n?"rightCliff":"leftCliff",g=0,m=l[r[i+n]];if(m)for(o=d;o>=0&&o<u;)(s=m.points[o])||(o===d?c[t][a]=!0:e[o]&&(p=l[t].points[o])&&(g-=p[1]-p[0])),o+=f;c[t][h]=g});else{for(o=d;o>=0&&o<u;){if(s=l[t].points[o]){g=s[1];break}o+=f}g=h.translate(g,0,1,0,1),n.push({isNull:!0,plotX:a.translate(t,0,0,0,1),x:t,plotY:g,yBottom:g})}})}return n},getGraphPath:function(t){var e,i,o,n,a,h,l,c,d=r.prototype.getGraphPath,p=this.options,u=p.stacking,f=this.yAxis,g=[],m=[],x=this.index,v=f.stacks[this.stackKey],y=p.threshold,b=Math.round(f.getThreshold(p.threshold)),M=s(p.connectNulls,"percent"===u),k=function(e,i,s){var o,n,r=t[e],a=u&&v[r.x].points[x],l=r[s+"Null"]||0,c=r[s+"Cliff"]||0,d=!0;c||l?(o=(l?a[0]:a[1])+c,n=a[0]+c,d=!!l):!u&&t[i]&&t[i].isNull&&(o=n=y),void 0!==o&&(m.push({plotX:h,plotY:null===o?b:f.getThreshold(o),isNull:d,isCliff:!0}),g.push({plotX:h,plotY:null===n?b:f.getThreshold(n),doCurve:!1}))};for(t=t||this.points,u&&(t=this.getStackPoints(t)),n=0;n<t.length;n++)u||(t[n].leftCliff=t[n].rightCliff=t[n].leftNull=t[n].rightNull=void 0),l=t[n].isNull,h=s(t[n].rectPlotX,t[n].plotX),c=s(t[n].yBottom,b),l&&!M||(M||k(n,n-1,"left"),l&&!u&&M||(m.push(t[n]),g.push({x:n,plotX:h,plotY:c})),M||k(n,n+1,"right"));return i=d.call(this,m,!0,!0),g.reversed=!0,(o=d.call(this,g,!0,!0)).length&&(o[0]="L"),a=i.concat(o),e=d.call(this,m,!1,M),a.xMap=i.xMap,this.areaPath=a,e},drawGraph:function(){this.areaPath=[],r.prototype.drawGraph.apply(this);var t=this,e=this.areaPath,i=this.options,n=this.zones,a=[["area","highcharts-area",this.color,i.fillColor]];n.forEach(function(e,s){a.push(["zone-area-"+s,"highcharts-area highcharts-zone-area-"+s+" "+e.className,e.color||t.color,e.fillColor||i.fillColor])}),a.forEach(function(n){var r=n[0],a=t[r],h=a?"animate":"attr",l={};a?(a.endX=t.preventGraphAnimation?null:e.xMap,a.animate({d:e})):(l.zIndex=0,(a=t[r]=t.chart.renderer.path(e).addClass(n[1]).add(t.group)).isArea=!0),t.chart.styledMode||(l.fill=s(n[3],o(n[2]).setOpacity(s(i.fillOpacity,.75)).get())),a[h](l),a.startX=e.xMap,a.shiftUnit=i.step?2:1})},drawLegendSymbol:n.drawRectangle})}),i(e,"parts/SplineSeries.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.pick;(0,t.seriesType)("spline","line",{},{getPointSpline:function(t,e,s){var o,n,r,a,h,l=e.plotX,c=e.plotY,d=t[s-1],p=t[s+1];function u(t){return t&&!t.isNull&&!1!==t.doCurve&&!e.isCliff}if(u(d)&&u(p)){var f=d.plotX,g=d.plotY,m=p.plotX,x=p.plotY,v=0;n=(1.5*c+g)/2.5,a=(1.5*c+x)/2.5,(r=(1.5*l+m)/2.5)!==(o=(1.5*l+f)/2.5)&&(v=(a-n)*(r-l)/(r-o)+c-a),a+=v,(n+=v)>g&&n>c?a=2*c-(n=Math.max(g,c)):n<g&&n<c&&(a=2*c-(n=Math.min(g,c))),a>x&&a>c?n=2*c-(a=Math.max(x,c)):a<x&&a<c&&(n=2*c-(a=Math.min(x,c))),e.rightContX=r,e.rightContY=a}return h=["C",i(d.rightContX,d.plotX),i(d.rightContY,d.plotY),i(o,l),i(n,c),l,c],d.rightContX=d.rightContY=null,h}})}),i(e,"parts/AreaSplineSeries.js",[e["parts/Globals.js"]],function(t){var e=t.seriesTypes.area.prototype,i=t.defaultPlotOptions,s=t.LegendSymbolMixin;(0,t.seriesType)("areaspline","spline",i.area,{getStackPoints:e.getStackPoints,getGraphPath:e.getGraphPath,drawGraph:e.drawGraph,drawLegendSymbol:s.drawRectangle})}),i(e,"parts/ColumnSeries.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.animObject,s=e.clamp,o=e.defined,n=e.extend,r=e.isNumber,a=e.pick,h=t.color,l=t.LegendSymbolMixin,c=t.merge,d=t.noop,p=t.Series,u=t.seriesType,f=t.svg;u("column","line",{borderRadius:0,crisp:!0,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{halo:!1,brightness:.1},select:{color:"#cccccc",borderColor:"#000000"}},dataLabels:{align:null,verticalAlign:null,y:null},softThreshold:!1,startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0,borderColor:"#ffffff"},{cropShoulder:0,directTouch:!0,trackerGroups:["group","dataLabelsGroup"],negStacks:!0,init:function(){p.prototype.init.apply(this,arguments);var t=this,e=t.chart;e.hasRendered&&e.series.forEach(function(e){e.type===t.type&&(e.isDirty=!0)})},getColumnMetrics:function(){var t,e=this,i=e.options,s=e.xAxis,o=e.yAxis,n=s.options.reversedStacks,r=s.reversed&&!n||!s.reversed&&n,h={},l=0;!1===i.grouping?l=1:e.chart.series.forEach(function(i){var s,n=i.yAxis,r=i.options;i.type!==e.type||!i.visible&&e.chart.options.chart.ignoreHiddenSeries||o.len!==n.len||o.pos!==n.pos||(r.stacking?(t=i.stackKey,void 0===h[t]&&(h[t]=l++),s=h[t]):!1!==r.grouping&&(s=l++),i.columnIndex=s)});var c=Math.min(Math.abs(s.transA)*(s.ordinalSlope||i.pointRange||s.closestPointRange||s.tickInterval||1),s.len),d=c*i.groupPadding,p=(c-2*d)/(l||1),u=Math.min(i.maxPointWidth||s.len,a(i.pointWidth,p*(1-2*i.pointPadding))),f=(p-u)/2+(d+((e.columnIndex||0)+(r?1:0))*p-c/2)*(r?-1:1);return e.columnMetrics={width:u,offset:f},e.columnMetrics},crispCol:function(t,e,i,s){var o,n,r=this.chart,a=this.borderWidth,h=-(a%2?.5:0),l=a%2?.5:1;return r.inverted&&r.renderer.isVML&&(l+=1),this.options.crisp&&(i=Math.round(t+i)+h-(t=Math.round(t)+h)),o=Math.round(e+s)+l,n=Math.abs(e)<=.5&&o>.5,s=o-(e=Math.round(e)+l),n&&s&&(e-=1,s+=1),{x:t,y:e,width:i,height:s}},translate:function(){var t=this,e=t.chart,i=t.options,n=t.dense=t.closestPointRange*t.xAxis.transA<2,r=t.borderWidth=a(i.borderWidth,n?0:1),h=t.yAxis,l=i.threshold,c=t.translatedThreshold=h.getThreshold(l),d=a(i.minPointLength,5),u=t.getColumnMetrics(),f=u.width,g=t.barW=Math.max(f,1+2*r),m=t.pointXOffset=u.offset,x=t.dataMin,v=t.dataMax;e.inverted&&(c-=.5),i.pointPadding&&(g=Math.ceil(g)),p.prototype.translate.apply(t),t.points.forEach(function(i){var n,r=a(i.yBottom,c),p=999+Math.abs(r),u=f,y=s(i.plotY,-p,h.len+p),b=i.plotX+m,M=g,k=Math.min(y,r),w=Math.max(y,r)-k;d&&Math.abs(w)<d&&(w=d,n=!h.reversed&&!i.negative||h.reversed&&i.negative,i.y===l&&t.dataMax<=l&&h.min<l&&x!==v&&(n=!n),k=Math.abs(k-c)>d?r-d:c-(n?d:0)),o(i.options.pointWidth)&&(u=M=Math.ceil(i.options.pointWidth),b-=Math.round((u-f)/2)),i.barX=b,i.pointWidth=u,i.tooltipPos=e.inverted?[h.len+h.pos-e.plotLeft-y,t.xAxis.len-b-M/2,w]:[b+M/2,y+h.pos-e.plotTop,w],i.shapeType=t.pointClass.prototype.shapeType||"rect",i.shapeArgs=t.crispCol.apply(t,i.isNull?[b,c,M,0]:[b,k,M,w])})},getSymbol:d,drawLegendSymbol:l.drawRectangle,drawGraph:function(){this.group[this.dense?"addClass":"removeClass"]("highcharts-dense-data")},pointAttribs:function(t,e){var i,s,o,n,r=this.options,l=this.pointAttrToOptions||{},d=l.stroke||"borderColor",p=l["stroke-width"]||"borderWidth",u=t&&t.color||this.color,f=t&&t[d]||r[d]||this.color||u,g=t&&t[p]||r[p]||this[p]||0,m=t&&t.options.dashStyle||r.dashStyle,x=a(t&&t.opacity,r.opacity,1);return t&&this.zones.length&&(o=t.getZone(),u=t.options.color||o&&(o.color||t.nonZonedColor)||this.color,o&&(f=o.borderColor||f,m=o.dashStyle||m,g=o.borderWidth||g)),e&&t&&(n=(i=c(r.states[e],t.options.states&&t.options.states[e]||{})).brightness,u=i.color||void 0!==n&&h(u).brighten(i.brightness).get()||u,f=i[d]||f,g=i[p]||g,m=i.dashStyle||m,x=a(i.opacity,x)),s={fill:u,stroke:f,"stroke-width":g,opacity:x},m&&(s.dashstyle=m),s},drawPoints:function(){var t,e=this,i=this.chart,s=e.options,o=i.renderer,n=s.animationLimit||250;e.points.forEach(function(a){var h=a.plotY,l=a.graphic,d=!!l,p=l&&i.pointCount<n?"animate":"attr";r(h)&&null!==a.y?(t=a.shapeArgs,l&&a.hasNewShapeType()&&(l=l.destroy()),e.enabledDataSorting&&(a.startXPos=e.xAxis.reversed?-(t?t.width:0):e.xAxis.width),l||(a.graphic=l=o[a.shapeType](t).add(a.group||e.group),l&&e.enabledDataSorting&&i.hasRendered&&i.pointCount<n&&(l.attr({x:a.startXPos}),d=!0,p="animate")),l&&d&&l[p](c(t)),s.borderRadius&&l[p]({r:s.borderRadius}),i.styledMode||l[p](e.pointAttribs(a,a.selected&&"select")).shadow(!1!==a.allowShadow&&s.shadow,null,s.stacking&&!s.borderRadius),l.addClass(a.getClassName(),!0)):l&&(a.graphic=l.destroy())})},animate:function(t){var e,o,r=this,a=this.yAxis,h=r.options,l=this.chart.inverted,c={},d=l?"translateX":"translateY";f&&(t?(c.scaleY=.001,o=s(a.toPixels(h.threshold),a.pos,a.pos+a.len),l?c.translateX=o-a.len:c.translateY=o,r.clipBox&&r.setClip(),r.group.attr(c)):(e=r.group.attr(d),r.group.animate({scaleY:1},n(i(r.options.animation),{step:function(t,i){c[d]=e+i.pos*(a.pos-e),r.group.attr(c)}})),r.animate=null))},remove:function(){var t=this,e=t.chart;e.hasRendered&&e.series.forEach(function(e){e.type===t.type&&(e.isDirty=!0)}),p.prototype.remove.apply(t,arguments)}})}),i(e,"parts/BarSeries.js",[e["parts/Globals.js"]],function(t){(0,t.seriesType)("bar","column",null,{inverted:!0})}),i(e,"parts/ScatterSeries.js",[e["parts/Globals.js"]],function(t){var e=t.Series;(0,t.seriesType)("scatter","line",{lineWidth:0,findNearestPointBy:"xy",jitter:{x:0,y:0},marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}"></span> <span style="font-size: 10px"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}},{sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"],takeOrdinalPosition:!1,drawGraph:function(){this.options.lineWidth&&e.prototype.drawGraph.call(this)},applyJitter:function(){var t=this,e=this.options.jitter,i=this.points.length;e&&this.points.forEach(function(s,o){["x","y"].forEach(function(n,r){var a,h,l,c,d,p,u="plot"+n.toUpperCase();e[n]&&!s.isNull&&(a=t[n+"Axis"],c=e[n]*a.transA,a&&!a.isLog&&(h=Math.max(0,s[u]-c),l=Math.min(a.len,s[u]+c),s[u]=h+(l-h)*(d=o+r*i,(p=1e4*Math.sin(d))-Math.floor(p)),"x"===n&&(s.clientX=s.plotX)))})})}}),t.addEvent(e,"afterTranslate",function(){this.applyJitter&&this.applyJitter()})}),i(e,"mixins/centered-series.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.isNumber,s=e.pick,o=e.relativeLength,n=t.deg2rad;t.CenteredSeriesMixin={getCenter:function(){var t,e,i,n=this.options,r=this.chart,a=2*(n.slicedOffset||0),h=r.plotWidth-2*a,l=r.plotHeight-2*a,c=n.center,d=[s(c[0],"50%"),s(c[1],"50%"),n.size||"100%",n.innerSize||0],p=Math.min(h,l);for(e=0;e<4;++e)i=d[e],t=e<2||2===e&&/%$/.test(i),d[e]=o(i,[h,l,p,d[2]][e])+(t?a:0);return d[3]>d[2]&&(d[3]=d[2]),d},getStartAndEndRadians:function(t,e){var s=i(t)?t:0,o=i(e)&&e>s&&e-s<360?e:s+360;return{start:n*(s+-90),end:n*(o+-90)}}}}),i(e,"parts/PieSeries.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.clamp,s=e.defined,o=e.isNumber,n=e.pick,r=e.relativeLength,a=e.setAnimation,h=t.addEvent,l=t.CenteredSeriesMixin,c=l.getStartAndEndRadians,d=t.LegendSymbolMixin,p=t.merge,u=t.noop,f=t.Point,g=t.Series,m=t.seriesType,x=t.seriesTypes,v=t.fireEvent;m("pie","line",{center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{allowOverlap:!0,connectorPadding:5,connectorShape:"fixedOffset",crookDistance:"70%",distance:30,enabled:!0,formatter:function(){return this.point.isNull?void 0:this.point.name},softConnector:!0,x:0},fillColor:void 0,ignoreHiddenPoint:!0,inactiveOtherPoints:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,stickyTracking:!1,tooltip:{followPointer:!0},borderColor:"#ffffff",borderWidth:1,lineWidth:void 0,states:{hover:{brightness:.1}}},{isCartesian:!1,requireSorting:!1,directTouch:!0,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],axisTypes:[],pointAttribs:x.column.prototype.pointAttribs,animate:function(t){var e=this,i=e.points,s=e.startAngleRad;t||(i.forEach(function(t){var i=t.graphic,o=t.shapeArgs;i&&o&&(i.attr({r:n(t.startR,e.center&&e.center[3]/2),start:s,end:s}),i.animate({r:o.r,start:o.start,end:o.end},e.options.animation))}),e.animate=null)},hasData:function(){return!!this.processedXData.length},updateTotals:function(){var t,e,i=0,s=this.points,o=s.length,n=this.options.ignoreHiddenPoint;for(t=0;t<o;t++)e=s[t],i+=n&&!e.visible?0:e.isNull?0:e.y;for(this.total=i,t=0;t<o;t++)(e=s[t]).percentage=i>0&&(e.visible||!n)?e.y/i*100:0,e.total=i},generatePoints:function(){g.prototype.generatePoints.call(this),this.updateTotals()},getX:function(t,e,s){var o,n=this.center,r=this.radii?this.radii[s.index]:n[2]/2;return o=Math.asin(i((t-n[1])/(r+s.labelDistance),-1,1)),n[0]+(e?-1:1)*(Math.cos(o)*(r+s.labelDistance))+(s.labelDistance>0?(e?-1:1)*this.options.dataLabels.padding:0)},translate:function(t){this.generatePoints();var e,i,s,o,a,h,l,d,p=0,u=this.options,f=u.slicedOffset,g=f+(u.borderWidth||0),m=c(u.startAngle,u.endAngle),x=this.startAngleRad=m.start,y=(this.endAngleRad=m.end)-x,b=this.points,M=u.dataLabels.distance,k=u.ignoreHiddenPoint,w=b.length;for(t||(this.center=t=this.getCenter()),l=0;l<w;l++)d=b[l],i=x+p*y,k&&!d.visible||(p+=d.percentage/100),s=x+p*y,d.shapeType="arc",d.shapeArgs={x:t[0],y:t[1],r:t[2]/2,innerR:t[3]/2,start:Math.round(1e3*i)/1e3,end:Math.round(1e3*s)/1e3},d.labelDistance=n(d.options.dataLabels&&d.options.dataLabels.distance,M),d.labelDistance=r(d.labelDistance,d.shapeArgs.r),this.maxLabelDistance=Math.max(this.maxLabelDistance||0,d.labelDistance),(o=(s+i)/2)>1.5*Math.PI?o-=2*Math.PI:o<-Math.PI/2&&(o+=2*Math.PI),d.slicedTranslation={translateX:Math.round(Math.cos(o)*f),translateY:Math.round(Math.sin(o)*f)},a=Math.cos(o)*t[2]/2,h=Math.sin(o)*t[2]/2,d.tooltipPos=[t[0]+.7*a,t[1]+.7*h],d.half=o<-Math.PI/2||o>Math.PI/2?1:0,d.angle=o,e=Math.min(g,d.labelDistance/5),d.labelPosition={natural:{x:t[0]+a+Math.cos(o)*d.labelDistance,y:t[1]+h+Math.sin(o)*d.labelDistance},final:{},alignment:d.labelDistance<0?"center":d.half?"right":"left",connectorPosition:{breakAt:{x:t[0]+a+Math.cos(o)*e,y:t[1]+h+Math.sin(o)*e},touchingSliceAt:{x:t[0]+a,y:t[1]+h}}};v(this,"afterTranslate")},drawEmpty:function(){var t,e,i=this.options;0===this.total?(t=this.center[0],e=this.center[1],this.graph||(this.graph=this.chart.renderer.circle(t,e,0).addClass("highcharts-graph").add(this.group)),this.graph.animate({"stroke-width":i.borderWidth,cx:t,cy:e,r:this.center[2]/2,fill:i.fillColor||"none",stroke:i.color||"#cccccc"})):this.graph&&(this.graph=this.graph.destroy())},redrawPoints:function(){var t,e,i,s,o=this,n=o.chart,r=n.renderer,a=o.options.shadow;this.drawEmpty(),!a||o.shadowGroup||n.styledMode||(o.shadowGroup=r.g("shadow").attr({zIndex:-1}).add(o.group)),o.points.forEach(function(h){var l={};if(e=h.graphic,!h.isNull&&e){if(s=h.shapeArgs,t=h.getTranslate(),!n.styledMode){var c=h.shadowGroup;a&&!c&&(c=h.shadowGroup=r.g("shadow").add(o.shadowGroup)),c&&c.attr(t),i=o.pointAttribs(h,h.selected&&"select")}h.delayedRendering?(e.setRadialReference(o.center).attr(s).attr(t),n.styledMode||e.attr(i).attr({"stroke-linejoin":"round"}).shadow(a,c),h.delayedRendering=!1):(e.setRadialReference(o.center),n.styledMode||p(!0,l,i),p(!0,l,s,t),e.animate(l)),e.attr({visibility:h.visible?"inherit":"hidden"}),e.addClass(h.getClassName())}else e&&(h.graphic=e.destroy())})},drawPoints:function(){var t=this.chart.renderer;this.points.forEach(function(e){e.graphic||(e.graphic=t[e.shapeType](e.shapeArgs).add(e.series.group),e.delayedRendering=!0)})},searchPoint:u,sortByAngle:function(t,e){t.sort(function(t,i){return void 0!==t.angle&&(i.angle-t.angle)*e})},drawLegendSymbol:d.drawRectangle,getCenter:l.getCenter,getSymbol:u,drawGraph:null},{init:function(){f.prototype.init.apply(this,arguments);var t,e=this;return e.name=n(e.name,"Slice"),h(e,"select",t=function(t){e.slice("select"===t.type)}),h(e,"unselect",t),e},isValid:function(){return o(this.y)&&this.y>=0},setVisible:function(t,e){var i=this,s=i.series,o=s.chart,r=s.options.ignoreHiddenPoint;e=n(e,r),t!==i.visible&&(i.visible=i.options.visible=t=void 0===t?!i.visible:t,s.options.data[s.data.indexOf(i)]=i.options,["graphic","dataLabel","connector","shadowGroup"].forEach(function(e){i[e]&&i[e][t?"show":"hide"](!0)}),i.legendItem&&o.legend.colorizeItem(i,t),t||"hover"!==i.state||i.setState(""),r&&(s.isDirty=!0),e&&o.redraw())},slice:function(t,e,i){var o=this.series,r=o.chart;a(i,r),e=n(e,!0),this.sliced=this.options.sliced=t=s(t)?t:!this.sliced,o.options.data[o.data.indexOf(this)]=this.options,this.graphic.animate(this.getTranslate()),this.shadowGroup&&this.shadowGroup.animate(this.getTranslate())},getTranslate:function(){return this.sliced?this.slicedTranslation:{translateX:0,translateY:0}},haloPath:function(t){var e=this.shapeArgs;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(e.x,e.y,e.r+t,e.r+t,{innerR:e.r-1,start:e.start,end:e.end})},connectorShapes:{fixedOffset:function(t,e,i){var s=e.breakAt,o=e.touchingSliceAt,n=i.softConnector?["C",t.x+("left"===t.alignment?-5:5),t.y,2*s.x-o.x,2*s.y-o.y,s.x,s.y]:["L",s.x,s.y];return["M",t.x,t.y].concat(n).concat(["L",o.x,o.y])},straight:function(t,e){var i=e.touchingSliceAt;return["M",t.x,t.y,"L",i.x,i.y]},crookedLine:function(t,e,i){var s=e.touchingSliceAt,o=this.series,n=o.center[0],a=o.chart.plotWidth,h=o.chart.plotLeft,l=t.alignment,c=this.shapeArgs.r,d=r(i.crookDistance,1),p="left"===l?n+c+(a+h-n-c)*(1-d):h+(n-c)*d,u=["L",p,t.y];return("left"===l?p>t.x||p<s.x:p<t.x||p>s.x)&&(u=[]),["M",t.x,t.y].concat(u).concat(["L",s.x,s.y])}},getConnectorPath:function(){var t=this.labelPosition,e=this.series.options.dataLabels,i=e.connectorShape,s=this.connectorShapes;return s[i]&&(i=s[i]),i.call(this,{x:t.final.x,y:t.final.y,alignment:t.alignment},t.connectorPosition,e)}})}),i(e,"parts/DataLabels.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.animObject,s=e.arrayMax,o=e.clamp,n=e.defined,r=e.extend,a=e.isArray,h=e.objectEach,l=e.pick,c=e.relativeLength,d=e.splat,p=t.format,u=t.merge,f=t.noop,g=t.Series,m=t.seriesTypes,x=t.stableSort;t.distribute=function(e,i,s){var n,r,a,h=!0,c=e,d=[],p=0,u=c.reducedLen||i;function f(t,e){return t.target-e.target}for(n=e.length;n--;)p+=e[n].size;if(p>u){for(x(e,function(t,e){return(e.rank||0)-(t.rank||0)}),n=0,p=0;p<=u;)p+=e[n].size,n++;d=e.splice(n-1,e.length)}for(x(e,f),e=e.map(function(t){return{size:t.size,targets:[t.target],align:l(t.align,.5)}});h;){for(n=e.length;n--;)r=e[n],a=(Math.min.apply(0,r.targets)+Math.max.apply(0,r.targets))/2,r.pos=o(a-r.size*r.align,0,i-r.size);for(n=e.length,h=!1;n--;)n>0&&e[n-1].pos+e[n-1].size>e[n].pos&&(e[n-1].size+=e[n].size,e[n-1].targets=e[n-1].targets.concat(e[n].targets),e[n-1].align=.5,e[n-1].pos+e[n-1].size>i&&(e[n-1].pos=i-e[n-1].size),e.splice(n,1),h=!0)}c.push.apply(c,d),n=0,e.some(function(e){var o=0;if(e.targets.some(function(){if(c[n].pos=e.pos+o,Math.abs(c[n].pos-c[n].target)>s)return c.slice(0,n+1).forEach(function(t){delete t.pos}),c.reducedLen=(c.reducedLen||i)-.1*i,c.reducedLen>.1*i&&t.distribute(c,i,s),!0;o+=c[n].size,n++}))return!0}),x(c,f)},g.prototype.drawDataLabels=function(){var e,s=this,o=s.chart,r=s.options,c=r.dataLabels,f=s.points,g=s.hasRendered||0,m=i(r.animation).duration,x=Math.min(m,200),v=!o.renderer.forExport&&l(c.defer,x>0),y=o.renderer;function b(t,e){var i,s=[];if(a(t)&&!a(e))s=t.map(function(t){return u(t,e)});else if(a(e)&&!a(t))s=e.map(function(e){return u(t,e)});else if(a(t)||a(e))for(i=Math.max(t.length,e.length);i--;)s[i]=u(t[i],e[i]);else s=u(t,e);return s}c=b(b(o.options.plotOptions&&o.options.plotOptions.series&&o.options.plotOptions.series.dataLabels,o.options.plotOptions&&o.options.plotOptions[s.type]&&o.options.plotOptions[s.type].dataLabels),c),t.fireEvent(this,"drawDataLabels"),(a(c)||c.enabled||s._hasPointLabels)&&(e=s.plotGroup("dataLabelsGroup","data-labels",v&&!g?"hidden":"inherit",c.zIndex||6),v&&(e.attr({opacity:+g}),g||setTimeout(function(){var t=s.dataLabelsGroup;t&&(s.visible&&e.show(!0),t[r.animation?"animate":"attr"]({opacity:1},{duration:x}))},m-x)),f.forEach(function(t){d(b(c,t.dlOptions||t.options&&t.options.dataLabels)).forEach(function(i,a){var c,d,u,f,g,m,x=i.enabled&&(!t.isNull||t.dataLabelOnNull)&&function(t,e){var i,s,o,n=e.filter;return!n||(i=n.operator,s=t[n.property],o=n.value,">"===i&&s>o||"<"===i&&s<o||">="===i&&s>=o||"<="===i&&s<=o||"=="===i&&s==o||"==="===i&&s===o)}(t,i),v=t.dataLabels?t.dataLabels[a]:t.dataLabel,b=t.connectors?t.connectors[a]:t.connector,M=l(i.distance,t.labelDistance),k=!v;x&&(c=t.getLabelConfig(),d=l(i[t.formatPrefix+"Format"],i.format),u=n(d)?p(d,c,o):(i[t.formatPrefix+"Formatter"]||i.formatter).call(c,i),f=i.style,g=i.rotation,o.styledMode||(f.color=l(i.color,f.color,s.color,"#000000"),"contrast"===f.color?(t.contrastColor=y.getContrast(t.color||s.color),f.color=!n(M)&&i.inside||M<0||r.stacking?t.contrastColor:"#000000"):delete t.contrastColor,r.cursor&&(f.cursor=r.cursor)),m={r:i.borderRadius||0,rotation:g,padding:i.padding,zIndex:1},o.styledMode||(m.fill=i.backgroundColor,m.stroke=i.borderColor,m["stroke-width"]=i.borderWidth),h(m,function(t,e){void 0===t&&delete m[e]})),!v||x&&n(u)?x&&n(u)&&(v?m.text=u:(t.dataLabels=t.dataLabels||[],v=t.dataLabels[a]=g?y.text(u,0,-9999).addClass("highcharts-data-label"):y.label(u,0,-9999,i.shape,null,null,i.useHTML,null,"data-label"),a||(t.dataLabel=v),v.addClass(" highcharts-data-label-color-"+t.colorIndex+" "+(i.className||"")+(i.useHTML?" highcharts-tracker":""))),v.options=i,v.attr(m),o.styledMode||v.css(f).shadow(i.shadow),v.added||v.add(e),i.textPath&&!i.useHTML&&(v.setTextPath(t.getDataLabelPath&&t.getDataLabelPath(v)||t.graphic,i.textPath),t.dataLabelPath&&!i.textPath.enabled&&(t.dataLabelPath=t.dataLabelPath.destroy())),s.alignDataLabel(t,v,i,null,k)):(t.dataLabel=t.dataLabel&&t.dataLabel.destroy(),t.dataLabels&&(1===t.dataLabels.length?delete t.dataLabels:delete t.dataLabels[a]),a||delete t.dataLabel,b&&(t.connector=t.connector.destroy(),t.connectors&&(1===t.connectors.length?delete t.connectors:delete t.connectors[a])))})})),t.fireEvent(this,"afterDrawDataLabels")},g.prototype.alignDataLabel=function(t,e,i,s,o){var n,a,h,c,d,p=this,u=this.chart,f=this.isCartesian&&u.inverted,g=this.enabledDataSorting,m=l(t.dlBox&&t.dlBox.centerX,t.plotX,-9999),x=l(t.plotY,-9999),v=e.getBBox(),y=i.rotation,b=i.align,M=u.isInsidePlot(m,Math.round(x),f),k="justify"===l(i.overflow,g?"none":"justify"),w=this.visible&&(t.series.forceDL||g&&!k||M||s&&u.isInsidePlot(m,f?s.x+1:s.y+s.height-1,f)),S=function(i){g&&p.xAxis&&!k&&p.setDataLabelStartPos(t,e,o,M,i)};w&&(n=u.renderer.fontMetrics(u.styledMode?void 0:i.style.fontSize,e).b,s=r({x:f?this.yAxis.len-x:m,y:Math.round(f?this.xAxis.len-m:x),width:0,height:0},s),r(i,{width:v.width,height:v.height}),y?(k=!1,c=u.renderer.rotCorr(n,y),S(d={x:s.x+i.x+s.width/2+c.x,y:s.y+i.y+{top:0,middle:.5,bottom:1}[i.verticalAlign]*s.height}),e[o?"attr":"animate"](d).attr({align:b}),h=(a=(y+720)%360)>180&&a<360,"left"===b?d.y-=h?v.height:0:"center"===b?(d.x-=v.width/2,d.y-=v.height/2):"right"===b&&(d.x-=v.width,d.y-=h?0:v.height),e.placed=!0,e.alignAttr=d):(S(s),e.align(i,null,s),d=e.alignAttr),k&&s.height>=0?this.justifyDataLabel(e,i,d,v,s,o):l(i.crop,!0)&&(w=u.isInsidePlot(d.x,d.y)&&u.isInsidePlot(d.x+v.width,d.y+v.height)),i.shape&&!y&&e[o?"attr":"animate"]({anchorX:f?u.plotWidth-t.plotY:t.plotX,anchorY:f?u.plotHeight-t.plotX:t.plotY})),o&&g&&(e.placed=!1),w||g&&!k||(e.hide(!0),e.placed=!1)},g.prototype.setDataLabelStartPos=function(t,e,i,s,o){var n,r,a=this.chart,h=a.inverted,l=this.xAxis,c=l.reversed,d=h?e.height/2:e.width/2,p=t.pointWidth,u=p?p/2:0;n=h?o.x:c?-d-u:l.width-d+u,r=h?c?this.yAxis.height-d+u:-d-u:o.y,e.startXPos=n,e.startYPos=r,s?"hidden"===e.visibility&&(e.show(),e.attr({opacity:0}).animate({opacity:1})):e.attr({opacity:1}).animate({opacity:0},void 0,e.hide),a.hasRendered&&(i&&e.attr({x:e.startXPos,y:e.startYPos}),e.placed=!0)},g.prototype.justifyDataLabel=function(t,e,i,s,o,n){var r,a,h=this.chart,l=e.align,c=e.verticalAlign,d=t.box?0:t.padding||0;return(r=i.x+d)<0&&("right"===l?(e.align="left",e.inside=!0):e.x=-r,a=!0),(r=i.x+s.width-d)>h.plotWidth&&("left"===l?(e.align="right",e.inside=!0):e.x=h.plotWidth-r,a=!0),(r=i.y+d)<0&&("bottom"===c?(e.verticalAlign="top",e.inside=!0):e.y=-r,a=!0),(r=i.y+s.height-d)>h.plotHeight&&("top"===c?(e.verticalAlign="bottom",e.inside=!0):e.y=h.plotHeight-r,a=!0),a&&(t.placed=!n,t.align(e,null,o)),a},m.pie&&(m.pie.prototype.dataLabelPositioners={radialDistributionY:function(t){return t.top+t.distributeBox.pos},radialDistributionX:function(t,e,i,s){return t.getX(i<e.top+2||i>e.bottom-2?s:i,e.half,e)},justify:function(t,e,i){return i[0]+(t.half?-1:1)*(e+t.labelDistance)},alignToPlotEdges:function(t,e,i,s){var o=t.getBBox().width;return e?o+s:i-o-s},alignToConnectors:function(t,e,i,s){var o,n=0;return t.forEach(function(t){(o=t.dataLabel.getBBox().width)>n&&(n=o)}),e?n+s:i-n-s}},m.pie.prototype.drawDataLabels=function(){var e,i,o,r,a,h,c,d,p,f,m,x,v=this,y=v.data,b=v.chart,M=v.options.dataLabels,k=M.connectorPadding,w=b.plotWidth,S=b.plotHeight,A=b.plotLeft,T=Math.round(b.chartWidth/3),P=v.center,L=P[2]/2,C=P[1],E=[[],[]],O=[0,0,0,0],D=v.dataLabelPositioners;v.visible&&(M.enabled||v._hasPointLabels)&&(y.forEach(function(t){t.dataLabel&&t.visible&&t.dataLabel.shortened&&(t.dataLabel.attr({width:"auto"}).css({width:"auto",textOverflow:"clip"}),t.dataLabel.shortened=!1)}),g.prototype.drawDataLabels.apply(v),y.forEach(function(t){t.dataLabel&&(t.visible?(E[t.half].push(t),t.dataLabel._pos=null,n(M.style.width)||n(t.options.dataLabels&&t.options.dataLabels.style&&t.options.dataLabels.style.width)||t.dataLabel.getBBox().width>T&&(t.dataLabel.css({width:.7*T}),t.dataLabel.shortened=!0)):(t.dataLabel=t.dataLabel.destroy(),t.dataLabels&&1===t.dataLabels.length&&delete t.dataLabels))}),E.forEach(function(i,s){var o,u,g,x,y,T,E=i.length,B=[];if(E)for(v.sortByAngle(i,s-.5),v.maxLabelDistance>0&&(o=Math.max(0,C-L-v.maxLabelDistance),u=Math.min(C+L+v.maxLabelDistance,b.plotHeight),i.forEach(function(t){t.labelDistance>0&&t.dataLabel&&(t.top=Math.max(0,C-L-t.labelDistance),t.bottom=Math.min(C+L+t.labelDistance,b.plotHeight),y=t.dataLabel.getBBox().height||21,t.distributeBox={target:t.labelPosition.natural.y-t.top+y/2,size:y,rank:t.y},B.push(t.distributeBox))}),T=u+y-o,t.distribute(B,T,T/5)),m=0;m<E;m++){if(e=i[m],h=e.labelPosition,r=e.dataLabel,f=!1===e.visible?"hidden":"inherit",g=h.natural.y,p=g,B&&n(e.distributeBox)&&(void 0===e.distributeBox.pos?f="hidden":(c=e.distributeBox.size,p=D.radialDistributionY(e))),delete e.positionIndex,M.justify)d=D.justify(e,L,P);else switch(M.alignTo){case"connectors":d=D.alignToConnectors(i,s,w,A);break;case"plotEdges":d=D.alignToPlotEdges(r,s,w,A);break;default:d=D.radialDistributionX(v,e,p,g)}r._attr={visibility:f,align:h.alignment},r._pos={x:d+M.x+({left:k,right:-k}[h.alignment]||0),y:p+M.y-10},h.final.x=d,h.final.y=p,l(M.crop,!0)&&(a=r.getBBox().width,x=null,d-a<k&&1===s?(x=Math.round(a-d+k),O[3]=Math.max(x,O[3])):d+a>w-k&&0===s&&(x=Math.round(d+a-w+k),O[1]=Math.max(x,O[1])),p-c/2<0?O[0]=Math.max(Math.round(c/2-p),O[0]):p+c/2>S&&(O[2]=Math.max(Math.round(p+c/2-S),O[2])),r.sideOverflow=x)}}),(0===s(O)||this.verifyDataLabelOverflow(O))&&(this.placeDataLabels(),this.points.forEach(function(t){var e;(x=u(M,t.options.dataLabels),i=l(x.connectorWidth,1))&&(o=t.connector,(r=t.dataLabel)&&r._pos&&t.visible&&t.labelDistance>0?(f=r._attr.visibility,(e=!o)&&(t.connector=o=b.renderer.path().addClass("highcharts-data-label-connector  highcharts-color-"+t.colorIndex+(t.className?" "+t.className:"")).add(v.dataLabelsGroup),b.styledMode||o.attr({"stroke-width":i,stroke:x.connectorColor||t.color||"#666666"})),o[e?"attr":"animate"]({d:t.getConnectorPath()}),o.attr("visibility",f)):o&&(t.connector=o.destroy()))})))},m.pie.prototype.placeDataLabels=function(){this.points.forEach(function(t){var e,i=t.dataLabel;i&&t.visible&&((e=i._pos)?(i.sideOverflow&&(i._attr.width=Math.max(i.getBBox().width-i.sideOverflow,0),i.css({width:i._attr.width+"px",textOverflow:(this.options.dataLabels.style||{}).textOverflow||"ellipsis"}),i.shortened=!0),i.attr(i._attr),i[i.moved?"animate":"attr"](e),i.moved=!0):i&&i.attr({y:-9999})),delete t.distributeBox},this)},m.pie.prototype.alignDataLabel=f,m.pie.prototype.verifyDataLabelOverflow=function(t){var e=this.center,i=this.options,s=i.center,n=i.minSize||80,r=n,a=null!==i.size;return a||(null!==s[0]?r=Math.max(e[2]-Math.max(t[1],t[3]),n):(r=Math.max(e[2]-t[1]-t[3],n),e[0]+=(t[3]-t[1])/2),null!==s[1]?r=o(r,n,e[2]-Math.max(t[0],t[2])):(r=o(r,n,e[2]-t[0]-t[2]),e[1]+=(t[0]-t[2])/2),r<e[2]?(e[2]=r,e[3]=Math.min(c(i.innerSize||0,r),r),this.translate(e),this.drawDataLabels&&this.drawDataLabels()):a=!0),a}),m.column&&(m.column.prototype.alignDataLabel=function(t,e,i,s,o){var n,r=this.chart.inverted,a=t.series,h=t.dlBox||t.shapeArgs,c=l(t.below,t.plotY>l(this.translatedThreshold,a.yAxis.len)),d=l(i.inside,!!this.options.stacking);h&&((s=u(h)).y<0&&(s.height+=s.y,s.y=0),(n=s.y+s.height-a.yAxis.len)>0&&(s.height-=n),r&&(s={x:a.yAxis.len-s.y-s.height,y:a.xAxis.len-s.x-s.width,width:s.height,height:s.width}),d||(r?(s.x+=c?0:s.width,s.width=0):(s.y+=c?s.height:0,s.height=0))),i.align=l(i.align,!r||d?"center":c?"right":"left"),i.verticalAlign=l(i.verticalAlign,r||d?"middle":c?"top":"bottom"),g.prototype.alignDataLabel.call(this,t,e,i,s,o),s&&(s.height<=0&&s.y===this.chart.plotHeight||s.width<=0&&0===s.x)&&(e.hide(!0),e.placed=!1),i.inside&&t.contrastColor&&e.css({color:t.contrastColor})})}),i(e,"modules/overlapping-datalabels.src.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.isArray,s=e.objectEach,o=e.pick,n=t.Chart,r=t.addEvent,a=t.fireEvent;r(n,"render",function(){var t=[];(this.labelCollectors||[]).forEach(function(e){t=t.concat(e())}),(this.yAxis||[]).forEach(function(e){e.options.stackLabels&&!e.options.stackLabels.allowOverlap&&s(e.stacks,function(e){s(e,function(e){t.push(e.label)})})}),(this.series||[]).forEach(function(e){var s=e.options.dataLabels;e.visible&&(!1!==s.enabled||e._hasPointLabels)&&e.points.forEach(function(e){e.visible&&(i(e.dataLabels)?e.dataLabels:e.dataLabel?[e.dataLabel]:[]).forEach(function(i){var s=i.options;i.labelrank=o(s.labelrank,e.labelrank,e.shapeArgs&&e.shapeArgs.height),s.allowOverlap||t.push(i)})})}),this.hideOverlappingLabels(t)}),n.prototype.hideOverlappingLabels=function(t){var e,i,s,o,n,r,h,l=this,c=t.length,d=l.renderer,p=!1,u=function(t,e){return!(e.x>t.x+t.width||e.x+e.width<t.x||e.y>t.y+t.height||e.y+e.height<t.y)},f=function(t){var e,i,s,o=t.box?0:t.padding||0,n=0;if(t&&(!t.alignAttr||t.placed))return e=t.alignAttr||{x:t.attr("x"),y:t.attr("y")},i=t.parentGroup,t.width||(s=t.getBBox(),t.width=s.width,t.height=s.height,n=d.fontMetrics(null,t.element).h),{x:e.x+(i.translateX||0)+o,y:e.y+(i.translateY||0)+o-n,width:t.width-2*o,height:t.height-2*o}};for(i=0;i<c;i++)(e=t[i])&&(e.oldOpacity=e.opacity,e.newOpacity=1,e.absoluteBox=f(e));for(t.sort(function(t,e){return(e.labelrank||0)-(t.labelrank||0)}),i=0;i<c;i++)for(r=(o=t[i])&&o.absoluteBox,s=i+1;s<c;++s)h=(n=t[s])&&n.absoluteBox,r&&h&&o!==n&&0!==o.newOpacity&&0!==n.newOpacity&&u(r,h)&&((o.labelrank<n.labelrank?o:n).newOpacity=0);t.forEach(function(t){var e,i;t&&(i=t.newOpacity,t.oldOpacity!==i&&(t.alignAttr&&t.placed?(i?t.show(!0):e=function(){t.hide(!0),t.placed=!1},p=!0,t.alignAttr.opacity=i,t[t.isOld?"animate":"attr"](t.alignAttr,null,e),a(l,"afterHideOverlappingLabel")):t.attr({opacity:i})),t.isOld=!0)}),p&&a(l,"afterHideAllOverlappingLabels")}}),i(e,"parts/Interaction.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i,s=e.defined,o=e.extend,n=e.isArray,r=e.isObject,a=e.objectEach,h=e.pick,l=t.addEvent,c=t.Chart,d=t.createElement,p=t.css,u=t.defaultOptions,f=t.defaultPlotOptions,g=t.fireEvent,m=t.hasTouch,x=t.Legend,v=t.merge,y=t.Point,b=t.Series,M=t.seriesTypes,k=t.svg;i=t.TrackerMixin={drawTrackerPoint:function(){var t,e=this,i=e.chart,s=i.pointer,o=function(t){var e=s.getPointFromEvent(t);void 0!==e&&(s.isDirectTouch=!0,e.onMouseOver(t))};e.points.forEach(function(e){t=n(e.dataLabels)?e.dataLabels:e.dataLabel?[e.dataLabel]:[],e.graphic&&(e.graphic.element.point=e),t.forEach(function(t){t.div?t.div.point=e:t.element.point=e})}),e._hasTracking||(e.trackerGroups.forEach(function(t){e[t]&&(e[t].addClass("highcharts-tracker").on("mouseover",o).on("mouseout",function(t){s.onTrackerMouseOut(t)}),m&&e[t].on("touchstart",o),!i.styledMode&&e.options.cursor&&e[t].css(p).css({cursor:e.options.cursor}))}),e._hasTracking=!0),g(this,"afterDrawTracker")},drawTrackerGraph:function(){var t,e=this,i=e.options,s=i.trackByArea,o=[].concat(s?e.areaPath:e.graphPath),n=o.length,r=e.chart,a=r.pointer,h=r.renderer,l=r.options.tooltip.snap,c=e.tracker,d=function(){r.hoverSeries!==e&&e.onMouseOver()},p="rgba(192,192,192,"+(k?1e-4:.002)+")";if(n&&!s)for(t=n+1;t--;)"M"===o[t]&&o.splice(t+1,0,o[t+1]-l,o[t+2],"L"),(t&&"M"===o[t]||t===n)&&o.splice(t,0,"L",o[t-2]+l,o[t-1]);c?c.attr({d:o}):e.graph&&(e.tracker=h.path(o).attr({visibility:e.visible?"visible":"hidden",zIndex:2}).addClass(s?"highcharts-tracker-area":"highcharts-tracker-line").add(e.group),r.styledMode||e.tracker.attr({"stroke-linejoin":"round",stroke:p,fill:s?p:"none","stroke-width":e.graph.strokeWidth()+(s?0:2*l)}),[e.tracker,e.markerGroup].forEach(function(t){t.addClass("highcharts-tracker").on("mouseover",d).on("mouseout",function(t){a.onTrackerMouseOut(t)}),i.cursor&&!r.styledMode&&t.css({cursor:i.cursor}),m&&t.on("touchstart",d)})),g(this,"afterDrawTracker")}},M.column&&(M.column.prototype.drawTracker=i.drawTrackerPoint),M.pie&&(M.pie.prototype.drawTracker=i.drawTrackerPoint),M.scatter&&(M.scatter.prototype.drawTracker=i.drawTrackerPoint),o(x.prototype,{setItemEvents:function(t,e,i){var s=this,o=s.chart.renderer.boxWrapper,n=t instanceof y,r="highcharts-legend-"+(n?"point":"series")+"-active",a=s.chart.styledMode;(i?e:t.legendGroup).on("mouseover",function(){t.visible&&s.allItems.forEach(function(e){t!==e&&e.setState("inactive",!n)}),t.setState("hover"),t.visible&&o.addClass(r),a||e.css(s.options.itemHoverStyle)}).on("mouseout",function(){s.chart.styledMode||e.css(v(t.visible?s.itemStyle:s.itemHiddenStyle)),s.allItems.forEach(function(e){t!==e&&e.setState("",!n)}),o.removeClass(r),t.setState()}).on("click",function(e){var i=function(){t.setVisible&&t.setVisible(),s.allItems.forEach(function(e){t!==e&&e.setState(t.visible?"inactive":"",!n)})};o.removeClass(r),e={browserEvent:e},t.firePointEvent?t.firePointEvent("legendItemClick",e,i):g(t,"legendItemClick",e,i)})},createCheckboxForItem:function(t){t.checkbox=d("input",{type:"checkbox",className:"highcharts-legend-checkbox",checked:t.selected,defaultChecked:t.selected},this.options.itemCheckboxStyle,this.chart.container),l(t.checkbox,"click",function(e){var i=e.target;g(t.series||t,"checkboxClick",{checked:i.checked,item:t},function(){t.select()})})}}),o(c.prototype,{showResetZoom:function(){var t=this,e=u.lang,i=t.options.chart.resetZoomButton,s=i.theme,o=s.states,n="chart"===i.relativeTo||"spaceBox"===i.relativeTo?null:"plotBox";function r(){t.zoomOut()}g(this,"beforeShowResetZoom",null,function(){t.resetZoomButton=t.renderer.button(e.resetZoom,null,null,r,s,o&&o.hover).attr({align:i.position.align,title:e.resetZoomTitle}).addClass("highcharts-reset-zoom").add().align(i.position,!1,n)}),g(this,"afterShowResetZoom")},zoomOut:function(){g(this,"selection",{resetSelection:!0},this.zoom)},zoom:function(t){var e,i,o=this,n=o.pointer,a=!1,l=o.inverted?n.mouseDownX:n.mouseDownY;!t||t.resetSelection?(o.axes.forEach(function(t){e=t.zoom()}),n.initiated=!1):t.xAxis.concat(t.yAxis).forEach(function(t){var i=t.axis,r=o.inverted?i.left:i.top,h=o.inverted?r+i.width:r+i.height,c=i.isXAxis,d=!1;(!c&&l>=r&&l<=h||c||!s(l))&&(d=!0),n[c?"zoomX":"zoomY"]&&d&&(e=i.zoom(t.min,t.max),i.displayBtn&&(a=!0))}),i=o.resetZoomButton,a&&!i?o.showResetZoom():!a&&r(i)&&(o.resetZoomButton=i.destroy()),e&&o.redraw(h(o.options.chart.animation,t&&t.animation,o.pointCount<100))},pan:function(t,e){var i,s,o,n=this,r=n.hoverPoints,a=n.options.chart;i="object"==typeof e?e:{enabled:e,type:"x"},a&&a.panning&&(a.panning=i),o=i.type,g(this,"pan",{originalEvent:t},function(){r&&r.forEach(function(t){t.setState()});var e=[1];"xy"===o?e=[1,0]:"y"===o&&(e=[0]),e.forEach(function(e){var i,o=n[e?"xAxis":"yAxis"][0],r=o.options,a=o.horiz,h=t[a?"chartX":"chartY"],l=a?"mouseDownX":"mouseDownY",c=n[l],d=(o.pointRange||0)/2,p=o.reversed&&!n.inverted||!o.reversed&&n.inverted?-1:1,u=o.getExtremes(),f=o.toValue(c-h,!0)+d*p,g=o.toValue(c+o.len-h,!0)-d*p,m=g<f,x=m?g:f,v=m?f:g,y=Math.min(u.dataMin,d?u.min:o.toValue(o.toPixels(u.min)-o.minPixelPadding)),b=Math.max(u.dataMax,d?u.max:o.toValue(o.toPixels(u.max)+o.minPixelPadding));r.ordinal||(e&&((i=y-x)>0&&(v+=i,x=y),(i=v-b)>0&&(v=b,x-=i)),(o.series.length&&x!==u.min&&v!==u.max&&e||o.panningState&&x>=o.panningState.startMin&&v<=o.panningState.startMax)&&(o.setExtremes(x,v,!1,!1,{trigger:"pan"}),s=!0),n[l]=h)}),s&&n.redraw(!1),p(n.container,{cursor:"move"})})}}),o(y.prototype,{select:function(t,e){var i=this,s=i.series,o=s.chart;t=h(t,!i.selected),this.selectedStaging=t,i.firePointEvent(t?"select":"unselect",{accumulate:e},function(){i.selected=i.options.selected=t,s.options.data[s.data.indexOf(i)]=i.options,i.setState(t&&"select"),e||o.getSelectedPoints().forEach(function(t){var e=t.series;t.selected&&t!==i&&(t.selected=t.options.selected=!1,e.options.data[e.data.indexOf(t)]=t.options,t.setState(o.hoverPoints&&e.options.inactiveOtherPoints?"inactive":""),t.firePointEvent("unselect"))})}),delete this.selectedStaging},onMouseOver:function(t){var e=this.series.chart,i=e.pointer;t=t?i.normalize(t):i.getChartCoordinatesFromPoint(this,e.inverted),i.runPointActions(t,this)},onMouseOut:function(){var t=this.series.chart;this.firePointEvent("mouseOut"),this.series.options.inactiveOtherPoints||(t.hoverPoints||[]).forEach(function(t){t.setState()}),t.hoverPoints=t.hoverPoint=null},importEvents:function(){if(!this.hasImportedEvents){var e=this,i=v(e.series.options.point,e.options).events;e.events=i,a(i,function(i,s){t.isFunction(i)&&l(e,s,i)}),this.hasImportedEvents=!0}},setState:function(t,e){var i,s,n,r,a,l=this.series,c=this.state,d=l.options.states[t||"normal"]||{},p=f[l.type].marker&&l.options.marker,u=p&&!1===p.enabled,m=p&&p.states&&p.states[t||"normal"]||{},x=!1===m.enabled,v=l.stateMarkerGraphic,y=this.marker||{},b=l.chart,M=l.halo,k=p&&l.markerAttribs;if(!((t=t||"")===this.state&&!e||this.selected&&"select"!==t||!1===d.enabled||t&&(x||u&&!1===m.enabled)||t&&y.states&&y.states[t]&&!1===y.states[t].enabled)){this.state=t,k&&(s=l.markerAttribs(this,t)),this.graphic?(c&&this.graphic.removeClass("highcharts-point-"+c),t&&this.graphic.addClass("highcharts-point-"+t),b.styledMode||(n=l.pointAttribs(this,t),r=h(b.options.chart.animation,d.animation),l.options.inactiveOtherPoints&&((this.dataLabels||[]).forEach(function(t){t&&t.animate({opacity:n.opacity},r)}),this.connector&&this.connector.animate({opacity:n.opacity},r)),this.graphic.animate(n,r)),s&&this.graphic.animate(s,h(b.options.chart.animation,m.animation,p.animation)),v&&v.hide()):(t&&m&&(a=y.symbol||l.symbol,v&&v.currentSymbol!==a&&(v=v.destroy()),s&&(v?v[e?"animate":"attr"]({x:s.x,y:s.y}):a&&(l.stateMarkerGraphic=v=b.renderer.symbol(a,s.x,s.y,s.width,s.height).add(l.markerGroup),v.currentSymbol=a)),!b.styledMode&&v&&v.attr(l.pointAttribs(this,t))),v&&(v[t&&this.isInside?"show":"hide"](),v.element.point=this)),i=d.halo;var w=this.graphic||v,S=w&&w.visibility||"inherit";i&&i.size&&w&&"hidden"!==S&&!this.isCluster?(M||(l.halo=M=b.renderer.path().add(w.parentGroup)),M.show()[e?"animate":"attr"]({d:this.haloPath(i.size)}),M.attr({class:"highcharts-halo highcharts-color-"+h(this.colorIndex,l.colorIndex)+(this.className?" "+this.className:""),visibility:S,zIndex:-1}),M.point=this,b.styledMode||M.attr(o({fill:this.color||l.color,"fill-opacity":i.opacity},i.attributes))):M&&M.point&&M.point.haloPath&&M.animate({d:M.point.haloPath(0)},null,M.hide),g(this,"afterSetState")}},haloPath:function(t){return this.series.chart.renderer.symbols.circle(Math.floor(this.plotX)-t,this.plotY-t,2*t,2*t)}}),o(b.prototype,{onMouseOver:function(){var t=this.chart,e=t.hoverSeries;e&&e!==this&&e.onMouseOut(),this.options.events.mouseOver&&g(this,"mouseOver"),this.setState("hover"),t.hoverSeries=this},onMouseOut:function(){var t=this.options,e=this.chart,i=e.tooltip,s=e.hoverPoint;e.hoverSeries=null,s&&s.onMouseOut(),this&&t.events.mouseOut&&g(this,"mouseOut"),!i||this.stickyTracking||i.shared&&!this.noSharedTooltip||i.hide(),e.series.forEach(function(t){t.setState("",!0)})},setState:function(t,e){var i,s=this,o=s.options,n=s.graph,r=o.inactiveOtherPoints,a=o.states,l=o.lineWidth,c=o.opacity,d=h(a[t||"normal"]&&a[t||"normal"].animation,s.chart.options.chart.animation),p=0;if(t=t||"",s.state!==t&&([s.group,s.markerGroup,s.dataLabelsGroup].forEach(function(e){e&&(s.state&&e.removeClass("highcharts-series-"+s.state),t&&e.addClass("highcharts-series-"+t))}),s.state=t,!s.chart.styledMode)){if(a[t]&&!1===a[t].enabled)return;if(t&&(l=a[t].lineWidth||l+(a[t].lineWidthPlus||0),c=h(a[t].opacity,c)),n&&!n.dashstyle)for(i={"stroke-width":l},n.animate(i,d);s["zone-graph-"+p];)s["zone-graph-"+p].attr(i),p+=1;r||[s.group,s.markerGroup,s.dataLabelsGroup,s.labelBySeries].forEach(function(t){t&&t.animate({opacity:c},d)})}e&&r&&s.points&&s.setAllPointsToState(t)},setAllPointsToState:function(t){this.points.forEach(function(e){e.setState&&e.setState(t)})},setVisible:function(t,e){var i,s=this,o=s.chart,n=s.legendItem,r=o.options.chart.ignoreHiddenSeries,a=s.visible;s.visible=t=s.options.visible=s.userOptions.visible=void 0===t?!a:t,i=t?"show":"hide",["group","dataLabelsGroup","markerGroup","tracker","tt"].forEach(function(t){s[t]&&s[t][i]()}),o.hoverSeries!==s&&(o.hoverPoint&&o.hoverPoint.series)!==s||s.onMouseOut(),n&&o.legend.colorizeItem(s,t),s.isDirty=!0,s.options.stacking&&o.series.forEach(function(t){t.options.stacking&&t.visible&&(t.isDirty=!0)}),s.linkedSeries.forEach(function(e){e.setVisible(t,!1)}),r&&(o.isDirtyBox=!0),g(s,i),!1!==e&&o.redraw()},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},select:function(t){this.selected=t=this.options.selected=void 0===t?!this.selected:t,this.checkbox&&(this.checkbox.checked=t),g(this,t?"select":"unselect")},drawTracker:i.drawTrackerGraph})}),i(e,"parts/Responsive.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.isArray,s=e.isObject,o=e.objectEach,n=e.pick,r=e.splat,a=t.Chart;a.prototype.setResponsive=function(e,i){var s,o,n=this.options.responsive,r=[],a=this.currentResponsive;!i&&n&&n.rules&&n.rules.forEach(function(e){void 0===e._id&&(e._id=t.uniqueKey()),this.matchResponsiveRule(e,r)},this);var h=t.merge.apply(0,r.map(function(e){return t.find(n.rules,function(t){return t._id===e}).chartOptions}));h.isResponsiveOptions=!0,r=r.toString()||void 0,s=a&&a.ruleIds,r!==s&&(a&&this.update(a.undoOptions,e,!0),r?((o=this.currentOptions(h)).isResponsiveOptions=!0,this.currentResponsive={ruleIds:r,mergedOptions:h,undoOptions:o},this.update(h,e,!0)):this.currentResponsive=void 0)},a.prototype.matchResponsiveRule=function(t,e){var i=t.condition;(i.callback||function(){return this.chartWidth<=n(i.maxWidth,Number.MAX_VALUE)&&this.chartHeight<=n(i.maxHeight,Number.MAX_VALUE)&&this.chartWidth>=n(i.minWidth,0)&&this.chartHeight>=n(i.minHeight,0)}).call(this)&&e.push(t._id)},a.prototype.currentOptions=function(t){var e=this,n={};return function t(n,a,h,l){var c;o(n,function(o,n){if(!l&&e.collectionsWithUpdate.indexOf(n)>-1)for(o=r(o),h[n]=[],c=0;c<o.length;c++)a[n][c]&&(h[n][c]={},t(o[c],a[n][c],h[n][c],l+1));else s(o)?(h[n]=i(o)?[]:{},t(o,a[n]||{},h[n],l+1)):void 0===a[n]?h[n]=null:h[n]=a[n]})}(t,this.options,n,0),n}}),i(e,"masters/highcharts.src.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){return(0,e.extend)(t,{animObject:e.animObject,arrayMax:e.arrayMax,arrayMin:e.arrayMin,attr:e.attr,correctFloat:e.correctFloat,defined:e.defined,destroyObjectProperties:e.destroyObjectProperties,discardElement:e.discardElement,erase:e.erase,extend:e.extend,extendClass:e.extendClass,isArray:e.isArray,isClass:e.isClass,isDOMElement:e.isDOMElement,isNumber:e.isNumber,isObject:e.isObject,isString:e.isString,numberFormat:e.numberFormat,objectEach:e.objectEach,offset:e.offset,pad:e.pad,pick:e.pick,pInt:e.pInt,relativeLength:e.relativeLength,setAnimation:e.setAnimation,splat:e.splat,syncTimeout:e.syncTimeout,wrap:e.wrap}),t}),i(e,"parts/Scrollbar.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i,s=e.correctFloat,o=e.defined,n=e.destroyObjectProperties,r=e.pick,a=t.addEvent,h=t.Axis,l=t.defaultOptions,c=t.fireEvent,d=t.hasTouch,p=t.isTouchDevice,u=t.merge,f=t.removeEvent,g={height:p?20:14,barBorderRadius:0,buttonBorderRadius:0,liveRedraw:void 0,margin:10,minWidth:6,step:.2,zIndex:3,barBackgroundColor:"#cccccc",barBorderWidth:1,barBorderColor:"#cccccc",buttonArrowColor:"#333333",buttonBackgroundColor:"#e6e6e6",buttonBorderColor:"#cccccc",buttonBorderWidth:1,rifleColor:"#333333",trackBackgroundColor:"#f2f2f2",trackBorderColor:"#f2f2f2",trackBorderWidth:1};function m(t,e,i){this.init(t,e,i)}l.scrollbar=u(!0,g,l.scrollbar),t.swapXY=i=function(t,e){var i,s,o=t.length;if(e)for(i=0;i<o;i+=3)s=t[i+1],t[i+1]=t[i+2],t[i+2]=s;return t},m.prototype={init:function(t,e,i){this.scrollbarButtons=[],this.renderer=t,this.userOptions=e,this.options=u(g,e),this.chart=i,this.size=r(this.options.size,this.options.height),e.enabled&&(this.render(),this.initEvents(),this.addEvents())},render:function(){var t,e=this.renderer,s=this.options,o=this.size,n=this.chart.styledMode;this.group=t=e.g("scrollbar").attr({zIndex:s.zIndex,translateY:-99999}).add(),this.track=e.rect().addClass("highcharts-scrollbar-track").attr({x:0,r:s.trackBorderRadius||0,height:o,width:o}).add(t),n||this.track.attr({fill:s.trackBackgroundColor,stroke:s.trackBorderColor,"stroke-width":s.trackBorderWidth}),this.trackBorderWidth=this.track.strokeWidth(),this.track.attr({y:-this.trackBorderWidth%2/2}),this.scrollbarGroup=e.g().add(t),this.scrollbar=e.rect().addClass("highcharts-scrollbar-thumb").attr({height:o,width:o,r:s.barBorderRadius||0}).add(this.scrollbarGroup),this.scrollbarRifles=e.path(i(["M",-3,o/4,"L",-3,2*o/3,"M",0,o/4,"L",0,2*o/3,"M",3,o/4,"L",3,2*o/3],s.vertical)).addClass("highcharts-scrollbar-rifles").add(this.scrollbarGroup),n||(this.scrollbar.attr({fill:s.barBackgroundColor,stroke:s.barBorderColor,"stroke-width":s.barBorderWidth}),this.scrollbarRifles.attr({stroke:s.rifleColor,"stroke-width":1})),this.scrollbarStrokeWidth=this.scrollbar.strokeWidth(),this.scrollbarGroup.translate(-this.scrollbarStrokeWidth%2/2,-this.scrollbarStrokeWidth%2/2),this.drawScrollbarButton(0),this.drawScrollbarButton(1)},position:function(t,e,i,s){var o=this.options.vertical,n=s,r=0,a=this.rendered?"animate":"attr";this.x=t,this.y=e+this.trackBorderWidth,this.width=i,this.height=s,this.xOffset=n,this.yOffset=r,o?(this.width=this.yOffset=i=r=this.size,this.xOffset=n=0,this.barWidth=s-2*i,this.x=t+=this.options.margin):(this.height=this.xOffset=s=n=this.size,this.barWidth=i-2*s,this.y=this.y+this.options.margin),this.group[a]({translateX:t,translateY:this.y}),this.track[a]({width:i,height:s}),this.scrollbarButtons[1][a]({translateX:o?0:i-n,translateY:o?s-r:0})},drawScrollbarButton:function(t){var e,s,o=this.renderer,n=this.scrollbarButtons,r=this.options,a=this.size;e=o.g().add(this.group),n.push(e),s=o.rect().addClass("highcharts-scrollbar-button").add(e),this.chart.styledMode||s.attr({stroke:r.buttonBorderColor,"stroke-width":r.buttonBorderWidth,fill:r.buttonBackgroundColor}),s.attr(s.crisp({x:-.5,y:-.5,width:a+1,height:a+1,r:r.buttonBorderRadius},s.strokeWidth())),s=o.path(i(["M",a/2+(t?-1:1),a/2-3,"L",a/2+(t?-1:1),a/2+3,"L",a/2+(t?2:-2),a/2],r.vertical)).addClass("highcharts-scrollbar-arrow").add(n[t]),this.chart.styledMode||s.attr({fill:r.buttonArrowColor})},setRange:function(t,e){var i,n,r,a,h,l=this.options,c=l.vertical,d=l.minWidth,p=this.barWidth,u=!this.rendered||this.hasDragged||this.chart.navigator&&this.chart.navigator.hasDragged?"attr":"animate";o(p)&&(t=Math.max(t,0),i=Math.ceil(p*t),n=p*Math.min(e,1),this.calculatedWidth=a=s(n-i),a<d&&(i=(p-d+a)*t,a=d),r=Math.floor(i+this.xOffset+this.yOffset),h=a/2-.5,this.from=t,this.to=e,c?(this.scrollbarGroup[u]({translateY:r}),this.scrollbar[u]({height:a}),this.scrollbarRifles[u]({translateY:h}),this.scrollbarTop=r,this.scrollbarLeft=0):(this.scrollbarGroup[u]({translateX:r}),this.scrollbar[u]({width:a}),this.scrollbarRifles[u]({translateX:h}),this.scrollbarLeft=r,this.scrollbarTop=0),a<=12?this.scrollbarRifles.hide():this.scrollbarRifles.show(!0),!1===l.showFull&&(t<=0&&e>=1?this.group.hide():this.group.show()),this.rendered=!0)},initEvents:function(){var t=this;t.mouseMoveHandler=function(e){var i,s=t.chart.pointer.normalize(e),o=t.options.vertical?"chartY":"chartX",n=t.initPositions;!t.grabbedCenter||e.touches&&0===e.touches[0][o]||(i=t.cursorToScrollbarPosition(s)[o]-t[o],t.hasDragged=!0,t.updatePosition(n[0]+i,n[1]+i),t.hasDragged&&c(t,"changed",{from:t.from,to:t.to,trigger:"scrollbar",DOMType:e.type,DOMEvent:e}))},t.mouseUpHandler=function(e){t.hasDragged&&c(t,"changed",{from:t.from,to:t.to,trigger:"scrollbar",DOMType:e.type,DOMEvent:e}),t.grabbedCenter=t.hasDragged=t.chartX=t.chartY=null},t.mouseDownHandler=function(e){var i=t.chart.pointer.normalize(e),s=t.cursorToScrollbarPosition(i);t.chartX=s.chartX,t.chartY=s.chartY,t.initPositions=[t.from,t.to],t.grabbedCenter=!0},t.buttonToMinClick=function(e){var i=s(t.to-t.from)*t.options.step;t.updatePosition(s(t.from-i),s(t.to-i)),c(t,"changed",{from:t.from,to:t.to,trigger:"scrollbar",DOMEvent:e})},t.buttonToMaxClick=function(e){var i=(t.to-t.from)*t.options.step;t.updatePosition(t.from+i,t.to+i),c(t,"changed",{from:t.from,to:t.to,trigger:"scrollbar",DOMEvent:e})},t.trackClick=function(e){var i=t.chart.pointer.normalize(e),s=t.to-t.from,o=t.y+t.scrollbarTop,n=t.x+t.scrollbarLeft;t.options.vertical&&i.chartY>o||!t.options.vertical&&i.chartX>n?t.updatePosition(t.from+s,t.to+s):t.updatePosition(t.from-s,t.to-s),c(t,"changed",{from:t.from,to:t.to,trigger:"scrollbar",DOMEvent:e})}},cursorToScrollbarPosition:function(t){var e=this.options,i=e.minWidth>this.calculatedWidth?e.minWidth:0;return{chartX:(t.chartX-this.x-this.xOffset)/(this.barWidth-i),chartY:(t.chartY-this.y-this.yOffset)/(this.barWidth-i)}},updatePosition:function(t,e){e>1&&(t=s(1-s(e-t)),e=1),t<0&&(e=s(e-t),t=0),this.from=t,this.to=e},update:function(t){this.destroy(),this.init(this.chart.renderer,u(!0,this.options,t),this.chart)},addEvents:function(){var t,e=this.options.inverted?[1,0]:[0,1],i=this.scrollbarButtons,s=this.scrollbarGroup.element,o=this.track.element,n=this.mouseDownHandler,r=this.mouseMoveHandler,h=this.mouseUpHandler;t=[[i[e[0]].element,"click",this.buttonToMinClick],[i[e[1]].element,"click",this.buttonToMaxClick],[o,"click",this.trackClick],[s,"mousedown",n],[s.ownerDocument,"mousemove",r],[s.ownerDocument,"mouseup",h]],d&&t.push([s,"touchstart",n],[s.ownerDocument,"touchmove",r],[s.ownerDocument,"touchend",h]),t.forEach(function(t){a.apply(null,t)}),this._events=t},removeEvents:function(){this._events.forEach(function(t){f.apply(null,t)}),this._events.length=0},destroy:function(){var t=this.chart.scroller;this.removeEvents(),["track","scrollbarRifles","scrollbar","scrollbarGroup","group"].forEach(function(t){this[t]&&this[t].destroy&&(this[t]=this[t].destroy())},this),t&&this===t.scrollbar&&(t.scrollbar=null,n(t.scrollbarButtons))}},t.Scrollbar||(a(h,"afterInit",function(){var e=this;e.options&&e.options.scrollbar&&e.options.scrollbar.enabled&&(e.options.scrollbar.vertical=!e.horiz,e.options.startOnTick=e.options.endOnTick=!1,e.scrollbar=new m(e.chart.renderer,e.options.scrollbar,e.chart),a(e.scrollbar,"changed",function(i){var s,n,a=Math.min(r(e.options.min,e.min),e.min,e.dataMin),h=Math.max(r(e.options.max,e.max),e.max,e.dataMax)-a;e.horiz&&!e.reversed||!e.horiz&&e.reversed?(s=a+h*this.to,n=a+h*this.from):(s=a+h*(1-this.from),n=a+h*(1-this.to)),r(this.options.liveRedraw,t.svg&&!t.isTouchDevice&&!this.chart.isBoosting)||"mouseup"===i.DOMType||!o(i.DOMType)?e.setExtremes(n,s,!0,"mousemove"!==i.DOMType,i):this.setRange(this.from,this.to)}))}),a(h,"afterRender",function(){var t,e,i,s=Math.min(r(this.options.min,this.min),this.min,r(this.dataMin,this.min)),n=Math.max(r(this.options.max,this.max),this.max,r(this.dataMax,this.max)),a=this.scrollbar,h=this.axisTitleMargin+(this.titleOffset||0),l=this.chart.scrollbarsOffsets,c=this.options.margin||0;a&&(this.horiz?(this.opposite||(l[1]+=h),a.position(this.left,this.top+this.height+2+l[1]-(this.opposite?c:0),this.width,this.height),this.opposite||(l[1]+=c),t=1):(this.opposite&&(l[0]+=h),a.position(this.left+this.width+2+l[0]-(this.opposite?0:c),this.top,this.width,this.height),this.opposite&&(l[0]+=c),t=0),l[t]+=a.size+a.options.margin,isNaN(s)||isNaN(n)||!o(this.min)||!o(this.max)||this.min===this.max?a.setRange(0,1):(e=(this.min-s)/(n-s),i=(this.max-s)/(n-s),this.horiz&&!this.reversed||!this.horiz&&this.reversed?a.setRange(e,i):a.setRange(1-i,1-e)))}),a(h,"afterGetOffset",function(){var t=this.horiz?2:1,e=this.scrollbar;e&&(this.chart.scrollbarsOffsets=[0,0],this.chart.axisOffset[t]+=e.size+e.options.margin)}),t.Scrollbar=m)}),i(e,"parts/Navigator.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i,s=e.clamp,o=e.correctFloat,n=e.defined,r=e.destroyObjectProperties,a=e.erase,h=e.extend,l=e.isArray,c=e.isNumber,d=e.pick,p=e.splat,u=t.addEvent,f=t.Axis,g=t.Chart,m=t.color,x=t.defaultOptions,v=t.hasTouch,y=t.isTouchDevice,b=t.merge,M=t.removeEvent,k=t.Scrollbar,w=t.Series,S=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var s=[].filter.call(e,c);if(s.length)return Math[t].apply(0,s)};function A(t){this.init(t)}i=void 0===t.seriesTypes.areaspline?"line":"areaspline",h(x,{navigator:{height:40,margin:25,maskInside:!0,handles:{width:7,height:15,symbols:["navigator-handle","navigator-handle"],enabled:!0,lineWidth:1,backgroundColor:"#f2f2f2",borderColor:"#999999"},maskFill:m("#6685c2").setOpacity(.3).get(),outlineColor:"#cccccc",outlineWidth:1,series:{type:i,fillOpacity:.05,lineWidth:1,compare:null,dataGrouping:{approximation:"average",enabled:!0,groupPixelWidth:2,smoothed:!0,units:[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2,3,4]],["week",[1,2,3]],["month",[1,3,6]],["year",null]]},dataLabels:{enabled:!1,zIndex:2},id:"highcharts-navigator-series",className:"highcharts-navigator-series",lineColor:null,marker:{enabled:!1},threshold:null},xAxis:{overscroll:0,className:"highcharts-navigator-xaxis",tickLength:0,lineWidth:0,gridLineColor:"#e6e6e6",gridLineWidth:1,tickPixelInterval:200,labels:{align:"left",style:{color:"#999999"},x:3,y:-4},crosshair:!1},yAxis:{className:"highcharts-navigator-yaxis",gridLineWidth:0,startOnTick:!1,endOnTick:!1,minPadding:.1,maxPadding:.1,labels:{enabled:!1},crosshair:!1,title:{text:null},tickLength:0,tickWidth:0}}}),t.Renderer.prototype.symbols["navigator-handle"]=function(t,e,i,s,o){var n=o.width/2,r=Math.round(n/3)+.5,a=o.height;return["M",-n-1,.5,"L",n,.5,"L",n,a+.5,"L",-n-1,a+.5,"L",-n-1,.5,"M",-r,4,"L",-r,a-3,"M",r-1,4,"L",r-1,a-3]},f.prototype.toFixedRange=function(t,e,i,s){var r=this.chart&&this.chart.fixedRange,a=(this.pointRange||0)/2,h=d(i,this.translate(t,!0,!this.horiz)),l=d(s,this.translate(e,!0,!this.horiz)),p=r&&(l-h)/r;return n(i)||(h=o(h+a)),n(s)||(l=o(l-a)),p>.7&&p<1.3&&(s?h=l-r:l=h+r),c(h)&&c(l)||(h=l=void 0),{min:h,max:l}},A.prototype={drawHandle:function(t,e,i,s){var o=this.navigatorOptions.handles.height;this.handles[e][s](i?{translateX:Math.round(this.left+this.height/2),translateY:Math.round(this.top+parseInt(t,10)+.5-o)}:{translateX:Math.round(this.left+parseInt(t,10)),translateY:Math.round(this.top+this.height/2-o/2-1)})},drawOutline:function(t,e,i,s){var o,n,r=this.navigatorOptions.maskInside,a=this.outline.strokeWidth(),h=a/2,l=a%2/2,c=this.outlineHeight,d=this.scrollbarHeight,p=this.size,u=this.left-d,f=this.top;n=i?["M",(u-=h)+c,f-d-l,"L",u+c,o=f+e+l,"L",u,o,"L",u,e=f+t+l,"L",u+c,e,"L",u+c,f+p+d].concat(r?["M",u+c,o-h,"L",u+c,e+h]:[]):["M",u,f+=h,"L",t+=u+d-l,f,"L",t,f+c,"L",e+=u+d-l,f+c,"L",e,f,"L",u+p+2*d,f].concat(r?["M",t-h,f,"L",e+h,f]:[]),this.outline[s]({d:n})},drawMasks:function(t,e,i,s){var o,n,r,a,h=this.left,l=this.top,c=this.height;i?(r=[h,h,h],a=[l,l+t,l+e],n=[c,c,c],o=[t,e-t,this.size-e]):(r=[h,h+t,h+e],a=[l,l,l],n=[t,e-t,this.size-e],o=[c,c,c]),this.shades.forEach(function(t,e){t[s]({x:r[e],y:a[e],width:n[e],height:o[e]})})},renderElements:function(){var t,e=this,i=e.navigatorOptions,s=i.maskInside,o=e.chart,n=o.inverted,r=o.renderer,a={cursor:n?"ns-resize":"ew-resize"};e.navigatorGroup=t=r.g("navigator").attr({zIndex:8,visibility:"hidden"}).add(),[!s,s,!s].forEach(function(s,n){e.shades[n]=r.rect().addClass("highcharts-navigator-mask"+(1===n?"-inside":"-outside")).add(t),o.styledMode||e.shades[n].attr({fill:s?i.maskFill:"rgba(0,0,0,0)"}).css(1===n&&a)}),e.outline=r.path().addClass("highcharts-navigator-outline").add(t),o.styledMode||e.outline.attr({"stroke-width":i.outlineWidth,stroke:i.outlineColor}),i.handles.enabled&&[0,1].forEach(function(s){if(i.handles.inverted=o.inverted,e.handles[s]=r.symbol(i.handles.symbols[s],-i.handles.width/2-1,0,i.handles.width,i.handles.height,i.handles),e.handles[s].attr({zIndex:7-s}).addClass("highcharts-navigator-handle highcharts-navigator-handle-"+["left","right"][s]).add(t),!o.styledMode){var n=i.handles;e.handles[s].attr({fill:n.backgroundColor,stroke:n.borderColor,"stroke-width":n.lineWidth}).css(a)}})},update:function(t){(this.series||[]).forEach(function(t){t.baseSeries&&delete t.baseSeries.navigatorSeries}),this.destroy();var e=this.chart.options;b(!0,e.navigator,this.options,t),this.init(this.chart)},render:function(t,e,i,r){var a,h,l,p,u,f,g,m,x,v,y=this.chart,b=this.scrollbarHeight,M=this.xAxis,k=M.pointRange||0,w=M.fake?y.xAxis[0]:M,S=this.navigatorEnabled,A=this.rendered,T=y.inverted,P=y.xAxis[0].minRange,L=y.xAxis[0].options.maxRange;if(!this.hasDragged||n(i)){if(t=o(t-k/2),e=o(e+k/2),!c(t)||!c(e)){if(!A)return;i=0,r=d(M.width,w.width)}this.left=d(M.left,y.plotLeft+b+(T?y.plotWidth:0)),this.size=f=p=d(M.len,(T?y.plotHeight:y.plotWidth)-2*b),a=T?b:p+2*b,i=d(i,M.toPixels(t,!0)),r=d(r,M.toPixels(e,!0)),c(i)&&Math.abs(i)!==1/0||(i=0,r=a),m=M.toValue(i,!0),x=M.toValue(r,!0),(v=Math.abs(o(x-m)))<P?this.grabbedLeft?i=M.toPixels(x-P-k,!0):this.grabbedRight&&(r=M.toPixels(m+P+k,!0)):n(L)&&o(v-k)>L&&(this.grabbedLeft?i=M.toPixels(x-L-k,!0):this.grabbedRight&&(r=M.toPixels(m+L+k,!0))),this.zoomedMax=s(Math.max(i,r),0,f),this.zoomedMin=s(this.fixedWidth?this.zoomedMax-this.fixedWidth:Math.min(i,r),0,f),this.range=this.zoomedMax-this.zoomedMin,f=Math.round(this.zoomedMax),u=Math.round(this.zoomedMin),S&&(this.navigatorGroup.attr({visibility:"visible"}),g=A&&!this.hasDragged?"animate":"attr",this.drawMasks(u,f,T,g),this.drawOutline(u,f,T,g),this.navigatorOptions.handles.enabled&&(this.drawHandle(u,0,T,g),this.drawHandle(f,1,T,g))),this.scrollbar&&(T?(l=this.top-b,h=this.left-b+(S||!w.opposite?0:(w.titleOffset||0)+w.axisTitleMargin),b=p+2*b):(l=this.top+(S?this.height:-b),h=this.left-b),this.scrollbar.position(h,l,a,b),this.scrollbar.setRange(this.zoomedMin/(p||1),this.zoomedMax/(p||1))),this.rendered=!0}},addMouseEvents:function(){var t,e,i=this,s=i.chart,o=s.container,n=[];i.mouseMoveHandler=t=function(t){i.onMouseMove(t)},i.mouseUpHandler=e=function(t){i.onMouseUp(t)},(n=i.getPartsEvents("mousedown")).push(u(s.renderTo,"mousemove",t),u(o.ownerDocument,"mouseup",e)),v&&(n.push(u(s.renderTo,"touchmove",t),u(o.ownerDocument,"touchend",e)),n.concat(i.getPartsEvents("touchstart"))),i.eventsToUnbind=n,i.series&&i.series[0]&&n.push(u(i.series[0].xAxis,"foundExtremes",function(){s.navigator.modifyNavigatorAxisExtremes()}))},getPartsEvents:function(t){var e=this,i=[];return["shades","handles"].forEach(function(s){e[s].forEach(function(o,n){i.push(u(o.element,t,function(t){e[s+"Mousedown"](t,n)}))})}),i},shadesMousedown:function(t,e){t=this.chart.pointer.normalize(t);var i,s,o,r,a=this.chart,h=this.xAxis,l=this.zoomedMin,c=this.left,d=this.size,p=this.range,u=t.chartX;a.inverted&&(u=t.chartY,c=this.top),1===e?(this.grabbedCenter=u,this.fixedWidth=p,this.dragOffset=u-l):(r=u-c-p/2,0===e?r=Math.max(0,r):2===e&&r+p>=d&&(r=d-p,this.reversedExtremes?(r-=p,s=this.getUnionExtremes().dataMin):i=this.getUnionExtremes().dataMax),r!==l&&(this.fixedWidth=p,o=h.toFixedRange(r,r+p,s,i),n(o.min)&&a.xAxis[0].setExtremes(Math.min(o.min,o.max),Math.max(o.min,o.max),!0,null,{trigger:"navigator"})))},handlesMousedown:function(t,e){t=this.chart.pointer.normalize(t);var i=this.chart,s=i.xAxis[0],o=this.reversedExtremes;0===e?(this.grabbedLeft=!0,this.otherHandlePos=this.zoomedMax,this.fixedExtreme=o?s.min:s.max):(this.grabbedRight=!0,this.otherHandlePos=this.zoomedMin,this.fixedExtreme=o?s.max:s.min),i.fixedRange=null},onMouseMove:function(e){var i,s=this,o=s.chart,n=s.left,r=s.navigatorSize,a=s.range,h=s.dragOffset,l=o.inverted;e.touches&&0===e.touches[0].pageX||(i=(e=o.pointer.normalize(e)).chartX,l&&(n=s.top,i=e.chartY),s.grabbedLeft?(s.hasDragged=!0,s.render(0,0,i-n,s.otherHandlePos)):s.grabbedRight?(s.hasDragged=!0,s.render(0,0,s.otherHandlePos,i-n)):s.grabbedCenter&&(s.hasDragged=!0,i<h?i=h:i>r+h-a&&(i=r+h-a),s.render(0,0,i-h,i-h+a)),s.hasDragged&&s.scrollbar&&d(s.scrollbar.options.liveRedraw,t.svg&&!y&&!this.chart.isBoosting)&&(e.DOMType=e.type,setTimeout(function(){s.onMouseUp(e)},0)))},onMouseUp:function(t){var e,i,s,o,r=this.chart,a=this.xAxis,h=this.scrollbar,l=t.DOMEvent||t;(!this.hasDragged||h&&h.hasDragged)&&"scrollbar"!==t.trigger||(e=this.getUnionExtremes(),this.zoomedMin===this.otherHandlePos?i=this.fixedExtreme:this.zoomedMax===this.otherHandlePos&&(s=this.fixedExtreme),this.zoomedMax===this.size&&(s=this.reversedExtremes?e.dataMin:e.dataMax),0===this.zoomedMin&&(i=this.reversedExtremes?e.dataMax:e.dataMin),o=a.toFixedRange(this.zoomedMin,this.zoomedMax,i,s),n(o.min)&&r.xAxis[0].setExtremes(Math.min(o.min,o.max),Math.max(o.min,o.max),!0,!this.hasDragged&&null,{trigger:"navigator",triggerOp:"navigator-drag",DOMEvent:l})),"mousemove"!==t.DOMType&&"touchmove"!==t.DOMType&&(this.grabbedLeft=this.grabbedRight=this.grabbedCenter=this.fixedWidth=this.fixedExtreme=this.otherHandlePos=this.hasDragged=this.dragOffset=null)},removeEvents:function(){this.eventsToUnbind&&(this.eventsToUnbind.forEach(function(t){t()}),this.eventsToUnbind=void 0),this.removeBaseSeriesEvents()},removeBaseSeriesEvents:function(){var t=this.baseSeries||[];this.navigatorEnabled&&t[0]&&(!1!==this.navigatorOptions.adaptToUpdatedData&&t.forEach(function(t){M(t,"updatedData",this.updatedDataHandler)},this),t[0].xAxis&&M(t[0].xAxis,"foundExtremes",this.modifyBaseAxisExtremes))},init:function(t){var e=t.options,i=e.navigator,s=i.enabled,o=e.scrollbar,n=o.enabled,r=s?i.height:0,a=n?o.height:0;this.handles=[],this.shades=[],this.chart=t,this.setBaseSeries(),this.height=r,this.scrollbarHeight=a,this.scrollbarEnabled=n,this.navigatorEnabled=s,this.navigatorOptions=i,this.scrollbarOptions=o,this.outlineHeight=r+a,this.opposite=d(i.opposite,Boolean(!s&&t.inverted));var h=this,l=h.baseSeries,c=t.xAxis.length,p=t.yAxis.length,g=l&&l[0]&&l[0].xAxis||t.xAxis[0]||{options:{}};t.isDirtyBox=!0,h.navigatorEnabled?(h.xAxis=new f(t,b({breaks:g.options.breaks,ordinal:g.options.ordinal},i.xAxis,{id:"navigator-x-axis",yAxis:"navigator-y-axis",isX:!0,type:"datetime",index:c,isInternal:!0,offset:0,keepOrdinalPadding:!0,startOnTick:!1,endOnTick:!1,minPadding:0,maxPadding:0,zoomEnabled:!1},t.inverted?{offsets:[a,0,-a,0],width:r}:{offsets:[0,-a,0,a],height:r})),h.yAxis=new f(t,b(i.yAxis,{id:"navigator-y-axis",alignTicks:!1,offset:0,index:p,isInternal:!0,zoomEnabled:!1},t.inverted?{width:r}:{height:r})),l||i.series.data?h.updateNavigatorSeries(!1):0===t.series.length&&(h.unbindRedraw=u(t,"beforeRedraw",function(){t.series.length>0&&!h.series&&(h.setBaseSeries(),h.unbindRedraw())})),h.reversedExtremes=t.inverted&&!h.xAxis.reversed||!t.inverted&&h.xAxis.reversed,h.renderElements(),h.addMouseEvents()):h.xAxis={translate:function(e,i){var s=t.xAxis[0],o=s.getExtremes(),n=s.len-2*a,r=S("min",s.options.min,o.dataMin),h=S("max",s.options.max,o.dataMax)-r;return i?e*h/n+r:n*(e-r)/h},toPixels:function(t){return this.translate(t)},toValue:function(t){return this.translate(t,!0)},toFixedRange:f.prototype.toFixedRange,fake:!0},t.options.scrollbar.enabled&&(t.scrollbar=h.scrollbar=new k(t.renderer,b(t.options.scrollbar,{margin:h.navigatorEnabled?0:10,vertical:t.inverted}),t),u(h.scrollbar,"changed",function(e){var i=h.size,s=i*this.to,o=i*this.from;h.hasDragged=h.scrollbar.hasDragged,h.render(0,0,o,s),(t.options.scrollbar.liveRedraw||"mousemove"!==e.DOMType&&"touchmove"!==e.DOMType)&&setTimeout(function(){h.onMouseUp(e)})})),h.addBaseSeriesEvents(),h.addChartEvents()},getUnionExtremes:function(t){var e,i=this.chart.xAxis[0],s=this.xAxis,o=s.options,n=i.options;return t&&null===i.dataMin||(e={dataMin:d(o&&o.min,S("min",n.min,i.dataMin,s.dataMin,s.min)),dataMax:d(o&&o.max,S("max",n.max,i.dataMax,s.dataMax,s.max))}),e},setBaseSeries:function(e,i){var s=this.chart,o=this.baseSeries=[];e=e||s.options&&s.options.navigator.baseSeries||(s.series.length?t.find(s.series,function(t){return!t.options.isInternal}).index:0),(s.series||[]).forEach(function(t,i){t.options.isInternal||!t.options.showInNavigator&&(i!==e&&t.options.id!==e||!1===t.options.showInNavigator)||o.push(t)}),this.xAxis&&!this.xAxis.fake&&this.updateNavigatorSeries(!0,i)},updateNavigatorSeries:function(t,e){var i,s,o,n=this,r=n.chart,a=n.baseSeries,c=n.navigatorOptions.series,u={enableMouseTracking:!1,index:null,linkedTo:null,group:"nav",padXAxis:!1,xAxis:"navigator-x-axis",yAxis:"navigator-y-axis",showInLegend:!1,stacking:!1,isInternal:!0,states:{inactive:{opacity:1}}},f=n.series=(n.series||[]).filter(function(t){var e=t.baseSeries;return!(a.indexOf(e)<0)||(e&&(M(e,"updatedData",n.updatedDataHandler),delete e.navigatorSeries),t.chart&&t.destroy(),!1)});a&&a.length&&a.forEach(function(t){var p=t.navigatorSeries,g=h({color:t.color,visible:t.visible},l(c)?x.navigator.series:c);if(!p||!1!==n.navigatorOptions.adaptToUpdatedData){u.name="Navigator "+a.length,i=t.options||{},o=i.navigatorOptions||{},(s=b(i,u,g,o)).pointRange=d(g.pointRange,o.pointRange,x.plotOptions[s.type||"line"].pointRange);var m=o.data||g.data;n.hasNavigatorData=n.hasNavigatorData||!!m,s.data=m||i.data&&i.data.slice(0),p&&p.options?p.update(s,e):(t.navigatorSeries=r.initSeries(s),t.navigatorSeries.baseSeries=t,f.push(t.navigatorSeries))}}),(!c.data||a&&a.length)&&!l(c)||(n.hasNavigatorData=!1,(c=p(c)).forEach(function(t,e){u.name="Navigator "+(f.length+1),(s=b(x.navigator.series,{color:r.series[e]&&!r.series[e].options.isInternal&&r.series[e].color||r.options.colors[e]||r.options.colors[0]},u,t)).data=t.data,s.data&&(n.hasNavigatorData=!0,f.push(r.initSeries(s)))})),t&&this.addBaseSeriesEvents()},addBaseSeriesEvents:function(){var t=this,e=t.baseSeries||[];e[0]&&e[0].xAxis&&u(e[0].xAxis,"foundExtremes",this.modifyBaseAxisExtremes),e.forEach(function(e){u(e,"show",function(){this.navigatorSeries&&this.navigatorSeries.setVisible(!0,!1)}),u(e,"hide",function(){this.navigatorSeries&&this.navigatorSeries.setVisible(!1,!1)}),!1!==this.navigatorOptions.adaptToUpdatedData&&e.xAxis&&u(e,"updatedData",this.updatedDataHandler),u(e,"remove",function(){this.navigatorSeries&&(a(t.series,this.navigatorSeries),n(this.navigatorSeries.options)&&this.navigatorSeries.remove(!1),delete this.navigatorSeries)})},this)},getBaseSeriesMin:function(t){return this.baseSeries.reduce(function(t,e){return Math.min(t,e.xData?e.xData[0]:t)},t)},modifyNavigatorAxisExtremes:function(){var t,e=this.xAxis;void 0!==e.getExtremes&&(!(t=this.getUnionExtremes(!0))||t.dataMin===e.min&&t.dataMax===e.max||(e.min=t.dataMin,e.max=t.dataMax))},modifyBaseAxisExtremes:function(){var t,e,i=this.chart.navigator,s=this.getExtremes(),o=s.min,n=s.max,r=s.dataMin,a=s.dataMax,h=n-o,l=i.stickToMin,p=i.stickToMax,u=d(this.options.overscroll,0),f=i.series&&i.series[0],g=!!this.setExtremes;this.eventArgs&&"rangeSelectorButton"===this.eventArgs.trigger||(l&&(t=(e=r)+h),p&&(t=a+u,l||(e=Math.max(t-h,i.getBaseSeriesMin(f&&f.xData?f.xData[0]:-Number.MAX_VALUE)))),g&&(l||p)&&c(e)&&(this.min=this.userMin=e,this.max=this.userMax=t)),i.stickToMin=i.stickToMax=null},updatedDataHandler:function(){var t=this.chart.navigator,e=this.navigatorSeries,i=t.getBaseSeriesMin(this.xData[0]);t.stickToMax=t.reversedExtremes?0===Math.round(t.zoomedMin):Math.round(t.zoomedMax)>=Math.round(t.size),t.stickToMin=c(this.xAxis.min)&&this.xAxis.min<=i&&(!this.chart.fixedRange||!t.stickToMax),e&&!t.hasNavigatorData&&(e.options.pointStart=this.xData[0],e.setData(this.options.data,!1,null,!1))},addChartEvents:function(){this.eventsToUnbind||(this.eventsToUnbind=[]),this.eventsToUnbind.push(u(this.chart,"redraw",function(){var t=this.navigator,e=t&&(t.baseSeries&&t.baseSeries[0]&&t.baseSeries[0].xAxis||t.scrollbar&&this.xAxis[0]);e&&t.render(e.min,e.max)}),u(this.chart,"getMargins",function(){var t=this.navigator,e=t.opposite?"plotTop":"marginBottom";this.inverted&&(e=t.opposite?"marginRight":"plotLeft"),this[e]=(this[e]||0)+(t.navigatorEnabled||!this.inverted?t.outlineHeight:0)+t.navigatorOptions.margin}))},destroy:function(){this.removeEvents(),this.xAxis&&(a(this.chart.xAxis,this.xAxis),a(this.chart.axes,this.xAxis)),this.yAxis&&(a(this.chart.yAxis,this.yAxis),a(this.chart.axes,this.yAxis)),(this.series||[]).forEach(function(t){t.destroy&&t.destroy()}),["series","xAxis","yAxis","shades","outline","scrollbarTrack","scrollbarRifles","scrollbarGroup","scrollbar","navigatorGroup","rendered"].forEach(function(t){this[t]&&this[t].destroy&&this[t].destroy(),this[t]=null},this),[this.handles].forEach(function(t){r(t)},this)}},t.Navigator||(t.Navigator=A,u(f,"zoom",function(t){var e,i=this.chart.options,s=i.chart.zoomType,o=i.chart.pinchType,r=i.navigator,a=i.rangeSelector;this.isXAxis&&(r&&r.enabled||a&&a.enabled)&&("y"===s?t.zoomed=!1:(!y&&"xy"===s||y&&"xy"===o)&&this.options.range&&(e=this.previousZoom,n(t.newMin)?this.previousZoom=[this.min,this.max]:e&&(t.newMin=e[0],t.newMax=e[1],delete this.previousZoom))),void 0!==t.zoomed&&t.preventDefault()}),u(g,"beforeShowResetZoom",function(){var t=this.options,e=t.navigator,i=t.rangeSelector;if((e&&e.enabled||i&&i.enabled)&&(!y&&"x"===t.chart.zoomType||y&&"x"===t.chart.pinchType))return!1}),u(g,"beforeRender",function(){var t=this.options;(t.navigator.enabled||t.scrollbar.enabled)&&(this.scroller=this.navigator=new A(this))}),u(g,"afterSetChartSize",function(){var t,e,i,s,o=this.legend,n=this.navigator;n&&(e=o&&o.options,i=n.xAxis,s=n.yAxis,t=n.scrollbarHeight,this.inverted?(n.left=n.opposite?this.chartWidth-t-n.height:this.spacing[3]+t,n.top=this.plotTop+t):(n.left=this.plotLeft+t,n.top=n.navigatorOptions.top||this.chartHeight-n.height-t-this.spacing[2]-(this.rangeSelector&&this.extraBottomMargin?this.rangeSelector.getHeight():0)-(e&&"bottom"===e.verticalAlign&&e.enabled&&!e.floating?o.legendHeight+d(e.margin,10):0)-(this.titleOffset?this.titleOffset[2]:0)),i&&s&&(this.inverted?i.options.left=s.options.left=n.left:i.options.top=s.options.top=n.top,i.setAxisSize(),s.setAxisSize()))}),u(g,"update",function(t){var e=t.options.navigator||{},i=t.options.scrollbar||{};this.navigator||this.scroller||!e.enabled&&!i.enabled||(b(!0,this.options.navigator,e),b(!0,this.options.scrollbar,i),delete t.options.navigator,delete t.options.scrollbar)}),u(g,"afterUpdate",function(t){this.navigator||this.scroller||!this.options.navigator.enabled&&!this.options.scrollbar.enabled||(this.scroller=this.navigator=new A(this),d(t.redraw,!0)&&this.redraw(t.animation))}),u(g,"afterAddSeries",function(){this.navigator&&this.navigator.setBaseSeries(null,!1)}),u(w,"afterUpdate",function(){this.chart.navigator&&!this.options.isInternal&&this.chart.navigator.setBaseSeries(null,!1)}),g.prototype.callbacks.push(function(t){var e,i=t.navigator;i&&t.xAxis[0]&&(e=t.xAxis[0].getExtremes(),i.render(e.min,e.max))}))}),i(e,"parts/OrdinalAxis.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.defined,s=e.extend,o=e.pick,n=t.addEvent,r=t.Axis,a=t.Chart,h=t.css,l=t.noop,c=t.Series,d=t.timeUnits;n(c,"updatedData",function(){var t=this.xAxis;t&&t.options.ordinal&&delete t.ordinalIndex}),r.prototype.getTimeTicks=function(t,e,s,o,n,r,a){var h,l,c,p,u,f,g=0,m={},x=[],v=-Number.MAX_VALUE,y=this.options.tickPixelInterval,b=this.chart.time,M=[];if(!this.options.ordinal&&!this.options.breaks||!n||n.length<3||void 0===e)return b.getTimeTicks.apply(b,arguments);for(u=n.length,h=0;h<u;h++){if(f=h&&n[h-1]>s,n[h]<e&&(g=h),h===u-1||n[h+1]-n[h]>5*r||f){if(n[h]>v){for(l=b.getTimeTicks(t,n[g],n[h],o);l.length&&l[0]<=v;)l.shift();l.length&&(v=l[l.length-1]),M.push(x.length),x=x.concat(l)}g=h+1}if(f)break}if(p=l.info,a&&p.unitRange<=d.hour){for(h=x.length-1,g=1;g<h;g++)b.dateFormat("%d",x[g])!==b.dateFormat("%d",x[g-1])&&(m[x[g]]="day",c=!0);c&&(m[x[0]]="day"),p.higherRanks=m}if(p.segmentStarts=M,x.info=p,a&&i(y)){for(var k,w,S,A,T,P=x.length,L=P,C=[],E=[];L--;)w=this.translate(x[L]),S&&(E[L]=S-w),C[L]=S=w;for(E.sort(),(A=E[Math.floor(E.length/2)])<.6*y&&(A=null),L=x[P-1]>s?P-1:P,S=void 0;L--;)w=C[L],T=Math.abs(S-w),S&&T<.8*y&&(null===A||T<.8*A)?(m[x[L]]&&!m[x[L+1]]?(k=L+1,S=w):k=L,x.splice(k,1)):S=w}return x},s(r.prototype,{beforeSetTickPositions:function(){var t,e,i,s,n,r,a,h,l=[],c=!1,d=this.getExtremes(),p=d.min,u=d.max,f=this.isXAxis&&!!this.options.breaks,g=this.options.ordinal,m=Number.MAX_VALUE,x=this.chart.options.chart.ignoreHiddenSeries;if(g||f){if(this.series.forEach(function(i,s){if(e=[],(!x||!1!==i.visible)&&(!1!==i.takeOrdinalPosition||f)&&(l=l.concat(i.processedXData),t=l.length,l.sort(function(t,e){return t-e}),m=Math.min(m,o(i.closestPointRange,m)),t)){for(s=0;s<t-1;)l[s]!==l[s+1]&&e.push(l[s+1]),s++;e[0]!==l[0]&&e.unshift(l[0]),l=e}i.isSeriesBoosting&&(h=!0)}),h&&(l.length=0),(t=l.length)>2){for(i=l[1]-l[0],a=t-1;a--&&!c;)l[a+1]-l[a]!==i&&(c=!0);!this.options.keepOrdinalPadding&&(l[0]-p>i||u-l[l.length-1]>i)&&(c=!0)}else this.options.overscroll&&(2===t?m=l[1]-l[0]:1===t?(m=this.options.overscroll,l=[l[0],l[0]+m]):m=this.overscrollPointsRange);c?(this.options.overscroll&&(this.overscrollPointsRange=m,l=l.concat(this.getOverscrollPositions())),this.ordinalPositions=l,s=this.ordinal2lin(Math.max(p,l[0]),!0),n=Math.max(this.ordinal2lin(Math.min(u,l[l.length-1]),!0),1),this.ordinalSlope=r=(u-p)/(n-s),this.ordinalOffset=p-s*r):(this.overscrollPointsRange=o(this.closestPointRange,this.overscrollPointsRange),this.ordinalPositions=this.ordinalSlope=this.ordinalOffset=void 0)}this.isOrdinal=g&&c,this.groupIntervalFactor=null},val2lin:function(t,e){var i,s=this.ordinalPositions;if(s){var o,n,r=s.length;for(o=r;o--;)if(s[o]===t){n=o;break}for(o=r-1;o--;)if(t>s[o]||0===o){n=o+(t-s[o])/(s[o+1]-s[o]);break}i=e?n:this.ordinalSlope*(n||0)+this.ordinalOffset}else i=t;return i},lin2val:function(t,e){var i=this.ordinalPositions;if(i){var s,o,n=this.ordinalSlope,r=this.ordinalOffset,a=i.length-1;if(e)t<0?t=i[0]:t>a?t=i[a]:o=t-(a=Math.floor(t));else for(;a--;)if(t>=(s=n*a+r)){o=(t-s)/(n*(a+1)+r-s);break}return void 0!==o&&void 0!==i[a]?i[a]+(o?o*(i[a+1]-i[a]):0):t}return t},getExtendedPositions:function(){var t,e,i=this,s=i.chart,o=i.series[0].currentDataGrouping,n=i.ordinalIndex,a=o?o.count+o.unitName:"raw",h=i.options.overscroll,c=i.getExtremes();return n||(n=i.ordinalIndex={}),n[a]||(t={series:[],chart:s,getExtremes:function(){return{min:c.dataMin,max:c.dataMax+h}},options:{ordinal:!0},val2lin:r.prototype.val2lin,ordinal2lin:r.prototype.ordinal2lin},i.series.forEach(function(n){(e={xAxis:t,xData:n.xData.slice(),chart:s,destroyGroupedData:l}).xData=e.xData.concat(i.getOverscrollPositions()),e.options={dataGrouping:o?{enabled:!0,forced:!0,approximation:"open",units:[[o.unitName,[o.count]]]}:{enabled:!1}},n.processData.apply(e),t.series.push(e)}),i.beforeSetTickPositions.apply(t),n[a]=t.ordinalPositions),n[a]},getOverscrollPositions:function(){var t=this.options.overscroll,e=this.overscrollPointsRange,s=[],o=this.dataMax;if(i(e))for(s.push(o);o<=this.dataMax+t;)o+=e,s.push(o);return s},getGroupIntervalFactor:function(t,e,i){var s,o,n=i.processedXData,r=n.length,a=[],h=this.groupIntervalFactor;if(!h){for(s=0;s<r-1;s++)a[s]=n[s+1]-n[s];a.sort(function(t,e){return t-e}),o=a[Math.floor(r/2)],t=Math.max(t,n[0]),e=Math.min(e,n[r-1]),this.groupIntervalFactor=h=r*o/(e-t)}return h},postProcessTickInterval:function(t){var e=this.ordinalSlope;return e?this.options.breaks?this.closestPointRange||t:t/(e/this.closestPointRange):t}}),r.prototype.ordinal2lin=r.prototype.val2lin,n(a,"pan",function(t){var e=this.xAxis[0],i=e.options.overscroll,s=t.originalEvent.chartX,o=this.options.chart&&this.options.chart.panning,n=!1;if(o&&"y"!==o.type&&e.options.ordinal&&e.series.length){var r,a,l,c,d=this.mouseDownX,p=e.getExtremes(),u=p.dataMax,f=p.min,g=p.max,m=this.hoverPoints,x=e.closestPointRange||e.overscrollPointsRange,v=(d-s)/(e.translationSlope*(e.ordinalSlope||x)),y={ordinalPositions:e.getExtendedPositions()},b=e.lin2val,M=e.val2lin;y.ordinalPositions?Math.abs(v)>1&&(m&&m.forEach(function(t){t.setState()}),v<0?(l=y,c=e.ordinalPositions?e:y):(l=e.ordinalPositions?e:y,c=y),u>(a=c.ordinalPositions)[a.length-1]&&a.push(u),this.fixedRange=g-f,(r=e.toFixedRange(null,null,b.apply(l,[M.apply(l,[f,!0])+v,!0]),b.apply(c,[M.apply(c,[g,!0])+v,!0]))).min>=Math.min(p.dataMin,f)&&r.max<=Math.max(u,g)+i&&e.setExtremes(r.min,r.max,!0,!1,{trigger:"pan"}),this.mouseDownX=s,h(this.container,{cursor:"move"})):n=!0}else n=!0;n||o&&/y/.test(o.type)?i&&(e.max=e.dataMax+i):t.preventDefault()}),n(r,"foundExtremes",function(){this.isXAxis&&i(this.options.overscroll)&&this.max===this.dataMax&&(!this.chart.mouseIsDown||this.isInternal)&&(!this.eventArgs||this.eventArgs&&"navigator"!==this.eventArgs.trigger)&&(this.max+=this.options.overscroll,!this.isInternal&&i(this.userMin)&&(this.min+=this.options.overscroll))}),n(r,"afterSetScale",function(){this.horiz&&!this.isDirty&&(this.isDirty=this.isOrdinal&&this.chart.navigator&&!this.chart.navigator.adaptToUpdatedData)})}),i(e,"modules/broken-axis.src.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.extend,s=e.isArray,o=e.pick,n=t.addEvent,r=t.find,a=t.fireEvent,h=t.Axis,l=t.Series,c=function(t,e){return r(e,function(e){return e.from<t&&t<e.to})};i(h.prototype,{isInBreak:function(t,e){var i=t.repeat||1/0,s=t.from,o=t.to-t.from,n=e>=s?(e-s)%i:i-(s-e)%i;return t.inclusive?n<=o:n<o&&0!==n},isInAnyBreak:function(t,e){var i,s,n,r=this.options.breaks,a=r&&r.length;if(a){for(;a--;)this.isInBreak(r[a],t)&&(i=!0,s||(s=o(r[a].showPoints,!this.isXAxis)));n=i&&e?i&&!s:i}return n}}),n(h,"afterInit",function(){"function"==typeof this.setBreaks&&this.setBreaks(this.options.breaks,!1)}),n(h,"afterSetTickPositions",function(){if(this.isBroken){var t,e=this.tickPositions,i=this.tickPositions.info,s=[];for(t=0;t<e.length;t++)this.isInAnyBreak(e[t])||s.push(e[t]);this.tickPositions=s,this.tickPositions.info=i}}),n(h,"afterSetOptions",function(){this.isBroken&&(this.options.ordinal=!1)}),h.prototype.setBreaks=function(t,e){var i=this,n=s(t)&&!!t.length;function r(t){var e,s,o=t;for(s=0;s<i.breakArray.length;s++)if((e=i.breakArray[s]).to<=t)o-=e.len;else{if(e.from>=t)break;if(i.isInBreak(e,t)){o-=t-e.from;break}}return o}i.isDirty=i.isBroken!==n,i.isBroken=n,i.options.breaks=i.userOptions.breaks=t,i.forceRedraw=!0,i.series.forEach(function(t){t.isDirty=!0}),n||i.val2lin!==r||(delete i.val2lin,delete i.lin2val),n&&(i.userOptions.ordinal=!1,i.val2lin=r,i.lin2val=function(t){var e,s,o=t;for(s=0;s<i.breakArray.length&&!((e=i.breakArray[s]).from>=o);s++)e.to<o?o+=e.len:i.isInBreak(e,o)&&(o+=e.len);return o},i.setExtremes=function(t,e,i,s,o){if(this.isBroken){for(var n,r=this.options.breaks;n=c(t,r);)t=n.to;for(;n=c(e,r);)e=n.from;e<t&&(e=t)}h.prototype.setExtremes.call(this,t,e,i,s,o)},i.setAxisTranslation=function(t){if(h.prototype.setAxisTranslation.call(this,t),this.unitLength=null,this.isBroken){var e,s,n,r,l=i.options.breaks,c=[],d=[],p=0,u=i.userMin||i.min,f=i.userMax||i.max,g=o(i.pointRangePadding,0);l.forEach(function(t){s=t.repeat||1/0,i.isInBreak(t,u)&&(u+=t.to%s-u%s),i.isInBreak(t,f)&&(f-=f%s-t.from%s)}),l.forEach(function(t){for(n=t.from,s=t.repeat||1/0;n-s>u;)n-=s;for(;n<u;)n+=s;for(r=n;r<f;r+=s)c.push({value:r,move:"in"}),c.push({value:r+(t.to-t.from),move:"out",size:t.breakSize})}),c.sort(function(t,e){return t.value===e.value?("in"===t.move?0:1)-("in"===e.move?0:1):t.value-e.value}),e=0,n=u,c.forEach(function(t){1===(e+="in"===t.move?1:-1)&&"in"===t.move&&(n=t.value),0===e&&(d.push({from:n,to:t.value,len:t.value-n-(t.size||0)}),p+=t.value-n-(t.size||0))}),i.breakArray=d,i.unitLength=f-u-p+g,a(i,"afterBreaks"),i.staticScale?i.transA=i.staticScale:i.unitLength&&(i.transA*=(f-i.min+g)/i.unitLength),g&&(i.minPixelPadding=i.transA*i.minPointOffset),i.min=u,i.max=f}}),o(e,!0)&&this.chart.redraw()},n(l,"afterGeneratePoints",function(){var t=this,e=t.isDirty,i=t.options.connectNulls,s=t.points,o=t.xAxis,n=t.yAxis;if(e)for(var r=s.length;r--;){var a=s[r],h=!(null===a.y&&!1===i)&&(o&&o.isInAnyBreak(a.x,!0)||n&&n.isInAnyBreak(a.y,!0));a.visible=!h&&!1!==a.options.visible}}),n(l,"afterRender",function(){this.drawBreaks(this.xAxis,["x"]),this.drawBreaks(this.yAxis,o(this.pointArrayMap,["y"]))}),t.Series.prototype.drawBreaks=function(t,e){var i,s,n,r,h=this,l=h.points;t&&e.forEach(function(e){i=t.breakArray||[],s=t.isXAxis?t.min:o(h.options.threshold,t.min),l.forEach(function(h){r=o(h["stack"+e.toUpperCase()],h[e]),i.forEach(function(e){n=!1,s<e.from&&r>e.to||s>e.from&&r<e.from?n="pointBreak":(s<e.from&&r>e.from&&r<e.to||s>e.from&&r>e.to&&r<e.from)&&(n="pointInBreak"),n&&a(t,n,{point:h,brk:e})})})})},t.Series.prototype.gappedPath=function(){var e=this.currentDataGrouping,i=e&&e.gapSize,s=this.options.gapSize,o=this.points.slice(),n=o.length-1,r=this.yAxis;if(s&&n>0){"value"!==this.options.gapUnit&&(s*=this.basePointRange),i&&i>s&&i>=this.basePointRange&&(s=i);for(var a=void 0,h=void 0;n--;)if(h&&!1!==h.visible||(h=o[n+1]),a=o[n],!1!==h.visible&&!1!==a.visible){if(h.x-a.x>s){var l=(a.x+h.x)/2;o.splice(n+1,0,{isNull:!0,x:l}),this.options.stacking&&((r.stacks[this.stackKey][l]=new t.StackItem(r,r.options.stackLabels,!1,l,this.stack)).total=0)}h=a}}return this.getGraphPath(o)}}),i(e,"masters/modules/broken-axis.src.js",[],function(){}),i(e,"parts/DataGrouping.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.arrayMax,s=e.arrayMin,o=e.correctFloat,n=e.defined,r=e.extend,a=e.isNumber,h=e.pick,l=t.addEvent,c=t.Axis,d=t.defaultPlotOptions,p=t.format,u=t.merge,f=t.Point,g=t.Series,m=t.Tooltip,x=t.approximations={sum:function(t){var e,i=t.length;if(!i&&t.hasNulls)e=null;else if(i)for(e=0;i--;)e+=t[i];return e},average:function(t){var e=t.length,i=x.sum(t);return a(i)&&e&&(i=o(i/e)),i},averages:function(){var t=[];return[].forEach.call(arguments,function(e){t.push(x.average(e))}),void 0===t[0]?void 0:t},open:function(t){return t.length?t[0]:t.hasNulls?null:void 0},high:function(t){return t.length?i(t):t.hasNulls?null:void 0},low:function(t){return t.length?s(t):t.hasNulls?null:void 0},close:function(t){return t.length?t[t.length-1]:t.hasNulls?null:void 0},ohlc:function(t,e,i,s){if(t=x.open(t),e=x.high(e),i=x.low(i),s=x.close(s),a(t)||a(e)||a(i)||a(s))return[t,e,i,s]},range:function(t,e){return t=x.low(t),e=x.high(e),a(t)||a(e)?[t,e]:null===t&&null===e?null:void 0}},v=function(t,e,i,s){var o,r,h,l,c,d,p,f,g=this,m=g.data,v=g.options&&g.options.data,y=[],b=[],M=[],k=t.length,w=!!e,S=[],A=g.pointArrayMap,T=A&&A.length,P=["x"].concat(A||["y"]),L=0,C=0;for(l="function"==typeof(f=s)?f:x[f]?x[f]:x[g.getDGApproximation&&g.getDGApproximation()||"average"],T?A.forEach(function(){S.push([])}):S.push([]),c=T||1,d=0;d<=k&&!(t[d]>=i[0]);d++);for(;d<=k;d++){for(;void 0!==i[L+1]&&t[d]>=i[L+1]||d===k;){for(o=i[L],g.dataGroupInfo={start:g.cropStart+C,length:S[0].length},h=l.apply(g,S),g.pointClass&&!n(g.dataGroupInfo.options)&&(g.dataGroupInfo.options=u(g.pointClass.prototype.optionsToObject.call({series:g},g.options.data[g.cropStart+C])),P.forEach(function(t){delete g.dataGroupInfo.options[t]})),void 0!==h&&(y.push(o),b.push(h),M.push(g.dataGroupInfo)),C=d,p=0;p<c;p++)S[p].length=0,S[p].hasNulls=!1;if(L+=1,d===k)break}if(d===k)break;if(A){var E,O=g.cropStart+d,D=m&&m[O]||g.pointClass.prototype.applyOptions.apply({series:g},[v[O]]);for(p=0;p<T;p++)E=D[A[p]],a(E)?S[p].push(E):null===E&&(S[p].hasNulls=!0)}else r=w?e[d]:null,a(r)?S[0].push(r):null===r&&(S[0].hasNulls=!0)}return{groupedXData:y,groupedYData:b,groupMap:M}},y={approximations:x,groupData:v},b=g.prototype,M=b.processData,k=b.generatePoints,w={groupPixelWidth:2,dateTimeLabelFormats:{millisecond:["%A, %b %e, %H:%M:%S.%L","%A, %b %e, %H:%M:%S.%L","-%H:%M:%S.%L"],second:["%A, %b %e, %H:%M:%S","%A, %b %e, %H:%M:%S","-%H:%M:%S"],minute:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],hour:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],day:["%A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],week:["Week from %A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],month:["%B %Y","%B","-%B %Y"],year:["%Y","%Y","-%Y"]}},S={line:{},spline:{},area:{},areaspline:{},arearange:{},column:{groupPixelWidth:10},columnrange:{groupPixelWidth:10},candlestick:{groupPixelWidth:10},ohlc:{groupPixelWidth:5}},A=t.defaultDataGroupingUnits=[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1]],["week",[1]],["month",[1,3,6]],["year",null]];return b.getDGApproximation=function(){return t.seriesTypes.arearange&&this instanceof t.seriesTypes.arearange?"range":t.seriesTypes.ohlc&&this instanceof t.seriesTypes.ohlc?"ohlc":t.seriesTypes.column&&this instanceof t.seriesTypes.column?"sum":"average"},b.groupData=v,b.processData=function(){var t,e,i,s,o=this.chart,r=this.options.dataGrouping,a=!1!==this.allowDG&&r&&h(r.enabled,o.options.isStock),l=this.visible||!o.options.chart.ignoreHiddenSeries,c=this.currentDataGrouping,d=!1;if(this.forceCrop=a,this.groupPixelWidth=null,this.hasProcessed=!0,a&&!this.requireSorting&&(this.requireSorting=d=!0),e=!1===M.apply(this,arguments)||!a,d&&(this.requireSorting=!1),!e){this.destroyGroupedData();var p,u=r.groupAll?this.xData:this.processedXData,f=r.groupAll?this.yData:this.processedYData,g=o.plotSizeX,m=this.xAxis,x=m.options.ordinal,v=this.groupPixelWidth=m.getGroupPixelWidth&&m.getGroupPixelWidth();if(v){t=!0,this.isDirty=!0,this.points=null;var y=m.getExtremes(),k=y.min,w=y.max,S=v*(w-k)/g*(x&&m.getGroupIntervalFactor(k,w,this)||1),T=m.getTimeTicks(m.normalizeTimeTickInterval(S,r.units||A),Math.min(k,u[0]),Math.max(w,u[u.length-1]),m.options.startOfWeek,u,this.closestPointRange),P=b.groupData.apply(this,[u,f,T,r.approximation]),L=P.groupedXData,C=P.groupedYData,E=0;if(r.smoothed&&L.length){for(L[p=L.length-1]=Math.min(L[p],w);p--&&p>0;)L[p]+=S/2;L[0]=Math.max(L[0],k)}for(p=1;p<T.length;p++)T.info.segmentStarts&&-1!==T.info.segmentStarts.indexOf(p)||(E=Math.max(T[p]-T[p-1],E));(i=T.info).gapSize=E,this.closestPointRange=T.info.totalRange,this.groupMap=P.groupMap,n(L[0])&&L[0]<m.min&&l&&((!n(m.options.min)&&m.min<=m.dataMin||m.min===m.dataMin)&&(m.min=Math.min(L[0],m.min)),m.dataMin=Math.min(L[0],m.dataMin)),r.groupAll&&(L=(s=this.cropData(L,C,m.min,m.max,1)).xData,C=s.yData),this.processedXData=L,this.processedYData=C}else this.groupMap=null;this.hasGroupedData=t,this.currentDataGrouping=i,this.preventGraphAnimation=(c&&c.totalRange)!==(i&&i.totalRange)}},b.destroyGroupedData=function(){this.groupedData&&(this.groupedData.forEach(function(t,e){t&&(this.groupedData[e]=t.destroy?t.destroy():null)},this),this.groupedData.length=0)},b.generatePoints=function(){k.apply(this),this.destroyGroupedData(),this.groupedData=this.hasGroupedData?this.points:null},l(f,"update",function(){if(this.dataGroup)return t.error(24,!1,this.series.chart),!1}),l(m,"headerFormatter",function(t){var e,i,s,o,n,h=this.chart,l=h.time,c=t.labelConfig,d=c.series,u=d.options,f=d.tooltipOptions,g=u.dataGrouping,m=f.xDateFormat,x=d.xAxis,v=f[(t.isFooter?"footer":"header")+"Format"];x&&"datetime"===x.options.type&&g&&a(c.key)&&(i=d.currentDataGrouping,s=g.dateTimeLabelFormats||w.dateTimeLabelFormats,i?(o=s[i.unitName],1===i.count?m=o[0]:(m=o[1],e=o[2])):!m&&s&&(m=this.getXDateFormat(c,f,x)),n=l.dateFormat(m,c.key),e&&(n+=l.dateFormat(e,c.key+i.totalRange-1)),d.chart.styledMode&&(v=this.styledModeFormat(v)),t.text=p(v,{point:r(c.point,{key:n}),series:d},h),t.preventDefault())}),l(g,"destroy",b.destroyGroupedData),l(g,"afterSetOptions",function(t){var e=t.options,i=this.type,s=this.chart.options.plotOptions,o=d[i].dataGrouping,n=this.useCommonDataGrouping&&w;(S[i]||n)&&(o||(o=u(w,S[i])),e.dataGrouping=u(n,o,s.series&&s.series.dataGrouping,s[i].dataGrouping,this.userOptions.dataGrouping))}),l(c,"afterSetScale",function(){this.series.forEach(function(t){t.hasProcessed=!1})}),c.prototype.getGroupPixelWidth=function(){var t,e,i,s=this.series,o=s.length,n=0,r=!1;for(t=o;t--;)(i=s[t].options.dataGrouping)&&(n=Math.max(n,h(i.groupPixelWidth,w.groupPixelWidth)));for(t=o;t--;)(i=s[t].options.dataGrouping)&&s[t].hasProcessed&&(e=(s[t].processedXData||s[t].data).length,(s[t].groupPixelWidth||e>this.chart.plotSizeX/n||e&&i.forced)&&(r=!0));return r?n:0},c.prototype.setDataGrouping=function(t,e){var i;if(e=h(e,!0),t||(t={forced:!1,units:null}),this instanceof c)for(i=this.series.length;i--;)this.series[i].update({dataGrouping:t},!1);else this.chart.options.series.forEach(function(e){e.dataGrouping=t},!1);this.ordinalSlope=null,e&&this.chart.redraw()},t.dataGrouping=y,y}),i(e,"parts/OHLCSeries.js",[e["parts/Globals.js"]],function(t){var e=t.Point,i=t.seriesType,s=t.seriesTypes;i("ohlc","column",{lineWidth:1,tooltip:{pointFormat:'<span style="color:{point.color}"></span> <b> {series.name}</b><br/>Open: {point.open}<br/>High: {point.high}<br/>Low: {point.low}<br/>Close: {point.close}<br/>'},threshold:null,states:{hover:{lineWidth:3}},stickyTracking:!0},{directTouch:!1,pointArrayMap:["open","high","low","close"],toYData:function(t){return[t.open,t.high,t.low,t.close]},pointValKey:"close",pointAttrToOptions:{stroke:"color","stroke-width":"lineWidth"},init:function(){s.column.prototype.init.apply(this,arguments),this.options.stacking=!1},pointAttribs:function(t,e){var i=s.column.prototype.pointAttribs.call(this,t,e),o=this.options;return delete i.fill,!t.options.color&&o.upColor&&t.open<t.close&&(i.stroke=o.upColor),i},translate:function(){var t=this,e=t.yAxis,i=!!t.modifyValue,o=["plotOpen","plotHigh","plotLow","plotClose","yBottom"];s.column.prototype.translate.apply(t),t.points.forEach(function(s){[s.open,s.high,s.low,s.close,s.low].forEach(function(n,r){null!==n&&(i&&(n=t.modifyValue(n)),s[o[r]]=e.toPixels(n,!0))}),s.tooltipPos[1]=s.plotHigh+e.pos-t.chart.plotTop})},drawPoints:function(){var t=this,e=t.points,i=t.chart;e.forEach(function(e){var s,o,n,r,a,h,l=e.graphic,c=!l;void 0!==e.plotY&&(l||(e.graphic=l=i.renderer.path().add(t.group)),i.styledMode||l.attr(t.pointAttribs(e,e.selected&&"select")),n=l.strokeWidth()%2/2,h=Math.round(e.plotX)-n,r=Math.round(e.shapeArgs.width/2),a=["M",h,Math.round(e.yBottom),"L",h,Math.round(e.plotHigh)],null!==e.open&&(s=Math.round(e.plotOpen)+n,a.push("M",h,s,"L",h-r,s)),null!==e.close&&(o=Math.round(e.plotClose)+n,a.push("M",h,o,"L",h+r,o)),l[c?"attr":"animate"]({d:a}).addClass(e.getClassName(),!0))})},animate:null},{getClassName:function(){return e.prototype.getClassName.call(this)+(this.open<this.close?" highcharts-point-up":" highcharts-point-down")}})}),i(e,"parts/CandlestickSeries.js",[e["parts/Globals.js"]],function(t){var e=t.defaultPlotOptions,i=t.merge,s=t.seriesType,o=t.seriesTypes,n={states:{hover:{lineWidth:2}},tooltip:e.ohlc.tooltip,threshold:null,lineColor:"#000000",lineWidth:1,upColor:"#ffffff",stickyTracking:!0};s("candlestick","ohlc",i(e.column,n),{pointAttribs:function(t,e){var i,s=o.column.prototype.pointAttribs.call(this,t,e),n=this.options,r=t.open<t.close,a=n.lineColor||this.color;return s["stroke-width"]=n.lineWidth,s.fill=t.options.color||r&&n.upColor||this.color,s.stroke=t.options.lineColor||r&&n.upLineColor||a,e&&(i=n.states[e],s.fill=i.color||s.fill,s.stroke=i.lineColor||s.stroke,s["stroke-width"]=i.lineWidth||s["stroke-width"]),s},drawPoints:function(){var t=this,e=t.points,i=t.chart,s=t.yAxis.reversed;e.forEach(function(e){var o,n,r,a,h,l,c,d,p,u,f=e.graphic,g=!f;void 0!==e.plotY&&(f||(e.graphic=f=i.renderer.path().add(t.group)),t.chart.styledMode||f.attr(t.pointAttribs(e,e.selected&&"select")).shadow(t.options.shadow),c=f.strokeWidth()%2/2,d=Math.round(e.plotX)-c,o=e.plotOpen,n=e.plotClose,r=Math.min(o,n),a=Math.max(o,n),u=Math.round(e.shapeArgs.width/2),h=s?a!==e.yBottom:Math.round(r)!==Math.round(e.plotHigh),l=s?Math.round(r)!==Math.round(e.plotHigh):a!==e.yBottom,r=Math.round(r)+c,a=Math.round(a)+c,(p=[]).push("M",d-u,a,"L",d-u,r,"L",d+u,r,"L",d+u,a,"Z","M",d,r,"L",d,h?Math.round(s?e.yBottom:e.plotHigh):r,"M",d,a,"L",d,l?Math.round(s?e.plotHigh:e.yBottom):a),f[g?"attr":"animate"]({d:p}).addClass(e.getClassName(),!0))})}})}),i(e,"mixins/on-series.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.defined,s=t.seriesTypes,o=t.stableSort;return{getPlotBox:function(){return t.Series.prototype.getPlotBox.call(this.options.onSeries&&this.chart.get(this.options.onSeries)||this)},translate:function(){s.column.prototype.translate.apply(this);var t,e,n,r,a,h,l,c=this,d=c.options,p=c.chart,u=c.points,f=u.length-1,g=d.onSeries,m=g&&p.get(g),x=d.onKey||"y",v=m&&m.options.step,y=m&&m.points,b=y&&y.length,M=p.inverted,k=c.xAxis,w=c.yAxis,S=0;if(m&&m.visible&&b)for(S=(m.pointXOffset||0)+(m.barW||0)/2,h=m.currentDataGrouping,r=y[b-1].x+(h?h.totalRange:0),o(u,function(t,e){return t.x-e.x}),x="plot"+x[0].toUpperCase()+x.substr(1);b--&&u[f]&&(n=y[b],(t=u[f]).y=n.y,!(n.x<=t.x&&void 0!==n[x]&&(t.x<=r&&(t.plotY=n[x],n.x<t.x&&!v&&(a=y[b+1])&&void 0!==a[x]&&(l=(t.x-n.x)/(a.x-n.x),t.plotY+=l*(a[x]-n[x]),t.y+=l*(a.y-n.y))),b++,--f<0))););u.forEach(function(t,s){var o;t.plotX+=S,(void 0===t.plotY||M)&&(t.plotX>=0&&t.plotX<=k.len?M?(t.plotY=k.translate(t.x,0,1,0,1),t.plotX=i(t.y)?w.translate(t.y,0,0,0,1):0):t.plotY=(k.opposite?0:c.yAxis.len)+k.offset:t.shapeArgs={}),(e=u[s-1])&&e.plotX===t.plotX&&(void 0===e.stackIndex&&(e.stackIndex=0),o=e.stackIndex+1),t.stackIndex=o}),this.onSeries=m}}}),i(e,"parts/FlagsSeries.js",[e["parts/Globals.js"],e["parts/Utilities.js"],e["mixins/on-series.js"]],function(t,e,i){var s=e.defined,o=e.isNumber,n=e.objectEach,r=e.wrap,a=t.addEvent,h=t.merge,l=t.noop,c=t.Renderer,d=t.Series,p=t.seriesType,u=t.SVGRenderer,f=t.TrackerMixin,g=t.VMLRenderer,m=u.prototype.symbols;function x(t){m[t+"pin"]=function(e,i,s,o,n){var r,a,h=n&&n.anchorX,l=n&&n.anchorY;return"circle"===t&&o>s&&(e-=Math.round((o-s)/2),s=o),r=m[t](e,i,s,o),h&&l&&(a=i>l?i:i+o,r.push("M","circle"===t?e+s/2:r[1]+r[4]/2,a,"L",h,l),r=r.concat(m.circle(h-1,l-1,2,2))),r}}p("flags","column",{pointRange:0,allowOverlapX:!1,shape:"flag",stackDistance:12,textAlign:"center",tooltip:{pointFormat:"{point.text}<br/>"},threshold:null,y:-30,fillColor:"#ffffff",lineWidth:1,states:{hover:{lineColor:"#000000",fillColor:"#ccd6eb"}},style:{fontSize:"11px",fontWeight:"bold"}},{sorted:!1,noSharedTooltip:!0,allowDG:!1,takeOrdinalPosition:!1,trackerGroups:["markerGroup"],forceCrop:!0,init:d.prototype.init,pointAttribs:function(t,e){var i=this.options,s=t&&t.color||this.color,o=i.lineColor,n=t&&t.lineWidth,r=t&&t.fillColor||i.fillColor;return e&&(r=i.states[e].fillColor,o=i.states[e].lineColor,n=i.states[e].lineWidth),{fill:r||s,stroke:o||s,"stroke-width":n||i.lineWidth||0}},translate:i.translate,getPlotBox:i.getPlotBox,drawPoints:function(){var e,i,o,a,l,c,d,p,u,f,g,m=this.points,x=this.chart,v=x.renderer,y=x.inverted,b=this.options,M=b.y,k=this.yAxis,w={},S=[];for(a=m.length;a--;)l=m[a],f=(y?l.plotY:l.plotX)>this.xAxis.len,e=l.plotX,d=l.stackIndex,o=l.options.shape||b.shape,void 0!==(i=l.plotY)&&(i=l.plotY+M-(void 0!==d&&d*b.stackDistance)),l.anchorX=d?void 0:l.plotX,p=d?void 0:l.plotY,g="flag"!==o,c=l.graphic,void 0!==i&&e>=0&&!f?(c||(c=l.graphic=v.label("",null,null,o,null,null,b.useHTML),x.styledMode||c.attr(this.pointAttribs(l)).css(h(b.style,l.style)),c.attr({align:g?"center":"left",width:b.width,height:b.height,"text-align":b.textAlign}).addClass("highcharts-point").add(this.markerGroup),l.graphic.div&&(l.graphic.div.point=l),x.styledMode||c.shadow(b.shadow),c.isNew=!0),e>0&&(e-=c.strokeWidth()%2),u={y:i,anchorY:p},b.allowOverlapX&&(u.x=e,u.anchorX=l.anchorX),c.attr({text:l.options.title||b.title||"A"})[c.isNew?"attr":"animate"](u),b.allowOverlapX||(w[l.plotX]?w[l.plotX].size=Math.max(w[l.plotX].size,c.width):w[l.plotX]={align:g?.5:0,size:c.width,target:e,anchorX:e}),l.tooltipPos=[e,i+k.pos-x.plotTop]):c&&(l.graphic=c.destroy());b.allowOverlapX||(n(w,function(t){t.plotX=t.anchorX,S.push(t)}),t.distribute(S,y?k.len:this.xAxis.len,100),m.forEach(function(t){var e=t.graphic&&w[t.plotX];e&&(t.graphic[t.graphic.isNew?"attr":"animate"]({x:e.pos+e.align*e.size,anchorX:t.anchorX}),s(e.pos)?t.graphic.isNew=!1:(t.graphic.attr({x:-9999,anchorX:-9999}),t.graphic.isNew=!0))})),b.useHTML&&r(this.markerGroup,"on",function(e){return t.SVGElement.prototype.on.apply(e.apply(this,[].slice.call(arguments,1)),[].slice.call(arguments,1))})},drawTracker:function(){var t=this.points;f.drawTrackerPoint.apply(this),t.forEach(function(e){var i=e.graphic;i&&a(i.element,"mouseover",function(){e.stackIndex>0&&!e.raised&&(e._y=i.y,i.attr({y:e._y-8}),e.raised=!0),t.forEach(function(t){t!==e&&t.raised&&t.graphic&&(t.graphic.attr({y:t._y}),t.raised=!1)})})})},animate:function(t){t?this.setClip():this.animate=null},setClip:function(){d.prototype.setClip.apply(this,arguments),!1!==this.options.clip&&this.sharedClipKey&&this.markerGroup.clip(this.chart[this.sharedClipKey])},buildKDTree:l,invertGroups:l},{isValid:function(){return o(this.y)||void 0===this.y}}),m.flag=function(t,e,i,s,o){var n=o&&o.anchorX||t,r=o&&o.anchorY||e;return m.circle(n-1,r-1,2,2).concat(["M",n,r,"L",t,e+s,t,e,t+i,e,t+i,e+s,t,e+s,"Z"])},x("circle"),x("square"),c===g&&["circlepin","flag","squarepin"].forEach(function(t){g.prototype.symbols[t]=m[t]})}),i(e,"parts/RangeSelector.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.defined,s=e.destroyObjectProperties,o=e.discardElement,n=e.extend,r=e.isNumber,a=e.objectEach,h=e.pick,l=e.pInt,c=e.splat,d=t.addEvent,p=t.Axis,u=t.Chart,f=t.css,g=t.createElement,m=t.defaultOptions,x=t.fireEvent,v=t.merge;function y(t){this.init(t)}n(m,{rangeSelector:{verticalAlign:"top",buttonTheme:{width:28,height:18,padding:2,zIndex:7},floating:!1,x:0,y:0,height:void 0,inputPosition:{align:"right",x:0,y:0},buttonPosition:{align:"left",x:0,y:0},labelStyle:{color:"#666666"}}}),m.lang=v(m.lang,{rangeSelectorZoom:"Zoom",rangeSelectorFrom:"From",rangeSelectorTo:"To"}),y.prototype={clickButton:function(t,e){var i,s,o,n,a,l,u,f=this.chart,g=this.buttonOptions[t],m=f.xAxis[0],x=f.scroller&&f.scroller.getUnionExtremes()||m||{},v=x.dataMin,y=x.dataMax,b=m&&Math.round(Math.min(m.max,h(y,m.max))),M=g.type,k=g._range,w=g.dataGrouping;if(null!==v&&null!==y){if(f.fixedRange=k,w&&(this.forcedDataGrouping=!0,p.prototype.setDataGrouping.call(m||{chart:this.chart},w,!1),this.frozenStates=g.preserveDataGrouping),"month"===M||"year"===M)m?(l={range:g,max:b,chart:f,dataMin:v,dataMax:y},i=m.minFromRange.call(l),r(l.newMax)&&(b=l.newMax)):k=g;else if(k)i=Math.max(b-k,v),b=Math.min(i+k,y);else if("ytd"===M){if(!m)return void(this.deferredYTDClick=t);void 0===y&&(v=Number.MAX_VALUE,y=Number.MIN_VALUE,f.series.forEach(function(t){var e=t.xData;v=Math.min(e[0],v),y=Math.max(e[e.length-1],y)}),e=!1),i=o=(u=this.getYTDExtremes(y,v,f.time.useUTC)).min,b=u.max}else"all"===M&&m&&(i=v,b=y);i+=g._offsetMin,b+=g._offsetMax,this.setSelected(t),m?m.setExtremes(i,b,h(e,1),null,{trigger:"rangeSelectorButton",rangeSelectorButton:g}):(s=c(f.options.xAxis)[0],a=s.range,s.range=k,n=s.min,s.min=o,d(f,"load",function(){s.range=a,s.min=n}))}},setSelected:function(t){this.selected=this.options.selected=t},defaultButtons:[{type:"month",count:1,text:"1m"},{type:"month",count:3,text:"3m"},{type:"month",count:6,text:"6m"},{type:"ytd",text:"YTD"},{type:"year",count:1,text:"1y"},{type:"all",text:"All"}],init:function(t){var e=this,i=t.options.rangeSelector,s=i.buttons||[].concat(e.defaultButtons),o=i.selected,n=function(){var t=e.minInput,i=e.maxInput;t&&t.blur&&x(t,"blur"),i&&i.blur&&x(i,"blur")};e.chart=t,e.options=i,e.buttons=[],e.buttonOptions=s,this.unMouseDown=d(t.container,"mousedown",n),this.unResize=d(t,"resize",n),s.forEach(e.computeButtonRange),void 0!==o&&s[o]&&this.clickButton(o,!1),d(t,"load",function(){t.xAxis&&t.xAxis[0]&&d(t.xAxis[0],"setExtremes",function(i){this.max-this.min!==t.fixedRange&&"rangeSelectorButton"!==i.trigger&&"updatedData"!==i.trigger&&e.forcedDataGrouping&&!e.frozenStates&&this.setDataGrouping(!1,!1)})})},updateButtonStates:function(){var t=this,e=this.chart,i=e.xAxis[0],s=Math.round(i.max-i.min),o=!i.hasVisibleSeries,n=e.scroller&&e.scroller.getUnionExtremes()||i,a=n.dataMin,h=n.dataMax,l=t.getYTDExtremes(h,a,e.time.useUTC),c=l.min,d=l.max,p=t.selected,u=r(p),f=t.options.allButtonsEnabled,g=t.buttons;t.buttonOptions.forEach(function(e,n){var r,l,m=e._range,x=e.type,v=e.count||1,y=g[n],b=0,M=e._offsetMax-e._offsetMin,k=n===p,w=m>h-a,S=m<i.minRange,A=!1,T=!1,P=m===s;("month"===x||"year"===x)&&s+36e5>=864e5*{month:28,year:365}[x]*v-M&&s-36e5<=864e5*{month:31,year:366}[x]*v+M?P=!0:"ytd"===x?(P=d-c+M===s,A=!k):"all"===x&&(P=i.max-i.min>=h-a,T=!k&&u&&P),r=!f&&(w||S||T||o),l=k&&P||P&&!u&&!A||k&&t.frozenStates,r?b=3:l&&(u=!0,b=2),y.state!==b&&(y.setState(b),0===b&&p===n&&t.setSelected(null))})},computeButtonRange:function(t){var e=t.type,i=t.count||1,s={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5};s[e]?t._range=s[e]*i:"month"!==e&&"year"!==e||(t._range=24*{month:30,year:365}[e]*36e5*i),t._offsetMin=h(t.offsetMin,0),t._offsetMax=h(t.offsetMax,0),t._range+=t._offsetMax-t._offsetMin},setInputValue:function(t,e){var s=this.chart.options.rangeSelector,o=this.chart.time,n=this[t+"Input"];i(e)&&(n.previousValue=n.HCTime,n.HCTime=e),n.value=o.dateFormat(s.inputEditDateFormat||"%Y-%m-%d",n.HCTime),this[t+"DateBox"].attr({text:o.dateFormat(s.inputDateFormat||"%b %e, %Y",n.HCTime)})},showInput:function(t){var e=this.inputGroup,i=this[t+"DateBox"];f(this[t+"Input"],{left:e.translateX+i.x+"px",top:e.translateY+"px",width:i.width-2+"px",height:i.height-2+"px",border:"2px solid silver"})},hideInput:function(t){f(this[t+"Input"],{border:0,width:"1px",height:"1px"}),this.setInputValue(t)},drawInput:function(e){var i,s,o,a=this,h=a.chart,c=h.renderer.style||{},d=h.renderer,p=h.options.rangeSelector,u=m.lang,x=a.div,y="min"===e,b=this.inputGroup;function M(){var t=i.value,e=(p.inputDateParser||Date.parse)(t),s=h.xAxis[0],o=h.scroller&&h.scroller.xAxis?h.scroller.xAxis:s,n=o.dataMin,c=o.dataMax;e!==i.previousValue&&(i.previousValue=e,r(e)||(e=t.split("-"),e=Date.UTC(l(e[0]),l(e[1])-1,l(e[2]))),r(e)&&(h.time.useUTC||(e+=60*(new Date).getTimezoneOffset()*1e3),y?e>a.maxInput.HCTime?e=void 0:e<n&&(e=n):e<a.minInput.HCTime?e=void 0:e>c&&(e=c),void 0!==e&&s.setExtremes(y?e:s.min,y?s.max:e,void 0,void 0,{trigger:"rangeSelectorInput"})))}this[e+"Label"]=s=d.label(u[y?"rangeSelectorFrom":"rangeSelectorTo"],this.inputGroup.offset).addClass("highcharts-range-label").attr({padding:2}).add(b),b.offset+=s.width+5,this[e+"DateBox"]=o=d.label("",b.offset).addClass("highcharts-range-input").attr({padding:2,width:p.inputBoxWidth||90,height:p.inputBoxHeight||17,"text-align":"center"}).on("click",function(){a.showInput(e),a[e+"Input"].focus()}),h.styledMode||o.attr({stroke:p.inputBoxBorderColor||"#cccccc","stroke-width":1}),o.add(b),b.offset+=o.width+(y?10:0),this[e+"Input"]=i=g("input",{name:e,className:"highcharts-range-selector",type:"text"},{top:h.plotTop+"px"},x),h.styledMode||(s.css(v(c,p.labelStyle)),o.css(v({color:"#333333"},c,p.inputStyle)),f(i,n({position:"absolute",border:0,width:"1px",height:"1px",padding:0,textAlign:"center",fontSize:c.fontSize,fontFamily:c.fontFamily,top:"-9999em"},p.inputStyle))),i.onfocus=function(){a.showInput(e)},i.onblur=function(){i===t.doc.activeElement&&M(),a.hideInput(e),i.blur()},i.onchange=M,i.onkeypress=function(t){13===t.keyCode&&M()}},getPosition:function(){var t=this.chart,e=t.options.rangeSelector,i="top"===e.verticalAlign?t.plotTop-t.axisOffset[0]:0;return{buttonTop:i+e.buttonPosition.y,inputTop:i+e.inputPosition.y-10}},getYTDExtremes:function(t,e,i){var s,o=this.chart.time,n=new o.Date(t),r=o.get("FullYear",n),a=i?o.Date.UTC(r,0,1):+new o.Date(r,0,1);return s=Math.max(e||0,a),n=n.getTime(),{max:Math.min(t||n,n),min:s}},render:function(t,e){var i,s,o,n,r,a=this,l=a.chart,c=l.renderer,d=l.container,p=l.options,u=p.exporting&&!1!==p.exporting.enabled&&p.navigation&&p.navigation.buttonOptions,f=m.lang,x=a.div,v=p.rangeSelector,y=h(p.chart.style&&p.chart.style.zIndex,0)+1,b=v.floating,M=a.buttons,k=a.inputGroup,w=v.buttonTheme,S=v.buttonPosition,A=v.inputPosition,T=v.inputEnabled,P=w&&w.states,L=l.plotLeft,C=a.buttonGroup,E=a.rendered,O=a.options.verticalAlign,D=l.legend,B=D&&D.options,I=S.y,z=A.y,R=E||!1,W=R?"animate":"attr",G=0,X=0;if(!1!==v.enabled){var N,H,j,Y;if(E||(a.group=s=c.g("range-selector-group").attr({zIndex:7}).add(),a.buttonGroup=C=c.g("range-selector-buttons").add(s),a.zoomText=c.text(f.rangeSelectorZoom,0,15).add(C),l.styledMode||(a.zoomText.css(v.labelStyle),w["stroke-width"]=h(w["stroke-width"],0)),a.buttonOptions.forEach(function(t,e){M[e]=c.button(t.text,0,0,function(i){var s,o=t.events&&t.events.click;o&&(s=o.call(t,i)),!1!==s&&a.clickButton(e),a.isActive=!0},w,P&&P.hover,P&&P.select,P&&P.disabled).attr({"text-align":"center"}).add(C)}),!1!==T&&(a.div=x=g("div",null,{position:"relative",height:0,zIndex:y}),d.parentNode.insertBefore(x,d),a.inputGroup=k=c.g("input-group").add(s),k.offset=0,a.drawInput("min"),a.drawInput("max"))),a.zoomText[W]({x:h(L+S.x,L)}),i=h(L+S.x,L)+a.zoomText.getBBox().width+5,a.buttonOptions.forEach(function(t,e){M[e][W]({x:i}),i+=M[e].width+h(v.buttonSpacing,5)}),L=l.plotLeft-l.spacing[3],a.updateButtonStates(),u&&this.titleCollision(l)&&"top"===O&&"right"===S.align&&S.y+C.getBBox().height-12<(u.y||0)+u.height&&(G=-40),"left"===S.align?r=S.x-l.spacing[3]:"right"===S.align&&(r=S.x+G-l.spacing[1]),C.align({y:S.y,width:C.getBBox().width,align:S.align,x:r},!0,l.spacingBox),a.group.placed=R,a.buttonGroup.placed=R,!1!==T)G=u&&this.titleCollision(l)&&"top"===O&&"right"===A.align&&A.y-k.getBBox().height-12<(u.y||0)+u.height+l.spacing[0]?-40:0,"left"===A.align?r=L:"right"===A.align&&(r=-Math.max(l.axisOffset[1],-G)),k.align({y:A.y,width:k.getBBox().width,align:A.align,x:A.x+r-2},!0,l.spacingBox),N=k.alignAttr.translateX+k.alignOptions.x-G+k.getBBox().x+2,H=k.alignOptions.width,j=C.alignAttr.translateX+C.getBBox().x,Y=C.getBBox().width+20,(A.align===S.align||j+Y>N&&N+H>j&&I<z+k.getBBox().height)&&k.attr({translateX:k.alignAttr.translateX+(l.axisOffset[1]>=-G?0:-G),translateY:k.alignAttr.translateY+C.getBBox().height+10}),a.setInputValue("min",t),a.setInputValue("max",e),a.inputGroup.placed=R;a.group.align({verticalAlign:O},!0,l.spacingBox),o=a.group.getBBox().height+20,n=a.group.alignAttr.translateY,"bottom"===O&&(X=n-(o=o+(B&&"bottom"===B.verticalAlign&&B.enabled&&!B.floating?D.legendHeight+h(B.margin,10):0)-20)-(b?0:v.y)-(l.titleOffset?l.titleOffset[2]:0)-10),"top"===O?(b&&(X=0),l.titleOffset&&l.titleOffset[0]&&(X=l.titleOffset[0]),X+=l.margin[0]-l.spacing[0]||0):"middle"===O&&(z===I?X=z<0?n+void 0:n:(z||I)&&(z<0||I<0?X-=Math.min(z,I):X=n-o+void 0)),a.group.translate(v.x,v.y+Math.floor(X)),!1!==T&&(a.minInput.style.marginTop=a.group.translateY+"px",a.maxInput.style.marginTop=a.group.translateY+"px"),a.rendered=!0}},getHeight:function(){var t,e=this.options,i=this.group,s=e.inputPosition,o=e.buttonPosition,n=e.y,r=o.y,a=s.y,h=0;return e.height?e.height:(h=i?i.getBBox(!0).height+13+n:0,t=Math.min(a,r),(a<0&&r<0||a>0&&r>0)&&(h+=Math.abs(t)),h)},titleCollision:function(t){return!(t.options.title.text||t.options.subtitle.text)},update:function(t){var e=this.chart;v(!0,e.options.rangeSelector,t),this.destroy(),this.init(e),e.rangeSelector.render()},destroy:function(){var t=this,e=t.minInput,i=t.maxInput;t.unMouseDown(),t.unResize(),s(t.buttons),e&&(e.onfocus=e.onblur=e.onchange=null),i&&(i.onfocus=i.onblur=i.onchange=null),a(t,function(e,i){e&&"chart"!==i&&(e.destroy?e.destroy():e.nodeType&&o(this[i])),e!==y.prototype[i]&&(t[i]=null)},this)}},p.prototype.minFromRange=function(){var t,e,i,s=this.range,o={month:"Month",year:"FullYear"}[s.type],n=this.max,a=this.chart.time,l=function(t,e){var i=new a.Date(t),s=a.get(o,i);return a.set(o,i,s+e),s===a.get(o,i)&&a.set("Date",i,0),i.getTime()-t};return r(s)?(t=n-s,i=s):(t=n+l(n,-s.count),this.chart&&(this.chart.fixedRange=n-t)),e=h(this.dataMin,Number.MIN_VALUE),r(t)||(t=e),t<=e&&(t=e,void 0===i&&(i=l(t,s.count)),this.newMax=Math.min(t+i,this.dataMax)),r(n)||(t=void 0),t},t.RangeSelector||(d(u,"afterGetContainer",function(){this.options.rangeSelector.enabled&&(this.rangeSelector=new y(this))}),d(u,"beforeRender",function(){var t,e=this.axes,i=this.rangeSelector;i&&(r(i.deferredYTDClick)&&(i.clickButton(i.deferredYTDClick),delete i.deferredYTDClick),e.forEach(function(t){t.updateNames(),t.setScale()}),this.getAxisMargins(),i.render(),t=i.options.verticalAlign,i.options.floating||("bottom"===t?this.extraBottomMargin=!0:"middle"!==t&&(this.extraTopMargin=!0)))}),d(u,"update",function(t){var e,s=t.options.rangeSelector,o=this.rangeSelector,n=this.extraBottomMargin,r=this.extraTopMargin;s&&s.enabled&&!i(o)&&(this.options.rangeSelector.enabled=!0,this.rangeSelector=new y(this)),this.extraBottomMargin=!1,this.extraTopMargin=!1,o&&(o.render(),e=s&&s.verticalAlign||o.options&&o.options.verticalAlign,o.options.floating||("bottom"===e?this.extraBottomMargin=!0:"middle"!==e&&(this.extraTopMargin=!0)),this.extraBottomMargin===n&&this.extraTopMargin===r||(this.isDirtyBox=!0))}),d(u,"render",function(){var t,e=this.rangeSelector;e&&!e.options.floating&&(e.render(),"bottom"===(t=e.options.verticalAlign)?this.extraBottomMargin=!0:"middle"!==t&&(this.extraTopMargin=!0))}),d(u,"getMargins",function(){var t,e=this.rangeSelector;e&&(t=e.getHeight(),this.extraTopMargin&&(this.plotTop+=t),this.extraBottomMargin&&(this.marginBottom+=t))}),u.prototype.callbacks.push(function(t){var e,i,s,o=t.rangeSelector;function n(){e=t.xAxis[0].getExtremes(),r(e.min)&&o.render(e.min,e.max)}o&&(s=d(t.xAxis[0],"afterSetExtremes",function(t){o.render(t.min,t.max)}),i=d(t,"redraw",n),n()),d(t,"destroy",function(){o&&(i(),s())})}),t.RangeSelector=y)}),i(e,"parts/StockChart.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.arrayMax,s=e.arrayMin,o=e.clamp,n=e.defined,r=e.extend,a=e.isNumber,h=e.isString,l=e.pick,c=e.splat,d=t.addEvent,p=t.Axis,u=t.Chart,f=t.format,g=t.merge,m=t.Point,x=t.Renderer,v=t.Series,y=t.SVGRenderer,b=t.VMLRenderer,M=v.prototype,k=M.init,w=M.processData,S=m.prototype.tooltipFormatter;t.StockChart=t.stockChart=function(e,i,s){var o,n=h(e)||e.nodeName,r=arguments[n?1:0],a=r,d=r.series,p=t.getOptions(),f=r.chart&&r.chart.panning,m=l(r.navigator&&r.navigator.enabled,p.navigator.enabled,!0),x=f&&/y/.test(f.type),v={startOnTick:!1,endOnTick:!1};return r.xAxis=c(r.xAxis||{}).map(function(t,e){return g({minPadding:0,maxPadding:0,overscroll:0,ordinal:!0,title:{text:null},labels:{overflow:"justify"},showLastLabel:!0},p.xAxis,p.xAxis&&p.xAxis[e],t,{type:"datetime",categories:null},m?v:null)}),r.yAxis=c(r.yAxis||{}).map(function(t,e){return o=l(t.opposite,!0),g({labels:{y:-2},opposite:o,showLastLabel:!(!t.categories&&"category"!==t.type),title:{text:null}},p.yAxis,p.yAxis&&p.yAxis[e],t,x?v:null)}),r.series=null,(r=g({chart:{panning:{enabled:!0,type:"x"},pinchType:"x"},navigator:{enabled:m},scrollbar:{enabled:l(p.scrollbar.enabled,!0)},rangeSelector:{enabled:l(p.rangeSelector.enabled,!0)},title:{text:null},tooltip:{split:l(p.tooltip.split,!0),crosshairs:!0},legend:{enabled:!1}},r,{isStock:!0})).series=a.series=d,n?new u(e,r,s):new u(r,i)},d(v,"setOptions",function(e){var i,s=this;function o(e){return t.seriesTypes[e]&&s instanceof t.seriesTypes[e]}this.chart.options.isStock&&(o("column")||o("columnrange")?i={borderWidth:0,shadow:!1}:!o("line")||o("scatter")||o("sma")||(i={marker:{enabled:!1,radius:2}}),i&&(e.plotOptions[this.type]=g(e.plotOptions[this.type],i)))}),d(p,"autoLabelAlign",function(t){var e,i=this.chart,s=this.options,o=i._labelPanes=i._labelPanes||{},n=this.options.labels;this.chart.options.isStock&&"yAxis"===this.coll&&!o[e=s.top+","+s.height]&&n.enabled&&(15===n.x&&(n.x=0),void 0===n.align&&(n.align="right"),o[e]=this,t.align="right",t.preventDefault())}),d(p,"destroy",function(){var t=this.chart,e=this.options&&this.options.top+","+this.options.height;e&&t._labelPanes&&t._labelPanes[e]===this&&delete t._labelPanes[e]}),d(p,"getPlotLinePath",function(e){var i,s,r,c,d,p,u,f,g,m=this,x=this.isLinked&&!this.series?this.linkedParent.series:this.series,v=m.chart,y=v.renderer,b=m.left,M=m.top,k=[],w=[],S=e.translatedValue,A=e.value,T=e.force;(v.options.isStock&&!1!==e.acrossPanes&&"xAxis"===m.coll||"yAxis"===m.coll)&&(e.preventDefault(),u=m.coll,f="xAxis"===u?"yAxis":"xAxis",g=m.options[f],w=a(g)?[v[f][g]]:h(g)?[v.get(g)]:x.map(function(t){return t[f]}),(m.isXAxis?v.yAxis:v.xAxis).forEach(function(t){if(!n(t.options.id)||-1===t.options.id.indexOf("navigator")){var e=t.isXAxis?"yAxis":"xAxis",i=n(t.options[e])?v[e][t.options[e]]:v[e][0];m===i&&w.push(t)}}),d=w.length?[]:[m.isXAxis?v.yAxis[0]:v.xAxis[0]],w.forEach(function(e){-1!==d.indexOf(e)||t.find(d,function(t){return t.pos===e.pos&&t.len===e.len})||d.push(e)}),p=l(S,m.translate(A,null,null,e.old)),a(p)&&(m.horiz?d.forEach(function(t){var e;s=t.pos,c=s+t.len,i=r=Math.round(p+m.transB),"pass"!==T&&(i<b||i>b+m.width)&&(T?i=r=o(i,b,b+m.width):e=!0),e||k.push("M",i,s,"L",r,c)}):d.forEach(function(t){var e;i=t.pos,r=i+t.len,s=c=Math.round(M+m.height-p),"pass"!==T&&(s<M||s>M+m.height)&&(T?s=c=o(s,M,M+m.height):e=!0),e||k.push("M",i,s,"L",r,c)})),e.path=k.length>0?y.crispPolyLine(k,e.lineWidth||1):null)}),y.prototype.crispPolyLine=function(t,e){var i;for(i=0;i<t.length;i+=6)t[i+1]===t[i+4]&&(t[i+1]=t[i+4]=Math.round(t[i+1])-e%2/2),t[i+2]===t[i+5]&&(t[i+2]=t[i+5]=Math.round(t[i+2])+e%2/2);return t},x===b&&(b.prototype.crispPolyLine=y.prototype.crispPolyLine),d(p,"afterHideCrosshair",function(){this.crossLabel&&(this.crossLabel=this.crossLabel.hide())}),d(p,"afterDrawCrosshair",function(t){if(n(this.crosshair.label)&&this.crosshair.label.enabled&&this.cross){var e,i,s,o,a,h,c,d,p=this.chart,u=this.options.crosshair.label,g=this.horiz,m=this.opposite,x=this.left,v=this.top,y=this.crossLabel,b=u.format,M="",k="inside"===this.options.tickPosition,w=!1!==this.crosshair.snap,S=0,A=t.e||this.cross&&this.cross.e,T=t.point,P=this.lin2log;this.isLog?(c=P(this.min),d=P(this.max)):(c=this.min,d=this.max),a=g?"center":m?"right"===this.labelAlign?"right":"left":"left"===this.labelAlign?"left":"center",y||(y=this.crossLabel=p.renderer.label(null,null,null,u.shape||"callout").addClass("highcharts-crosshair-label"+(this.series[0]&&" highcharts-color-"+this.series[0].colorIndex)).attr({align:u.align||a,padding:l(u.padding,8),r:l(u.borderRadius,3),zIndex:2}).add(this.labelGroup),p.styledMode||y.attr({fill:u.backgroundColor||this.series[0]&&this.series[0].color||"#666666",stroke:u.borderColor||"","stroke-width":u.borderWidth||0}).css(r({color:"#ffffff",fontWeight:"normal",fontSize:"11px",textAlign:"center"},u.style))),g?(e=w?T.plotX+x:A.chartX,i=v+(m?0:this.height)):(e=m?this.width+x:0,i=w?T.plotY+v:A.chartY),b||u.formatter||(this.isDatetimeAxis&&(M="%b %d, %Y"),b="{value"+(M?":"+M:"")+"}"),h=w?T[this.isXAxis?"x":"y"]:this.toValue(g?A.chartX:A.chartY),y.attr({text:b?f(b,{value:h},p):u.formatter.call(this,h),x:e,y:i,visibility:h<c||h>d?"hidden":"visible"}),s=y.getBBox(),g?(k&&!m||!k&&m)&&(i=y.y-s.height):i=y.y-s.height/2,o=g?{left:x-s.x,right:x+this.width-s.x}:{left:"left"===this.labelAlign?x:0,right:"right"===this.labelAlign?x+this.width:p.chartWidth},y.translateX<o.left&&(S=o.left-y.translateX),y.translateX+s.width>=o.right&&(S=-(y.translateX+s.width-o.right)),y.attr({x:e+S,y:i,anchorX:g?e:this.opposite?0:p.chartWidth,anchorY:g?this.opposite?p.chartHeight:0:i+s.height/2})}}),M.init=function(){k.apply(this,arguments),this.setCompare(this.options.compare)},M.setCompare=function(t){this.modifyValue="value"===t||"percent"===t?function(e,i){var s=this.compareValue;return void 0!==e&&void 0!==s?("value"===t?e-=s:e=e/s*100-(100===this.options.compareBase?0:100),i&&(i.change=e),e):0}:null,this.userOptions.compare=t,this.chart.hasRendered&&(this.isDirty=!0)},M.processData=function(t){var e,i,s,o,n,r=-1,h=!0===this.options.compareStart?0:1;if(w.apply(this,arguments),this.xAxis&&this.processedYData)for(i=this.processedXData,o=(s=this.processedYData).length,this.pointArrayMap&&(r=this.pointArrayMap.indexOf(this.options.pointValKey||this.pointValKey||"y")),e=0;e<o-h;e++)if(n=s[e]&&r>-1?s[e][r]:s[e],a(n)&&i[e+h]>=this.xAxis.min&&0!==n){this.compareValue=n;break}},d(v,"afterGetExtremes",function(){if(this.modifyValue){var t=[this.modifyValue(this.dataMin),this.modifyValue(this.dataMax)];this.dataMin=s(t),this.dataMax=i(t)}}),p.prototype.setCompare=function(t,e){this.isXAxis||(this.series.forEach(function(e){e.setCompare(t)}),l(e,!0)&&this.chart.redraw())},m.prototype.tooltipFormatter=function(t){var e=this.series.chart.numberFormatter;return t=t.replace("{point.change}",(this.change>0?"+":"")+e(this.change,l(this.series.tooltipOptions.changeDecimals,2))),S.apply(this,[t])},d(v,"render",function(){var t,e=this.chart;if((!e.is3d||!e.is3d())&&!e.polar&&this.xAxis&&!this.xAxis.isRadial){if(t=this.yAxis.len,this.xAxis.axisLine){var i=e.plotTop+e.plotHeight-this.yAxis.pos-this.yAxis.len,s=Math.floor(this.xAxis.axisLine.strokeWidth()/2);i>=0&&(t-=Math.max(s-i,0))}!this.clipBox&&this.animate?(this.clipBox=g(e.clipBox),this.clipBox.width=this.xAxis.len,this.clipBox.height=t):e[this.sharedClipKey]&&(e[this.sharedClipKey].animate({width:this.xAxis.len,height:t}),e[this.sharedClipKey+"m"]&&e[this.sharedClipKey+"m"].animate({width:this.xAxis.len}))}}),d(u,"update",function(t){var e=t.options;"scrollbar"in e&&this.navigator&&(g(!0,this.options.scrollbar,e.scrollbar),this.navigator.update({},!1),delete e.scrollbar)}),d(p,"afterSetScale",function(){var e=this,i=e.chart.options.chart&&e.chart.options.chart.panning;if(i&&("y"===i.type||"xy"===i.type)&&!e.isXAxis&&!n(e.panningState)){var s=Number.MAX_VALUE,o=Number.MIN_VALUE;e.series.forEach(function(i){s=Math.min(t.arrayMin(i.yData),s)-(e.min&&e.dataMin?e.dataMin-e.min:0),o=Math.max(t.arrayMax(i.yData),o)+(e.max&&e.dataMax?e.max-e.dataMax:0)}),e.panningState={startMin:s,startMax:o}}})}),i(e,"masters/modules/stock.src.js",[],function(){}),i(e,"masters/highstock.src.js",[e["masters/highcharts.src.js"]],function(t){return t.product="Highstock",t}),e["masters/highstock.src.js"]._modules=e,e["masters/highstock.src.js"]});
!function(t){"object"==typeof module&&module.exports?(t.default=t,module.exports=t):"function"==typeof define&&define.amd?define("highcharts/highcharts-3d",["highcharts"],function(e){return t(e),t.Highcharts=e,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){var e=t?t._modules:{};function i(t,e,i,s){t.hasOwnProperty(e)||(t[e]=s.apply(null,i))}i(e,"parts-3d/Math.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.pick,s=t.deg2rad;t.perspective3D=function(t,e,i){var s=i>0&&i<Number.POSITIVE_INFINITY?i/(t.z+e.z+i):1;return{x:t.x*s,y:t.y*s}},t.perspective=function(e,o,r){var a=o.options.chart.options3d,n=!!r&&o.inverted,l={x:o.plotWidth/2,y:o.plotHeight/2,z:a.depth/2,vd:i(a.depth,1)*i(a.viewDistance,0)},h=o.scale3d||1,p=s*a.beta*(n?-1:1),c=s*a.alpha*(n?-1:1),d={cosA:Math.cos(c),cosB:Math.cos(-p),sinA:Math.sin(c),sinB:Math.sin(-p)};return r||(l.x+=o.plotLeft,l.y+=o.plotTop),e.map(function(e){var i=function(t,e,i,s){return{x:s.cosB*t-s.sinB*i,y:-s.sinA*s.sinB*t+s.cosA*e-s.cosB*s.sinA*i,z:s.cosA*s.sinB*t+s.sinA*e+s.cosA*s.cosB*i}}((n?e.y:e.x)-l.x,(n?e.x:e.y)-l.y,(e.z||0)-l.z,d),s=t.perspective3D(i,l,l.vd);return s.x=s.x*h+l.x,s.y=s.y*h+l.y,s.z=i.z*h+l.z,{x:n?s.y:s.x,y:n?s.x:s.y,z:s.z}})},t.pointCameraDistance=function(t,e){var s=e.options.chart.options3d,o=e.plotWidth/2,r=e.plotHeight/2,a=i(s.depth,1)*i(s.viewDistance,0)+s.depth;return Math.sqrt(Math.pow(o-t.plotX,2)+Math.pow(r-t.plotY,2)+Math.pow(a-t.plotZ,2))},t.shapeArea=function(t){var e,i,s=0;for(e=0;e<t.length;e++)i=(e+1)%t.length,s+=t[e].x*t[i].y-t[i].x*t[e].y;return s/2},t.shapeArea3d=function(e,i,s){return t.shapeArea(t.perspective(e,i,s))}}),i(e,"parts-3d/SVGRenderer.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i,s,o,r=e.animObject,a=e.defined,n=e.extend,l=e.objectEach,h=e.pick,p=Math.cos,c=Math.PI,d=Math.sin,x=t.charts,y=t.color,f=t.deg2rad,u=t.merge,z=t.perspective,b=t.SVGElement,v=t.SVGRenderer;function g(t,e,s,o,r,a,n,l){var h=[],p=a-r;return a>r&&a-r>Math.PI/2+1e-4?h=(h=h.concat(g(t,e,s,o,r,r+Math.PI/2,n,l))).concat(g(t,e,s,o,r+Math.PI/2,a,n,l)):a<r&&r-a>Math.PI/2+1e-4?h=(h=h.concat(g(t,e,s,o,r,r-Math.PI/2,n,l))).concat(g(t,e,s,o,r-Math.PI/2,a,n,l)):["C",t+s*Math.cos(r)-s*i*p*Math.sin(r)+n,e+o*Math.sin(r)+o*i*p*Math.cos(r)+l,t+s*Math.cos(a)+s*i*p*Math.sin(a)+n,e+o*Math.sin(a)-o*i*p*Math.cos(a)+l,t+s*Math.cos(a)+n,e+o*Math.sin(a)+l]}i=4*(Math.sqrt(2)-1)/3/(c/2),v.prototype.toLinePath=function(t,e){var i=[];return t.forEach(function(t){i.push("L",t.x,t.y)}),t.length&&(i[0]="M",e&&i.push("Z")),i},v.prototype.toLineSegments=function(t){var e=[],i=!0;return t.forEach(function(t){e.push(i?"M":"L",t.x,t.y),i=!i}),e},v.prototype.face3d=function(e){var i=this,s=this.createElement("path");return s.vertexes=[],s.insidePlotArea=!1,s.enabled=!0,s.attr=function(e){if("object"==typeof e&&(a(e.enabled)||a(e.vertexes)||a(e.insidePlotArea))){this.enabled=h(e.enabled,this.enabled),this.vertexes=h(e.vertexes,this.vertexes),this.insidePlotArea=h(e.insidePlotArea,this.insidePlotArea),delete e.enabled,delete e.vertexes,delete e.insidePlotArea;var s=x[i.chartIndex],o=z(this.vertexes,s,this.insidePlotArea),r=i.toLinePath(o,!0),n=t.shapeArea(o),l=this.enabled&&n>0?"visible":"hidden";e.d=r,e.visibility=l}return b.prototype.attr.apply(this,arguments)},s.animate=function(e){if("object"==typeof e&&(a(e.enabled)||a(e.vertexes)||a(e.insidePlotArea))){this.enabled=h(e.enabled,this.enabled),this.vertexes=h(e.vertexes,this.vertexes),this.insidePlotArea=h(e.insidePlotArea,this.insidePlotArea),delete e.enabled,delete e.vertexes,delete e.insidePlotArea;var s=x[i.chartIndex],o=z(this.vertexes,s,this.insidePlotArea),r=i.toLinePath(o,!0),n=t.shapeArea(o),l=this.enabled&&n>0?"visible":"hidden";e.d=r,this.attr("visibility",l)}return b.prototype.animate.apply(this,arguments)},s.attr(e)},v.prototype.polyhedron=function(t){var e=this,i=this.g(),s=i.destroy;return this.styledMode||i.attr({"stroke-linejoin":"round"}),i.faces=[],i.destroy=function(){for(var t=0;t<i.faces.length;t++)i.faces[t].destroy();return s.call(this)},i.attr=function(t,s,o,r){if("object"==typeof t&&a(t.faces)){for(;i.faces.length>t.faces.length;)i.faces.pop().destroy();for(;i.faces.length<t.faces.length;)i.faces.push(e.face3d().add(i));for(var n=0;n<t.faces.length;n++)e.styledMode&&delete t.faces[n].fill,i.faces[n].attr(t.faces[n],null,o,r);delete t.faces}return b.prototype.attr.apply(this,arguments)},i.animate=function(t,s,o){if(t&&t.faces){for(;i.faces.length>t.faces.length;)i.faces.pop().destroy();for(;i.faces.length<t.faces.length;)i.faces.push(e.face3d().add(i));for(var r=0;r<t.faces.length;r++)i.faces[r].animate(t.faces[r],s,o);delete t.faces}return b.prototype.animate.apply(this,arguments)},i.attr(t)},s={initArgs:function(t){var e=this,i=e.renderer,s=i[e.pathType+"Path"](t),o=s.zIndexes;e.parts.forEach(function(t){e[t]=i.path(s[t]).attr({class:"highcharts-3d-"+t,zIndex:o[t]||0}).add(e)}),e.attr({"stroke-linejoin":"round",zIndex:o.group}),e.originalDestroy=e.destroy,e.destroy=e.destroyParts},singleSetterForParts:function(t,e,i,s,o,r){var a={},n=[null,null,s||"attr",o,r],h=i&&i.zIndexes;return i?(l(i,function(e,s){a[s]={},a[s][t]=e,h&&(a[s].zIndex=i.zIndexes[s]||0)}),n[1]=a):(a[t]=e,n[0]=a),this.processParts.apply(this,n)},processParts:function(t,e,i,s,o){var r=this;return r.parts.forEach(function(a){e&&(t=h(e[a],!1)),!1!==t&&r[a][i](t,s,o)}),r},destroyParts:function(){return this.processParts(null,null,"destroy"),this.originalDestroy()}},o=t.merge(s,{parts:["front","top","side"],pathType:"cuboid",attr:function(t,e,i,s){if("string"==typeof t&&void 0!==e){var o=t;(t={})[o]=e}return t.shapeArgs||a(t.x)?this.singleSetterForParts("d",null,this.renderer[this.pathType+"Path"](t.shapeArgs||t)):b.prototype.attr.call(this,t,void 0,i,s)},animate:function(t,e,i){if(a(t.x)&&a(t.y)){var s=this.renderer[this.pathType+"Path"](t);this.singleSetterForParts("d",null,s,"animate",e,i),this.attr({zIndex:s.zIndexes.group})}else b.prototype.animate.call(this,t,e,i);return this},fillSetter:function(t){return this.singleSetterForParts("fill",null,{front:t,top:y(t).brighten(.1).get(),side:y(t).brighten(-.1).get()}),this.color=this.fill=t,this}}),v.prototype.elements3d={base:s,cuboid:o},v.prototype.element3d=function(t,e){var i=this.g();return n(i,this.elements3d[t]),i.initArgs(e),i},v.prototype.cuboid=function(t){return this.element3d("cuboid",t)},t.SVGRenderer.prototype.cuboidPath=function(e){var i,s,o,r,a,n,l,h,p=e.x,c=e.y,d=e.z,y=e.height,f=e.width,u=e.depth,b=x[this.chartIndex],v=b.options.chart.options3d.alpha,g=0,m=[{x:p,y:c,z:d},{x:p+f,y:c,z:d},{x:p+f,y:c+y,z:d},{x:p,y:c+y,z:d},{x:p,y:c+y,z:d+u},{x:p+f,y:c+y,z:d+u},{x:p+f,y:c,z:d+u},{x:p,y:c,z:d+u}];function M(t){return m[t]}return m=z(m,b,e.insidePlotArea),h=function(e,i){var s=[[],-1];return e=e.map(M),i=i.map(M),t.shapeArea(e)<0?s=[e,0]:t.shapeArea(i)<0&&(s=[i,1]),s},s=(i=h([3,2,1,0],[7,6,5,4]))[0],a=i[1],o=(i=h([1,6,7,0],[4,5,2,3]))[0],n=i[1],r=(i=h([1,2,5,6],[0,7,4,3]))[0],1===(l=i[1])?g+=1e4*(1e3-p):l||(g+=1e4*p),g+=10*(!n||v>=0&&v<=180||v<360&&v>357.5?b.plotHeight-c:10+c),1===a?g+=100*d:a||(g+=100*(1e3-d)),{front:this.toLinePath(s,!0),top:this.toLinePath(o,!0),side:this.toLinePath(r,!0),zIndexes:{group:Math.round(g)},isFront:a,isTop:n}},t.SVGRenderer.prototype.arc3d=function(e){var i=this.g(),s=i.renderer,o=["x","y","r","innerR","start","end"];function a(t){var e,i=!1,s={};for(e in t=u(t))-1!==o.indexOf(e)&&(s[e]=t[e],delete t[e],i=!0);return!!i&&s}return(e=u(e)).alpha=(e.alpha||0)*f,e.beta=(e.beta||0)*f,i.top=s.path(),i.side1=s.path(),i.side2=s.path(),i.inn=s.path(),i.out=s.path(),i.onAdd=function(){var t=i.parentGroup,e=i.attr("class");i.top.add(i),["out","inn","side1","side2"].forEach(function(s){i[s].attr({class:e+" highcharts-3d-side"}).add(t)})},["addClass","removeClass"].forEach(function(t){i[t]=function(){var e=arguments;["top","out","inn","side1","side2"].forEach(function(s){i[s][t].apply(i[s],e)})}}),i.setPaths=function(t){var e=i.renderer.arc3dPath(t),s=100*e.zTop;i.attribs=t,i.top.attr({d:e.top,zIndex:e.zTop}),i.inn.attr({d:e.inn,zIndex:e.zInn}),i.out.attr({d:e.out,zIndex:e.zOut}),i.side1.attr({d:e.side1,zIndex:e.zSide1}),i.side2.attr({d:e.side2,zIndex:e.zSide2}),i.zIndex=s,i.attr({zIndex:s}),t.center&&(i.top.setRadialReference(t.center),delete t.center)},i.setPaths(e),i.fillSetter=function(t){var e=y(t).brighten(-.1).get();return this.fill=t,this.side1.attr({fill:e}),this.side2.attr({fill:e}),this.inn.attr({fill:e}),this.out.attr({fill:e}),this.top.attr({fill:t}),this},["opacity","translateX","translateY","visibility"].forEach(function(t){i[t+"Setter"]=function(t,e){i[e]=t,["out","inn","side1","side2","top"].forEach(function(s){i[s].attr(e,t)})}}),i.attr=function(t){var e;return"object"==typeof t&&(e=a(t))&&(n(i.attribs,e),i.setPaths(i.attribs)),b.prototype.attr.apply(i,arguments)},i.animate=function(e,s,o){var n,l,p,c=this.attribs,d="data-"+Math.random().toString(26).substring(2,9);return delete e.center,delete e.z,delete e.depth,delete e.alpha,delete e.beta,(p=r(h(s,this.renderer.globalAnimation))).duration&&(n=a(e),i[d]=0,e[d]=1,i[d+"Setter"]=t.noop,n&&(l=n,p.step=function(t,e){function i(t){return c[t]+(h(l[t],c[t])-c[t])*e.pos}e.prop===d&&e.elem.setPaths(u(c,{x:i("x"),y:i("y"),r:i("r"),innerR:i("innerR"),start:i("start"),end:i("end")}))}),s=p),b.prototype.animate.call(this,e,s,o)},i.destroy=function(){return this.top.destroy(),this.out.destroy(),this.inn.destroy(),this.side1.destroy(),this.side2.destroy(),b.prototype.destroy.call(this)},i.hide=function(){this.top.hide(),this.out.hide(),this.inn.hide(),this.side1.hide(),this.side2.hide()},i.show=function(t){this.top.show(t),this.out.show(t),this.inn.show(t),this.side1.show(t),this.side2.show(t)},i},v.prototype.arc3dPath=function(t){var e=t.x,i=t.y,s=t.start,o=t.end-1e-5,r=t.r,a=t.innerR||0,n=t.depth||0,l=t.alpha,h=t.beta,x=Math.cos(s),y=Math.sin(s),f=Math.cos(o),u=Math.sin(o),z=r*Math.cos(h),b=r*Math.cos(l),v=a*Math.cos(h),m=a*Math.cos(l),M=n*Math.sin(h),A=n*Math.sin(l),P=["M",e+z*x,i+b*y];P=(P=(P=(P=P.concat(g(e,i,z,b,s,o,0,0))).concat(["L",e+v*f,i+m*u])).concat(g(e,i,v,m,o,s,0,0))).concat(["Z"]);var k=h>0?Math.PI/2:0,S=l>0?0:Math.PI/2,L=s>-k?s:o>-k?-k:s,I=o<c-S?o:s<c-S?c-S:o,w=2*c-S,D=["M",e+z*p(L),i+b*d(L)];D=D.concat(g(e,i,z,b,L,I,0,0)),o>w&&s<w?D=(D=(D=(D=(D=(D=(D=(D=D.concat(["L",e+z*p(I)+M,i+b*d(I)+A])).concat(g(e,i,z,b,I,w,M,A))).concat(["L",e+z*p(w),i+b*d(w)])).concat(g(e,i,z,b,w,o,0,0))).concat(["L",e+z*p(o)+M,i+b*d(o)+A])).concat(g(e,i,z,b,o,w,M,A))).concat(["L",e+z*p(w),i+b*d(w)])).concat(g(e,i,z,b,w,I,0,0)):o>c-S&&s<c-S&&(D=(D=(D=(D=D.concat(["L",e+z*Math.cos(I)+M,i+b*Math.sin(I)+A])).concat(g(e,i,z,b,I,o,M,A))).concat(["L",e+z*Math.cos(o),i+b*Math.sin(o)])).concat(g(e,i,z,b,o,I,0,0))),D=(D=(D=D.concat(["L",e+z*Math.cos(I)+M,i+b*Math.sin(I)+A])).concat(g(e,i,z,b,I,L,M,A))).concat(["Z"]);var F=["M",e+v*x,i+m*y];F=(F=(F=(F=F.concat(g(e,i,v,m,s,o,0,0))).concat(["L",e+v*Math.cos(o)+M,i+m*Math.sin(o)+A])).concat(g(e,i,v,m,o,s,M,A))).concat(["Z"]);var E=["M",e+z*x,i+b*y,"L",e+z*x+M,i+b*y+A,"L",e+v*x+M,i+m*y+A,"L",e+v*x,i+m*y,"Z"],j=["M",e+z*f,i+b*u,"L",e+z*f+M,i+b*u+A,"L",e+v*f+M,i+m*u+A,"L",e+v*f,i+m*u,"Z"],T=Math.atan2(A,-M),G=Math.abs(o+T),Y=Math.abs(s+T),X=Math.abs((s+o)/2+T);function Z(t){return(t%=2*Math.PI)>Math.PI&&(t=2*Math.PI-t),t}G=Z(G),Y=Z(Y);var C=1e5*(X=Z(X)),W=1e5*Y,O=1e5*G;return{top:P,zTop:1e5*Math.PI+1,out:D,zOut:Math.max(C,W,O),inn:F,zInn:Math.max(C,W,O),side1:E,zSide1:.99*O,side2:j,zSide2:.99*W}}}),i(e,"parts-3d/Chart.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.isArray,s=e.pick,o=e.wrap,r=t.addEvent,a=t.Chart,n=t.merge,l=t.perspective;a.prototype.is3d=function(){return this.options.chart.options3d&&this.options.chart.options3d.enabled},a.prototype.propsRequireDirtyBox.push("chart.options3d"),a.prototype.propsRequireUpdateSeries.push("chart.options3d"),r(a,"afterInit",function(){var t=this.options;this.is3d()&&(t.series||[]).forEach(function(e){"scatter"===(e.type||t.chart.type||t.chart.defaultSeriesType)&&(e.type="scatter3d")})}),r(a,"addSeries",function(t){this.is3d()&&"scatter"===t.options.type&&(t.options.type="scatter3d")}),o(t.Chart.prototype,"isInsidePlot",function(t){return this.is3d()||t.apply(this,[].slice.call(arguments,1))});n(!0,t.getOptions(),{chart:{options3d:{enabled:!1,alpha:0,beta:0,depth:100,fitToPlot:!0,viewDistance:25,axisLabelPosition:null,frame:{visible:"default",size:1,bottom:{},top:{},left:{},right:{},back:{},front:{}}}}}),r(a,"afterGetContainer",function(){this.styledMode&&(this.renderer.definition({tagName:"style",textContent:".highcharts-3d-top{filter: url(#highcharts-brighter)}\n.highcharts-3d-side{filter: url(#highcharts-darker)}\n"}),[{name:"darker",slope:.6},{name:"brighter",slope:1.4}].forEach(function(t){this.renderer.definition({tagName:"filter",id:"highcharts-"+t.name,children:[{tagName:"feComponentTransfer",children:[{tagName:"feFuncR",type:"linear",slope:t.slope},{tagName:"feFuncG",type:"linear",slope:t.slope},{tagName:"feFuncB",type:"linear",slope:t.slope}]}]})},this))}),o(a.prototype,"setClassName",function(t){t.apply(this,[].slice.call(arguments,1)),this.is3d()&&(this.container.className+=" highcharts-3d-chart")}),r(t.Chart,"afterSetChartSize",function(){var t=this.options.chart.options3d;if(this.is3d()){var e=this.inverted,i=this.clipBox,s=this.margin,o=e?"x":"y",r=e?"height":"width",a=e?"width":"height";i[e?"y":"x"]=-(s[3]||0),i[o]=-(s[0]||0),i[r]=this.chartWidth+(s[3]||0)+(s[1]||0),i[a]=this.chartHeight+(s[0]||0)+(s[2]||0),this.scale3d=1,!0===t.fitToPlot&&(this.scale3d=function(t,e){var i,s=t.plotLeft,o=t.plotWidth+s,r=t.plotTop,a=t.plotHeight+r,n=s+t.plotWidth/2,h=r+t.plotHeight/2,p={minX:Number.MAX_VALUE,maxX:-Number.MAX_VALUE,minY:Number.MAX_VALUE,maxY:-Number.MAX_VALUE},c=1;return i=[{x:s,y:r,z:0},{x:s,y:r,z:e}],[0,1].forEach(function(t){i.push({x:o,y:i[t].y,z:i[t].z})}),[0,1,2,3].forEach(function(t){i.push({x:i[t].x,y:a,z:i[t].z})}),(i=l(i,t,!1)).forEach(function(t){p.minX=Math.min(p.minX,t.x),p.maxX=Math.max(p.maxX,t.x),p.minY=Math.min(p.minY,t.y),p.maxY=Math.max(p.maxY,t.y)}),s>p.minX&&(c=Math.min(c,1-Math.abs((s+n)/(p.minX+n))%1)),o<p.maxX&&(c=Math.min(c,(o-n)/(p.maxX-n))),r>p.minY&&(c=p.minY<0?Math.min(c,(r+h)/(-p.minY+r+h)):Math.min(c,1-(r+h)/(p.minY+h)%1)),a<p.maxY&&(c=Math.min(c,Math.abs((a-h)/(p.maxY-h)))),c}(this,t.depth)),this.frame3d=this.get3dFrame()}}),r(a,"beforeRedraw",function(){this.is3d()&&(this.isDirtyBox=!0)}),r(a,"beforeRender",function(){this.is3d()&&(this.frame3d=this.get3dFrame())}),o(a.prototype,"renderSeries",function(t){var e,i=this.series.length;if(this.is3d())for(;i--;)(e=this.series[i]).translate(),e.render();else t.call(this)}),r(a,"afterDrawChartBox",function(){if(this.is3d()){var e=this.renderer,i=this.options.chart.options3d,s=this.get3dFrame(),o=this.plotLeft,r=this.plotLeft+this.plotWidth,a=this.plotTop,n=this.plotTop+this.plotHeight,l=i.depth,h=o-(s.left.visible?s.left.size:0),p=r+(s.right.visible?s.right.size:0),c=a-(s.top.visible?s.top.size:0),d=n+(s.bottom.visible?s.bottom.size:0),x=0-(s.front.visible?s.front.size:0),y=l+(s.back.visible?s.back.size:0),f=this.hasRendered?"animate":"attr";this.frame3d=s,this.frameShapes||(this.frameShapes={bottom:e.polyhedron().add(),top:e.polyhedron().add(),left:e.polyhedron().add(),right:e.polyhedron().add(),back:e.polyhedron().add(),front:e.polyhedron().add()}),this.frameShapes.bottom[f]({class:"highcharts-3d-frame highcharts-3d-frame-bottom",zIndex:s.bottom.frontFacing?-1e3:1e3,faces:[{fill:t.color(s.bottom.color).brighten(.1).get(),vertexes:[{x:h,y:d,z:x},{x:p,y:d,z:x},{x:p,y:d,z:y},{x:h,y:d,z:y}],enabled:s.bottom.visible},{fill:t.color(s.bottom.color).brighten(.1).get(),vertexes:[{x:o,y:n,z:l},{x:r,y:n,z:l},{x:r,y:n,z:0},{x:o,y:n,z:0}],enabled:s.bottom.visible},{fill:t.color(s.bottom.color).brighten(-.1).get(),vertexes:[{x:h,y:d,z:x},{x:h,y:d,z:y},{x:o,y:n,z:l},{x:o,y:n,z:0}],enabled:s.bottom.visible&&!s.left.visible},{fill:t.color(s.bottom.color).brighten(-.1).get(),vertexes:[{x:p,y:d,z:y},{x:p,y:d,z:x},{x:r,y:n,z:0},{x:r,y:n,z:l}],enabled:s.bottom.visible&&!s.right.visible},{fill:t.color(s.bottom.color).get(),vertexes:[{x:p,y:d,z:x},{x:h,y:d,z:x},{x:o,y:n,z:0},{x:r,y:n,z:0}],enabled:s.bottom.visible&&!s.front.visible},{fill:t.color(s.bottom.color).get(),vertexes:[{x:h,y:d,z:y},{x:p,y:d,z:y},{x:r,y:n,z:l},{x:o,y:n,z:l}],enabled:s.bottom.visible&&!s.back.visible}]}),this.frameShapes.top[f]({class:"highcharts-3d-frame highcharts-3d-frame-top",zIndex:s.top.frontFacing?-1e3:1e3,faces:[{fill:t.color(s.top.color).brighten(.1).get(),vertexes:[{x:h,y:c,z:y},{x:p,y:c,z:y},{x:p,y:c,z:x},{x:h,y:c,z:x}],enabled:s.top.visible},{fill:t.color(s.top.color).brighten(.1).get(),vertexes:[{x:o,y:a,z:0},{x:r,y:a,z:0},{x:r,y:a,z:l},{x:o,y:a,z:l}],enabled:s.top.visible},{fill:t.color(s.top.color).brighten(-.1).get(),vertexes:[{x:h,y:c,z:y},{x:h,y:c,z:x},{x:o,y:a,z:0},{x:o,y:a,z:l}],enabled:s.top.visible&&!s.left.visible},{fill:t.color(s.top.color).brighten(-.1).get(),vertexes:[{x:p,y:c,z:x},{x:p,y:c,z:y},{x:r,y:a,z:l},{x:r,y:a,z:0}],enabled:s.top.visible&&!s.right.visible},{fill:t.color(s.top.color).get(),vertexes:[{x:h,y:c,z:x},{x:p,y:c,z:x},{x:r,y:a,z:0},{x:o,y:a,z:0}],enabled:s.top.visible&&!s.front.visible},{fill:t.color(s.top.color).get(),vertexes:[{x:p,y:c,z:y},{x:h,y:c,z:y},{x:o,y:a,z:l},{x:r,y:a,z:l}],enabled:s.top.visible&&!s.back.visible}]}),this.frameShapes.left[f]({class:"highcharts-3d-frame highcharts-3d-frame-left",zIndex:s.left.frontFacing?-1e3:1e3,faces:[{fill:t.color(s.left.color).brighten(.1).get(),vertexes:[{x:h,y:d,z:x},{x:o,y:n,z:0},{x:o,y:n,z:l},{x:h,y:d,z:y}],enabled:s.left.visible&&!s.bottom.visible},{fill:t.color(s.left.color).brighten(.1).get(),vertexes:[{x:h,y:c,z:y},{x:o,y:a,z:l},{x:o,y:a,z:0},{x:h,y:c,z:x}],enabled:s.left.visible&&!s.top.visible},{fill:t.color(s.left.color).brighten(-.1).get(),vertexes:[{x:h,y:d,z:y},{x:h,y:c,z:y},{x:h,y:c,z:x},{x:h,y:d,z:x}],enabled:s.left.visible},{fill:t.color(s.left.color).brighten(-.1).get(),vertexes:[{x:o,y:a,z:l},{x:o,y:n,z:l},{x:o,y:n,z:0},{x:o,y:a,z:0}],enabled:s.left.visible},{fill:t.color(s.left.color).get(),vertexes:[{x:h,y:d,z:x},{x:h,y:c,z:x},{x:o,y:a,z:0},{x:o,y:n,z:0}],enabled:s.left.visible&&!s.front.visible},{fill:t.color(s.left.color).get(),vertexes:[{x:h,y:c,z:y},{x:h,y:d,z:y},{x:o,y:n,z:l},{x:o,y:a,z:l}],enabled:s.left.visible&&!s.back.visible}]}),this.frameShapes.right[f]({class:"highcharts-3d-frame highcharts-3d-frame-right",zIndex:s.right.frontFacing?-1e3:1e3,faces:[{fill:t.color(s.right.color).brighten(.1).get(),vertexes:[{x:p,y:d,z:y},{x:r,y:n,z:l},{x:r,y:n,z:0},{x:p,y:d,z:x}],enabled:s.right.visible&&!s.bottom.visible},{fill:t.color(s.right.color).brighten(.1).get(),vertexes:[{x:p,y:c,z:x},{x:r,y:a,z:0},{x:r,y:a,z:l},{x:p,y:c,z:y}],enabled:s.right.visible&&!s.top.visible},{fill:t.color(s.right.color).brighten(-.1).get(),vertexes:[{x:r,y:a,z:0},{x:r,y:n,z:0},{x:r,y:n,z:l},{x:r,y:a,z:l}],enabled:s.right.visible},{fill:t.color(s.right.color).brighten(-.1).get(),vertexes:[{x:p,y:d,z:x},{x:p,y:c,z:x},{x:p,y:c,z:y},{x:p,y:d,z:y}],enabled:s.right.visible},{fill:t.color(s.right.color).get(),vertexes:[{x:p,y:c,z:x},{x:p,y:d,z:x},{x:r,y:n,z:0},{x:r,y:a,z:0}],enabled:s.right.visible&&!s.front.visible},{fill:t.color(s.right.color).get(),vertexes:[{x:p,y:d,z:y},{x:p,y:c,z:y},{x:r,y:a,z:l},{x:r,y:n,z:l}],enabled:s.right.visible&&!s.back.visible}]}),this.frameShapes.back[f]({class:"highcharts-3d-frame highcharts-3d-frame-back",zIndex:s.back.frontFacing?-1e3:1e3,faces:[{fill:t.color(s.back.color).brighten(.1).get(),vertexes:[{x:p,y:d,z:y},{x:h,y:d,z:y},{x:o,y:n,z:l},{x:r,y:n,z:l}],enabled:s.back.visible&&!s.bottom.visible},{fill:t.color(s.back.color).brighten(.1).get(),vertexes:[{x:h,y:c,z:y},{x:p,y:c,z:y},{x:r,y:a,z:l},{x:o,y:a,z:l}],enabled:s.back.visible&&!s.top.visible},{fill:t.color(s.back.color).brighten(-.1).get(),vertexes:[{x:h,y:d,z:y},{x:h,y:c,z:y},{x:o,y:a,z:l},{x:o,y:n,z:l}],enabled:s.back.visible&&!s.left.visible},{fill:t.color(s.back.color).brighten(-.1).get(),vertexes:[{x:p,y:c,z:y},{x:p,y:d,z:y},{x:r,y:n,z:l},{x:r,y:a,z:l}],enabled:s.back.visible&&!s.right.visible},{fill:t.color(s.back.color).get(),vertexes:[{x:o,y:a,z:l},{x:r,y:a,z:l},{x:r,y:n,z:l},{x:o,y:n,z:l}],enabled:s.back.visible},{fill:t.color(s.back.color).get(),vertexes:[{x:h,y:d,z:y},{x:p,y:d,z:y},{x:p,y:c,z:y},{x:h,y:c,z:y}],enabled:s.back.visible}]}),this.frameShapes.front[f]({class:"highcharts-3d-frame highcharts-3d-frame-front",zIndex:s.front.frontFacing?-1e3:1e3,faces:[{fill:t.color(s.front.color).brighten(.1).get(),vertexes:[{x:h,y:d,z:x},{x:p,y:d,z:x},{x:r,y:n,z:0},{x:o,y:n,z:0}],enabled:s.front.visible&&!s.bottom.visible},{fill:t.color(s.front.color).brighten(.1).get(),vertexes:[{x:p,y:c,z:x},{x:h,y:c,z:x},{x:o,y:a,z:0},{x:r,y:a,z:0}],enabled:s.front.visible&&!s.top.visible},{fill:t.color(s.front.color).brighten(-.1).get(),vertexes:[{x:h,y:c,z:x},{x:h,y:d,z:x},{x:o,y:n,z:0},{x:o,y:a,z:0}],enabled:s.front.visible&&!s.left.visible},{fill:t.color(s.front.color).brighten(-.1).get(),vertexes:[{x:p,y:d,z:x},{x:p,y:c,z:x},{x:r,y:a,z:0},{x:r,y:n,z:0}],enabled:s.front.visible&&!s.right.visible},{fill:t.color(s.front.color).get(),vertexes:[{x:r,y:a,z:0},{x:o,y:a,z:0},{x:o,y:n,z:0},{x:r,y:n,z:0}],enabled:s.front.visible},{fill:t.color(s.front.color).get(),vertexes:[{x:p,y:d,z:x},{x:h,y:d,z:x},{x:h,y:c,z:x},{x:p,y:c,z:x}],enabled:s.front.visible}]})}}),a.prototype.retrieveStacks=function(t){var e,i=this.series,o={},r=1;return this.series.forEach(function(a){e=s(a.options.stack,t?0:i.length-1-a.index),o[e]?o[e].series.push(a):(o[e]={series:[a],position:r},r++)}),o.totalStacks=r+1,o},a.prototype.get3dFrame=function(){var e=this,i=e.options.chart.options3d,o=i.frame,r=e.plotLeft,a=e.plotLeft+e.plotWidth,n=e.plotTop,h=e.plotTop+e.plotHeight,p=i.depth,c=function(i){var s=t.shapeArea3d(i,e);return s>.5?1:s<-.5?-1:0},d=c([{x:r,y:h,z:p},{x:a,y:h,z:p},{x:a,y:h,z:0},{x:r,y:h,z:0}]),x=c([{x:r,y:n,z:0},{x:a,y:n,z:0},{x:a,y:n,z:p},{x:r,y:n,z:p}]),y=c([{x:r,y:n,z:0},{x:r,y:n,z:p},{x:r,y:h,z:p},{x:r,y:h,z:0}]),f=c([{x:a,y:n,z:p},{x:a,y:n,z:0},{x:a,y:h,z:0},{x:a,y:h,z:p}]),u=c([{x:r,y:h,z:0},{x:a,y:h,z:0},{x:a,y:n,z:0},{x:r,y:n,z:0}]),z=c([{x:r,y:n,z:p},{x:a,y:n,z:p},{x:a,y:h,z:p},{x:r,y:h,z:p}]),b=!1,v=!1,g=!1,m=!1;[].concat(e.xAxis,e.yAxis,e.zAxis).forEach(function(t){t&&(t.horiz?t.opposite?v=!0:b=!0:t.opposite?m=!0:g=!0)});var M=function(t,e,i){for(var o=["size","color","visible"],r={},a=0;a<o.length;a++)for(var n=o[a],l=0;l<t.length;l++)if("object"==typeof t[l]){var h=t[l][n];if(void 0!==h&&null!==h){r[n]=h;break}}var p=i;return!0===r.visible||!1===r.visible?p=r.visible:"auto"===r.visible&&(p=e>0),{size:s(r.size,1),color:s(r.color,"none"),frontFacing:e>0,visible:p}},A={axes:{},bottom:M([o.bottom,o.top,o],d,b),top:M([o.top,o.bottom,o],x,v),left:M([o.left,o.right,o.side,o],y,g),right:M([o.right,o.left,o.side,o],f,m),back:M([o.back,o.front,o],z,!0),front:M([o.front,o.back,o],u,!1)};if("auto"===i.axisLabelPosition){var P=function(t,e){return t.visible!==e.visible||t.visible&&e.visible&&t.frontFacing!==e.frontFacing},k=[];P(A.left,A.front)&&k.push({y:(n+h)/2,x:r,z:0,xDir:{x:1,y:0,z:0}}),P(A.left,A.back)&&k.push({y:(n+h)/2,x:r,z:p,xDir:{x:0,y:0,z:-1}}),P(A.right,A.front)&&k.push({y:(n+h)/2,x:a,z:0,xDir:{x:0,y:0,z:1}}),P(A.right,A.back)&&k.push({y:(n+h)/2,x:a,z:p,xDir:{x:-1,y:0,z:0}});var S=[];P(A.bottom,A.front)&&S.push({x:(r+a)/2,y:h,z:0,xDir:{x:1,y:0,z:0}}),P(A.bottom,A.back)&&S.push({x:(r+a)/2,y:h,z:p,xDir:{x:-1,y:0,z:0}});var L=[];P(A.top,A.front)&&L.push({x:(r+a)/2,y:n,z:0,xDir:{x:1,y:0,z:0}}),P(A.top,A.back)&&L.push({x:(r+a)/2,y:n,z:p,xDir:{x:-1,y:0,z:0}});var I=[];P(A.bottom,A.left)&&I.push({z:(0+p)/2,y:h,x:r,xDir:{x:0,y:0,z:-1}}),P(A.bottom,A.right)&&I.push({z:(0+p)/2,y:h,x:a,xDir:{x:0,y:0,z:1}});var w=[];P(A.top,A.left)&&w.push({z:(0+p)/2,y:n,x:r,xDir:{x:0,y:0,z:-1}}),P(A.top,A.right)&&w.push({z:(0+p)/2,y:n,x:a,xDir:{x:0,y:0,z:1}});var D=function(t,i,s){if(0===t.length)return null;if(1===t.length)return t[0];for(var o=0,r=l(t,e,!1),a=1;a<r.length;a++)s*r[a][i]>s*r[o][i]?o=a:s*r[a][i]==s*r[o][i]&&r[a].z<r[o].z&&(o=a);return t[o]};A.axes={y:{left:D(k,"x",-1),right:D(k,"x",1)},x:{top:D(L,"y",-1),bottom:D(S,"y",1)},z:{top:D(w,"y",-1),bottom:D(I,"y",1)}}}else A.axes={y:{left:{x:r,z:0,xDir:{x:1,y:0,z:0}},right:{x:a,z:0,xDir:{x:0,y:0,z:1}}},x:{top:{y:n,z:0,xDir:{x:1,y:0,z:0}},bottom:{y:h,z:0,xDir:{x:1,y:0,z:0}}},z:{top:{x:g?a:r,y:n,xDir:g?{x:0,y:0,z:1}:{x:0,y:0,z:-1}},bottom:{x:g?a:r,y:h,xDir:g?{x:0,y:0,z:1}:{x:0,y:0,z:-1}}}};return A},t.Fx.prototype.matrixSetter=function(){var t;if(this.pos<1&&(i(this.start)||i(this.end))){var e=this.start||[1,0,0,1,0,0],s=this.end||[1,0,0,1,0,0];t=[];for(var o=0;o<6;o++)t.push(this.pos*s[o]+(1-this.pos)*e[o])}else t=this.end;this.elem.attr(this.prop,t,null,!0)}}),i(e,"parts-3d/Axis.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i,s=e.extend,o=e.pick,r=e.splat,a=e.wrap,n=t.addEvent,l=t.Axis,h=t.Chart,p=t.deg2rad,c=t.merge,d=t.perspective,x=t.perspective3D,y=t.shapeArea,f=t.Tick;function u(t,e,i){if(!t.chart.is3d()||"colorAxis"===t.coll)return e;var s,r=t.chart,a=p*r.options.chart.options3d.alpha,n=p*r.options.chart.options3d.beta,l=o(i&&t.options.title.position3d,t.options.labels.position3d),h=o(i&&t.options.title.skew3d,t.options.labels.skew3d),c=r.frame3d,x=r.plotLeft,f=r.plotWidth+x,u=r.plotTop,z=r.plotHeight+u,b=!1,v=0,g=0,m={x:0,y:1,z:0};if(e=t.swapZ({x:e.x,y:e.y,z:0}),t.isZAxis)if(t.opposite){if(null===c.axes.z.top)return{};g=e.y-u,e.x=c.axes.z.top.x,e.y=c.axes.z.top.y,s=c.axes.z.top.xDir,b=!c.top.frontFacing}else{if(null===c.axes.z.bottom)return{};g=e.y-z,e.x=c.axes.z.bottom.x,e.y=c.axes.z.bottom.y,s=c.axes.z.bottom.xDir,b=!c.bottom.frontFacing}else if(t.horiz)if(t.opposite){if(null===c.axes.x.top)return{};g=e.y-u,e.y=c.axes.x.top.y,e.z=c.axes.x.top.z,s=c.axes.x.top.xDir,b=!c.top.frontFacing}else{if(null===c.axes.x.bottom)return{};g=e.y-z,e.y=c.axes.x.bottom.y,e.z=c.axes.x.bottom.z,s=c.axes.x.bottom.xDir,b=!c.bottom.frontFacing}else if(t.opposite){if(null===c.axes.y.right)return{};v=e.x-f,e.x=c.axes.y.right.x,e.z=c.axes.y.right.z,s={x:(s=c.axes.y.right.xDir).z,y:s.y,z:-s.x}}else{if(null===c.axes.y.left)return{};v=e.x-x,e.x=c.axes.y.left.x,e.z=c.axes.y.left.z,s=c.axes.y.left.xDir}if("chart"===l);else if("flap"===l)if(t.horiz){var M=Math.sin(a),A=Math.cos(a);t.opposite&&(M=-M),b&&(M=-M),m={x:s.z*M,y:A,z:-s.x*M}}else s={x:Math.cos(n),y:0,z:Math.sin(n)};else if("ortho"===l)if(t.horiz){var P=Math.sin(a),k=Math.cos(a),S={x:Math.sin(n)*k,y:-P,z:-k*Math.cos(n)};m={x:s.y*S.z-s.z*S.y,y:s.z*S.x-s.x*S.z,z:s.x*S.y-s.y*S.x};var L=1/Math.sqrt(m.x*m.x+m.y*m.y+m.z*m.z);b&&(L=-L),m={x:L*m.x,y:L*m.y,z:L*m.z}}else s={x:Math.cos(n),y:0,z:Math.sin(n)};else t.horiz?m={x:Math.sin(n)*Math.sin(a),y:Math.cos(a),z:-Math.cos(n)*Math.sin(a)}:s={x:Math.cos(n),y:0,z:Math.sin(n)};e.x+=v*s.x+g*m.x,e.y+=v*s.y+g*m.y,e.z+=v*s.z+g*m.z;var I=d([e],t.chart)[0];if(h){y(d([e,{x:e.x+s.x,y:e.y+s.y,z:e.z+s.z},{x:e.x+m.x,y:e.y+m.y,z:e.z+m.z}],t.chart))<0&&(s={x:-s.x,y:-s.y,z:-s.z});var w=d([{x:e.x,y:e.y,z:e.z},{x:e.x+s.x,y:e.y+s.y,z:e.z+s.z},{x:e.x+m.x,y:e.y+m.y,z:e.z+m.z}],t.chart);I.matrix=[w[1].x-w[0].x,w[1].y-w[0].y,w[2].x-w[0].x,w[2].y-w[0].y,I.x,I.y],I.matrix[4]-=I.x*I.matrix[0]+I.y*I.matrix[2],I.matrix[5]-=I.x*I.matrix[1]+I.y*I.matrix[3]}return I}c(!0,l.prototype.defaultOptions,{labels:{position3d:"offset",skew3d:!1},title:{position3d:null,skew3d:null}}),n(l,"afterSetOptions",function(){var t;this.chart.is3d&&this.chart.is3d()&&"colorAxis"!==this.coll&&((t=this.options).tickWidth=o(t.tickWidth,0),t.gridLineWidth=o(t.gridLineWidth,1))}),a(l.prototype,"getPlotLinePath",function(t){var e=t.apply(this,[].slice.call(arguments,1));if(!this.chart.is3d()||"colorAxis"===this.coll)return e;if(null===e)return e;var i=this.chart,s=i.options.chart.options3d,o=this.isZAxis?i.plotWidth:s.depth,r=i.frame3d,a=[this.swapZ({x:e[1],y:e[2],z:0}),this.swapZ({x:e[1],y:e[2],z:o}),this.swapZ({x:e[4],y:e[5],z:0}),this.swapZ({x:e[4],y:e[5],z:o})],n=[];return this.horiz?this.isZAxis?(r.left.visible&&n.push(a[0],a[2]),r.right.visible&&n.push(a[1],a[3]),r.top.visible&&n.push(a[0],a[1]),r.bottom.visible&&n.push(a[2],a[3])):(r.front.visible&&n.push(a[0],a[2]),r.back.visible&&n.push(a[1],a[3]),r.top.visible&&n.push(a[0],a[1]),r.bottom.visible&&n.push(a[2],a[3])):(r.front.visible&&n.push(a[0],a[2]),r.back.visible&&n.push(a[1],a[3]),r.left.visible&&n.push(a[0],a[1]),r.right.visible&&n.push(a[2],a[3])),n=d(n,this.chart,!1),this.chart.renderer.toLineSegments(n)}),a(l.prototype,"getLinePath",function(t){return this.chart.is3d()&&"colorAxis"!==this.coll?[]:t.apply(this,[].slice.call(arguments,1))}),a(l.prototype,"getPlotBandPath",function(t){if(!this.chart.is3d()||"colorAxis"===this.coll)return t.apply(this,[].slice.call(arguments,1));var e=arguments,i=e[1],s=e[2],o=[],r=this.getPlotLinePath({value:i}),a=this.getPlotLinePath({value:s});if(r&&a)for(var n=0;n<r.length;n+=6)o.push("M",r[n+1],r[n+2],"L",r[n+4],r[n+5],"L",a[n+4],a[n+5],"L",a[n+1],a[n+2],"Z");return o}),a(f.prototype,"getMarkPath",function(t){var e=t.apply(this,[].slice.call(arguments,1)),i=[u(this.axis,{x:e[1],y:e[2],z:0}),u(this.axis,{x:e[4],y:e[5],z:0})];return this.axis.chart.renderer.toLineSegments(i)}),n(f,"afterGetLabelPosition",function(t){s(t.pos,u(this.axis,t.pos))}),a(l.prototype,"getTitlePosition",function(t){return u(this,t.apply(this,[].slice.call(arguments,1)),!0)}),n(l,"drawCrosshair",function(t){this.chart.is3d()&&"colorAxis"!==this.coll&&t.point&&(t.point.crosshairPos=this.isXAxis?t.point.axisXpos:this.len-t.point.axisYpos)}),n(l,"destroy",function(){["backFrame","bottomFrame","sideFrame"].forEach(function(t){this[t]&&(this[t]=this[t].destroy())},this)}),h.prototype.addZAxis=function(t){return new i(this,t)},h.prototype.collectionsWithUpdate.push("zAxis"),h.prototype.collectionsWithInit.zAxis=[h.prototype.addZAxis],l.prototype.swapZ=function(t,e){if(this.isZAxis){var i=e?0:this.chart.plotLeft;return{x:i+t.z,y:t.y,z:t.x-i}}return t},i=t.ZAxis=function(){this.init.apply(this,arguments)},s(i.prototype,l.prototype),s(i.prototype,{isZAxis:!0,setOptions:function(t){t=c({offset:0,lineWidth:0},t),l.prototype.setOptions.call(this,t),this.coll="zAxis"},setAxisSize:function(){l.prototype.setAxisSize.call(this),this.width=this.len=this.chart.options.chart.options3d.depth,this.right=this.chart.chartWidth-this.width-this.left},getSeriesExtremes:function(){var t=this,e=t.chart;t.hasVisibleSeries=!1,t.dataMin=t.dataMax=t.ignoreMinPadding=t.ignoreMaxPadding=null,t.buildStacks&&t.buildStacks(),t.series.forEach(function(i){if(i.visible||!e.options.chart.ignoreHiddenSeries){var s,r=i.options.threshold;t.hasVisibleSeries=!0,t.positiveValuesOnly&&r<=0&&(r=null),(s=i.zData).length&&(t.dataMin=Math.min(o(t.dataMin,s[0]),Math.min.apply(null,s)),t.dataMax=Math.max(o(t.dataMax,s[0]),Math.max.apply(null,s)))}})}}),n(h,"afterGetAxes",function(){var t=this,e=this.options,i=e.zAxis=r(e.zAxis||{});t.is3d()&&(this.zAxis=[],i.forEach(function(e,i){e.index=i,e.isX=!0,t.addZAxis(e).setScale()}))}),a(l.prototype,"getSlotWidth",function(t,e){if(this.chart.is3d()&&e&&e.label&&this.categories&&this.chart.frameShapes){var i,s,r,a=this.chart,n=this.ticks,l=this.gridGroup.element.childNodes[0].getBBox(),h=a.frameShapes.left.getBBox(),p=a.options.chart.options3d,c={x:a.plotWidth/2,y:a.plotHeight/2,z:p.depth/2,vd:o(p.depth,1)*o(p.viewDistance,0)},d=e.pos,y=n[d-1],f=n[d+1];return 0!==d&&y&&y.label.xy&&(s=x({x:y.label.xy.x,y:y.label.xy.y,z:null},c,c.vd)),f&&f.label.xy&&(r=x({x:f.label.xy.x,y:f.label.xy.y,z:null},c,c.vd)),i={x:e.label.xy.x,y:e.label.xy.y,z:null},i=x(i,c,c.vd),Math.abs(s?i.x-s.x:r?r.x-i.x:l.x-h.x)}return t.apply(this,[].slice.call(arguments,1))})}),i(e,"parts-3d/Series.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.pick,s=t.addEvent,o=t.perspective;s(t.Series,"afterTranslate",function(){this.chart.is3d()&&this.translate3dPoints()}),t.Series.prototype.translate3dPoints=function(){var t,e,s,r,a,n=this.chart,l=i(this.zAxis,n.options.zAxis[0]),h=[];for(a=0;a<this.data.length;a++)t=this.data[a],l&&l.translate?(r=l.isLog&&l.val2lin?l.val2lin(t.z):t.z,t.plotZ=l.translate(r),t.isInside=!!t.isInside&&(r>=l.min&&r<=l.max)):t.plotZ=0,t.axisXpos=t.plotX,t.axisYpos=t.plotY,t.axisZpos=t.plotZ,h.push({x:t.plotX,y:t.plotY,z:t.plotZ});for(e=o(h,n,!0),a=0;a<this.data.length;a++)t=this.data[a],s=e[a],t.plotX=s.x,t.plotY=s.y,t.plotZ=s.z}}),i(e,"parts-3d/Column.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.pick,s=e.wrap,o=t.addEvent,r=t.perspective,a=t.Series,n=t.seriesTypes,l=t.svg;function h(t){var e=t.apply(this,[].slice.call(arguments,1));return this.chart.is3d&&this.chart.is3d()&&(e.stroke=this.options.edgeColor||e.fill,e["stroke-width"]=i(this.options.edgeWidth,1)),e}function p(t,e,i){var s=this.chart.is3d&&this.chart.is3d();s&&(this.options.inactiveOtherPoints=!0),t.call(this,e,i),s&&(this.options.inactiveOtherPoints=!1)}function c(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return this.series.chart.is3d()?this.graphic&&"g"!==this.graphic.element.nodeName:t.apply(this,e)}s(n.column.prototype,"translate",function(t){t.apply(this,[].slice.call(arguments,1)),this.chart.is3d()&&this.translate3dShapes()}),s(t.Series.prototype,"alignDataLabel",function(t){arguments[3].outside3dPlot=arguments[1].outside3dPlot,t.apply(this,[].slice.call(arguments,1))}),s(t.Series.prototype,"justifyDataLabel",function(t){return!arguments[2].outside3dPlot&&t.apply(this,[].slice.call(arguments,1))}),n.column.prototype.translate3dPoints=function(){},n.column.prototype.translate3dShapes=function(){var t=this,e=t.chart,i=t.options,s=i.depth||25,o=(i.stacking?i.stack||0:t.index)*(s+(i.groupZPadding||1)),a=t.borderWidth%2?.5:0;e.inverted&&!t.yAxis.reversed&&(a*=-1),!1!==i.grouping&&(o=0),o+=i.groupZPadding||1,t.data.forEach(function(i){if(i.outside3dPlot=null,null!==i.y){var n,l=i.shapeArgs,h=i.tooltipPos;[["x","width"],["y","height"]].forEach(function(e){if((n=l[e[0]]-a)<0&&(l[e[1]]+=l[e[0]]+a,l[e[0]]=-a,n=0),n+l[e[1]]>t[e[0]+"Axis"].len&&0!==l[e[1]]&&(l[e[1]]=t[e[0]+"Axis"].len-l[e[0]]),0!==l[e[1]]&&(l[e[0]]>=t[e[0]+"Axis"].len||l[e[0]]+l[e[1]]<=a)){for(var s in l)l[s]=0;i.outside3dPlot=!0}}),"rect"===i.shapeType&&(i.shapeType="cuboid"),l.z=o,l.depth=s,l.insidePlotArea=!0,h=r([{x:h[0],y:h[1],z:o}],e,!0)[0],i.tooltipPos=[h.x,h.y]}}),t.z=o},s(n.column.prototype,"animate",function(t){if(this.chart.is3d()){var e=arguments[1],i=this.yAxis,s=this,o=this.yAxis.reversed;l&&(e?s.data.forEach(function(t){null!==t.y&&(t.height=t.shapeArgs.height,t.shapey=t.shapeArgs.y,t.shapeArgs.height=1,o||(t.stackY?t.shapeArgs.y=t.plotY+i.translate(t.stackY):t.shapeArgs.y=t.plotY+(t.negative?-t.height:t.height)))}):(s.data.forEach(function(t){null!==t.y&&(t.shapeArgs.height=t.height,t.shapeArgs.y=t.shapey,t.graphic&&t.graphic.animate(t.shapeArgs,s.options.animation))}),this.drawDataLabels(),s.animate=null))}else t.apply(this,[].slice.call(arguments,1))}),s(n.column.prototype,"plotGroup",function(t,e,i,s,o,r){return"dataLabelsGroup"!==e&&this.chart.is3d()&&(this[e]&&delete this[e],r&&(this.chart.columnGroup||(this.chart.columnGroup=this.chart.renderer.g("columnGroup").add(r)),this[e]=this.chart.columnGroup,this.chart.columnGroup.attr(this.getPlotBox()),this[e].survive=!0,"group"!==e&&"markerGroup"!==e||(arguments[3]="visible"))),t.apply(this,Array.prototype.slice.call(arguments,1))}),s(n.column.prototype,"setVisible",function(t,e){var s,o=this;o.chart.is3d()&&o.data.forEach(function(t){t.visible=t.options.visible=e=void 0===e?!i(o.visible,t.visible):e,s=e?"visible":"hidden",o.options.data[o.data.indexOf(t)]=t.options,t.graphic&&t.graphic.attr({visibility:s})}),t.apply(this,Array.prototype.slice.call(arguments,1))}),n.column.prototype.handle3dGrouping=!0,o(a,"afterInit",function(){if(this.chart.is3d()&&this.handle3dGrouping){var t=this.options,e=t.grouping,s=t.stacking,o=i(this.yAxis.options.reversedStacks,!0),r=0;if(void 0===e||e){var a,n=this.chart.retrieveStacks(s),l=t.stack||0;for(a=0;a<n[l].series.length&&n[l].series[a]!==this;a++);r=10*(n.totalStacks-n[l].position)+(o?a:-a),this.xAxis.reversed||(r=10*n.totalStacks-r)}t.zIndex=r}}),s(n.column.prototype,"pointAttribs",h),s(n.column.prototype,"setState",p),s(n.column.prototype.pointClass.prototype,"hasNewShapeType",c),n.columnrange&&(s(n.columnrange.prototype,"pointAttribs",h),s(n.columnrange.prototype,"setState",p),s(n.columnrange.prototype.pointClass.prototype,"hasNewShapeType",c),n.columnrange.prototype.plotGroup=n.column.prototype.plotGroup,n.columnrange.prototype.setVisible=n.column.prototype.setVisible),s(a.prototype,"alignDataLabel",function(t){if(this.chart.is3d()&&this instanceof n.column){var e=this.chart,i=arguments,s=i[4],o=i[1],a={x:s.x,y:s.y,z:this.z};a=r([a],e,!0)[0],s.x=a.x,s.y=o.outside3dPlot?-9e9:a.y}t.apply(this,[].slice.call(arguments,1))}),s(t.StackItem.prototype,"getStackBox",function(e,i){var s=e.apply(this,[].slice.call(arguments,1));if(i.is3d()){var o={x:s.x,y:s.y,z:0};o=t.perspective([o],i,!0)[0],s.x=o.x,s.y=o.y}return s})}),i(e,"parts-3d/Pie.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.pick,s=e.wrap,o=t.deg2rad,r=t.seriesTypes,a=t.svg;s(r.pie.prototype,"translate",function(t){if(t.apply(this,[].slice.call(arguments,1)),this.chart.is3d()){var e=this,i=e.options,s=i.depth||0,r=e.chart.options.chart.options3d,a=r.alpha,n=r.beta,l=i.stacking?(i.stack||0)*s:e._i*s;l+=s/2,!1!==i.grouping&&(l=0),e.data.forEach(function(t){var r,h=t.shapeArgs;t.shapeType="arc3d",h.z=l,h.depth=.75*s,h.alpha=a,h.beta=n,h.center=e.center,r=(h.end+h.start)/2,t.slicedTranslation={translateX:Math.round(Math.cos(r)*i.slicedOffset*Math.cos(a*o)),translateY:Math.round(Math.sin(r)*i.slicedOffset*Math.cos(a*o))}})}}),s(r.pie.prototype.pointClass.prototype,"haloPath",function(t){var e=arguments;return this.series.chart.is3d()?[]:t.call(this,e[1])}),s(r.pie.prototype,"pointAttribs",function(t,e,s){var o=t.call(this,e,s),r=this.options;return this.chart.is3d()&&!this.chart.styledMode&&(o.stroke=r.edgeColor||e.color||this.color,o["stroke-width"]=i(r.edgeWidth,1)),o}),s(r.pie.prototype,"drawDataLabels",function(t){if(this.chart.is3d()){var e=this.chart.options.chart.options3d;this.data.forEach(function(t){var i=t.shapeArgs,s=i.r,r=(i.alpha||e.alpha)*o,a=(i.beta||e.beta)*o,n=(i.start+i.end)/2,l=t.labelPosition,h=l.connectorPosition,p=-s*(1-Math.cos(r))*Math.sin(n),c=s*(Math.cos(a)-1)*Math.cos(n);[l.natural,h.breakAt,h.touchingSliceAt].forEach(function(t){t.x+=c,t.y+=p})})}t.apply(this,[].slice.call(arguments,1))}),s(r.pie.prototype,"addPoint",function(t){t.apply(this,[].slice.call(arguments,1)),this.chart.is3d()&&this.update(this.userOptions,!0)}),s(r.pie.prototype,"animate",function(t){if(this.chart.is3d()){var e,i=arguments[1],s=this.options.animation,o=this.center,r=this.group,n=this.markerGroup;a&&(!0===s&&(s={}),i?(r.oldtranslateX=r.translateX,r.oldtranslateY=r.translateY,e={translateX:o[0],translateY:o[1],scaleX:.001,scaleY:.001},r.attr(e),n&&(n.attrSetters=r.attrSetters,n.attr(e))):(e={translateX:r.oldtranslateX,translateY:r.oldtranslateY,scaleX:1,scaleY:1},r.animate(e,s),n&&n.animate(e,s),this.animate=null))}else t.apply(this,[].slice.call(arguments,1))})}),i(e,"parts-3d/Scatter.js",[e["parts/Globals.js"]],function(t){var e=t.Point,i=t.seriesType,s=t.seriesTypes;i("scatter3d","scatter",{tooltip:{pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>z: <b>{point.z}</b><br/>"}},{pointAttribs:function(e){var i=s.scatter.prototype.pointAttribs.apply(this,arguments);return this.chart.is3d()&&e&&(i.zIndex=t.pointCameraDistance(e,this.chart)),i},axisTypes:["xAxis","yAxis","zAxis"],pointArrayMap:["x","y","z"],parallelArrays:["x","y","z"],directTouch:!0},{applyOptions:function(){return e.prototype.applyOptions.apply(this,arguments),void 0===this.z&&(this.z=0),this}})}),i(e,"parts-3d/VMLRenderer.js",[e["parts/Globals.js"]],function(t){var e=t.addEvent,i=t.Axis,s=t.SVGRenderer,o=t.VMLRenderer;o&&(t.setOptions({animate:!1}),o.prototype.face3d=s.prototype.face3d,o.prototype.polyhedron=s.prototype.polyhedron,o.prototype.elements3d=s.prototype.elements3d,o.prototype.element3d=s.prototype.element3d,o.prototype.cuboid=s.prototype.cuboid,o.prototype.cuboidPath=s.prototype.cuboidPath,o.prototype.toLinePath=s.prototype.toLinePath,o.prototype.toLineSegments=s.prototype.toLineSegments,o.prototype.arc3d=function(t){var e=s.prototype.arc3d.call(this,t);return e.css({zIndex:e.zIndex}),e},t.VMLRenderer.prototype.arc3dPath=t.SVGRenderer.prototype.arc3dPath,e(i,"render",function(){this.sideFrame&&(this.sideFrame.css({zIndex:0}),this.sideFrame.front.attr({fill:this.sideFrame.color})),this.bottomFrame&&(this.bottomFrame.css({zIndex:1}),this.bottomFrame.front.attr({fill:this.bottomFrame.color})),this.backFrame&&(this.backFrame.css({zIndex:0}),this.backFrame.front.attr({fill:this.backFrame.color}))}))}),i(e,"masters/highcharts-3d.src.js",[],function(){})});
!function(t){"object"==typeof module&&module.exports?(t.default=t,module.exports=t):"function"==typeof define&&define.amd?define("highcharts/highcharts-more",["highcharts"],function(e){return t(e),t.Highcharts=e,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){var e=t?t._modules:{};function i(t,e,i,s){t.hasOwnProperty(e)||(t[e]=s.apply(null,i))}i(e,"parts-more/Pane.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.extend,s=e.splat,a=t.CenteredSeriesMixin,o=t.merge;function r(t,e){this.init(t,e)}t.Chart.prototype.collectionsWithUpdate.push("pane"),i(r.prototype,{coll:"pane",init:function(t,e){this.chart=e,this.background=[],e.pane.push(this),this.setOptions(t)},setOptions:function(t){this.options=t=o(this.defaultOptions,this.chart.angular?{background:{}}:void 0,t)},render:function(){var t,e,i=this.options,a=this.options.background,r=this.chart.renderer;if(this.group||(this.group=r.g("pane-group").attr({zIndex:i.zIndex||0}).add()),this.updateCenter(),a)for(a=s(a),t=Math.max(a.length,this.background.length||0),e=0;e<t;e++)a[e]&&this.axis?this.renderBackground(o(this.defaultBackgroundOptions,a[e]),e):this.background[e]&&(this.background[e]=this.background[e].destroy(),this.background.splice(e,1))},renderBackground:function(t,e){var s="animate",a={class:"highcharts-pane "+(t.className||"")};this.chart.styledMode||i(a,{fill:t.backgroundColor,stroke:t.borderColor,"stroke-width":t.borderWidth}),this.background[e]||(this.background[e]=this.chart.renderer.path().add(this.group),s="attr"),this.background[e][s]({d:this.axis.getPlotBandPath(t.from,t.to,t)}).attr(a)},defaultOptions:{center:["50%","50%"],size:"85%",startAngle:0},defaultBackgroundOptions:{shape:"circle",borderWidth:1,borderColor:"#cccccc",backgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#ffffff"],[1,"#e6e6e6"]]},from:-Number.MAX_VALUE,innerRadius:0,to:Number.MAX_VALUE,outerRadius:"105%"},updateCenter:function(t){this.center=(t||this.axis||{}).center=a.getCenter.call(this)},update:function(t,e){o(!0,this.options,t),o(!0,this.chart.options.pane,t),this.setOptions(this.options),this.render(),this.chart.axes.forEach(function(t){t.pane===this&&(t.pane=null,t.update({},e))},this)}}),t.Pane=r}),i(e,"parts-more/RadialAxis.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i,s,a=e.correctFloat,o=e.defined,r=e.extend,n=e.pick,l=e.pInt,h=e.relativeLength,p=e.wrap,d=t.addEvent,c=t.Axis,u=t.merge,g=t.noop,f=t.Tick,m=c.prototype,b=f.prototype;i={getOffset:g,redraw:function(){this.isDirty=!1},render:function(){this.isDirty=!1},createLabelCollector:function(){return!1},setScale:g,setCategories:g,setTitle:g},s={defaultRadialGaugeOptions:{labels:{align:"center",x:0,y:null},minorGridLineWidth:0,minorTickInterval:"auto",minorTickLength:10,minorTickPosition:"inside",minorTickWidth:1,tickLength:10,tickPosition:"inside",tickWidth:2,title:{rotation:0},zIndex:2},defaultCircularOptions:{gridLineWidth:1,labels:{align:null,distance:15,x:0,y:null,style:{textOverflow:"none"}},maxPadding:0,minPadding:0,showLastLabel:!1,tickLength:0},defaultRadialOptions:{gridLineInterpolation:"circle",gridLineWidth:1,labels:{align:"right",x:-3,y:-2},showLastLabel:!1,title:{x:4,text:null,rotation:90}},setOptions:function(e){var i=this.options=u(this.defaultOptions,this.defaultPolarOptions,e);i.plotBands||(i.plotBands=[]),t.fireEvent(this,"afterSetOptions")},getOffset:function(){m.getOffset.call(this),this.chart.axisOffset[this.side]=0},getLinePath:function(t,e){var i,s,a=this.center,o=this.chart,r=n(e,a[2]/2-this.offset);return this.isCircular||void 0!==e?((s=this.chart.renderer.symbols.arc(this.left+a[0],this.top+a[1],r,r,{start:this.startAngleRad,end:this.endAngleRad,open:!0,innerR:0})).xBounds=[this.left+a[0]],s.yBounds=[this.top+a[1]-r]):(i=this.postTranslate(this.angleRad,r),s=["M",a[0]+o.plotLeft,a[1]+o.plotTop,"L",i.x,i.y]),s},setAxisTranslation:function(){m.setAxisTranslation.call(this),this.center&&(this.isCircular?this.transA=(this.endAngleRad-this.startAngleRad)/(this.max-this.min||1):this.transA=this.center[2]/2/(this.max-this.min||1),this.isXAxis?this.minPixelPadding=this.transA*this.minPointOffset:this.minPixelPadding=0)},beforeSetTickPositions:function(){this.autoConnect=this.isCircular&&void 0===n(this.userMax,this.options.max)&&a(this.endAngleRad-this.startAngleRad)===a(2*Math.PI),!this.isCircular&&this.chart.inverted&&this.max++,this.autoConnect&&(this.max+=(this.categories?1:this.pointRange)||this.closestPointRange||0)},setAxisSize:function(){m.setAxisSize.call(this),this.isRadial&&(this.pane.updateCenter(this),this.isCircular&&(this.sector=this.endAngleRad-this.startAngleRad),this.len=this.width=this.height=this.center[2]*n(this.sector,1)/2)},getPosition:function(t,e){var i=this.translate(t);return this.postTranslate(this.isCircular?i:this.angleRad,n(this.isCircular?e:i<0?0:i,this.center[2]/2)-this.offset)},postTranslate:function(t,e){var i=this.chart,s=this.center;return t=this.startAngleRad+t,{x:i.plotLeft+s[0]+Math.cos(t)*e,y:i.plotTop+s[1]+Math.sin(t)*e}},getPlotBandPath:function(t,e,i){var s,a,o,r,h,p,d=this.center,c=this.startAngleRad,u=d[2]/2,g=[n(i.outerRadius,"100%"),i.innerRadius,n(i.thickness,10)],f=Math.min(this.offset,0),m=/%$/,b=this.isCircular;return"polygon"===this.options.gridLineInterpolation?p=this.getPlotLinePath({value:t}).concat(this.getPlotLinePath({value:e,reverse:!0})):(t=Math.max(t,this.min),e=Math.min(e,this.max),b||(g[0]=this.translate(t),g[1]=this.translate(e)),g=g.map(function(t){return m.test(t)&&(t=l(t,10)*u/100),t}),"circle"!==i.shape&&b?(s=c+this.translate(t),a=c+this.translate(e)):(s=-Math.PI/2,a=1.5*Math.PI,h=!0),g[0]-=f,g[2]-=f,p=this.chart.renderer.symbols.arc(this.left+d[0],this.top+d[1],g[0],g[0],{start:Math.min(s,a),end:Math.max(s,a),innerR:n(g[1],g[0]-g[2]),open:h}),b&&(o=(a+s)/2,r=this.left+d[0]+d[2]/2*Math.cos(o),p.xBounds=o>-Math.PI/2&&o<Math.PI/2?[r,this.chart.plotWidth]:[0,r],p.yBounds=[this.top+d[1]+d[2]/2*Math.sin(o)],p.yBounds[0]+=o>-Math.PI&&o<0||o>Math.PI?-10:10)),p},getCrosshairPosition:function(t,e,i){var s,a,r,n=t.value;return this.isCircular?(o(n)?t.point&&(t.point.shapeArgs||{}).start&&(n=this.translate(t.point.rectPlotY,!0)):(a=t.chartX||0,r=t.chartY||0,n=this.translate(Math.atan2(r-i,a-e)-this.startAngleRad,!0)),a=(s=this.getPosition(n)).x,r=s.y):(o(n)||(a=t.chartX,r=t.chartY),o(a)&&o(r)&&(n=this.translate(Math.min(Math.sqrt(Math.pow(a-e,2)+Math.pow(r-i,2)),this.len),!0))),[n,a||0,r||0]},getPlotLinePath:function(t){var e,i,s,a,o,r,n,l=this,p=l.center,d=l.chart,c=d.inverted,u=t.value,g=t.reverse,f=l.getPosition(u),m=l.pane.options.background?l.pane.options.background[0]||l.pane.options.background:{},b=m.innerRadius||"0%",y=m.outerRadius||"100%",x=p[0]+d.plotLeft,v=p[1]+d.plotTop,M=f.x,P=f.y;return t.isCrosshair&&(r=this.getCrosshairPosition(t,x,v),u=r[0],M=r[1],P=r[2]),l.isCircular?(e="string"==typeof b?h(b,1):b/Math.sqrt(Math.pow(M-x,2)+Math.pow(P-v,2)),i="string"==typeof y?h(y,1):y/Math.sqrt(Math.pow(M-x,2)+Math.pow(P-v,2)),n=["M",x+e*(M-x),v-e*(v-P),"L",M-(1-i)*(M-x),P+(1-i)*(v-P)]):(u=l.translate(u),!t.isCrosshair&&(u<0||u>l.height)&&c&&(u=0),"circle"===l.options.gridLineInterpolation?n=l.getLinePath(0,u):(d[c?"yAxis":"xAxis"].forEach(function(t){t.pane===l.pane&&(s=t)}),n=[],o=s.tickPositions,s.autoConnect&&(o=o.concat([o[0]])),g&&(o=[].concat(o).reverse()),o.forEach(function(t,e){a=s.getPosition(t,u),n.push(e?"L":"M",a.x,a.y)}))),n},getTitlePosition:function(){var t=this.center,e=this.chart,i=this.options.title;return{x:e.plotLeft+t[0]+(i.x||0),y:e.plotTop+t[1]-{high:.5,middle:.25,low:0}[i.align]*t[2]+(i.y||0)}},createLabelCollector:function(){var t=this;return function(){if(t.isRadial&&t.tickPositions&&!0!==t.options.labels.allowOverlap)return t.tickPositions.map(function(e){return t.ticks[e]&&t.ticks[e].label}).filter(function(t){return Boolean(t)})}}},d(c,"init",function(t){var e,a=this.chart,o=a.inverted,n=a.angular,l=a.polar,h=this.isXAxis,p=this.coll,d=n&&h,c=a.options,g=t.userOptions.pane||0,f=this.pane=a.pane&&a.pane[g];"colorAxis"!==p?(n?(r(this,d?i:s),(e=!h)&&(this.defaultPolarOptions=this.defaultRadialGaugeOptions)):l&&(r(this,s),e=this.horiz,this.defaultPolarOptions=e?this.defaultCircularOptions:u("xAxis"===p?this.defaultOptions:this.defaultYAxisOptions,this.defaultRadialOptions),o&&"yAxis"===p&&(this.defaultPolarOptions.stackLabels=this.defaultYAxisOptions.stackLabels)),n||l?(this.isRadial=!0,c.chart.zoomType=null,this.labelCollector||(this.labelCollector=this.createLabelCollector()),this.labelCollector&&a.labelCollectors.push(this.labelCollector)):this.isRadial=!1,f&&e&&(f.axis=this),this.isCircular=e):this.isRadial=!1}),d(c,"afterInit",function(){var t=this.chart,e=this.options,i=t.angular&&this.isXAxis,s=this.pane,a=s&&s.options;!i&&s&&(t.angular||t.polar)&&(this.angleRad=(e.angle||0)*Math.PI/180,this.startAngleRad=(a.startAngle-90)*Math.PI/180,this.endAngleRad=(n(a.endAngle,a.startAngle+360)-90)*Math.PI/180,this.offset=e.offset||0)}),d(c,"autoLabelAlign",function(t){this.isRadial&&(t.align=void 0,t.preventDefault())}),d(c,"destroy",function(){if(this.chart&&this.chart.labelCollectors){var t=this.chart.labelCollectors.indexOf(this.labelCollector);t>=0&&this.chart.labelCollectors.splice(t,1)}}),d(f,"afterGetPosition",function(t){this.axis.getPosition&&r(t.pos,this.axis.getPosition(this.pos))}),d(f,"afterGetLabelPosition",function(t){var e,i=this.axis,s=this.label,a=s.getBBox(),o=i.options.labels,r=o.y,l=20,p=o.align,d=(i.translate(this.pos)+i.startAngleRad+Math.PI/2)/Math.PI*180%360,c=Math.round(d),u="end",g=c<0?c+360:c,f=g,m=0,b=0,y=null===o.y?.3*-a.height:0;i.isRadial&&(e=i.getPosition(this.pos,i.center[2]/2+h(n(o.distance,-25),i.center[2]/2,-i.center[2]/2)),"auto"===o.rotation?s.attr({rotation:d}):null===r&&(r=i.chart.renderer.fontMetrics(s.styles&&s.styles.fontSize).b-a.height/2),null===p&&(i.isCircular?(a.width>i.len*i.tickInterval/(i.max-i.min)&&(l=0),p=d>l&&d<180-l?"left":d>180+l&&d<360-l?"right":"center"):p="center",s.attr({align:p})),"auto"===p&&2===i.tickPositions.length&&i.isCircular&&(g>90&&g<180?g=180-g:g>270&&g<=360&&(g=540-g),f>180&&f<=360&&(f=360-f),i.pane.options.startAngle!==c&&i.pane.options.startAngle!==c+360&&i.pane.options.startAngle!==c-360||(u="start"),p=c>=-90&&c<=90||c>=-360&&c<=-270||c>=270&&c<=360?"start"===u?"right":"left":"start"===u?"left":"right",f>70&&f<110&&(p="center"),g<15||g>=180&&g<195?m=.3*a.height:g>=15&&g<=35?m="start"===u?0:.75*a.height:g>=195&&g<=215?m="start"===u?.75*a.height:0:g>35&&g<=90?m="start"===u?.25*-a.height:a.height:g>215&&g<=270&&(m="start"===u?a.height:.25*-a.height),f<15?b="start"===u?.15*-a.height:.15*a.height:f>165&&f<=180&&(b="start"===u?.15*a.height:.15*-a.height),s.attr({align:p}),s.translate(b,m+y)),t.pos.x=e.x+o.x,t.pos.y=e.y+r)}),p(b,"getMarkPath",function(t,e,i,s,a,o,r){var n,l=this.axis;return l.isRadial?["M",e,i,"L",(n=l.getPosition(this.pos,l.center[2]/2+s)).x,n.y]:t.call(this,e,i,s,a,o,r)})}),i(e,"parts-more/AreaRangeSeries.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.defined,s=e.extend,a=e.isArray,o=e.isNumber,r=e.pick,n=t.noop,l=t.Series,h=t.seriesType,p=t.seriesTypes,d=l.prototype,c=t.Point.prototype;h("arearange","area",{lineWidth:1,threshold:null,tooltip:{pointFormat:'<span style="color:{series.color}"></span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},trackByArea:!0,dataLabels:{align:null,verticalAlign:null,xLow:0,xHigh:0,yLow:0,yHigh:0}},{pointArrayMap:["low","high"],pointValKey:"low",deferTranslatePolar:!0,toYData:function(t){return[t.low,t.high]},highToXY:function(t){var e=this.chart,i=this.xAxis.postTranslate(t.rectPlotX,this.yAxis.len-t.plotHigh);t.plotHighX=i.x-e.plotLeft,t.plotHigh=i.y-e.plotTop,t.plotLowX=t.plotX},translate:function(){var t=this,e=t.yAxis,i=!!t.modifyValue;p.area.prototype.translate.apply(t),t.points.forEach(function(s){var a=s.high,o=s.plotY;s.isNull?s.plotY=null:(s.plotLow=o,s.plotHigh=e.translate(i?t.modifyValue(a,s):a,0,1,0,1),i&&(s.yBottom=s.plotHigh))}),this.chart.polar&&this.points.forEach(function(e){t.highToXY(e),e.tooltipPos=[(e.plotHighX+e.plotLowX)/2,(e.plotHigh+e.plotLow)/2]})},getGraphPath:function(t){var e,i,s,a,o,n,l,h=[],d=[],c=p.area.prototype.getGraphPath,u=this.options,g=this.chart.polar&&!1!==u.connectEnds,f=u.connectNulls,m=u.step;for(e=(t=t||this.points).length,e=t.length;e--;)(i=t[e]).isNull||g||f||t[e+1]&&!t[e+1].isNull||d.push({plotX:i.plotX,plotY:i.plotY,doCurve:!1}),s={polarPlotY:i.polarPlotY,rectPlotX:i.rectPlotX,yBottom:i.yBottom,plotX:r(i.plotHighX,i.plotX),plotY:i.plotHigh,isNull:i.isNull},d.push(s),h.push(s),i.isNull||g||f||t[e-1]&&!t[e-1].isNull||d.push({plotX:i.plotX,plotY:i.plotY,doCurve:!1});return o=c.call(this,t),m&&(!0===m&&(m="left"),u.step={left:"right",center:"center",right:"left"}[m]),n=c.call(this,h),l=c.call(this,d),u.step=m,a=[].concat(o,n),this.chart.polar||"M"!==l[0]||(l[0]="L"),this.graphPath=a,this.areaPath=o.concat(l),a.isArea=!0,a.xMap=o.xMap,this.areaPath.xMap=o.xMap,a},drawDataLabels:function(){var t,e,i,o,r,n=this.points,l=n.length,h=[],p=this.options.dataLabels,c=this.chart.inverted;if(a(p)?p.length>1?(o=p[0],r=p[1]):(o=p[0],r={enabled:!1}):((o=s({},p)).x=p.xHigh,o.y=p.yHigh,(r=s({},p)).x=p.xLow,r.y=p.yLow),o.enabled||this._hasPointLabels){for(t=l;t--;)(e=n[t])&&(i=o.inside?e.plotHigh<e.plotLow:e.plotHigh>e.plotLow,e.y=e.high,e._plotY=e.plotY,e.plotY=e.plotHigh,h[t]=e.dataLabel,e.dataLabel=e.dataLabelUpper,e.below=i,c?o.align||(o.align=i?"right":"left"):o.verticalAlign||(o.verticalAlign=i?"top":"bottom"));for(this.options.dataLabels=o,d.drawDataLabels&&d.drawDataLabels.apply(this,arguments),t=l;t--;)(e=n[t])&&(e.dataLabelUpper=e.dataLabel,e.dataLabel=h[t],delete e.dataLabels,e.y=e.low,e.plotY=e._plotY)}if(r.enabled||this._hasPointLabels){for(t=l;t--;)(e=n[t])&&(i=r.inside?e.plotHigh<e.plotLow:e.plotHigh>e.plotLow,e.below=!i,c?r.align||(r.align=i?"left":"right"):r.verticalAlign||(r.verticalAlign=i?"bottom":"top"));this.options.dataLabels=r,d.drawDataLabels&&d.drawDataLabels.apply(this,arguments)}if(o.enabled)for(t=l;t--;)(e=n[t])&&(e.dataLabels=[e.dataLabelUpper,e.dataLabel].filter(function(t){return!!t}));this.options.dataLabels=p},alignDataLabel:function(){p.column.prototype.alignDataLabel.apply(this,arguments)},drawPoints:function(){var t,e,a=this.points.length;for(d.drawPoints.apply(this,arguments),e=0;e<a;)(t=this.points[e]).origProps={plotY:t.plotY,plotX:t.plotX,isInside:t.isInside,negative:t.negative,zone:t.zone,y:t.y},t.lowerGraphic=t.graphic,t.graphic=t.upperGraphic,t.plotY=t.plotHigh,i(t.plotHighX)&&(t.plotX=t.plotHighX),t.y=t.high,t.negative=t.high<(this.options.threshold||0),t.zone=this.zones.length&&t.getZone(),this.chart.polar||(t.isInside=t.isTopInside=void 0!==t.plotY&&t.plotY>=0&&t.plotY<=this.yAxis.len&&t.plotX>=0&&t.plotX<=this.xAxis.len),e++;for(d.drawPoints.apply(this,arguments),e=0;e<a;)(t=this.points[e]).upperGraphic=t.graphic,t.graphic=t.lowerGraphic,s(t,t.origProps),delete t.origProps,e++},setStackedPoints:n},{setState:function(){var t=this.state,e=this.series,s=e.chart.polar;i(this.plotHigh)||(this.plotHigh=e.yAxis.toPixels(this.high,!0)),i(this.plotLow)||(this.plotLow=this.plotY=e.yAxis.toPixels(this.low,!0)),e.stateMarkerGraphic&&(e.lowerStateMarkerGraphic=e.stateMarkerGraphic,e.stateMarkerGraphic=e.upperStateMarkerGraphic),this.graphic=this.upperGraphic,this.plotY=this.plotHigh,s&&(this.plotX=this.plotHighX),c.setState.apply(this,arguments),this.state=t,this.plotY=this.plotLow,this.graphic=this.lowerGraphic,s&&(this.plotX=this.plotLowX),e.stateMarkerGraphic&&(e.upperStateMarkerGraphic=e.stateMarkerGraphic,e.stateMarkerGraphic=e.lowerStateMarkerGraphic,e.lowerStateMarkerGraphic=void 0),c.setState.apply(this,arguments)},haloPath:function(){var t=this.series.chart.polar,e=[];return this.plotY=this.plotLow,t&&(this.plotX=this.plotLowX),this.isInside&&(e=c.haloPath.apply(this,arguments)),this.plotY=this.plotHigh,t&&(this.plotX=this.plotHighX),this.isTopInside&&(e=e.concat(c.haloPath.apply(this,arguments))),e},destroyElements:function(){return["lowerGraphic","upperGraphic"].forEach(function(t){this[t]&&(this[t]=this[t].destroy())},this),this.graphic=null,c.destroyElements.apply(this,arguments)},isValid:function(){return o(this.low)&&o(this.high)}})}),i(e,"parts-more/AreaSplineRangeSeries.js",[e["parts/Globals.js"]],function(t){(0,t.seriesType)("areasplinerange","arearange",null,{getPointSpline:t.seriesTypes.spline.prototype.getPointSpline})}),i(e,"parts-more/ColumnRangeSeries.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.clamp,s=e.pick,a=t.defaultPlotOptions,o=t.merge,r=t.noop,n=t.seriesType,l=t.seriesTypes.column.prototype;n("columnrange","arearange",o(a.column,a.arearange,{pointRange:null,marker:null,states:{hover:{halo:!1}}}),{translate:function(){var t,e,a=this,o=a.yAxis,r=a.xAxis,n=r.startAngleRad,h=a.chart,p=a.xAxis.isRadial,d=Math.max(h.chartWidth,h.chartHeight)+999;function c(t){return i(t,-d,d)}l.translate.apply(a),a.points.forEach(function(i){var l,d,u,g=i.shapeArgs,f=a.options.minPointLength;i.plotHigh=e=c(o.translate(i.high,0,1,0,1)),i.plotLow=c(i.plotY),u=e,d=s(i.rectPlotY,i.plotY)-e,Math.abs(d)<f?(d+=l=f-d,u-=l/2):d<0&&(u-=d*=-1),p?(t=i.barX+n,i.shapeType="path",i.shapeArgs={d:a.polarArc(u+d,u,t,t+i.pointWidth)}):(g.height=d,g.y=u,i.tooltipPos=h.inverted?[o.len+o.pos-h.plotLeft-u-d/2,r.len+r.pos-h.plotTop-g.x-g.width/2,d]:[r.left-h.plotLeft+g.x+g.width/2,o.pos-h.plotTop+u+d/2,d])})},directTouch:!0,trackerGroups:["group","dataLabelsGroup"],drawGraph:r,getSymbol:r,crispCol:function(){return l.crispCol.apply(this,arguments)},drawPoints:function(){return l.drawPoints.apply(this,arguments)},drawTracker:function(){return l.drawTracker.apply(this,arguments)},getColumnMetrics:function(){return l.getColumnMetrics.apply(this,arguments)},pointAttribs:function(){return l.pointAttribs.apply(this,arguments)},animate:function(){return l.animate.apply(this,arguments)},polarArc:function(){return l.polarArc.apply(this,arguments)},translate3dPoints:function(){return l.translate3dPoints.apply(this,arguments)},translate3dShapes:function(){return l.translate3dShapes.apply(this,arguments)}},{setState:l.pointClass.prototype.setState})}),i(e,"parts-more/ColumnPyramidSeries.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.clamp,s=e.pick,a=t.seriesType,o=t.seriesTypes.column.prototype;a("columnpyramid","column",{},{translate:function(){var t=this,e=t.chart,a=t.options,r=t.dense=t.closestPointRange*t.xAxis.transA<2,n=t.borderWidth=s(a.borderWidth,r?0:1),l=t.yAxis,h=a.threshold,p=t.translatedThreshold=l.getThreshold(h),d=s(a.minPointLength,5),c=t.getColumnMetrics(),u=c.width,g=t.barW=Math.max(u,1+2*n),f=t.pointXOffset=c.offset;e.inverted&&(p-=.5),a.pointPadding&&(g=Math.ceil(g)),o.translate.apply(t),t.points.forEach(function(o){var r,n,c,m,b,y,x,v,M,P,L,w,k=s(o.yBottom,p),S=999+Math.abs(k),A=i(o.plotY,-S,l.len+S),X=o.plotX+f,T=g/2,N=Math.min(A,k),Y=Math.max(A,k)-N;o.barX=X,o.pointWidth=u,o.tooltipPos=e.inverted?[l.len+l.pos-e.plotLeft-A,t.xAxis.len-X-T,Y]:[X+T,A+l.pos-e.plotTop,Y],r=h+(o.total||o.y),"percent"===a.stacking&&(r=h+(o.y<0)?-100:100),x=X-(m=T*(N-(c=l.toPixels(r,!0)))/(n=e.plotHeight-c-(e.plotHeight-p)))+T,v=X+m+T,M=X+(b=T*(N+Y-c)/n)+T,P=X-b+T,L=N-d,w=N+Y,o.y<0&&(L=N,w=N+Y+d),e.inverted&&(v=(x=X+T+(m=T*(c-(y=e.plotWidth-N))/(n=c-(e.plotWidth-p))))-2*m,M=X-(b=T*(c-(y-Y))/n)+T,P=X+b+T,L=N,w=N+Y-d,o.y<0&&(w=N+Y+d)),o.shapeType="path",o.shapeArgs={x:x,y:L,width:v-x,height:Y,d:["M",x,L,"L",v,L,M,w,P,w,"Z"]}})}})}),i(e,"parts-more/GaugeSeries.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.clamp,s=e.isNumber,a=e.pick,o=e.pInt,r=t.merge,n=t.noop,l=t.Series,h=t.seriesType,p=t.TrackerMixin;h("gauge","line",{dataLabels:{borderColor:"#cccccc",borderRadius:3,borderWidth:1,crop:!1,defer:!1,enabled:!0,verticalAlign:"top",y:15,zIndex:2},dial:{},pivot:{},tooltip:{headerFormat:""},showInLegend:!1},{angular:!0,directTouch:!0,drawGraph:n,fixedBox:!0,forceDL:!0,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],translate:function(){var t=this.yAxis,e=this.options,n=t.center;this.generatePoints(),this.points.forEach(function(l){var h=r(e.dial,l.dial),p=o(a(h.radius,"80%"))*n[2]/200,d=o(a(h.baseLength,"70%"))*p/100,c=o(a(h.rearLength,"10%"))*p/100,u=h.baseWidth||3,g=h.topWidth||1,f=e.overshoot,m=t.startAngleRad+t.translate(l.y,null,null,null,!0);(s(f)||!1===e.wrap)&&(f=s(f)?f/180*Math.PI:0,m=i(m,t.startAngleRad-f,t.endAngleRad+f)),m=180*m/Math.PI,l.shapeType="path",l.shapeArgs={d:h.path||["M",-c,-u/2,"L",d,-u/2,p,-g/2,p,g/2,d,u/2,-c,u/2,"z"],translateX:n[0],translateY:n[1],rotation:m},l.plotX=n[0],l.plotY=n[1]})},drawPoints:function(){var t=this,e=t.chart,i=t.yAxis.center,s=t.pivot,o=t.options,n=o.pivot,l=e.renderer;t.points.forEach(function(i){var s=i.graphic,a=i.shapeArgs,n=a.d,h=r(o.dial,i.dial);s?(s.animate(a),a.d=n):i.graphic=l[i.shapeType](a).attr({rotation:a.rotation,zIndex:1}).addClass("highcharts-dial").add(t.group),e.styledMode||i.graphic[s?"animate":"attr"]({stroke:h.borderColor||"none","stroke-width":h.borderWidth||0,fill:h.backgroundColor||"#000000"})}),s?s.animate({translateX:i[0],translateY:i[1]}):(t.pivot=l.circle(0,0,a(n.radius,5)).attr({zIndex:2}).addClass("highcharts-pivot").translate(i[0],i[1]).add(t.group),e.styledMode||t.pivot.attr({"stroke-width":n.borderWidth||0,stroke:n.borderColor||"#cccccc",fill:n.backgroundColor||"#000000"}))},animate:function(t){var e=this;t||(e.points.forEach(function(t){var i=t.graphic;i&&(i.attr({rotation:180*e.yAxis.startAngleRad/Math.PI}),i.animate({rotation:t.shapeArgs.rotation},e.options.animation))}),e.animate=null)},render:function(){this.group=this.plotGroup("group","series",this.visible?"visible":"hidden",this.options.zIndex,this.chart.seriesGroup),l.prototype.render.call(this),this.group.clip(this.chart.clipRect)},setData:function(t,e){l.prototype.setData.call(this,t,!1),this.processData(),this.generatePoints(),a(e,!0)&&this.chart.redraw()},hasData:function(){return!!this.points.length},drawTracker:p&&p.drawTrackerPoint},{setState:function(t){this.state=t}})}),i(e,"parts-more/BoxPlotSeries.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.pick,s=t.noop,a=t.seriesType,o=t.seriesTypes;a("boxplot","column",{threshold:null,tooltip:{pointFormat:'<span style="color:{point.color}"></span> <b> {series.name}</b><br/>Maximum: {point.high}<br/>Upper quartile: {point.q3}<br/>Median: {point.median}<br/>Lower quartile: {point.q1}<br/>Minimum: {point.low}<br/>'},whiskerLength:"50%",fillColor:"#ffffff",lineWidth:1,medianWidth:2,whiskerWidth:2},{pointArrayMap:["low","q1","median","q3","high"],toYData:function(t){return[t.low,t.q1,t.median,t.q3,t.high]},pointValKey:"high",pointAttribs:function(){return{}},drawDataLabels:s,translate:function(){var t=this.yAxis,e=this.pointArrayMap;o.column.prototype.translate.apply(this),this.points.forEach(function(i){e.forEach(function(e){null!==i[e]&&(i[e+"Plot"]=t.translate(i[e],0,1,0,1))})})},drawPoints:function(){var t,e,s,a,o,r,n,l,h,p,d,c=this,u=c.points,g=c.options,f=c.chart,m=f.renderer,b=0,y=!1!==c.doQuartiles,x=c.options.whiskerLength;u.forEach(function(u){var v=u.graphic,M=v?"animate":"attr",P=u.shapeArgs,L={},w={},k={},S={},A=u.color||c.color;void 0!==u.plotY&&(n=P.width,l=Math.floor(P.x),h=l+n,p=Math.round(n/2),t=Math.floor(y?u.q1Plot:u.lowPlot),e=Math.floor(y?u.q3Plot:u.lowPlot),s=Math.floor(u.highPlot),a=Math.floor(u.lowPlot),v||(u.graphic=v=m.g("point").add(c.group),u.stem=m.path().addClass("highcharts-boxplot-stem").add(v),x&&(u.whiskers=m.path().addClass("highcharts-boxplot-whisker").add(v)),y&&(u.box=m.path(void 0).addClass("highcharts-boxplot-box").add(v)),u.medianShape=m.path(void 0).addClass("highcharts-boxplot-median").add(v)),f.styledMode||(w.stroke=u.stemColor||g.stemColor||A,w["stroke-width"]=i(u.stemWidth,g.stemWidth,g.lineWidth),w.dashstyle=u.stemDashStyle||g.stemDashStyle,u.stem.attr(w),x&&(k.stroke=u.whiskerColor||g.whiskerColor||A,k["stroke-width"]=i(u.whiskerWidth,g.whiskerWidth,g.lineWidth),u.whiskers.attr(k)),y&&(L.fill=u.fillColor||g.fillColor||A,L.stroke=g.lineColor||A,L["stroke-width"]=g.lineWidth||0,u.box.attr(L)),S.stroke=u.medianColor||g.medianColor||A,S["stroke-width"]=i(u.medianWidth,g.medianWidth,g.lineWidth),u.medianShape.attr(S)),r=u.stem.strokeWidth()%2/2,b=l+p+r,u.stem[M]({d:["M",b,e,"L",b,s,"M",b,t,"L",b,a]}),y&&(r=u.box.strokeWidth()%2/2,t=Math.floor(t)+r,e=Math.floor(e)+r,l+=r,h+=r,u.box[M]({d:["M",l,e,"L",l,t,"L",h,t,"L",h,e,"L",l,e,"z"]})),x&&(r=u.whiskers.strokeWidth()%2/2,s+=r,a+=r,d=/%$/.test(x)?p*parseFloat(x)/100:x/2,u.whiskers[M]({d:["M",b-d,s,"L",b+d,s,"M",b-d,a,"L",b+d,a]})),o=Math.round(u.medianPlot),r=u.medianShape.strokeWidth()%2/2,o+=r,u.medianShape[M]({d:["M",l,o,"L",h,o]}))})},setStackedPoints:s})}),i(e,"parts-more/ErrorBarSeries.js",[e["parts/Globals.js"]],function(t){var e=t.noop,i=t.seriesType,s=t.seriesTypes;i("errorbar","boxplot",{color:"#000000",grouping:!1,linkedTo:":previous",tooltip:{pointFormat:'<span style="color:{point.color}"></span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},whiskerWidth:null},{type:"errorbar",pointArrayMap:["low","high"],toYData:function(t){return[t.low,t.high]},pointValKey:"high",doQuartiles:!1,drawDataLabels:s.arearange?function(){var t=this.pointValKey;s.arearange.prototype.drawDataLabels.call(this),this.data.forEach(function(e){e.y=e[t]})}:e,getColumnMetrics:function(){return this.linkedParent&&this.linkedParent.columnMetrics||s.column.prototype.getColumnMetrics.call(this)}})}),i(e,"parts-more/WaterfallSeries.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.arrayMax,s=e.arrayMin,a=e.correctFloat,o=e.isNumber,r=e.objectEach,n=e.pick,l=t.addEvent,h=t.Axis,p=t.Chart,d=t.Point,c=t.Series,u=t.StackItem,g=t.seriesType,f=t.seriesTypes;function m(t,e){return Object.hasOwnProperty.call(t,e)}l(h,"afterInit",function(){this.isXAxis||(this.waterfallStacks={changed:!1})}),l(h,"afterBuildStacks",function(){this.waterfallStacks.changed=!1,delete this.waterfallStacks.alreadyChanged}),l(p,"beforeRedraw",function(){for(var t=this.axes,e=this.series,i=e.length;i--;)e[i].options.stacking&&(t.forEach(function(t){t.isXAxis||(t.waterfallStacks.changed=!0)}),i=0)}),l(h,"afterRender",function(){var t=this.options.stackLabels;t&&t.enabled&&this.waterfallStacks&&this.renderWaterfallStackTotals()}),h.prototype.renderWaterfallStackTotals=function(){var t=this.waterfallStacks,e=this.stackTotalGroup,i=new u(this,this.options.stackLabels,!1,0,void 0);this.dummyStackItem=i,r(t,function(t){r(t,function(t){i.total=t.stackTotal,t.label&&(i.label=t.label),u.prototype.render.call(i,e),t.label=i.label,delete i.label})}),i.total=null},g("waterfall","column",{dataLabels:{inside:!0},lineWidth:1,lineColor:"#333333",dashStyle:"Dot",borderColor:"#333333",states:{hover:{lineWidthPlus:0}}},{pointValKey:"y",showLine:!0,generatePoints:function(){var t,e,i,s;for(f.column.prototype.generatePoints.apply(this),i=0,e=this.points.length;i<e;i++)t=this.points[i],s=this.processedYData[i],(t.isIntermediateSum||t.isSum)&&(t.y=a(s))},translate:function(){var t,e,i,s,a,o,r,l,h,p,d,c,u,g,b,y,x,v=this.options,M=this.yAxis,P=n(v.minPointLength,5),L=P/2,w=v.threshold,k=v.stacking,S=M.waterfallStacks[this.stackKey];for(f.column.prototype.translate.apply(this),l=h=w,e=0,t=(i=this.points).length;e<t;e++)s=i[e],r=this.processedYData[e],a=s.shapeArgs,p=[0,r],b=s.y,k?(S&&(c=S[e],"overlap"===k?(g=c.stackState[c.stateIndex--],o=b>=0?g:g-b,m(c,"absolutePos")&&delete c.absolutePos,m(c,"absoluteNeg")&&delete c.absoluteNeg):(b>=0?(g=c.threshold+c.posTotal,c.posTotal-=b,o=g):(g=c.threshold+c.negTotal,c.negTotal-=b,o=g-b),c.posTotal||m(c,"absolutePos")&&(c.posTotal=c.absolutePos,delete c.absolutePos),c.negTotal||m(c,"absoluteNeg")&&(c.negTotal=c.absoluteNeg,delete c.absoluteNeg)),s.isSum||(c.connectorThreshold=c.threshold+c.stackTotal),M.reversed?(y=b>=0?o-b:o+b,x=o):(y=o,x=o-b),s.below=y<=n(w,0),a.y=M.translate(y,0,1,0,1),a.height=Math.abs(a.y-M.translate(x,0,1,0,1))),(u=M.dummyStackItem)&&(u.x=e,u.label=S[e].label,u.setOffset(this.pointXOffset||0,this.barW||0,this.stackedYNeg[e],this.stackedYPos[e]))):(o=Math.max(l,l+b)+p[0],a.y=M.translate(o,0,1,0,1),s.isSum?(a.y=M.translate(p[1],0,1,0,1),a.height=Math.min(M.translate(p[0],0,1,0,1),M.len)-a.y):s.isIntermediateSum?(b>=0?(y=p[1]+h,x=h):(y=h,x=p[1]+h),M.reversed&&(y^=x,y^=x^=y),a.y=M.translate(y,0,1,0,1),a.height=Math.abs(a.y-Math.min(M.translate(x,0,1,0,1),M.len)),h+=p[1]):(a.height=r>0?M.translate(l,0,1,0,1)-a.y:M.translate(l,0,1,0,1)-M.translate(l-r,0,1,0,1),l+=r,s.below=l<n(w,0)),a.height<0&&(a.y+=a.height,a.height*=-1)),s.plotY=a.y=Math.round(a.y)-this.borderWidth%2/2,a.height=Math.max(Math.round(a.height),.001),s.yBottom=a.y+a.height,a.height<=P&&!s.isNull?(a.height=P,a.y-=L,s.plotY=a.y,s.y<0?s.minPointLengthOffset=-L:s.minPointLengthOffset=L):(s.isNull&&(a.width=0),s.minPointLengthOffset=0),d=s.plotY+(s.negative?a.height:0),this.chart.inverted?s.tooltipPos[0]=M.len-d:s.tooltipPos[1]=d},processData:function(t){var e,i,s,o,r,n,l,h=this.options,p=this.yData,d=h.data,u=p.length,g=h.threshold||0;for(s=i=o=r=0,l=0;l<u;l++)n=p[l],e=d&&d[l]?d[l]:{},"sum"===n||e.isSum?p[l]=a(s):"intermediateSum"===n||e.isIntermediateSum?(p[l]=a(i),i=0):(s+=n,i+=n),o=Math.min(s,o),r=Math.max(s,r);c.prototype.processData.call(this,t),h.stacking||(this.dataMin=o+g,this.dataMax=r)},toYData:function(t){return t.isSum?"sum":t.isIntermediateSum?"intermediateSum":t.y},updateParallelArrays:function(t,e){c.prototype.updateParallelArrays.call(this,t,e),"sum"!==this.yData[0]&&"intermediateSum"!==this.yData[0]||(this.yData[0]=null)},pointAttribs:function(t,e){var i,s=this.options.upColor;return s&&!t.options.color&&(t.color=t.y>0?s:null),delete(i=f.column.prototype.pointAttribs.call(this,t,e)).dashstyle,i},getGraphPath:function(){return["M",0,0]},getCrispPath:function(){var t,e,i,s,a,o,r,n,l,h,p=this.data,d=this.yAxis,c=p.length,u=Math.round(this.graph.strokeWidth())%2/2,g=Math.round(this.borderWidth)%2/2,f=this.xAxis.reversed,m=this.yAxis.reversed,b=this.options.stacking,y=[];for(l=1;l<c;l++)n=p[l].shapeArgs,s=p[l-1],r=p[l-1].shapeArgs,e=d.waterfallStacks[this.stackKey],o=s.y>0?-r.height:0,e&&(i=e[l-1],b?(t=i.connectorThreshold,a=Math.round(d.translate(t,0,1,0,1)+(m?o:0))-u):a=r.y+s.minPointLengthOffset+g-u,h=["M",r.x+(f?0:r.width),a,"L",n.x+(f?n.width:0),a]),(!b&&h&&s.y<0&&!m||s.y>0&&m)&&(h[2]+=r.height,h[5]+=r.height),y=y.concat(h);return y},drawGraph:function(){c.prototype.drawGraph.call(this),this.graph.attr({d:this.getCrispPath()})},setStackedPoints:function(){var t,e,i,s,a,o,r,n,l,h,p,d,c,u=this.options,g=this.yAxis.waterfallStacks,f=u.threshold,m=f||0,b=m,y=this.stackKey,x=this.xData,v=x.length;function M(t,i,s,a){if(o)for(;s<o;s++)e.stackState[s]+=a;else e.stackState[0]=t,o=e.stackState.length;e.stackState.push(e.stackState[o-1]+i)}if(this.yAxis.usePercentage=!1,i=s=a=m,this.visible||!this.chart.options.chart.ignoreHiddenSeries){c=g.changed,(d=g.alreadyChanged)&&d.indexOf(y)<0&&(c=!0),g[y]||(g[y]={}),t=g[y];for(var P=0;P<v;P++)t[p=x[P]]&&!c||(t[p]={negTotal:0,posTotal:0,stackTotal:0,threshold:0,stateIndex:0,stackState:[],label:c&&t[p]?t[p].label:void 0}),e=t[p],(h=this.yData[P])>=0?e.posTotal+=h:e.negTotal+=h,l=u.data[P],r=e.absolutePos=e.posTotal,n=e.absoluteNeg=e.negTotal,e.stackTotal=r+n,o=e.stackState.length,l&&l.isIntermediateSum?(M(a,s,0,a),a=s,s=f,m^=b,m^=b^=m):l&&l.isSum?(M(f,i,o),m=f):(M(m,h,0,i),l&&(i+=h,s+=h)),e.stateIndex++,e.threshold=m,m+=e.stackTotal;g.changed=!1,g.alreadyChanged||(g.alreadyChanged=[]),g.alreadyChanged.push(y)}},getExtremes:function(){var t,e,a,o=this.options.stacking;o&&(t=this.yAxis.waterfallStacks,e=this.stackedYNeg=[],a=this.stackedYPos=[],r(t[this.stackKey],"overlap"===o?function(t){e.push(s(t.stackState)),a.push(i(t.stackState))}:function(t){e.push(t.negTotal+t.threshold),a.push(t.posTotal+t.threshold)}),this.dataMin=s(e),this.dataMax=i(a))}},{getClassName:function(){var t=d.prototype.getClassName.call(this);return this.isSum?t+=" highcharts-sum":this.isIntermediateSum&&(t+=" highcharts-intermediate-sum"),t},isValid:function(){return o(this.y)||this.isSum||this.isIntermediateSum}})}),i(e,"parts-more/PolygonSeries.js",[e["parts/Globals.js"]],function(t){var e=t.LegendSymbolMixin,i=t.noop,s=t.Series,a=t.seriesType,o=t.seriesTypes;a("polygon","scatter",{marker:{enabled:!1,states:{hover:{enabled:!1}}},stickyTracking:!1,tooltip:{followPointer:!0,pointFormat:""},trackByArea:!0},{type:"polygon",getGraphPath:function(){for(var t=s.prototype.getGraphPath.call(this),e=t.length+1;e--;)(e===t.length||"M"===t[e])&&e>0&&t.splice(e,0,"z");return this.areaPath=t,t},drawGraph:function(){this.options.fillColor=this.color,o.area.prototype.drawGraph.call(this)},drawLegendSymbol:e.drawRectangle,drawTracker:s.prototype.drawTracker,setStackedPoints:i})}),i(e,"parts-more/BubbleLegend.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.arrayMax,s=e.arrayMin,a=e.isNumber,o=e.objectEach,r=e.pick,n=e.wrap,l=t.Series,h=t.Legend,p=t.Chart,d=t.addEvent,c=t.color,u=t.merge,g=t.noop,f=t.stableSort;(0,t.setOptions)({legend:{bubbleLegend:{borderColor:void 0,borderWidth:2,className:void 0,color:void 0,connectorClassName:void 0,connectorColor:void 0,connectorDistance:60,connectorWidth:1,enabled:!1,labels:{className:void 0,allowOverlap:!1,format:"",formatter:void 0,align:"right",style:{fontSize:10,color:void 0},x:0,y:0},maxSize:60,minSize:10,legendIndex:0,ranges:{value:void 0,borderColor:void 0,color:void 0,connectorColor:void 0},sizeBy:"area",sizeByAbsoluteValue:!1,zIndex:1,zThreshold:0}}}),t.BubbleLegend=function(t,e){this.init(t,e)},t.BubbleLegend.prototype={init:function(t,e){this.options=t,this.visible=!0,this.chart=e.chart,this.legend=e},setState:g,addToLegend:function(t){t.splice(this.options.legendIndex,0,this)},drawLegendSymbol:function(t){var e,i,s,o,n=this.chart,l=this.options,h=r(t.options.itemDistance,20),p=l.ranges,d=l.connectorDistance;this.fontMetrics=n.renderer.fontMetrics(l.labels.style.fontSize.toString()+"px"),p&&p.length&&a(p[0].value)?(f(p,function(t,e){return e.value-t.value}),this.ranges=p,this.setOptions(),this.render(),o=this.getMaxLabelSize(),e=2*(s=this.ranges[0].radius),i=(i=d-s+o.width)>0?i:0,this.maxLabel=o,this.movementX="left"===l.labels.align?i:0,this.legendItemWidth=e+i+h,this.legendItemHeight=e+this.fontMetrics.h/2):t.options.bubbleLegend.autoRanges=!0},setOptions:function(){var t=this.ranges,e=this.options,i=this.chart.series[e.seriesIndex],s=this.legend.baseline,a={"z-index":e.zIndex,"stroke-width":e.borderWidth},o={"z-index":e.zIndex,"stroke-width":e.connectorWidth},n=this.getLabelStyles(),l=i.options.marker.fillOpacity,h=this.chart.styledMode;t.forEach(function(p,d){h||(a.stroke=r(p.borderColor,e.borderColor,i.color),a.fill=r(p.color,e.color,1!==l?c(i.color).setOpacity(l).get("rgba"):i.color),o.stroke=r(p.connectorColor,e.connectorColor,i.color)),t[d].radius=this.getRangeRadius(p.value),t[d]=u(t[d],{center:t[0].radius-t[d].radius+s}),h||u(!0,t[d],{bubbleStyle:u(!1,a),connectorStyle:u(!1,o),labelStyle:n})},this)},getLabelStyles:function(){var t=this.options,e={},i="left"===t.labels.align,s=this.legend.options.rtl;return o(t.labels.style,function(t,i){"color"!==i&&"fontSize"!==i&&"z-index"!==i&&(e[i]=t)}),u(!1,e,{"font-size":t.labels.style.fontSize,fill:r(t.labels.style.color,"#000000"),"z-index":t.zIndex,align:s||i?"right":"left"})},getRangeRadius:function(t){var e=this.options,i=this.options.seriesIndex,s=this.chart.series[i],a=e.ranges[0].value,o=e.ranges[e.ranges.length-1].value,r=e.minSize,n=e.maxSize;return s.getRadius.call(this,o,a,r,n,t)},render:function(){var t=this.chart.renderer,e=this.options.zThreshold;this.symbols||(this.symbols={connectors:[],bubbleItems:[],labels:[]}),this.legendSymbol=t.g("bubble-legend"),this.legendItem=t.g("bubble-legend-item"),this.legendSymbol.translateX=0,this.legendSymbol.translateY=0,this.ranges.forEach(function(t){t.value>=e&&this.renderRange(t)},this),this.legendSymbol.add(this.legendItem),this.legendItem.add(this.legendGroup),this.hideOverlappingLabels()},renderRange:function(t){var e,i,s,a=this.ranges[0],o=this.legend,r=this.options,n=r.labels,l=this.chart.renderer,h=this.symbols,p=h.labels,d=t.center,c=Math.abs(t.radius),u=r.connectorDistance,g=n.align,f=o.options.rtl,m=n.style.fontSize,b=f||"left"===g?-u:u,y=r.borderWidth,x=r.connectorWidth,v=a.radius,M=d-c-y/2+x/2,P=m/2-(this.fontMetrics.h-m)/2,L=(M%1?1:.5)-(x%2?0:.5),w=l.styledMode;"center"===g&&(b=0,r.connectorDistance=0,t.labelStyle.align="center"),i=M+r.labels.y,s=v+b+r.labels.x,h.bubbleItems.push(l.circle(v,d+L,c).attr(w?{}:t.bubbleStyle).addClass((w?"highcharts-color-"+this.options.seriesIndex+" ":"")+"highcharts-bubble-legend-symbol "+(r.className||"")).add(this.legendSymbol)),h.connectors.push(l.path(l.crispLine(["M",v,M,"L",v+b,M],r.connectorWidth)).attr(w?{}:t.connectorStyle).addClass((w?"highcharts-color-"+this.options.seriesIndex+" ":"")+"highcharts-bubble-legend-connectors "+(r.connectorClassName||"")).add(this.legendSymbol)),e=l.text(this.formatLabel(t),s,i+P).attr(w?{}:t.labelStyle).addClass("highcharts-bubble-legend-labels "+(r.labels.className||"")).add(this.legendSymbol),p.push(e),e.placed=!0,e.alignAttr={x:s,y:i+P}},getMaxLabelSize:function(){var t,e;return this.symbols.labels.forEach(function(i){e=i.getBBox(!0),t=t?e.width>t.width?e:t:e}),t||{}},formatLabel:function(e){var i=this.options,s=i.labels.formatter,a=i.labels.format,o=this.chart.numberFormatter;return a?t.format(a,e):s?s.call(e):o(e.value,1)},hideOverlappingLabels:function(){var t=this.chart,e=this.options.labels.allowOverlap,i=this.symbols;!e&&i&&(t.hideOverlappingLabels(i.labels),i.labels.forEach(function(t,e){t.newOpacity?t.newOpacity!==t.oldOpacity&&i.connectors[e].show():i.connectors[e].hide()}))},getRanges:function(){var t,e,o=this.legend.bubbleLegend,n=o.chart.series,l=o.options.ranges,h=Number.MAX_VALUE,p=-Number.MAX_VALUE;return n.forEach(function(t){t.isBubble&&!t.ignoreSeries&&(e=t.zData.filter(a)).length&&(h=r(t.options.zMin,Math.min(h,Math.max(s(e),!1===t.options.displayNegative?t.options.zThreshold:-Number.MAX_VALUE))),p=r(t.options.zMax,Math.max(p,i(e))))}),t=h===p?[{value:p}]:[{value:h},{value:(h+p)/2},{value:p,autoRanges:!0}],l.length&&l[0].radius&&t.reverse(),t.forEach(function(e,i){l&&l[i]&&(t[i]=u(!1,l[i],e))}),t},predictBubbleSizes:function(){var t,e=this.chart,i=this.fontMetrics,s=e.legend.options,a=s.floating,o="horizontal"===s.layout,r=o?e.legend.lastLineHeight:0,n=e.plotSizeX,l=e.plotSizeY,h=e.series[this.options.seriesIndex],p=Math.ceil(h.minPxSize),d=Math.ceil(h.maxPxSize),c=h.options.maxSize,u=Math.min(l,n);return a||!/%$/.test(c)?t=d:(c=parseFloat(c),t=(u+r-i.h/2)*c/100/(c/100+1),(o&&l-t>=n||!o&&n-t>=l)&&(t=d)),[p,Math.ceil(t)]},updateRanges:function(t,e){var i=this.legend.options.bubbleLegend;i.minSize=t,i.maxSize=e,i.ranges=this.getRanges()},correctSizes:function(){var t=this.legend,e=this.chart.series[this.options.seriesIndex],i=e.maxPxSize,s=this.options.maxSize;Math.abs(Math.ceil(i)-s)>1&&(this.updateRanges(this.options.minSize,e.maxPxSize),t.render())}},d(t.Legend,"afterGetAllItems",function(e){var i=this.bubbleLegend,s=this.options,a=s.bubbleLegend,o=this.chart.getVisibleBubbleSeriesIndex();i&&i.ranges&&i.ranges.length&&(a.ranges.length&&(a.autoRanges=!!a.ranges[0].autoRanges),this.destroyItem(i)),o>=0&&s.enabled&&a.enabled&&(a.seriesIndex=o,this.bubbleLegend=new t.BubbleLegend(a,this),this.bubbleLegend.addToLegend(e.allItems))}),p.prototype.getVisibleBubbleSeriesIndex=function(){for(var t=this.series,e=0;e<t.length;){if(t[e]&&t[e].isBubble&&t[e].visible&&t[e].zData.length)return e;e++}return-1},h.prototype.getLinesHeights=function(){var t,e=this.allItems,i=[],s=e.length,a=0,o=0;for(a=0;a<s;a++)if(e[a].legendItemHeight&&(e[a].itemHeight=e[a].legendItemHeight),e[a]===e[s-1]||e[a+1]&&e[a]._legendItemPos[1]!==e[a+1]._legendItemPos[1]){for(i.push({height:0}),t=i[i.length-1];o<=a;o++)e[o].itemHeight>t.height&&(t.height=e[o].itemHeight);t.step=a}return i},h.prototype.retranslateItems=function(t){var e,i,s,a=this.allItems,o=this.options.rtl,r=0;a.forEach(function(a,n){e=a.legendGroup.translateX,i=a._legendItemPos[1],((s=a.movementX)||o&&a.ranges)&&(s=o?e-a.options.maxSize/2:e+s,a.legendGroup.attr({translateX:s})),n>t[r].step&&r++,a.legendGroup.attr({translateY:Math.round(i+t[r].height/2)}),a._legendItemPos[1]=i+t[r].height/2})},d(l,"legendItemClick",function(){var t,e=this.chart,i=this.visible,s=this.chart.legend;s&&s.bubbleLegend&&(this.visible=!i,this.ignoreSeries=i,t=e.getVisibleBubbleSeriesIndex()>=0,s.bubbleLegend.visible!==t&&(s.update({bubbleLegend:{enabled:t}}),s.bubbleLegend.visible=t),this.visible=i)}),n(p.prototype,"drawChartBox",function(t,e,i){var s,a,r=this.legend,n=this.getVisibleBubbleSeriesIndex()>=0;r&&r.options.enabled&&r.bubbleLegend&&r.options.bubbleLegend.autoRanges&&n?(s=r.bubbleLegend.options,a=r.bubbleLegend.predictBubbleSizes(),r.bubbleLegend.updateRanges(a[0],a[1]),s.placed||(r.group.placed=!1,r.allItems.forEach(function(t){t.legendGroup.translateY=null})),r.render(),this.getMargins(),this.axes.forEach(function(t){t.visible&&t.render(),s.placed||(t.setScale(),t.updateNames(),o(t.ticks,function(t){t.isNew=!0,t.isNewLabel=!0}))}),s.placed=!0,this.getMargins(),t.call(this,e,i),r.bubbleLegend.correctSizes(),r.retranslateItems(r.getLinesHeights())):(t.call(this,e,i),r&&r.options.enabled&&r.bubbleLegend&&(r.render(),r.retranslateItems(r.getLinesHeights())))})}),i(e,"parts-more/BubbleSeries.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.arrayMax,s=e.arrayMin,a=e.clamp,o=e.extend,r=e.isNumber,n=e.pick,l=e.pInt,h=t.Axis,p=t.color,d=t.noop,c=t.Point,u=t.Series,g=t.seriesType,f=t.seriesTypes;g("bubble","scatter",{dataLabels:{formatter:function(){return this.point.z},inside:!0,verticalAlign:"middle"},animationLimit:250,marker:{lineColor:null,lineWidth:1,fillOpacity:.5,radius:null,states:{hover:{radiusPlus:0}},symbol:"circle"},minSize:8,maxSize:"20%",softThreshold:!1,states:{hover:{halo:{size:5}}},tooltip:{pointFormat:"({point.x}, {point.y}), Size: {point.z}"},turboThreshold:0,zThreshold:0,zoneAxis:"z"},{pointArrayMap:["y","z"],parallelArrays:["x","y","z"],trackerGroups:["group","dataLabelsGroup"],specialGroup:"group",bubblePadding:!0,zoneAxis:"z",directTouch:!0,isBubble:!0,pointAttribs:function(t,e){var i=this.options.marker.fillOpacity,s=u.prototype.pointAttribs.call(this,t,e);return 1!==i&&(s.fill=p(s.fill).setOpacity(i).get("rgba")),s},getRadii:function(t,e,i){var s,a,o,r=this.zData,n=this.yData,l=i.minPxSize,h=i.maxPxSize,p=[];for(a=0,s=r.length;a<s;a++)o=r[a],p.push(this.getRadius(t,e,l,h,o,n[a]));this.radii=p},getRadius:function(t,e,i,s,a,o){var n=this.options,l="width"!==n.sizeBy,h=n.zThreshold,p=e-t,d=.5;if(null===o||null===a)return null;if(r(a)){if(n.sizeByAbsoluteValue&&(a=Math.abs(a-h),e=p=Math.max(e-h,Math.abs(t-h)),t=0),a<t)return i/2-1;p>0&&(d=(a-t)/p)}return l&&d>=0&&(d=Math.sqrt(d)),Math.ceil(i+d*(s-i))/2},animate:function(t){!t&&this.points.length<this.options.animationLimit&&(this.points.forEach(function(t){var e,i=t.graphic;i&&i.width&&(e={x:i.x,y:i.y,width:i.width,height:i.height},i.attr({x:t.plotX,y:t.plotY,width:1,height:1}),i.animate(e,this.options.animation))},this),this.animate=null)},hasData:function(){return!!this.processedXData.length},translate:function(){var t,e,i,s=this.data,a=this.radii;for(f.scatter.prototype.translate.call(this),t=s.length;t--;)e=s[t],i=a?a[t]:0,r(i)&&i>=this.minPxSize/2?(e.marker=o(e.marker,{radius:i,width:2*i,height:2*i}),e.dlBox={x:e.plotX-i,y:e.plotY-i,width:2*i,height:2*i}):e.shapeArgs=e.plotY=e.dlBox=void 0},alignDataLabel:f.column.prototype.alignDataLabel,buildKDTree:d,applyZones:d},{haloPath:function(t){return c.prototype.haloPath.call(this,0===t?0:(this.marker&&this.marker.radius||0)+t)},ttBelow:!1}),h.prototype.beforePadding=function(){var t=this,e=this.len,o=this.chart,h=0,p=e,d=this.isXAxis,c=d?"xData":"yData",u=this.min,g={},f=Math.min(o.plotWidth,o.plotHeight),m=Number.MAX_VALUE,b=-Number.MAX_VALUE,y=this.max-u,x=e/y,v=[];this.series.forEach(function(e){var h,p=e.options;!e.bubblePadding||!e.visible&&o.options.chart.ignoreHiddenSeries||(t.allowZoomOutside=!0,v.push(e),d&&(["minSize","maxSize"].forEach(function(t){var e=p[t],i=/%$/.test(e);e=l(e),g[t]=i?f*e/100:e}),e.minPxSize=g.minSize,e.maxPxSize=Math.max(g.maxSize,g.minSize),(h=e.zData.filter(r)).length&&(m=n(p.zMin,a(s(h),!1===p.displayNegative?p.zThreshold:-Number.MAX_VALUE,m)),b=n(p.zMax,Math.max(b,i(h))))))}),v.forEach(function(e){var i,s=e[c],a=s.length;if(d&&e.getRadii(m,b,e),y>0)for(;a--;)r(s[a])&&t.dataMin<=s[a]&&s[a]<=t.max&&(i=e.radii?e.radii[a]:0,h=Math.min((s[a]-u)*x-i,h),p=Math.max((s[a]-u)*x+i,p))}),v.length&&y>0&&!this.isLog&&(p-=e,x*=(e+Math.max(0,h)-Math.min(p,e))/e,[["min","userMin",h],["max","userMax",p]].forEach(function(e){void 0===n(t.options[e[0]],t[e[1]])&&(t[e[0]]+=e[2]/x)}))}}),i(e,"modules/networkgraph/integrations.js",[e["parts/Globals.js"]],function(t){t.networkgraphIntegrations={verlet:{attractiveForceFunction:function(t,e){return(e-t)/t},repulsiveForceFunction:function(t,e){return(e-t)/t*(e>t?1:0)},barycenter:function(){var t=this.options.gravitationalConstant,e=this.barycenter.xFactor,i=this.barycenter.yFactor;e=(e-(this.box.left+this.box.width)/2)*t,i=(i-(this.box.top+this.box.height)/2)*t,this.nodes.forEach(function(t){t.fixedPosition||(t.plotX-=e/t.mass/t.degree,t.plotY-=i/t.mass/t.degree)})},repulsive:function(t,e,i){var s=e*this.diffTemperature/t.mass/t.degree;t.fixedPosition||(t.plotX+=i.x*s,t.plotY+=i.y*s)},attractive:function(t,e,i){var s=t.getMass(),a=-i.x*e*this.diffTemperature,o=-i.y*e*this.diffTemperature;t.fromNode.fixedPosition||(t.fromNode.plotX-=a*s.fromNode/t.fromNode.degree,t.fromNode.plotY-=o*s.fromNode/t.fromNode.degree),t.toNode.fixedPosition||(t.toNode.plotX+=a*s.toNode/t.toNode.degree,t.toNode.plotY+=o*s.toNode/t.toNode.degree)},integrate:function(t,e){var i=-t.options.friction,s=t.options.maxSpeed,a=e.prevX,o=e.prevY,r=(e.plotX+e.dispX-a)*i,n=(e.plotY+e.dispY-o)*i,l=Math.abs,h=l(r)/(r||1),p=l(n)/(n||1);r=h*Math.min(s,Math.abs(r)),n=p*Math.min(s,Math.abs(n)),e.prevX=e.plotX+e.dispX,e.prevY=e.plotY+e.dispY,e.plotX+=r,e.plotY+=n,e.temperature=t.vectorLength({x:r,y:n})},getK:function(t){return Math.pow(t.box.width*t.box.height/t.nodes.length,.5)}},euler:{attractiveForceFunction:function(t,e){return t*t/e},repulsiveForceFunction:function(t,e){return e*e/t},barycenter:function(){var t=this.options.gravitationalConstant,e=this.barycenter.xFactor,i=this.barycenter.yFactor;this.nodes.forEach(function(s){if(!s.fixedPosition){var a=s.getDegree(),o=a*(1+a/2);s.dispX+=(e-s.plotX)*t*o/s.degree,s.dispY+=(i-s.plotY)*t*o/s.degree}})},repulsive:function(t,e,i,s){t.dispX+=i.x/s*e/t.degree,t.dispY+=i.y/s*e/t.degree},attractive:function(t,e,i,s){var a=t.getMass(),o=i.x/s*e,r=i.y/s*e;t.fromNode.fixedPosition||(t.fromNode.dispX-=o*a.fromNode/t.fromNode.degree,t.fromNode.dispY-=r*a.fromNode/t.fromNode.degree),t.toNode.fixedPosition||(t.toNode.dispX+=o*a.toNode/t.toNode.degree,t.toNode.dispY+=r*a.toNode/t.toNode.degree)},integrate:function(t,e){var i;e.dispX+=e.dispX*t.options.friction,e.dispY+=e.dispY*t.options.friction,0!==(i=e.temperature=t.vectorLength({x:e.dispX,y:e.dispY}))&&(e.plotX+=e.dispX/i*Math.min(Math.abs(e.dispX),t.temperature),e.plotY+=e.dispY/i*Math.min(Math.abs(e.dispY),t.temperature))},getK:function(t){return Math.pow(t.box.width*t.box.height/t.nodes.length,.3)}}}}),i(e,"modules/networkgraph/QuadTree.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.extend,s=t.QuadTreeNode=function(t){this.box=t,this.boxSize=Math.min(t.width,t.height),this.nodes=[],this.isInternal=!1,this.body=!1,this.isEmpty=!0};i(s.prototype,{insert:function(t,e){var i;this.isInternal?this.nodes[this.getBoxPosition(t)].insert(t,e-1):(this.isEmpty=!1,this.body?e?(this.isInternal=!0,this.divideBox(),!0!==this.body&&(this.nodes[this.getBoxPosition(this.body)].insert(this.body,e-1),this.body=!0),this.nodes[this.getBoxPosition(t)].insert(t,e-1)):((i=new s({top:t.plotX,left:t.plotY,width:.1,height:.1})).body=t,i.isInternal=!1,this.nodes.push(i)):(this.isInternal=!1,this.body=t))},updateMassAndCenter:function(){var t=0,e=0,i=0;this.isInternal?(this.nodes.forEach(function(s){s.isEmpty||(t+=s.mass,e+=s.plotX*s.mass,i+=s.plotY*s.mass)}),e/=t,i/=t):this.body&&(t=this.body.mass,e=this.body.plotX,i=this.body.plotY),this.mass=t,this.plotX=e,this.plotY=i},divideBox:function(){var t=this.box.width/2,e=this.box.height/2;this.nodes[0]=new s({left:this.box.left,top:this.box.top,width:t,height:e}),this.nodes[1]=new s({left:this.box.left+t,top:this.box.top,width:t,height:e}),this.nodes[2]=new s({left:this.box.left+t,top:this.box.top+e,width:t,height:e}),this.nodes[3]=new s({left:this.box.left,top:this.box.top+e,width:t,height:e})},getBoxPosition:function(t){var e=t.plotX<this.box.left+this.box.width/2,i=t.plotY<this.box.top+this.box.height/2;return e?i?0:3:i?1:2}}),i((t.QuadTree=function(t,e,i,a){this.box={left:t,top:e,width:i,height:a},this.maxDepth=25,this.root=new s(this.box,"0"),this.root.isInternal=!0,this.root.isRoot=!0,this.root.divideBox()}).prototype,{insertNodes:function(t){t.forEach(function(t){this.root.insert(t,this.maxDepth)},this)},visitNodeRecursive:function(t,e,i){var s;t||(t=this.root),t===this.root&&e&&(s=e(t)),!1!==s&&(t.nodes.forEach(function(t){if(t.isInternal){if(e&&(s=e(t)),!1===s)return;this.visitNodeRecursive(t,e,i)}else t.body&&e&&e(t.body);i&&i(t)},this),t===this.root&&i&&i(t))},calculateMassAndCenter:function(){this.visitNodeRecursive(null,null,function(t){t.updateMassAndCenter()})}})}),i(e,"modules/networkgraph/layouts.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.clamp,s=e.defined,a=e.extend,o=e.pick,r=e.setAnimation,n=t.addEvent,l=t.Chart;t.layouts={"reingold-fruchterman":function(){}},a(t.layouts["reingold-fruchterman"].prototype,{init:function(e){this.options=e,this.nodes=[],this.links=[],this.series=[],this.box={x:0,y:0,width:0,height:0},this.setInitialRendering(!0),this.integration=t.networkgraphIntegrations[e.integration],this.attractiveForce=o(e.attractiveForce,this.integration.attractiveForceFunction),this.repulsiveForce=o(e.repulsiveForce,this.integration.repulsiveForceFunction),this.approximation=e.approximation},start:function(){var t=this.series,e=this.options;this.currentStep=0,this.forces=t[0]&&t[0].forces||[],this.initialRendering&&(this.initPositions(),t.forEach(function(t){t.render()})),this.setK(),this.resetSimulation(e),e.enableSimulation&&this.step()},step:function(){var e=this,i=this.series,s=this.options;e.currentStep++,"barnes-hut"===e.approximation&&(e.createQuadTree(),e.quadTree.calculateMassAndCenter()),e.forces.forEach(function(t){e[t+"Forces"](e.temperature)}),e.applyLimits(e.temperature),e.temperature=e.coolDown(e.startTemperature,e.diffTemperature,e.currentStep),e.prevSystemTemperature=e.systemTemperature,e.systemTemperature=e.getSystemTemperature(),s.enableSimulation&&(i.forEach(function(t){t.chart&&t.render()}),e.maxIterations--&&isFinite(e.temperature)&&!e.isStable()?(e.simulation&&t.win.cancelAnimationFrame(e.simulation),e.simulation=t.win.requestAnimationFrame(function(){e.step()})):e.simulation=!1)},stop:function(){this.simulation&&t.win.cancelAnimationFrame(this.simulation)},setArea:function(t,e,i,s){this.box={left:t,top:e,width:i,height:s}},setK:function(){this.k=this.options.linkLength||this.integration.getK(this)},addElementsToCollection:function(t,e){t.forEach(function(t){-1===e.indexOf(t)&&e.push(t)})},removeElementFromCollection:function(t,e){var i=e.indexOf(t);-1!==i&&e.splice(i,1)},clear:function(){this.nodes.length=0,this.links.length=0,this.series.length=0,this.resetSimulation()},resetSimulation:function(){this.forcedStop=!1,this.systemTemperature=0,this.setMaxIterations(),this.setTemperature(),this.setDiffTemperature()},setMaxIterations:function(t){this.maxIterations=o(t,this.options.maxIterations)},setTemperature:function(){this.temperature=this.startTemperature=Math.sqrt(this.nodes.length)},setDiffTemperature:function(){this.diffTemperature=this.startTemperature/(this.options.maxIterations+1)},setInitialRendering:function(t){this.initialRendering=t},createQuadTree:function(){this.quadTree=new t.QuadTree(this.box.left,this.box.top,this.box.width,this.box.height),this.quadTree.insertNodes(this.nodes)},initPositions:function(){var e=this.options.initialPositions;t.isFunction(e)?(e.call(this),this.nodes.forEach(function(t){s(t.prevX)||(t.prevX=t.plotX),s(t.prevY)||(t.prevY=t.plotY),t.dispX=0,t.dispY=0})):"circle"===e?this.setCircularPositions():this.setRandomPositions()},setCircularPositions:function(){var t=this.box,e=this.nodes,i=e.length+1,s=2*Math.PI/i,a=e.filter(function(t){return 0===t.linksTo.length}),r=[],n={},l=this.options.initialPositionRadius;a.forEach(function(t){r.push(t),function t(e){e.linksFrom.forEach(function(e){n[e.toNode.id]||(n[e.toNode.id]=!0,r.push(e.toNode),t(e.toNode))})}(t)}),r.length?e.forEach(function(t){-1===r.indexOf(t)&&r.push(t)}):r=e,r.forEach(function(e,i){e.plotX=e.prevX=o(e.plotX,t.width/2+l*Math.cos(i*s)),e.plotY=e.prevY=o(e.plotY,t.height/2+l*Math.sin(i*s)),e.dispX=0,e.dispY=0})},setRandomPositions:function(){var t=this.box,e=this.nodes,i=e.length+1;function s(t){var e=t*t/Math.PI;return e-=Math.floor(e)}e.forEach(function(e,a){e.plotX=e.prevX=o(e.plotX,t.width*s(a)),e.plotY=e.prevY=o(e.plotY,t.height*s(i+a)),e.dispX=0,e.dispY=0})},force:function(t){this.integration[t].apply(this,Array.prototype.slice.call(arguments,1))},barycenterForces:function(){this.getBarycenter(),this.force("barycenter")},getBarycenter:function(){var t=0,e=0,i=0;return this.nodes.forEach(function(s){e+=s.plotX*s.mass,i+=s.plotY*s.mass,t+=s.mass}),this.barycenter={x:e,y:i,xFactor:e/t,yFactor:i/t},this.barycenter},barnesHutApproximation:function(t,e){var i,s,a=this.getDistXY(t,e),o=this.vectorLength(a);return t!==e&&0!==o&&(e.isInternal?e.boxSize/o<this.options.theta&&0!==o?(s=this.repulsiveForce(o,this.k),this.force("repulsive",t,s*e.mass,a,o),i=!1):i=!0:(s=this.repulsiveForce(o,this.k),this.force("repulsive",t,s*e.mass,a,o))),i},repulsiveForces:function(){var t=this;"barnes-hut"===t.approximation?t.nodes.forEach(function(e){t.quadTree.visitNodeRecursive(null,function(i){return t.barnesHutApproximation(e,i)})}):t.nodes.forEach(function(e){t.nodes.forEach(function(i){var s,a,o;e===i||e.fixedPosition||(o=t.getDistXY(e,i),0!==(a=t.vectorLength(o))&&(s=t.repulsiveForce(a,t.k),t.force("repulsive",e,s*i.mass,o,a)))})})},attractiveForces:function(){var t,e,i,s=this;s.links.forEach(function(a){a.fromNode&&a.toNode&&(t=s.getDistXY(a.fromNode,a.toNode),0!==(e=s.vectorLength(t))&&(i=s.attractiveForce(e,s.k),s.force("attractive",a,i,t,e)))})},applyLimits:function(){var t=this;t.nodes.forEach(function(e){e.fixedPosition||(t.integration.integrate(t,e),t.applyLimitBox(e,t.box),e.dispX=0,e.dispY=0)})},applyLimitBox:function(t,e){var s=t.radius;t.plotX=i(t.plotX,e.left+s,e.width-s),t.plotY=i(t.plotY,e.top+s,e.height-s)},coolDown:function(t,e,i){return t-e*i},isStable:function(){return Math.abs(this.systemTemperature-this.prevSystemTemperature)<1e-5||this.temperature<=0},getSystemTemperature:function(){return this.nodes.reduce(function(t,e){return t+e.temperature},0)},vectorLength:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},getDistR:function(t,e){var i=this.getDistXY(t,e);return this.vectorLength(i)},getDistXY:function(t,e){var i=t.plotX-e.plotX,s=t.plotY-e.plotY;return{x:i,y:s,absX:Math.abs(i),absY:Math.abs(s)}}}),n(l,"predraw",function(){this.graphLayoutsLookup&&this.graphLayoutsLookup.forEach(function(t){t.stop()})}),n(l,"render",function(){var t,e=!1;function i(i){i.maxIterations--&&isFinite(i.temperature)&&!i.isStable()&&!i.options.enableSimulation&&(i.beforeStep&&i.beforeStep(),i.step(),t=!1,e=!0)}if(this.graphLayoutsLookup){for(r(!1,this),this.graphLayoutsLookup.forEach(function(t){t.start()});!t;)t=!0,this.graphLayoutsLookup.forEach(i);e&&this.series.forEach(function(t){t&&t.layout&&t.render()})}})}),i(e,"modules/networkgraph/draggable-nodes.js",[e["parts/Globals.js"]],function(t){var e=t.Chart,i=t.addEvent;t.dragNodesMixin={onMouseDown:function(t,e){var i=this.chart.pointer.normalize(e);t.fixedPosition={chartX:i.chartX,chartY:i.chartY,plotX:t.plotX,plotY:t.plotY},t.inDragMode=!0},onMouseMove:function(t,e){if(t.fixedPosition&&t.inDragMode){var i,s,a=this.chart,o=a.pointer.normalize(e),r=t.fixedPosition.chartX-o.chartX,n=t.fixedPosition.chartY-o.chartY;(Math.abs(r)>5||Math.abs(n)>5)&&(i=t.fixedPosition.plotX-r,s=t.fixedPosition.plotY-n,a.isInsidePlot(i,s)&&(t.plotX=i,t.plotY=s,t.hasDragged=!0,this.redrawHalo(t),this.layout.simulation?this.layout.resetSimulation():(this.layout.setInitialRendering(!1),this.layout.enableSimulation?this.layout.start():this.layout.setMaxIterations(1),this.chart.redraw(),this.layout.setInitialRendering(!0))))}},onMouseUp:function(t,e){t.fixedPosition&&t.hasDragged&&(this.layout.enableSimulation?this.layout.start():this.chart.redraw(),t.inDragMode=t.hasDragged=!1,this.options.fixedDraggable||delete t.fixedPosition)},redrawHalo:function(t){t&&this.halo&&this.halo.attr({d:t.haloPath(this.options.states.hover.halo.size)})}},i(e,"load",function(){var t,e,s,a=this;a.container&&(t=i(a.container,"mousedown",function(t){var o=a.hoverPoint;o&&o.series&&o.series.hasDraggableNodes&&o.series.options.draggable&&(o.series.onMouseDown(o,t),e=i(a.container,"mousemove",function(t){return o&&o.series&&o.series.onMouseMove(o,t)}),s=i(a.container.ownerDocument,"mouseup",function(t){return e(),s(),o&&o.series&&o.series.onMouseUp(o,t)}))})),i(a,"destroy",function(){t()})})}),i(e,"parts-more/PackedBubbleSeries.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.clamp,s=e.defined,a=e.extend,o=e.extendClass,r=e.isArray,n=e.isNumber,l=e.pick,h=t.seriesType,p=t.Series,d=t.Point,c=t.addEvent,u=t.fireEvent,g=t.Chart,f=t.Color,m=t.layouts["reingold-fruchterman"],b=t.seriesTypes.bubble.prototype.pointClass,y=t.dragNodesMixin;t.networkgraphIntegrations.packedbubble={repulsiveForceFunction:function(t,e,i,s){return Math.min(t,(i.marker.radius+s.marker.radius)/2)},barycenter:function(){var t,e,i=this,s=i.options.gravitationalConstant,a=i.box,o=i.nodes;o.forEach(function(r){i.options.splitSeries&&!r.isParentNode?(t=r.series.parentNode.plotX,e=r.series.parentNode.plotY):(t=a.width/2,e=a.height/2),r.fixedPosition||(r.plotX-=(r.plotX-t)*s/(r.mass*Math.sqrt(o.length)),r.plotY-=(r.plotY-e)*s/(r.mass*Math.sqrt(o.length)))})},repulsive:function(t,e,i,s){var a=e*this.diffTemperature/t.mass/t.degree,o=i.x*a,r=i.y*a;t.fixedPosition||(t.plotX+=o,t.plotY+=r),s.fixedPosition||(s.plotX-=o,s.plotY-=r)},integrate:t.networkgraphIntegrations.verlet.integrate,getK:t.noop},t.layouts.packedbubble=o(m,{beforeStep:function(){this.options.marker&&this.series.forEach(function(t){t&&t.calculateParentRadius()})},setCircularPositions:function(){var t,e,i=this,s=i.box,a=i.nodes,o=a.length+1,r=2*Math.PI/o,n=i.options.initialPositionRadius;a.forEach(function(a,o){i.options.splitSeries&&!a.isParentNode?(t=a.series.parentNode.plotX,e=a.series.parentNode.plotY):(t=s.width/2,e=s.height/2),a.plotX=a.prevX=l(a.plotX,t+n*Math.cos(a.index||o*r)),a.plotY=a.prevY=l(a.plotY,e+n*Math.sin(a.index||o*r)),a.dispX=0,a.dispY=0})},repulsiveForces:function(){var t,e,i,s=this,a=s.options.bubblePadding;s.nodes.forEach(function(o){o.degree=o.mass,o.neighbours=0,s.nodes.forEach(function(r){t=0,o===r||o.fixedPosition||!s.options.seriesInteraction&&o.series!==r.series||(i=s.getDistXY(o,r),(e=s.vectorLength(i)-(o.marker.radius+r.marker.radius+a))<0&&(o.degree+=.01,o.neighbours++,t=s.repulsiveForce(-e/Math.sqrt(o.neighbours),s.k,o,r)),s.force("repulsive",o,t*r.mass,i,r,e))})})},applyLimitBox:function(t){var e,i;this.options.splitSeries&&!t.isParentNode&&this.options.parentNodeLimit&&(e=this.getDistXY(t,t.series.parentNode),(i=t.series.parentNodeRadius-t.marker.radius-this.vectorLength(e))<0&&i>-2*t.marker.radius&&(t.plotX-=.01*e.x,t.plotY-=.01*e.y)),m.prototype.applyLimitBox.apply(this,arguments)},isStable:function(){return Math.abs(this.systemTemperature-this.prevSystemTemperature)<1e-5||this.temperature<=0||this.systemTemperature>0&&this.systemTemperature/this.nodes.length<.02&&this.enableSimulation}}),h("packedbubble","bubble",{minSize:"10%",maxSize:"50%",sizeBy:"area",zoneAxis:"y",tooltip:{pointFormat:"Value: {point.value}"},draggable:!0,useSimulation:!0,dataLabels:{formatter:function(){return this.point.value},parentNodeFormatter:function(){return this.name},parentNodeTextPath:{enabled:!0},padding:0},layoutAlgorithm:{initialPositions:"circle",initialPositionRadius:20,bubblePadding:5,parentNodeLimit:!1,seriesInteraction:!0,dragBetweenSeries:!1,parentNodeOptions:{maxIterations:400,gravitationalConstant:.03,maxSpeed:50,initialPositionRadius:100,seriesInteraction:!0,marker:{fillColor:null,fillOpacity:1,lineWidth:1,lineColor:null,symbol:"circle"}},enableSimulation:!0,type:"packedbubble",integration:"packedbubble",maxIterations:1e3,splitSeries:!1,maxSpeed:5,gravitationalConstant:.01,friction:-.981}},{hasDraggableNodes:!0,forces:["barycenter","repulsive"],pointArrayMap:["value"],pointValKey:"value",isCartesian:!1,requireSorting:!1,directTouch:!0,axisTypes:[],noSharedTooltip:!0,searchPoint:t.noop,accumulateAllPoints:function(t){var e,i,s=t.chart,a=[];for(e=0;e<s.series.length;e++)if((t=s.series[e]).visible||!s.options.chart.ignoreHiddenSeries)for(i=0;i<t.yData.length;i++)a.push([null,null,t.yData[i],t.index,i,{id:i,marker:{radius:0}}]);return a},init:function(){return p.prototype.init.apply(this,arguments),c(this,"updatedData",function(){this.chart.series.forEach(function(t){t.type===this.type&&(t.isDirty=!0)},this)}),this},render:function(){var t=[];p.prototype.render.apply(this,arguments),this.options.dataLabels.allowOverlap||(this.data.forEach(function(e){r(e.dataLabels)&&e.dataLabels.forEach(function(e){t.push(e)})}),this.chart.hideOverlappingLabels(t))},setVisible:function(){var t=this;p.prototype.setVisible.apply(t,arguments),t.parentNodeLayout&&t.graph?t.visible?(t.graph.show(),t.parentNode.dataLabel&&t.parentNode.dataLabel.show()):(t.graph.hide(),t.parentNodeLayout.removeElementFromCollection(t.parentNode,t.parentNodeLayout.nodes),t.parentNode.dataLabel&&t.parentNode.dataLabel.hide()):t.layout&&(t.visible?t.layout.addElementsToCollection(t.points,t.layout.nodes):t.points.forEach(function(e){t.layout.removeElementFromCollection(e,t.layout.nodes)}))},drawDataLabels:function(){var t=this.options.dataLabels.textPath,e=this.points;p.prototype.drawDataLabels.apply(this,arguments),this.parentNode&&(this.parentNode.formatPrefix="parentNode",this.points=[this.parentNode],this.options.dataLabels.textPath=this.options.dataLabels.parentNodeTextPath,p.prototype.drawDataLabels.apply(this,arguments),this.points=e,this.options.dataLabels.textPath=t)},seriesBox:function(){var t,e=this.chart,i=this.data,a=Math.max,o=Math.min,r=[e.plotLeft,e.plotLeft+e.plotWidth,e.plotTop,e.plotTop+e.plotHeight];return i.forEach(function(e){s(e.plotX)&&s(e.plotY)&&e.marker.radius&&(t=e.marker.radius,r[0]=o(r[0],e.plotX-t),r[1]=a(r[1],e.plotX+t),r[2]=o(r[2],e.plotY-t),r[3]=a(r[3],e.plotY+t))}),n(r.width/r.height)?r:null},calculateParentRadius:function(){var t;t=this.seriesBox(),this.parentNodeRadius=i(Math.sqrt(2*this.parentNodeMass/Math.PI)+20,20,t?Math.max(Math.sqrt(Math.pow(t.width,2)+Math.pow(t.height,2))/2+20,20):Math.sqrt(2*this.parentNodeMass/Math.PI)+20),this.parentNode&&(this.parentNode.marker.radius=this.parentNode.radius=this.parentNodeRadius)},drawGraph:function(){if(this.layout&&this.layout.options.splitSeries){var e,i=this.chart,s=this.layout.options.parentNodeOptions.marker,a={fill:s.fillColor||f(this.color).brighten(.4).get(),opacity:s.fillOpacity,stroke:s.lineColor||this.color,"stroke-width":s.lineWidth},o=this.visible?"inherit":"hidden";this.parentNodesGroup||(this.parentNodesGroup=this.plotGroup("parentNodesGroup","parentNode",o,.1,i.seriesGroup),this.group.attr({zIndex:2})),this.calculateParentRadius(),e=t.merge({x:this.parentNode.plotX-this.parentNodeRadius,y:this.parentNode.plotY-this.parentNodeRadius,width:2*this.parentNodeRadius,height:2*this.parentNodeRadius},a),this.parentNode.graphic||(this.graph=this.parentNode.graphic=i.renderer.symbol(a.symbol).add(this.parentNodesGroup)),this.parentNode.graphic.attr(e)}},createParentNodes:function(){var t,e=this,i=e.chart,s=e.parentNodeLayout,a=e.parentNode;e.parentNodeMass=0,e.points.forEach(function(t){e.parentNodeMass+=Math.PI*Math.pow(t.marker.radius,2)}),e.calculateParentRadius(),s.nodes.forEach(function(i){i.seriesIndex===e.index&&(t=!0)}),s.setArea(0,0,i.plotWidth,i.plotHeight),t||(a||(a=(new b).init(this,{mass:e.parentNodeRadius/2,marker:{radius:e.parentNodeRadius},dataLabels:{inside:!1},dataLabelOnNull:!0,degree:e.parentNodeRadius,isParentNode:!0,seriesIndex:e.index})),e.parentNode&&(a.plotX=e.parentNode.plotX,a.plotY=e.parentNode.plotY),e.parentNode=a,s.addElementsToCollection([e],s.series),s.addElementsToCollection([a],s.nodes))},addSeriesLayout:function(){var e,i=this.options.layoutAlgorithm,s=this.chart.graphLayoutsStorage,a=this.chart.graphLayoutsLookup,o=t.merge(i,i.parentNodeOptions,{enableSimulation:this.layout.options.enableSimulation});(e=s[i.type+"-series"])||(s[i.type+"-series"]=e=new t.layouts[i.type],e.init(o),a.splice(e.index,0,e)),this.parentNodeLayout=e,this.createParentNodes()},addLayout:function(){var e,i=this.options.layoutAlgorithm,a=this.chart.graphLayoutsStorage,o=this.chart.graphLayoutsLookup,r=this.chart.options.chart;a||(this.chart.graphLayoutsStorage=a={},this.chart.graphLayoutsLookup=o=[]),(e=a[i.type])||(i.enableSimulation=s(r.forExport)?!r.forExport:i.enableSimulation,a[i.type]=e=new t.layouts[i.type],e.init(i),o.splice(e.index,0,e)),this.layout=e,this.points.forEach(function(t){t.mass=2,t.degree=1,t.collisionNmb=1}),e.setArea(0,0,this.chart.plotWidth,this.chart.plotHeight),e.addElementsToCollection([this],e.series),e.addElementsToCollection(this.points,e.nodes)},deferLayout:function(){var t=this.options.layoutAlgorithm;this.visible&&(this.addLayout(),t.splitSeries&&this.addSeriesLayout())},translate:function(){var t,e,i,o,r=this.chart,n=this.data,l=this.index,h=this.options.useSimulation;for(this.processedXData=this.xData,this.generatePoints(),s(r.allDataPoints)||(r.allDataPoints=this.accumulateAllPoints(this),this.getPointRadius()),h?i=r.allDataPoints:(i=this.placeBubbles(r.allDataPoints),this.options.draggable=!1),o=0;o<i.length;o++)i[o][3]===l&&(t=n[i[o][4]],e=i[o][2],h||(t.plotX=i[o][0]-r.plotLeft+r.diffX,t.plotY=i[o][1]-r.plotTop+r.diffY),t.marker=a(t.marker,{radius:e,width:2*e,height:2*e}),t.radius=e);h&&this.deferLayout(),u(this,"afterTranslate")},checkOverlap:function(t,e){var i=t[0]-e[0],s=t[1]-e[1],a=t[2]+e[2];return Math.sqrt(i*i+s*s)-Math.abs(a)<-.001},positionBubble:function(t,e,i){var s=Math.sqrt,a=Math.asin,o=Math.acos,r=Math.pow,n=Math.abs,l=s(r(t[0]-e[0],2)+r(t[1]-e[1],2)),h=o((r(l,2)+r(i[2]+e[2],2)-r(i[2]+t[2],2))/(2*(i[2]+e[2])*l)),p=a(n(t[0]-e[0])/l),d=(t[1]-e[1]<0?0:Math.PI)+h+p*((t[0]-e[0])*(t[1]-e[1])<0?1:-1),c=Math.cos(d),u=Math.sin(d);return[e[0]+(e[2]+i[2])*u,e[1]-(e[2]+i[2])*c,i[2],i[3],i[4]]},placeBubbles:function(t){var e,i,s,a=this.checkOverlap,o=this.positionBubble,r=[],n=1,l=0,h=0,p=[];if((i=t.sort(function(t,e){return e[2]-t[2]})).length){if(r.push([[0,0,i[0][2],i[0][3],i[0][4]]]),i.length>1)for(r.push([[0,0-i[1][2]-i[0][2],i[1][2],i[1][3],i[1][4]]]),s=2;s<i.length;s++)i[s][2]=i[s][2]||1,a(e=o(r[n][l],r[n-1][h],i[s]),r[n][0])?(r.push([]),h=0,r[n+1].push(o(r[n][l],r[n][0],i[s])),n++,l=0):n>1&&r[n-1][h+1]&&a(e,r[n-1][h+1])?(h++,r[n].push(o(r[n][l],r[n-1][h],i[s])),l++):(l++,r[n].push(e));this.chart.stages=r,this.chart.rawPositions=[].concat.apply([],r),this.resizeRadius(),p=this.chart.rawPositions}return p},resizeRadius:function(){var t,e,i,s,a,o,r,n,l,h=this.chart,p=h.rawPositions,d=Math.min,c=Math.max,u=h.plotLeft,g=h.plotTop,f=h.plotHeight,m=h.plotWidth;for(t=i=Number.POSITIVE_INFINITY,e=s=Number.NEGATIVE_INFINITY,l=0;l<p.length;l++)a=p[l][2],t=d(t,p[l][0]-a),e=c(e,p[l][0]+a),i=d(i,p[l][1]-a),s=c(s,p[l][1]+a);if(r=[(m-u)/(o=[e-t,s-i])[0],(f-g)/o[1]],n=d.apply([],r),Math.abs(n-1)>1e-10){for(l=0;l<p.length;l++)p[l][2]*=n;this.placeBubbles(p)}else h.diffY=f/2+g-i-(s-i)/2,h.diffX=m/2+u-t-(e-t)/2},calculateZExtremes:function(){var t=this.chart,e=this.options.zMin,i=this.options.zMax,a=1/0,o=-1/0;return e&&i?[e,i]:(t.series.forEach(function(t){t.yData.forEach(function(t){s(t)&&(t>o&&(o=t),t<a&&(a=t))})}),[e=l(e,a),i=l(i,o)])},getPointRadius:function(){var t,e,s,a,o,r=this,n=r.chart,l=n.plotWidth,h=n.plotHeight,p=r.options,d=p.useSimulation,c=Math.min(l,h),u={},g=[],f=n.allDataPoints;["minSize","maxSize"].forEach(function(t){var e=parseInt(p[t],10),i=/%$/.test(p[t]);u[t]=i?c*e/100:e*Math.sqrt(f.length)}),n.minRadius=t=u.minSize/Math.sqrt(f.length),n.maxRadius=e=u.maxSize/Math.sqrt(f.length),o=d?r.calculateZExtremes():[t,e],(f||[]).forEach(function(n,l){s=d?i(n[2],o[0],o[1]):n[2],0===(a=r.getRadius(o[0],o[1],t,e,s))&&(a=null),f[l][2]=a,g.push(a)}),r.radii=g},redrawHalo:y.redrawHalo,onMouseDown:y.onMouseDown,onMouseMove:y.onMouseMove,onMouseUp:function(e){if(e.fixedPosition&&!e.removed){var i,s=this.layout,a=this.parentNodeLayout;a&&s.options.dragBetweenSeries&&a.nodes.forEach(function(a){e&&e.marker&&a!==e.series.parentNode&&(i=s.getDistXY(e,a),s.vectorLength(i)-a.marker.radius-e.marker.radius<0&&(a.series.addPoint(t.merge(e.options,{plotX:e.plotX,plotY:e.plotY}),!1),s.removeElementFromCollection(e,s.nodes),e.remove()))}),y.onMouseUp.apply(this,arguments)}},destroy:function(){this.chart.graphLayoutsLookup&&this.chart.graphLayoutsLookup.forEach(function(t){t.removeElementFromCollection(this,t.series)},this),this.parentNode&&(this.parentNodeLayout.removeElementFromCollection(this.parentNode,this.parentNodeLayout.nodes),this.parentNode.dataLabel&&(this.parentNode.dataLabel=this.parentNode.dataLabel.destroy())),t.Series.prototype.destroy.apply(this,arguments)},alignDataLabel:t.Series.prototype.alignDataLabel},{destroy:function(){return this.series.layout&&this.series.layout.removeElementFromCollection(this,this.series.layout.nodes),d.prototype.destroy.apply(this,arguments)}}),c(g,"beforeRedraw",function(){this.allDataPoints&&delete this.allDataPoints})}),i(e,"parts-more/Polar.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i,s=e.defined,a=e.pick,o=e.splat,r=e.wrap,n=t.Pointer,l=t.Series,h=t.seriesTypes,p=l.prototype,d=n.prototype;p.searchPointByAngle=function(t){var e=this.chart,i=this.xAxis.pane.center,s=t.chartX-i[0]-e.plotLeft,a=t.chartY-i[1]-e.plotTop;return this.searchKDTree({clientX:180+Math.atan2(s,a)*(-180/Math.PI)})},p.getConnectors=function(t,e,i,s){var a,o,r,n,l,h,p,d,c,u,g,f,m,b,y,x,v,M,P,L,w,k=s?1:0;return o=(a=e>=0&&e<=t.length-1?e:e<0?t.length-1+e:0)-1<0?t.length-(1+k):a-1,r=a+1>t.length-1?k:a+1,n=t[o],l=t[r],h=n.plotX,p=n.plotY,d=l.plotX,c=l.plotY,m=(1.5*(u=t[a].plotX)+h)/2.5,b=(1.5*(g=t[a].plotY)+p)/2.5,y=(1.5*u+d)/2.5,x=(1.5*g+c)/2.5,v=Math.sqrt(Math.pow(m-u,2)+Math.pow(b-g,2)),M=Math.sqrt(Math.pow(y-u,2)+Math.pow(x-g,2)),P=Math.atan2(b-g,m-u),L=Math.atan2(x-g,y-u),w=Math.PI/2+(P+L)/2,Math.abs(P-w)>Math.PI/2&&(w-=Math.PI),m=u+Math.cos(w)*v,b=g+Math.sin(w)*v,f={rightContX:y=u+Math.cos(Math.PI+w)*M,rightContY:x=g+Math.sin(Math.PI+w)*M,leftContX:m,leftContY:b,plotX:u,plotY:g},i&&(f.prevPointCont=this.getConnectors(t,o,!1,s)),f},p.toXY=function(t){var e,i,s=this.chart,a=this.xAxis,o=this.yAxis,r=t.plotX,n=t.plotY,l=t.series,h=s.inverted,p=t.y;h&&l&&!l.isRadialBar&&(t.plotY=n="number"==typeof p&&o.translate(p)||0),t.rectPlotX=r,t.rectPlotY=n,e=h?a.postTranslate(n,r):a.postTranslate(r,o.len-n),t.plotX=t.polarPlotX=e.x-s.plotLeft,t.plotY=t.polarPlotY=e.y-s.plotTop,this.kdByAngle?((i=(r/Math.PI*180+a.pane.options.startAngle)%360)<0&&(i+=360),t.clientX=i):t.clientX=t.plotX},h.spline&&(r(h.spline.prototype,"getPointSpline",function(t,e,i,s){var a;return this.chart.polar?s?["C",(a=this.getConnectors(e,s,!0,this.connectEnds)).prevPointCont.rightContX,a.prevPointCont.rightContY,a.leftContX,a.leftContY,a.plotX,a.plotY]:["M",i.plotX,i.plotY]:t.call(this,e,i,s)}),h.areasplinerange&&(h.areasplinerange.prototype.getPointSpline=h.spline.prototype.getPointSpline)),t.addEvent(l,"afterTranslate",function(){var e=this.chart;if(e.polar&&this.xAxis){if(this.kdByAngle=e.tooltip&&e.tooltip.shared,this.kdByAngle?this.searchPoint=this.searchPointByAngle:this.options.findNearestPointBy="xy",!this.preventPostTranslate)for(var i=this.points,s=i.length;s--;)this.toXY(i[s]),!e.hasParallelCoordinates&&!this.yAxis.reversed&&i[s].y<this.yAxis.min&&(i[s].isNull=!0);this.hasClipCircleSetter||(this.hasClipCircleSetter=!!this.eventsToUnbind.push(t.addEvent(this,"afterRender",function(){var i;e.polar&&(i=this.yAxis.center,this.clipCircle?this.clipCircle.animate({x:i[0],y:i[1],r:i[2]/2}):this.clipCircle=e.renderer.clipCircle(i[0],i[1],i[2]/2),this.group.clip(this.clipCircle),this.setClip=t.noop)})))}},{order:2}),r(p,"getGraphPath",function(t,e){var i,s,a,o=this;if(this.chart.polar){for(e=e||this.points,i=0;i<e.length;i++)if(!e[i].isNull){s=i;break}!1!==this.options.connectEnds&&void 0!==s&&(this.connectEnds=!0,e.splice(e.length,0,e[s]),a=!0),e.forEach(function(t){void 0===t.polarPlotY&&o.toXY(t)})}var r=t.apply(this,[].slice.call(arguments,1));return a&&e.pop(),r});var c=function(e,i){var s,o=this.chart,r=this.options.animation,n=this.group,l=this.markerGroup,h=this.xAxis.center,p=o.plotLeft,d=o.plotTop;o.polar?this.isRadialBar?i||(this.startAngleRad=a(this.translatedThreshold,this.xAxis.startAngleRad),t.seriesTypes.pie.prototype.animate.call(this,i)):o.renderer.isSVG&&(r=t.animObject(r),i?(s={translateX:h[0]+p,translateY:h[1]+d,scaleX:.001,scaleY:.001},n.attr(s),l&&l.attr(s)):(s={translateX:p,translateY:d,scaleX:1,scaleY:1},n.animate(s,r),l&&l.animate(s,r),this.animate=null)):e.call(this,i)};r(p,"animate",c),h.column&&((i=h.column.prototype).polarArc=function(t,e,i,s){var o=this.xAxis.center,r=this.yAxis.len;return this.chart.renderer.symbols.arc(o[0],o[1],r-e,null,{start:i,end:s,innerR:r-a(t,r)})},r(i,"animate",c),r(i,"translate",function(i){var a,o,r,n,l,h,p,d,c,u,g,f,m,b,y,x,v=this.options,M=v.threshold,P=v.stacking,L=this.chart,w=this.xAxis,k=this.yAxis,S=k.reversed,A=w.center,X=w.startAngleRad,T=w.endAngleRad-X;if(this.preventPostTranslate=!0,i.call(this),w.isRadial)for(n=(o=this.points).length,l=k.translate(k.min),h=k.translate(k.max),M=v.threshold||0,L.inverted&&t.isNumber(M)&&(a=k.translate(M),s(a)&&(a<0?a=0:a>T&&(a=T),this.translatedThreshold=a+X));n--;)b=(r=o[n]).barX,u=r.x,g=r.y,L.inverted?(r.shapeType="arc",r.plotY=k.translate(g),P?(m=k.stacks[(g<0?"-":"")+this.stackKey],this.visible&&m&&m[u]&&(r.isNull||(f=m[u].points[this.getStackIndicator(void 0,u,this.index).key],p=k.translate(f[0]),d=k.translate(f[1]),s(p)&&(p=e.clamp(p,0,T))))):(p=a,d=r.plotY),p>d&&(d=[p,p=d][0]),S?d>l?d=l:p<h?p=h:(p>l||d<h)&&(p=d=T):p<l?p=l:d>h?d=h:(d<l||p>h)&&(p=d=0),k.min>k.max&&(p=d=S?T:0),p+=X,d+=X,y=Math.max(b,0),x=Math.max(b+r.pointWidth,0),r.shapeArgs={x:A[0],y:A[1],r:x,innerR:y,start:p,end:d},r.opacity=p===d?0:void 0,r.plotY=(s(this.translatedThreshold)&&(p<this.translatedThreshold?p:d))-X):(r.shapeType="path",p=b+X,r.shapeArgs={d:this.polarArc(r.yBottom,r.plotY,p,p+r.pointWidth)}),this.toXY(r),L.inverted?(c=w.postTranslate(r.rectPlotY,r.barX+r.pointWidth/2),r.tooltipPos=[c.x-L.plotLeft,c.y-L.plotTop]):r.tooltipPos=[r.plotX,r.plotY],r.ttBelow=r.plotY>A[1]}),i.findAlignments=function(t,e){var i,s;return null===e.align&&(i=t>20&&t<160?"left":t>200&&t<340?"right":"center",e.align=i),null===e.verticalAlign&&(s=t<45||t>315?"bottom":t>135&&t<225?"top":"middle",e.verticalAlign=s),e},r(i,"alignDataLabel",function(t,e,i,s,o,r){var n,l,h,d=this.chart,c=a(s.inside,!!this.options.stacking);d.polar?(n=e.rectPlotX/Math.PI*180,d.inverted?(this.forceDL=d.isInsidePlot(e.plotX,Math.round(e.plotY),!1),c&&e.shapeArgs?(l=e.shapeArgs,o={x:(h=this.xAxis.postTranslate((l.start+l.end)/2-this.xAxis.startAngleRad,e.barX+e.pointWidth/2)).x-d.plotLeft,y:h.y-d.plotTop}):e.tooltipPos&&(o={x:e.tooltipPos[0],y:e.tooltipPos[1]}),s.align=a(s.align,"center"),s.verticalAlign=a(s.verticalAlign,"middle")):s=this.findAlignments(n,s),p.alignDataLabel.call(this,e,i,s,o,r),this.isRadialBar&&e.shapeArgs&&e.shapeArgs.start===e.shapeArgs.end&&i.hide(!0)):t.call(this,e,i,s,o,r)})),r(d,"getCoordinates",function(t,e){var i=this.chart,s={xAxis:[],yAxis:[]};return i.polar?i.axes.forEach(function(t){var a,o,r=t.isXAxis,n=t.center;"colorAxis"!==t.coll&&(a=e.chartX-n[0]-i.plotLeft,o=e.chartY-n[1]-i.plotTop,s[r?"xAxis":"yAxis"].push({axis:t,value:t.translate(r?Math.PI-Math.atan2(a,o):Math.sqrt(Math.pow(a,2)+Math.pow(o,2)),!0)}))}):s=t.call(this,e),s}),t.SVGRenderer.prototype.clipCircle=function(e,i,s){var a,o=t.uniqueKey(),r=this.createElement("clipPath").attr({id:o}).add(this.defs);return(a=this.circle(e,i,s).add(r)).id=o,a.clipPath=r,a},t.addEvent(t.Chart,"getAxes",function(){this.pane||(this.pane=[]),o(this.options.pane).forEach(function(e){new t.Pane(e,this)},this)}),t.addEvent(t.Chart,"afterDrawChartBox",function(){this.pane.forEach(function(t){t.render()})}),t.addEvent(t.Series,"afterInit",function(){var t=this.chart;t.inverted&&t.polar&&(this.isRadialSeries=!0,this instanceof h.column&&(this.isRadialBar=!0))}),r(t.Chart.prototype,"get",function(e,i){return t.find(this.pane,function(t){return t.options.id===i})||e.call(this,i)})}),i(e,"masters/highcharts-more.src.js",[],function(){})});
!function(t){"object"==typeof module&&module.exports?(t.default=t,module.exports=t):"function"==typeof define&&define.amd?define("highcharts/modules/funnel",["highcharts"],function(e){return t(e),t.Highcharts=e,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){var e=t?t._modules:{};function i(t,e,i,a){t.hasOwnProperty(e)||(t[e]=a.apply(null,i))}i(e,"modules/funnel.src.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){var i=e.pick,a=t.seriesType,n=t.seriesTypes,o=t.fireEvent,l=t.addEvent,s=t.noop;a("funnel","pie",{animation:!1,center:["50%","50%"],width:"90%",neckWidth:"30%",height:"100%",neckHeight:"25%",reversed:!1,size:!0,dataLabels:{connectorWidth:1,verticalAlign:"middle"},states:{select:{color:"#cccccc",borderColor:"#000000"}}},{animate:s,translate:function(){var t,e,a,n,l,h,r,c,d,p,g=0,u=this,f=u.chart,b=u.options,m=b.reversed,y=b.ignoreHiddenPoint,v=f.plotWidth,L=f.plotHeight,W=0,x=b.center,A=C(x[0],v),D=C(x[1],L),H=C(b.width,v),k=C(b.height,L),w=C(b.neckWidth,v),Y=C(b.neckHeight,L),j=D-k/2+k-Y,E=u.data,P="left"===b.dataLabels.position?1:0;function C(t,e){return/%$/.test(t)?e*parseInt(t,10)/100:parseInt(t,10)}u.getWidthAt=function(t){return t>j||k===Y?w:w+(H-w)*(1-(t-(D-k/2))/(k-Y))},u.getX=function(t,e,i){return A+(e?-1:1)*(u.getWidthAt(m?2*D-t:t)/2+i.labelDistance)},u.center=[A,D,k],u.centerX=A,E.forEach(function(t){y&&!1===t.visible||(g+=t.y)}),E.forEach(function(o){p=null,a=g?o.y/g:0,c=(l=D-k/2+W*k)+a*k,t=u.getWidthAt(l),h=(n=A-t/2)+t,t=u.getWidthAt(c),d=(r=A-t/2)+t,l>j?(n=r=A-w/2,h=d=A+w/2):c>j&&(p=c,t=u.getWidthAt(j),d=(r=A-t/2)+t,c=j),m&&(l=2*D-l,c=2*D-c,null!==p&&(p=2*D-p)),e=["M",n,l,"L",h,l,d,c],null!==p&&e.push(d,p,r,p),e.push(r,c,"Z"),o.shapeType="path",o.shapeArgs={d:e},o.percentage=100*a,o.plotX=A,o.plotY=(l+(p||c))/2,o.tooltipPos=[A,o.plotY],o.dlBox={x:r,y:l,topWidth:h-n,bottomWidth:d-r,height:Math.abs(i(p,c)-l),width:NaN},o.slice=s,o.half=P,y&&!1===o.visible||(W+=a)}),o(u,"afterTranslate")},sortByAngle:function(t){t.sort(function(t,e){return t.plotY-e.plotY})},drawDataLabels:function(){var t,e,a,o,l,s=this.data,h=this.options.dataLabels.distance,r=s.length;for(this.center[2]-=2*h;r--;)e=(t=(a=s[r]).half)?1:-1,l=a.plotY,a.labelDistance=i(a.options.dataLabels&&a.options.dataLabels.distance,h),this.maxLabelDistance=Math.max(a.labelDistance,this.maxLabelDistance||0),o=this.getX(l,t,a),a.labelPosition={natural:{x:0,y:l},final:{},alignment:t?"right":"left",connectorPosition:{breakAt:{x:o+(a.labelDistance-5)*e,y:l},touchingSliceAt:{x:o+a.labelDistance*e,y:l}}};n[this.options.dataLabels.inside?"column":"pie"].prototype.drawDataLabels.call(this)},alignDataLabel:function(e,i,a,n,o){var l=e.series,s=l.options.reversed,h=e.dlBox||e.shapeArgs,r=a.align,c=a.verticalAlign,d=((l.options||{}).dataLabels||{}).inside,p=l.center[1],g=s?2*p-e.plotY:e.plotY,u=l.getWidthAt(g-h.height/2+i.height),f="middle"===c?(h.topWidth-h.bottomWidth)/4:(u-h.bottomWidth)/2,b=h.y,m=h.x;"middle"===c?b=h.y-h.height/2+i.height/2:"top"===c&&(b=h.y-h.height+i.height+a.padding),("top"===c&&!s||"bottom"===c&&s||"middle"===c)&&("right"===r?m=h.x-a.padding+f:"left"===r&&(m=h.x+a.padding-f)),n={x:m,y:s?b-h.height:b,width:h.bottomWidth,height:h.height},a.verticalAlign="bottom",d&&!e.visible||t.Series.prototype.alignDataLabel.call(this,e,i,a,n,o),d&&(!e.visible&&e.dataLabel&&(e.dataLabel.placed=!1),e.contrastColor&&i.css({color:e.contrastColor}))}}),l(t.Chart,"afterHideAllOverlappingLabels",function(){this.series.forEach(function(t){t instanceof n.pie&&t.placeDataLabels&&!((t.options||{}).dataLabels||{}).inside&&t.placeDataLabels()})}),a("pyramid","funnel",{neckWidth:"0%",neckHeight:"0%",reversed:!0})}),i(e,"masters/modules/funnel.src.js",[],function(){})});
!function(t){"object"==typeof module&&module.exports?module.exports=t:t(Highcharts)}(function(t){var o=t.relativeLength;t.wrap(t.seriesTypes.column.prototype,"translate",function(e){var r=this.options,i=r.topMargin||0,s=r.bottomMargin||0;e.call(this),t.each(this.points,function(t){var e=t.shapeArgs,a=e.width,h=e.height,p=e.x,n=e.y,d=t.y>0?["Top"," Bottom"]:["Bottom","Top"],u=o(r["borderRadius"+d[0]+"Left"]||0,a),c=o(r["borderRadius"+d[0]+"Right"]||0,a),g=o(r["borderRadius"+d[1]+"Right"]||0,a),l=o(r["borderRadius"+d[1]+"Left"]||0,a);if(u||c||g||l){var f=Math.min(a,h)/2;u>f&&(u=f),c>f&&(c=f),g>f&&(g=f),l>f&&(l=f),t.dlBox=t.shapeArgs,t.shapeType="path",t.shapeArgs={d:["M",p+u,n+i,"L",p+a-c,n+i,"C",p+a-c/2,n,p+a,n+c/2,p+a,n+c,"L",p+a,n+h-g,"C",p+a,n+h-g/2,p+a-g/2,n+h,p+a-g,n+h+s,"L",p+l,n+h+s,"C",p+l/2,n+h,p,n+h-l/2,p,n+h-l,"L",p,n+u,"C",p,n+u/2,p+u/2,n,p+u,n,"Z"]}}})})});
!function(e){"object"==typeof module&&module.exports?(e.default=e,module.exports=e):"function"==typeof define&&define.amd?define("highcharts/modules/pareto",["highcharts"],function(s){return e(s),e.Highcharts=s,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(e){var s=e?e._modules:{};function t(e,s,t,i){e.hasOwnProperty(s)||(e[s]=i.apply(null,t))}t(s,"mixins/derived-series.js",[s["parts/Globals.js"],s["parts/Utilities.js"]],function(e,s){var t=s.defined,i=e.Series,n=e.addEvent;return{hasDerivedData:!0,init:function(){i.prototype.init.apply(this,arguments),this.initialised=!1,this.baseSeries=null,this.eventRemovers=[],this.addEvents()},setDerivedData:e.noop,setBaseSeries:function(){var e=this.chart,s=this.options.baseSeries,i=t(s)&&(e.series[s]||e.get(s));this.baseSeries=i||null},addEvents:function(){var e,s=this;e=n(this.chart,"afterLinkSeries",function(){s.setBaseSeries(),s.baseSeries&&!s.initialised&&(s.setDerivedData(),s.addBaseSeriesEvents(),s.initialised=!0)}),this.eventRemovers.push(e)},addBaseSeriesEvents:function(){var e,s,t=this;e=n(t.baseSeries,"updatedData",function(){t.setDerivedData()}),s=n(t.baseSeries,"destroy",function(){t.baseSeries=null,t.initialised=!1}),t.eventRemovers.push(e,s)},destroy:function(){this.eventRemovers.forEach(function(e){e()}),i.prototype.destroy.apply(this,arguments)}}}),t(s,"modules/pareto.src.js",[s["parts/Globals.js"],s["parts/Utilities.js"],s["mixins/derived-series.js"]],function(e,s,t){var i=s.correctFloat;(0,e.seriesType)("pareto","line",{zIndex:3},(0,e.merge)(t,{setDerivedData:function(){var e=this.baseSeries.xData,s=this.baseSeries.yData,t=this.sumPointsPercents(s,e,null,!0);this.setData(this.sumPointsPercents(s,e,t,!1),!1)},sumPointsPercents:function(e,s,t,n){var r,a=0,o=0,d=[];return e.forEach(function(e,u){null!==e&&(n?a+=e:(r=e/t*100,d.push([s[u],i(o+r)]),o+=r))}),n?a:d}}))}),t(s,"masters/modules/pareto.src.js",[],function(){})});
!function(t){"object"==typeof module&&module.exports?(t.default=t,module.exports=t):"function"==typeof define&&define.amd?define("highcharts/modules/wordcloud",["highcharts"],function(i){return t(i),t.Highcharts=i,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){var i=t?t._modules:{};function n(t,i,n,o){t.hasOwnProperty(i)||(t[i]=o.apply(null,n))}n(i,"mixins/draw-point.js",[],function(){return function(t){(t.attribs=t.attribs||{}).class=this.getClassName(),function(t){var i=this,n=i.graphic,o=t.animatableAttribs,e=t.onComplete,r=t.css,a=t.renderer;if(i.shouldDraw())n||(i.graphic=n=a[t.shapeType](t.shapeArgs).add(t.group)),n.css(r).attr(t.attribs).animate(o,!t.isNew&&void 0,e);else if(n){var s=function(){i.graphic=n=n.destroy(),"function"==typeof e&&e()};Object.keys(o).length?n.animate(o,void 0,function(){s()}):s()}}.call(this,t)}}),n(i,"mixins/polygon.js",[i["parts/Globals.js"],i["parts/Utilities.js"]],function(t,i){var n=i.isArray,o=i.isNumber,e=t.deg2rad,r=t.find,a=function(t,i){var n=o(i)?i:14,e=Math.pow(10,n);return Math.round(t*e)/e},s=function(t,i){var n=t.map(function(t){return o=i,e=(n=t)[0],r=n[1],e*o[0]+r*o[1];var n,o,e,r});return{min:Math.min.apply(this,n),max:Math.max.apply(this,n)}},l=function(t,i){var n=t[0],o=t[1],r=e*-i,s=Math.cos(r),l=Math.sin(r);return[a(n*s-o*l),a(n*l+o*s)]},h=function(t,i,n){var o=t[0]-i[0],e=t[1]-i[1],r=l([o,e],n);return[r[0]+i[0],r[1]+i[1]]},u=function(t){var i=t.axes;return n(i)||(i=[],t.concat([t[0]]).reduce(function(t,n){var o=function(t,i){var n=i[0]-t[0],o=i[1]-t[1];return[[-o,n],[o,-n]]}(t,n)[0];return r(i,function(t){return n=o,(i=t)[0]===n[0]&&i[1]===n[1];var i,n})||i.push(o),n}),t.axes=i),i};return{getBoundingBoxFromPolygon:function(t){return t.reduce(function(t,i){var n=i[0],o=i[1];return t.left=Math.min(n,t.left),t.right=Math.max(n,t.right),t.bottom=Math.max(o,t.bottom),t.top=Math.min(o,t.top),t},{left:Number.MAX_VALUE,right:-Number.MAX_VALUE,bottom:-Number.MAX_VALUE,top:Number.MAX_VALUE})},getPolygon:function(t,i,n,o,e){var r=[t,i],a=t-n/2,s=t+n/2,l=i-o/2,u=i+o/2;return[[a,l],[s,l],[s,u],[a,u]].map(function(t){return h(t,r,-e)})},isPolygonsColliding:function(t,i){var n=function(t,i){var n=u(t),o=u(i);return n.concat(o)}(t,i);return!r(n,function(n){return function(t,i,n){var o=s(i,t),e=s(n,t);return!!(e.min>o.max||e.max<o.min)}(n,t,i)})},movePolygon:function(t,i,n){return n.map(function(n){return[n[0]+t,n[1]+i]})},rotate2DToOrigin:l,rotate2DToPoint:h}}),n(i,"modules/wordcloud.src.js",[i["parts/Globals.js"],i["parts/Utilities.js"],i["mixins/draw-point.js"],i["mixins/polygon.js"]],function(t,i,n,o){var e=i.extend,r=i.isArray,a=i.isNumber,s=i.isObject,l=t.merge,h=t.noop,u=t.find,c=o.getBoundingBoxFromPolygon,d=o.getPolygon,p=o.isPolygonsColliding,f=o.movePolygon,m=t.Series;function g(t,i){var n=!1,o=t.rect,e=t.polygon,r=t.lastCollidedWith,a=function(i){var n,r,a=(n=o,!((r=i.rect).left>n.right||r.right<n.left||r.top>n.bottom||r.bottom<n.top));return a&&(t.rotation%90||i.rotation%90)&&(a=p(e,i.polygon)),a};return r&&((n=a(r))||delete t.lastCollidedWith),n||(n=!!u(i,function(i){var n=a(i);return n&&(t.lastCollidedWith=i),n})),n}function x(t,i){var n=4*t,o=Math.ceil((Math.sqrt(n)-1)/2),e=2*o+1,r=Math.pow(e,2),a=function(t){return"boolean"==typeof t},s=!1;return e-=1,t<=1e4&&(a(s)&&n>=r-e&&(s={x:o-(r-n),y:-o}),r-=e,a(s)&&n>=r-e&&(s={x:-o,y:r-n-o}),r-=e,a(s)&&(s=n>=r-e?{x:r-n-o,y:o}:{x:o,y:o-(r-n-e)}),s.x*=5,s.y*=5),s}function y(t){return Math.round(t*(Math.random()+.5)/2)}function v(t,i,n,o){var e=!1;return a(t)&&a(i)&&a(n)&&a(o)&&t>0&&i>-1&&o>n&&(e=n+i%t*((o-n)/(t-1||1))),e}function b(t,i){var n=-i.width/2,o=i.width/2,e=-i.height/2,r=i.height/2;return!(n<t.left&&o>t.right&&e<t.top&&r>t.bottom)}function w(t,i){var n=i.placed,o=i.field,r=i.rectangle,a=i.polygon,l=i.spiral,h=1,u={x:0,y:0},c=t.rect=e({},r);for(t.polygon=a,t.rotation=i.rotation;!1!==u&&(g(t,n)||b(c,o));)u=l(h),s(u)&&(c.left=r.left+u.x,c.right=r.right+u.x,c.top=r.top+u.y,c.bottom=r.bottom+u.y,t.polygon=f(u.x,u.y,a)),h++;return u}function M(t,i){var n,o,e,r,a,h,u,c;return s(t)&&s(i)?(n=i.bottom-i.top,h=(a=(o=i.right-i.left)*(e=t.ratioX)>n*(r=t.ratioY)?o:n)*e,u=a*r,c=l(t,{width:t.width+2*h,height:t.height+2*u})):c=t,c}var A={animate:m.prototype.animate,animateDrilldown:h,animateDrillupFrom:h,setClip:h,bindAxes:function(){var t={endOnTick:!1,gridLineWidth:0,lineWidth:0,maxPadding:0,startOnTick:!1,title:null,tickPositions:[]};m.prototype.bindAxes.call(this),e(this.yAxis.options,t),e(this.xAxis.options,t)},pointAttribs:function(i,n){var o=t.seriesTypes.column.prototype.pointAttribs.call(this,i,n);return delete o.stroke,delete o["stroke-width"],o},deriveFontSize:function(t,i,n){var o=a(t)?t:0,e=a(i)?i:1,r=a(n)?n:1;return Math.floor(Math.max(r,o*e))},drawPoints:function(){var t,i,n,o=this,r=o.hasRendered,l=o.xAxis,h=o.yAxis,u=o.chart,p=o.group,f=o.options,m=f.animation,g=f.allowExtendPlayingField,x=u.renderer,y=x.text().add(p),v=[],b=o.placementStrategy[f.placementStrategy],A=f.rotation,P=o.points.map(function(t){return t.weight}),F=Math.max.apply(null,P),S=o.points.sort(function(t,i){return i.weight-t.weight});S.forEach(function(t){var i,n=1/F*t.weight,r=o.deriveFontSize(n,f.maxFontSize,f.minFontSize),a=e({fontSize:r+"px"},f.style);y.css(a).attr({x:0,y:0,text:t.name}),i=y.getBBox(!0),t.dimensions={height:i.height,width:i.width}}),n=function(t,i,n){var o=n.reduce(function(t,i){var n=i.dimensions,o=Math.max(n.width,n.height);return t.maxHeight=Math.max(t.maxHeight,n.height),t.maxWidth=Math.max(t.maxWidth,n.width),t.area+=o*o,t},{maxHeight:0,maxWidth:0,area:0}),e=Math.max(o.maxHeight,o.maxWidth,.85*Math.sqrt(o.area)),r=t>i?t/i:1,a=i>t?i/t:1;return{width:e*r,height:e*a,ratioX:r,ratioY:a}}(l.len,h.len,S),t=function(t,i){var n,o=[];for(n=1;n<1e4;n++)o.push(t(n,i));return function(t){return t<=1e4&&o[t-1]}}(o.spirals[f.spiral],{field:n}),S.forEach(function(i){var l,h=1/F*i.weight,u=o.deriveFontSize(h,f.maxFontSize,f.minFontSize),y=e({fontSize:u+"px"},f.style),P=b(i,{data:S,field:n,placed:v,rotation:A}),j=e(o.pointAttribs(i,i.selected&&"select"),{align:"center","alignment-baseline":"middle",x:P.x,y:P.y,text:i.name,rotation:P.rotation}),T=d(P.x,P.y,i.dimensions.width,i.dimensions.height,P.rotation),W=c(T),z=w(i,{rectangle:W,polygon:T,field:n,placed:v,spiral:t,rotation:P.rotation});!z&&g&&(z=w(i,{rectangle:W,polygon:T,field:n=M(n,W),placed:v,spiral:t,rotation:P.rotation})),s(z)?(j.x+=z.x,j.y+=z.y,W.left+=z.x,W.right+=z.x,W.top+=z.y,W.bottom+=z.y,n=function(t,i){return(!a(t.left)||t.left>i.left)&&(t.left=i.left),(!a(t.right)||t.right<i.right)&&(t.right=i.right),(!a(t.top)||t.top>i.top)&&(t.top=i.top),(!a(t.bottom)||t.bottom<i.bottom)&&(t.bottom=i.bottom),t}(n,W),v.push(i),i.isNull=!1):i.isNull=!0,m&&(l={x:j.x,y:j.y},r?(delete j.x,delete j.y):(j.x=0,j.y=0)),i.draw({animatableAttribs:l,attribs:j,css:y,group:p,renderer:x,shapeArgs:void 0,shapeType:"text"})}),y=y.destroy(),i=function(t,i,n){var o=2*Math.max(Math.abs(n.top),Math.abs(n.bottom)),e=2*Math.max(Math.abs(n.left),Math.abs(n.right)),r=e>0?1/e*t:1,a=o>0?1/o*i:1;return Math.min(r,a)}(l.len,h.len,n),o.group.attr({scaleX:i,scaleY:i})},hasData:function(){return s(this)&&!0===this.visible&&r(this.points)&&this.points.length>0},placementStrategy:{random:function(t,i){var n=i.field,o=i.rotation;return{x:y(n.width)-n.width/2,y:y(n.height)-n.height/2,rotation:v(o.orientations,t.index,o.from,o.to)}},center:function(t,i){var n=i.rotation;return{x:0,y:0,rotation:v(n.orientations,t.index,n.from,n.to)}}},pointArrayMap:["weight"],spirals:{archimedean:function(t,i){var n=i.field,o=!1,e=n.width*n.width+n.height*n.height,r=.8*t;return t<=1e4&&(o={x:r*Math.cos(r),y:r*Math.sin(r)},Math.min(Math.abs(o.x),Math.abs(o.y))<e||(o=!1)),o},rectangular:function(t,i){var n=x(t),o=i.field;return n&&(n.x*=o.ratioX,n.y*=o.ratioY),n},square:x},utils:{extendPlayingField:M,getRotation:v,isPolygonsColliding:p,rotate2DToOrigin:o.rotate2DToOrigin,rotate2DToPoint:o.rotate2DToPoint},getPlotBox:function(){var t=this.chart,i=t.inverted,n=this[i?"yAxis":"xAxis"],o=this[i?"xAxis":"yAxis"],e=n?n.len:t.plotWidth,r=o?o.len:t.plotHeight;return{translateX:(n?n.left:t.plotLeft)+e/2,translateY:(o?o.top:t.plotTop)+r/2,scaleX:1,scaleY:1}}},P={draw:n,shouldDraw:function(){return!this.isNull},isValid:function(){return!0},weight:1};t.seriesType("wordcloud","column",{allowExtendPlayingField:!0,animation:{duration:500},borderWidth:0,clip:!1,colorByPoint:!0,minFontSize:1,maxFontSize:25,placementStrategy:"center",rotation:{from:0,orientations:2,to:90},showInLegend:!1,spiral:"rectangular",style:{fontFamily:"sans-serif",fontWeight:"900",whiteSpace:"nowrap"},tooltip:{followPointer:!0,pointFormat:'<span style="color:{point.color}"></span> {series.name}: <b>{point.weight}</b><br/>'}},A,P)}),n(i,"masters/modules/wordcloud.src.js",[],function(){})});
!function(r){function t(r,t){for(var e,n,o=[],a=0,s=r.length-(t-1);a<s;a++){e=0;for(var i=0;i<t;i++)e+=r[a+i].y;n=e/t,o.push([r[a].x+(t-1),n])}return{equation:[1,1],points:o,string:"y = Ai + Ai+1"}}function e(r){var t=[0,0,0,0,0,0],e=0,n=[];for(g=r.length;e<g;e++)r[e].x&&(r[e][0]=r[e].x,r[e][1]=r[e].y),r[e][1]&&(t[0]+=r[e][0],t[1]+=r[e][1],t[2]+=r[e][0]*r[e][0]*r[e][1],t[3]+=r[e][1]*Math.log(r[e][1]),t[4]+=r[e][0]*r[e][1]*Math.log(r[e][1]),t[5]+=r[e][0]*r[e][1]);for(var o=t[1]*t[2]-t[5]*t[5],a=Math.pow(Math.E,(t[2]*t[3]-t[5]*t[4])/o),s=(t[1]*t[4]-t[5]*t[3])/o,i=0,g=r.length;i<g;i++){var h=[r[i][0],a*Math.pow(Math.E,s*r[i][0])];n.push(h)}return n.sort(function(r,t){return r[0]>t[0]?1:r[0]<t[0]?-1:0}),{equation:[a,s],points:n,string:"y = "+Math.round(100*a)/100+"e^("+Math.round(100*s)/100+"x)"}}function n(r){var t=[0,0,0,0,0],e=0,n=[];for(r.length;e<r.length;e++)r[e].x&&(r[e][0]=r[e].x,r[e][1]=r[e].y),r[e][1]&&(t[0]+=r[e][0],t[1]+=r[e][1],t[2]+=r[e][0]*r[e][0],t[3]+=r[e][0]*r[e][1],t[4]+=r[e][1]*r[e][1]);for(var o=(e*t[3]-t[0]*t[1])/(e*t[2]-t[0]*t[0]),a=t[1]/e-o*t[0]/e,s=0,i=r.length;s<i;s++){var g=[r[s][0],r[s][0]*o+a];n.push(g)}return n.sort(function(r,t){return r[0]>t[0]?1:r[0]<t[0]?-1:0}),{equation:[o,a],points:n,string:"y = "+Math.round(100*o)/100+"x + "+Math.round(100*a)/100}}function o(r){var t=[0,0,0,0],e=0,n=[];for(i=r.length;e<i;e++)r[e].x&&(r[e][0]=r[e].x,r[e][1]=r[e].y),r[e][1]&&(t[0]+=Math.log(r[e][0]),t[1]+=r[e][1]*Math.log(r[e][0]),t[2]+=r[e][1],t[3]+=Math.pow(Math.log(r[e][0]),2));for(var o=(e*t[1]-t[2]*t[0])/(e*t[3]-t[0]*t[0]),a=(t[2]-o*t[0])/e,s=0,i=r.length;s<i;s++){var g=[r[s][0],a+o*Math.log(r[s][0])];n.push(g)}return n.sort(function(r,t){return r[0]>t[0]?1:r[0]<t[0]?-1:0}),{equation:[a,o],points:n,string:"y = "+Math.round(100*a)/100+" + "+Math.round(100*o)/100+" ln(x)"}}function a(r){var t=[0,0,0,0],e=0,n=[];for(i=r.length;e<i;e++)r[e].x&&(r[e][0]=r[e].x,r[e][1]=r[e].y),r[e][1]&&(t[0]+=Math.log(r[e][0]),t[1]+=Math.log(r[e][1])*Math.log(r[e][0]),t[2]+=Math.log(r[e][1]),t[3]+=Math.pow(Math.log(r[e][0]),2));for(var o=(e*t[1]-t[2]*t[0])/(e*t[3]-t[0]*t[0]),a=Math.pow(Math.E,(t[2]-o*t[0])/e),s=0,i=r.length;s<i;s++){var g=[r[s][0],a*Math.pow(r[s][0],o)];n.push(g)}return n.sort(function(r,t){return r[0]>t[0]?1:r[0]<t[0]?-1:0}),{equation:[a,o],points:n,string:"y = "+Math.round(100*a)/100+"x^"+Math.round(100*o)/100}}function s(r,t){void 0===t&&(t=2);for(var e=[],n=[],o=[],a=0,s=0,i=0,g=t+1;i<g;i++){for(var h=0,l=r.length;h<l;h++)r[h].x&&(r[h][0]=r[h].x,r[h][1]=r[h].y),r[h][1]&&(a+=Math.pow(r[h][0],i)*r[h][1]);e.push(a),a=0;for(var u=[],f=0;f<g;f++){for(h=0,l=r.length;h<l;h++)r[h][1]&&(s+=Math.pow(r[h][0],i+f));u.push(s),s=0}n.push(u)}n.push(e);var p=function(r,t){var e=0,n=0,o=0,a=0,s=0,i=r.length-1,g=new Array(t);for(e=0;e<i;e++){for(a=e,n=e+1;n<i;n++)Math.abs(r[e][n])>Math.abs(r[e][a])&&(a=n);for(o=e;o<i+1;o++)s=r[o][e],r[o][e]=r[o][a],r[o][a]=s;for(n=e+1;n<i;n++)for(o=i;o>=e;o--)r[o][n]-=r[o][e]*r[e][n]/r[e][e]}for(n=i-1;n>=0;n--){for(s=0,o=n+1;o<i;o++)s+=r[o][n]*g[o];g[n]=(r[i][n]-s)/r[n][n]}return g}(n,g);for(i=0,l=r.length;i<l;i++){for(var d=0,v=0;v<p.length;v++)d+=p[v]*Math.pow(r[i][0],v);o.push([r[i][0],d])}o.sort(function(r,t){return r[0]>t[0]?1:r[0]<t[0]?-1:0});var M="y = ";for(i=p.length-1;i>=0;i--)M+=i>1?Math.round(100*p[i])/100+"x^"+i+" + ":1==i?Math.round(100*p[i])/100+"x + ":Math.round(100*p[i])/100;return{equation:p,points:o,string:M}}function i(r,t){t=t||.25;var e=r.map(function(r){return r[0]}),n=function(r){var t,e={},n=r.length,o=[];for(t=0;t<n;t+=1)e[r[t]]=r[t];for(t in e)o.push(e[t]);return o}(e);2/n.length>t&&(t=Math.min(2/n.length,1));var o=r.map(function(r){return r[1]});function a(r){var t=1-r*r*r;return t*t*t}var s=[],i=0,g=Math.floor(t*e.length)-1;for(var h in e){var l,u=e[h];h>0&&g<e.length-1&&e[g+1]-e[h]<e[h]-e[i]&&(i++,g++),l=e[h]-e[i]>e[g]-e[h]?i:g;for(var f=Math.abs(1/(e[l]-u)),p=0,d=0,v=0,M=0,c=0,S=i;S<=g;){var y=e[S],x=o[S],w=a((S<h?u-y:y-u)*f),m=y*w;p+=w,d+=m,v+=y*m,M+=x*w,c+=x*m,S++}var q,b=d/p,A=M/p,L=v/p,E=A-(q=L==b*b?0:(c/p-b*A)/(L-b*b))*b;s[h]=q*u+E}return{equation:"",points:e.map(function(r,t){return[r,s[t]]}),string:""}}function g(r,t){var e,n,o,a;for(e=n=o=a=0,e=0;e<r.length;e++)a+=r[e][1]/r.length;for(e=0;e<r.length;e++)o+=Math.pow(r[e][1]-t[e][1],2),n+=Math.pow(r[e][1]-a,2);return 1-o/n}r.wrap(r.Chart.prototype,"init",function(r){var h=arguments[1].series,l=arguments[1].legend,u=arguments[1].colors||[],f=[],p=0;for(p=0;p<h.length;p++){var d=h[p];if(d.regression&&!d.rendered){d.regressionSettings=d.regressionSettings||{},d.regressionSettings.tooltip=d.regressionSettings.tooltip||{},d.regressionSettings.dashStyle=d.regressionSettings.dashStyle||"solid",d.regressionSettings.showInLegend=d.regressionSettings.showInLegend||l.enabled;var v,M=d.regressionSettings.type||"linear",c={data:[],color:d.color,yAxis:d.yAxis,lineWidth:2,marker:{enabled:!1},isRegressionLine:!0,type:d.regressionSettings.linetype||"spline",name:d.regressionSettings.name||"Equation: %eq",color:d.regressionSettings.color||u[p]||"",dashStyle:d.regressionSettings.dashStyle||"solid",showInLegend:d.regressionSettings.showInLegend,tooltip:{valueSuffix:d.regressionSettings.tooltip.valueSuffix||" "}};if("linear"==M)v=n(d.data),c.type="line";else if("exponential"==M)v=e(d.data);else if("polynomial"==M){var S=d.regressionSettings.order||2;v=s(d.data,S)}else if("logarithmic"==M)v=o(d.data);else if("loess"==M){var y=d.regressionSettings.loessSmooth||25;v=i(d.data,y/100)}else if("power"==M)v=a(d.data);else{if("average"!=M)break;var x=d.regressionSettings.period||d.regressionSettings.order||2;v=t(d.data,x)}"average"!==M&&(v.rSquared=g(d.data,v.points).toFixed(2),v.rValue=Math.sqrt(v.rSquared,2).toFixed(2),c.name=c.name.replace("%r2",v.rSquared),c.name=c.name.replace("%r",v.rValue),c.name=c.name.replace("%eq",v.string)),c.data=v.points,c.regressionOutputs=v,f.push(c),arguments[1].series[p].rendered=!0}}arguments[1].series=h.concat(f),r.apply(this,Array.prototype.slice.call(arguments,1))})}(Highcharts);
!function(t){var i=void 0,e=Math.round,s=Math.min,a=Math.max,r=t.merge,o=t.pick,h=window.HighchartsAdapter&&window.HighchartsAdapter.inArray||t.inArray,n=t.Axis.prototype,l=t.Tick.prototype,c=n.init,p=n.render,d=n.setCategories,u=l.getLabelSize,g=l.addLabel,f=l.destroy,x=l.render;function b(t,i){return this.userOptions=S(t),this.name=t.name||t,this.parent=i,this}function y(t){for(var i=t.length,e=0;i--;)e+=t[i];return e}function v(t,i,e){for(t.unshift(new b(i,e));e;)e.leaves++||(e.leaves=1),e=e.parent}function k(t,i,s){i[0]===i[2]&&(i[0]=i[2]=e(i[0])-s%2/2),i[1]===i[3]&&(i[1]=i[3]=e(i[1])+s%2/2),t.push("M",i[0],i[1],"L",i[2],i[3])}function G(t,i){return t.getPosition(t.axis.horiz,i,t.axis.tickmarkOffset)}function z(t,i,e){for(var s,a=t.length;a--;)(s=t[a][i])&&z(s,i,e),e(t[a])}function S(t){return JSON.parse(JSON.stringify(t))}b.prototype.toString=function(){for(var t=[],i=this;i;)t.push(i.name),i=i.parent;return t.join(" ")},n.init=function(t,i){c.call(this,t,i),"object"==typeof i&&i.categories&&this.setupGroups(i)},n.setupGroups=function(t){var i,e=[],s={};(function t(i,e,s,r,o){var h,n=i.length;for(o||(o=0),s.depth||(s.depth=0);n--;)h=i[n],r&&"object"==typeof h&&(h.parent=r),h.categories?t(h.categories,e,s,h,o+1):v(e,h,r);s.depth=a(s.depth,o)})(i=S(t.categories),e,s),this.categoriesTree=i,this.categories=e,this.isGrouped=0!==s.depth,this.labelsDepth=s.depth,this.labelsSizes=[],this.labelsGridPath=[],this.tickLength=t.tickLength||this.tickLength||null,this.tickWidth=o(t.tickWidth,this.isXAxis?1:0),this.directionFactor=[-1,1,1,-1][this.side],this.options.lineWidth=o(t.lineWidth,1)},n.render=function(){if(this.isGrouped&&(this.labelsGridPath=[]),this.originalTickLength===i&&(this.originalTickLength=this.options.tickLength),this.options.tickLength=this.isGrouped?.001:this.originalTickLength,p.call(this),this.isGrouped){var t=this,e=t.options,s=t.top,a=t.left,r=a+t.width,o=s+t.height,h=t.hasVisibleSeries||("function"==typeof t.hasData?t.hasData():t.hasData),n=t.labelsDepth,l=t.labelsGrid,c=t.horiz,d=t.labelsGridPath,u=!1===e.drawHorizontalBorders?n+1:0,g=t.opposite?c?s:r:c?o:a,f=t.tickWidth;for(t.userTickLength&&(n-=1),l||(l=t.labelsGrid=t.chart.renderer.path().attr({strokeWidth:f,"stroke-width":f,stroke:e.tickColor}).add(t.axisGroup));u<=n;)g+=t.groupSize(u),c?[a,g,r,g]:[g,s,g,o],u++;l.attr({d:d,visibility:h?"visible":"hidden"}),t.labelGroup.attr({visibility:h?"visible":"hidden"}),z(t.categoriesTree,"categories",function(i){var e=i.tick;e&&(e.startAt+e.leaves-1<t.min||e.startAt>t.max?(e.label.hide(),e.destroyed=0):e.label.attr({visibility:h?"visible":"hidden"}))})}else this.labelsGrid&&this.labelsGrid.attr({visibility:"hidden"})},n.setCategories=function(t,i){this.categories&&this.cleanGroups(),this.setupGroups({categories:t}),this.categories=this.userOptions.categories=t,d.call(this,this.categories,i)},n.cleanGroups=function(){var t,i=this.ticks;for(t in i)i[t].parent&&delete i[t].parent;z(this.categoriesTree,"categories",function(t){var i,e=t.tick;if(e){for(i in e.label.destroy(),e)delete e[i];delete t.tick}}),this.labelsGrid=null},n.groupSize=function(t,e){var s=this.labelsSizes,r=this.directionFactor,o=!!this.options.labels.groupedOptions&&this.options.labels.groupedOptions[t-1],h=0;return o&&(h=-1==r?o.x?o.x:0:o.y?o.y:0),e!==i&&(s[t]=a(s[t]||0,e+10+Math.abs(h))),!0===t?y(s)*r:s[t]?s[t]*r:0},l.addLabel=function(){var t;g.call(this),this.axis.categories&&(t=this.axis.categories[this.pos])&&(this.label&&this.label.attr("text",this.axis.labelFormatter.call({axis:this.axis,chart:this.axis.chart,isFirst:this.isFirst,isLast:this.isLast,value:t.name})),this.axis.isGrouped&&this.axis.options.labels.enabled&&this.addGroupedLabels(t))},l.addGroupedLabels=function(t){for(var i,e,s,a,o=this,h=this.axis,n=h.chart,l=h.options.labels,c=l.useHTML,p=l.style,d=l.groupedOptions,u={align:"center",rotation:l.rotation,x:0,y:0},g=h.horiz?"height":"width",f=0;o;){if(f>0&&!t.tick){this.value=t.name;var x=l.formatter?l.formatter.call(this,t):t.name,b=d&&d[f-1],y=b?r(u,d[f-1]):u,v=b&&d[f-1].style?r(p,d[f-1].style):p;delete y.style,e=this.axis.width/this.axis.categories.length*t.leaves-20,s=0==(s=(s=parseInt(v.fontSize)*x.length)>e?s-e:0)?0:s/parseInt(v.fontSize),a=x=x.trim(),x=(x=x.substring(0,x.length-s)).split("...")[0],x+=a!=x&&-1===x.indexOf("...")?"...":"",i=n.renderer.text(x,0,0,!0|c).attr(y).css(v).add(h.labelGroup),o.startAt=this.pos,o.childCount=t.categories.length,o.leaves=t.leaves,o.visible=this.childCount,o.label=i,-1!==n.options.chart.type.indexOf("bar")?o.labelOffsets={x:y.x-5,y:y.y}:o.labelOffsets={x:y.x,y:y.y+10},t.tick=o}h.groupSize(f,o.label.getBBox()[g]),o=(t=t.parent)?o.parent=t.tick||{}:null,f++}},l.render=function(t,i,e){x.call(this,t,i,e);var r=this.axis.categories[this.pos];if(this.axis.isGrouped&&r&&!(this.pos>this.axis.max)){var o,n,l,c,p,d=this,u=this.axis,g=this.pos,f=this.isFirst,b=u.max,y=u.min,v=u.horiz,z=(u.categories[g],u.labelsGridPath),S=u.groupSize(0),m=(u.tickLength,u.tickWidth),L=(u.directionFactor,G(this,g)),O=v?L.y:L.x,A=u.chart.renderer.fontMetrics(u.options.labels.style.fontSize).b,w=1,T=v&&L.x===u.pos+u.len||!v&&L.y===u.pos?-1:0;for(f&&k(z,v?[u.left,L.y,u.left,L.y+u.groupSize(!0)]:u.isXAxis?[L.x,u.top,L.x+u.groupSize(!0),u.top]:[L.x,u.top+u.len,L.x+u.groupSize(!0),u.top+u.len],m),v&&u.left<L.x?k(z,[L.x-T,L.y,L.x-T,L.y+S],m):!v&&u.top<=L.y&&k(z,[L.x,L.y+T,L.x+S,L.y+T],m),S=O+S;d=d.parent;){var F=N(0,r),M=d.labelOffsets.x,W=d.labelOffsets.y;n=G(this,a(d.startAt-1,y-1)),l=G(this,s(d.startAt+d.leaves-1-F,b)),p=d.label.getBBox(0),o=u.groupSize(w),T=v&&l.x===u.pos+u.len||!v&&l.y===u.pos?-1:0,c=v?{x:(n.x+l.x)/2+M,y:S+o/2+A-p.height/2-4+W/2}:{x:S+o/2+M,y:(n.y+l.y-p.height)/2+A+W},isNaN(c.x)||isNaN(c.y)||(d.label.attr(c),z&&(v&&u.left<l.x?k(z,[l.x-T,S,l.x-T,S+o],m):!v&&u.top<=l.y&&k(z,[S,l.y+T,S+o,l.y+T],m))),S+=o,w++}}function N(t,i,e){var s=0;return f?s=(s=h(i.name,i.parent.categories))<0?0:s:s}},l.destroy=function(){for(var t=this;t=t.parent;)t.destroyed++||(t.destroyed=1);f.call(this)},l.getLabelSize=function(){if(!0===this.axis.isGrouped){var t=u.call(this)+10;return this.axis.labelsSizes[0]<t&&(this.axis.labelsSizes[0]=t),y(this.axis.labelsSizes)}return u.call(this)}}(Highcharts);
function RGBColor(e){this.ok=!1,"#"==e.charAt(0)&&(e=e.substr(1,6)),e=(e=e.replace(/ /g,"")).toLowerCase();var f={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var a in f)e==a&&(e=f[a]);for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}],t=0;t<r.length;t++){var d=r[t].re,l=r[t].process,i=d.exec(e);if(i){var n=l(i);this.r=n[0],this.g=n[1],this.b=n[2],this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var e=this.r.toString(16),f=this.g.toString(16),a=this.b.toString(16);return 1==e.length&&(e="0"+e),1==f.length&&(f="0"+f),1==a.length&&(a="0"+a),"#"+e+f+a},this.getHelpXML=function(){for(var e=new Array,a=0;a<r.length;a++)for(var t=r[a].example,d=0;d<t.length;d++)e[e.length]=t[d];for(var l in f)e[e.length]=l;var i=document.createElement("ul");i.setAttribute("id","rgbcolor-examples");for(a=0;a<e.length;a++)try{var n=document.createElement("li"),o=new RGBColor(e[a]),s=document.createElement("div");s.style.cssText="margin: 3px; border: 1px solid black; background:"+o.toHex()+"; color:"+o.toHex(),s.appendChild(document.createTextNode("test"));var c=document.createTextNode(" "+e[a]+" -> "+o.toRGB()+" -> "+o.toHex());n.appendChild(s),n.appendChild(c),i.appendChild(n)}catch(e){}return i}}
!function(t,e){"undefined"!=typeof define&&define.amd?define("canvgModule",["rgbcolor","stackblur"],e):"undefined"!=typeof module&&module.exports&&(module.exports=e(require("rgbcolor"),require("stackblur"))),t.canvg=e(t.RGBColor,t.stackBlur)}("undefined"!=typeof window?window:this,function(t,e){var i,n=function(s,a,r){if(null!=s||null!=a||null!=r){"string"==typeof s&&(s=document.getElementById(s)),null!=s.svg&&s.svg.stop();var o=function(n){var s={opts:n,FRAMERATE:30,MAX_VIRTUAL_PIXELS:3e4,log:function(t){}};1==s.opts.log&&"undefined"!=typeof console&&(s.log=function(t){});s.init=function(t){var e=0;s.UniqueId=function(){return"canvg"+ ++e},s.Definitions={},s.Styles={},s.StylesSpecificity={},s.Animations=[],s.Images=[],s.ctx=t,s.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(t,e){this.viewPorts.push({width:t,height:e})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(t){return null!=t&&"number"==typeof t?t:"x"==t?this.width():"y"==t?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},s.init(),s.ImagesLoaded=function(){for(var t=0;t<s.Images.length;t++)if(!s.Images[t].loaded)return!1;return!0},s.trim=function(t){return(t=t||"").replace(/^\s+|\s+$/g,"")},s.compressSpaces=function(t){return t.replace(/[\s\r\t\n]+/gm," ")},s.ajax=function(t){var e;return(e=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"))?(e.open("GET",t,!1),e.send(null),e.responseText):null},s.parseXml=function(t){if("undefined"!=typeof Windows&&void 0!==Windows.Data&&void 0!==Windows.Data.Xml){var e=new Windows.Data.Xml.Dom.XmlDocument,i=new Windows.Data.Xml.Dom.XmlLoadSettings;return i.prohibitDtd=!1,e.loadXml(t,i),e}if(!window.DOMParser){t=t.replace(/<!DOCTYPE svg[^>]*>/,"");var e=new ActiveXObject("Microsoft.XMLDOM");return e.async="false",e.loadXML(t),e}try{var n=new DOMParser;return n.parseFromString(t,"image/svg+xml")}catch(e){return(n=new DOMParser).parseFromString(t,"text/xml")}},s.Property=function(t,e){this.name=t,this.value=e},s.Property.prototype.getValue=function(){return this.value},s.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},s.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var t=parseFloat(this.value);return(this.value+"").match(/%$/)&&(t/=100),t},s.Property.prototype.valueOrDefault=function(t){return this.hasValue()?this.value:t},s.Property.prototype.numValueOrDefault=function(t){return this.hasValue()?this.numValue():t},s.Property.prototype.addOpacity=function(e){var i=this.value;if(null!=e.value&&""!=e.value&&"string"==typeof this.value){var n=new t(this.value);n.ok&&(i="rgba("+n.r+", "+n.g+", "+n.b+", "+e.numValue()+")")}return new s.Property(this.name,i)},s.Property.prototype.getDefinition=function(){var t=this.value.match(/#([^\)'"]+)/);return t&&(t=t[1]),t||(t=this.value),s.Definitions[t]},s.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},s.Property.prototype.getFillStyleDefinition=function(t,e){var i=this.getDefinition();if(null!=i&&i.createGradient)return i.createGradient(s.ctx,t,e);if(null!=i&&i.createPattern){if(i.getHrefAttribute().hasValue()){var n=i.attribute("patternTransform");i=i.getHrefAttribute().getDefinition(),n.hasValue()&&(i.attribute("patternTransform",!0).value=n.value)}return i.createPattern(s.ctx,t)}return null},s.Property.prototype.getDPI=function(t){return 96},s.Property.prototype.getEM=function(t){var e=12,i=new s.Property("fontSize",s.Font.Parse(s.ctx.font).fontSize);return i.hasValue()&&(e=i.toPixels(t)),e},s.Property.prototype.getUnits=function(){var t=this.value+"";return t.replace(/[0-9\.\-]/g,"")},s.Property.prototype.toPixels=function(t,e){if(!this.hasValue())return 0;var i=this.value+"";if(i.match(/em$/))return this.numValue()*this.getEM(t);if(i.match(/ex$/))return this.numValue()*this.getEM(t)/2;if(i.match(/px$/))return this.numValue();if(i.match(/pt$/))return this.numValue()*this.getDPI(t)*(1/72);if(i.match(/pc$/))return 15*this.numValue();if(i.match(/cm$/))return this.numValue()*this.getDPI(t)/2.54;if(i.match(/mm$/))return this.numValue()*this.getDPI(t)/25.4;if(i.match(/in$/))return this.numValue()*this.getDPI(t);if(i.match(/%$/))return this.numValue()*s.ViewPort.ComputeSize(t);var n=this.numValue();return e&&n<1?n*s.ViewPort.ComputeSize(t):n},s.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var t=this.value+"";return t.match(/s$/)?1e3*this.numValue():(t.match(/ms$/),this.numValue())},s.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var t=this.value+"";return t.match(/deg$/)?this.numValue()*(Math.PI/180):t.match(/grad$/)?this.numValue()*(Math.PI/200):t.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)};var a={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};return s.Property.prototype.toTextBaseline=function(){return this.hasValue()?a[this.value]:null},s.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(t,e,i,n,a,r){var o=null!=r?this.Parse(r):this.CreateFont("","","","","",s.ctx.font);return{fontFamily:a||o.fontFamily,fontSize:n||o.fontSize,fontStyle:t||o.fontStyle,fontWeight:i||o.fontWeight,fontVariant:e||o.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var t=this;this.Parse=function(e){for(var i={},n=s.trim(s.compressSpaces(e||"")).split(" "),a={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},r="",o=0;o<n.length;o++)a.fontStyle||-1==t.Styles.indexOf(n[o])?a.fontVariant||-1==t.Variants.indexOf(n[o])?a.fontWeight||-1==t.Weights.indexOf(n[o])?a.fontSize?"inherit"!=n[o]&&(r+=n[o]):("inherit"!=n[o]&&(i.fontSize=n[o].split("/")[0]),a.fontStyle=a.fontVariant=a.fontWeight=a.fontSize=!0):("inherit"!=n[o]&&(i.fontWeight=n[o]),a.fontStyle=a.fontVariant=a.fontWeight=!0):("inherit"!=n[o]&&(i.fontVariant=n[o]),a.fontStyle=a.fontVariant=!0):("inherit"!=n[o]&&(i.fontStyle=n[o]),a.fontStyle=!0);return""!=r&&(i.fontFamily=r),i}},s.ToNumberArray=function(t){for(var e=s.trim(s.compressSpaces((t||"").replace(/,/g," "))).split(" "),i=0;i<e.length;i++)e[i]=parseFloat(e[i]);return e},s.Point=function(t,e){this.x=t,this.y=e},s.Point.prototype.angleTo=function(t){return Math.atan2(t.y-this.y,t.x-this.x)},s.Point.prototype.applyTransform=function(t){var e=this.x*t[0]+this.y*t[2]+t[4],i=this.x*t[1]+this.y*t[3]+t[5];this.x=e,this.y=i},s.CreatePoint=function(t){var e=s.ToNumberArray(t);return new s.Point(e[0],e[1])},s.CreatePath=function(t){for(var e=s.ToNumberArray(t),i=[],n=0;n<e.length;n+=2)i.push(new s.Point(e[n],e[n+1]));return i},s.BoundingBox=function(t,e,i,n){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(t,e){null!=t&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),null!=e&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))},this.addX=function(t){this.addPoint(t,null)},this.addY=function(t){this.addPoint(null,t)},this.addBoundingBox=function(t){this.addPoint(t.x1,t.y1),this.addPoint(t.x2,t.y2)},this.addQuadraticCurve=function(t,e,i,n,s,a){var r=t+2/3*(i-t),o=e+2/3*(n-e),h=r+1/3*(s-t),l=o+1/3*(a-e);this.addBezierCurve(t,e,r,h,o,l,s,a)},this.addBezierCurve=function(t,e,i,n,s,a,r,o){var h=[t,e],l=[i,n],u=[s,a],c=[r,o];this.addPoint(h[0],h[1]),this.addPoint(c[0],c[1]);for(var p=0;p<=1;p++){var f=function(t){return Math.pow(1-t,3)*h[p]+3*Math.pow(1-t,2)*t*l[p]+3*(1-t)*Math.pow(t,2)*u[p]+Math.pow(t,3)*c[p]},m=6*h[p]-12*l[p]+6*u[p],d=-3*h[p]+9*l[p]-9*u[p]+3*c[p],y=3*l[p]-3*h[p];if(0!=d){var v=Math.pow(m,2)-4*y*d;if(!(v<0)){var g=(-m+Math.sqrt(v))/(2*d);0<g&&g<1&&(0==p&&this.addX(f(g)),1==p&&this.addY(f(g)));var x=(-m-Math.sqrt(v))/(2*d);0<x&&x<1&&(0==p&&this.addX(f(x)),1==p&&this.addY(f(x)))}}else{if(0==m)continue;var b=-y/m;0<b&&b<1&&(0==p&&this.addX(f(b)),1==p&&this.addY(f(b)))}}},this.isPointInBox=function(t,e){return this.x1<=t&&t<=this.x2&&this.y1<=e&&e<=this.y2},this.addPoint(t,e),this.addPoint(i,n)},s.Transform=function(t){var e=this;this.Type={},this.Type.translate=function(t){this.p=s.CreatePoint(t),this.apply=function(t){t.translate(this.p.x||0,this.p.y||0)},this.unapply=function(t){t.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(t){t.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(t){var e=s.ToNumberArray(t);this.angle=new s.Property("angle",e[0]),this.cx=e[1]||0,this.cy=e[2]||0,this.apply=function(t){t.translate(this.cx,this.cy),t.rotate(this.angle.toRadians()),t.translate(-this.cx,-this.cy)},this.unapply=function(t){t.translate(this.cx,this.cy),t.rotate(-1*this.angle.toRadians()),t.translate(-this.cx,-this.cy)},this.applyToPoint=function(t){var e=this.angle.toRadians();t.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),t.applyTransform([Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0]),t.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(t){this.p=s.CreatePoint(t),this.apply=function(t){t.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(t){t.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(t){t.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(t){this.m=s.ToNumberArray(t),this.apply=function(t){t.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.unapply=function(t){var e=this.m[0],i=this.m[2],n=this.m[4],s=this.m[1],a=this.m[3],r=this.m[5],o=1/(e*(1*a-0*r)-i*(1*s-0*r)+n*(0*s-0*a));t.transform(o*(1*a-0*r),o*(0*r-1*s),o*(0*n-1*i),o*(1*e-0*n),o*(i*r-n*a),o*(n*s-e*r))},this.applyToPoint=function(t){t.applyTransform(this.m)}},this.Type.SkewBase=function(t){this.base=e.Type.matrix,this.base(t),this.angle=new s.Property("angle",t)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(t){this.base=e.Type.SkewBase,this.base(t),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(t){this.base=e.Type.SkewBase,this.base(t),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(t){for(var e=0;e<this.transforms.length;e++)this.transforms[e].apply(t)},this.unapply=function(t){for(var e=this.transforms.length-1;e>=0;e--)this.transforms[e].unapply(t)},this.applyToPoint=function(t){for(var e=0;e<this.transforms.length;e++)this.transforms[e].applyToPoint(t)};for(var i=s.trim(s.compressSpaces(t)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),n=0;n<i.length;n++){var a=s.trim(i[n].split("(")[0]),r=i[n].split("(")[1].replace(")",""),o=this.Type[a];if(void 0!==o){var h=new o(r);h.type=a,this.transforms.push(h)}}},s.AspectRatio=function(t,e,i,n,a,r,o,h,l,u){var c=(e=(e=s.compressSpaces(e)).replace(/^defer\s/,"")).split(" ")[0]||"xMidYMid",p=e.split(" ")[1]||"meet",f=i/n,m=a/r,d=Math.min(f,m),y=Math.max(f,m);"meet"==p&&(n*=d,r*=d),"slice"==p&&(n*=y,r*=y),l=new s.Property("refX",l),u=new s.Property("refY",u),l.hasValue()&&u.hasValue()?t.translate(-d*l.toPixels("x"),-d*u.toPixels("y")):(c.match(/^xMid/)&&("meet"==p&&d==m||"slice"==p&&y==m)&&t.translate(i/2-n/2,0),c.match(/YMid$/)&&("meet"==p&&d==f||"slice"==p&&y==f)&&t.translate(0,a/2-r/2),c.match(/^xMax/)&&("meet"==p&&d==m||"slice"==p&&y==m)&&t.translate(i-n,0),c.match(/YMax$/)&&("meet"==p&&d==f||"slice"==p&&y==f)&&t.translate(0,a-r)),"none"==c?t.scale(f,m):"meet"==p?t.scale(d,d):"slice"==p&&t.scale(y,y),t.translate(null==o?0:-o,null==h?0:-h)},s.Element={},s.EmptyProperty=new s.Property("EMPTY",""),s.Element.ElementBase=function(t){this.attributes={},this.styles={},this.stylesSpecificity={},this.children=[],this.attribute=function(t,e){var i=this.attributes[t];return null!=i?i:(1==e&&(i=new s.Property(t,""),this.attributes[t]=i),i||s.EmptyProperty)},this.getHrefAttribute=function(){for(var t in this.attributes)if("href"==t||t.match(/:href$/))return this.attributes[t];return s.EmptyProperty},this.style=function(t,e,i){var n=this.styles[t];if(null!=n)return n;var a=this.attribute(t);if(null!=a&&a.hasValue())return this.styles[t]=a,a;if(1!=i){var r=this.parent;if(null!=r){var o=r.style(t);if(null!=o&&o.hasValue())return o}}return 1==e&&(n=new s.Property(t,""),this.styles[t]=n),n||s.EmptyProperty},this.render=function(t){if("none"!=this.style("display").value&&"hidden"!=this.style("visibility").value){if(t.save(),this.style("mask").hasValue()){var e=this.style("mask").getDefinition();null!=e&&e.apply(t,this)}else if(this.style("filter").hasValue()){var i=this.style("filter").getDefinition();null!=i&&i.apply(t,this)}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}},this.setContext=function(t){},this.clearContext=function(t){},this.renderChildren=function(t){for(var e=0;e<this.children.length;e++)this.children[e].render(t)},this.addChild=function(t,e){var i=t;e&&(i=s.CreateElement(t)),i.parent=this,"title"!=i.type&&this.children.push(i)},this.addStylesFromStyleDefinition=function(){for(var e in s.Styles)if("@"!=e[0]&&i(t,e)){var n=s.Styles[e],a=s.StylesSpecificity[e];if(null!=n)for(var r in n){var o=this.stylesSpecificity[r];void 0===o&&(o="000"),a>o&&(this.styles[r]=n[r],this.stylesSpecificity[r]=a)}}};var e=new RegExp("^[A-Z-]+$"),n=function(t){return e.test(t)?t.toLowerCase():t};if(null!=t&&1==t.nodeType){for(var a=0;a<t.attributes.length;a++){var r=t.attributes[a],o=n(r.nodeName);this.attributes[o]=new s.Property(o,r.value)}if(this.addStylesFromStyleDefinition(),this.attribute("style").hasValue()){var h=this.attribute("style").value.split(";");for(a=0;a<h.length;a++)if(""!=s.trim(h[a])){var l=h[a].split(":"),u=s.trim(l[0]),c=s.trim(l[1]);this.styles[u]=new s.Property(u,c)}}for(this.attribute("id").hasValue()&&null==s.Definitions[this.attribute("id").value]&&(s.Definitions[this.attribute("id").value]=this),a=0;a<t.childNodes.length;a++){var p=t.childNodes[a];if(1==p.nodeType&&this.addChild(p,!0),this.captureTextNodes&&(3==p.nodeType||4==p.nodeType)){var f=p.value||p.text||p.textContent||"";""!=s.compressSpaces(f)&&this.addChild(new s.Element.tspan(p),!1)}}}},s.Element.RenderedElementBase=function(t){this.base=s.Element.ElementBase,this.base(t),this.setContext=function(t){var e;if(this.style("fill").isUrlDefinition())null!=(e=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity")))&&(t.fillStyle=e);else if(this.style("fill").hasValue()){var i;"currentColor"==(i=this.style("fill")).value&&(i.value=this.style("color").value),"inherit"!=i.value&&(t.fillStyle="none"==i.value?"rgba(0,0,0,0)":i.value)}if(this.style("fill-opacity").hasValue()&&(i=(i=new s.Property("fill",t.fillStyle)).addOpacity(this.style("fill-opacity")),t.fillStyle=i.value),this.style("stroke").isUrlDefinition())null!=(e=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity")))&&(t.strokeStyle=e);else if(this.style("stroke").hasValue()){var n;"currentColor"==(n=this.style("stroke")).value&&(n.value=this.style("color").value),"inherit"!=n.value&&(t.strokeStyle="none"==n.value?"rgba(0,0,0,0)":n.value)}if(this.style("stroke-opacity").hasValue()&&(n=(n=new s.Property("stroke",t.strokeStyle)).addOpacity(this.style("stroke-opacity")),t.strokeStyle=n.value),this.style("stroke-width").hasValue()){var a=this.style("stroke-width").toPixels();t.lineWidth=0==a?.001:a}if(this.style("stroke-linecap").hasValue()&&(t.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(t.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(t.miterLimit=this.style("stroke-miterlimit").value),this.style("stroke-dasharray").hasValue()&&"none"!=this.style("stroke-dasharray").value){var r=s.ToNumberArray(this.style("stroke-dasharray").value);void 0!==t.setLineDash?t.setLineDash(r):void 0!==t.webkitLineDash?t.webkitLineDash=r:void 0===t.mozDash||1==r.length&&0==r[0]||(t.mozDash=r);var o=this.style("stroke-dashoffset").numValueOrDefault(1);void 0!==t.lineDashOffset?t.lineDashOffset=o:void 0!==t.webkitLineDashOffset?t.webkitLineDashOffset=o:void 0!==t.mozDashOffset&&(t.mozDashOffset=o)}if(void 0!==t.font&&(t.font=s.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString()),this.style("transform",!1,!0).hasValue()&&new s.Transform(this.style("transform",!1,!0).value).apply(t),this.style("clip-path",!1,!0).hasValue()){var h=this.style("clip-path",!1,!0).getDefinition();null!=h&&h.apply(t)}this.style("opacity").hasValue()&&(t.globalAlpha=this.style("opacity").numValue())}},s.Element.RenderedElementBase.prototype=new s.Element.ElementBase,s.Element.PathElementBase=function(t){this.base=s.Element.RenderedElementBase,this.base(t),this.path=function(t){return null!=t&&t.beginPath(),new s.BoundingBox},this.renderChildren=function(t){this.path(t),s.Mouse.checkPath(this,t),""!=t.fillStyle&&("inherit"!=this.style("fill-rule").valueOrDefault("inherit")?t.fill(this.style("fill-rule").value):t.fill()),""!=t.strokeStyle&&t.stroke();var e=this.getMarkers();if(null!=e){if(this.style("marker-start").isUrlDefinition()&&(i=this.style("marker-start").getDefinition()).render(t,e[0][0],e[0][1]),this.style("marker-mid").isUrlDefinition())for(var i=this.style("marker-mid").getDefinition(),n=1;n<e.length-1;n++)i.render(t,e[n][0],e[n][1]);this.style("marker-end").isUrlDefinition()&&(i=this.style("marker-end").getDefinition()).render(t,e[e.length-1][0],e[e.length-1][1])}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},s.Element.PathElementBase.prototype=new s.Element.RenderedElementBase,s.Element.svg=function(t){this.base=s.Element.RenderedElementBase,this.base(t),this.baseClearContext=this.clearContext,this.clearContext=function(t){this.baseClearContext(t),s.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(t){t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4,void 0!==t.font&&void 0!==window.getComputedStyle&&(t.font=window.getComputedStyle(t.canvas).getPropertyValue("font")),this.baseSetContext(t),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),t.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var e=s.ViewPort.width(),i=s.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),void 0===this.root){e=this.attribute("width").toPixels("x"),i=this.attribute("height").toPixels("y");var n=0,a=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(n=-this.attribute("refX").toPixels("x"),a=-this.attribute("refY").toPixels("y")),"visible"!=this.attribute("overflow").valueOrDefault("hidden")&&(t.beginPath(),t.moveTo(n,a),t.lineTo(e,a),t.lineTo(e,i),t.lineTo(n,i),t.closePath(),t.clip())}if(s.ViewPort.SetCurrent(e,i),this.attribute("viewBox").hasValue()){var r=s.ToNumberArray(this.attribute("viewBox").value),o=r[0],h=r[1];e=r[2],i=r[3],s.AspectRatio(t,this.attribute("preserveAspectRatio").value,s.ViewPort.width(),e,s.ViewPort.height(),i,o,h,this.attribute("refX").value,this.attribute("refY").value),s.ViewPort.RemoveCurrent(),s.ViewPort.SetCurrent(r[2],r[3])}}},s.Element.svg.prototype=new s.Element.RenderedElementBase,s.Element.rect=function(t){this.base=s.Element.PathElementBase,this.base(t),this.path=function(t){var e=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),n=this.attribute("width").toPixels("x"),a=this.attribute("height").toPixels("y"),r=this.attribute("rx").toPixels("x"),o=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(o=r),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(r=o),r=Math.min(r,n/2),o=Math.min(o,a/2),null!=t&&(t.beginPath(),t.moveTo(e+r,i),t.lineTo(e+n-r,i),t.quadraticCurveTo(e+n,i,e+n,i+o),t.lineTo(e+n,i+a-o),t.quadraticCurveTo(e+n,i+a,e+n-r,i+a),t.lineTo(e+r,i+a),t.quadraticCurveTo(e,i+a,e,i+a-o),t.lineTo(e,i+o),t.quadraticCurveTo(e,i,e+r,i),t.closePath()),new s.BoundingBox(e,i,e+n,i+a)}},s.Element.rect.prototype=new s.Element.PathElementBase,s.Element.circle=function(t){this.base=s.Element.PathElementBase,this.base(t),this.path=function(t){var e=this.attribute("cx").toPixels("x"),i=this.attribute("cy").toPixels("y"),n=this.attribute("r").toPixels();return null!=t&&(t.beginPath(),t.arc(e,i,n,0,2*Math.PI,!0),t.closePath()),new s.BoundingBox(e-n,i-n,e+n,i+n)}},s.Element.circle.prototype=new s.Element.PathElementBase,s.Element.ellipse=function(t){this.base=s.Element.PathElementBase,this.base(t),this.path=function(t){var e=(Math.sqrt(2)-1)/3*4,i=this.attribute("rx").toPixels("x"),n=this.attribute("ry").toPixels("y"),a=this.attribute("cx").toPixels("x"),r=this.attribute("cy").toPixels("y");return null!=t&&(t.beginPath(),t.moveTo(a,r-n),t.bezierCurveTo(a+e*i,r-n,a+i,r-e*n,a+i,r),t.bezierCurveTo(a+i,r+e*n,a+e*i,r+n,a,r+n),t.bezierCurveTo(a-e*i,r+n,a-i,r+e*n,a-i,r),t.bezierCurveTo(a-i,r-e*n,a-e*i,r-n,a,r-n),t.closePath()),new s.BoundingBox(a-i,r-n,a+i,r+n)}},s.Element.ellipse.prototype=new s.Element.PathElementBase,s.Element.line=function(t){this.base=s.Element.PathElementBase,this.base(t),this.getPoints=function(){return[new s.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new s.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(t){var e=this.getPoints();return null!=t&&(t.beginPath(),t.moveTo(e[0].x,e[0].y),t.lineTo(e[1].x,e[1].y)),new s.BoundingBox(e[0].x,e[0].y,e[1].x,e[1].y)},this.getMarkers=function(){var t=this.getPoints(),e=t[0].angleTo(t[1]);return[[t[0],e],[t[1],e]]}},s.Element.line.prototype=new s.Element.PathElementBase,s.Element.polyline=function(t){this.base=s.Element.PathElementBase,this.base(t),this.points=s.CreatePath(this.attribute("points").value),this.path=function(t){var e=new s.BoundingBox(this.points[0].x,this.points[0].y);null!=t&&(t.beginPath(),t.moveTo(this.points[0].x,this.points[0].y));for(var i=1;i<this.points.length;i++)e.addPoint(this.points[i].x,this.points[i].y),null!=t&&t.lineTo(this.points[i].x,this.points[i].y);return e},this.getMarkers=function(){for(var t=[],e=0;e<this.points.length-1;e++)t.push([this.points[e],this.points[e].angleTo(this.points[e+1])]);return t.length>0&&t.push([this.points[this.points.length-1],t[t.length-1][1]]),t}},s.Element.polyline.prototype=new s.Element.PathElementBase,s.Element.polygon=function(t){this.base=s.Element.polyline,this.base(t),this.basePath=this.path,this.path=function(t){var e=this.basePath(t);return null!=t&&(t.lineTo(this.points[0].x,this.points[0].y),t.closePath()),e}},s.Element.polygon.prototype=new s.Element.polyline,s.Element.path=function(t){this.base=s.Element.PathElementBase,this.base(t);var e=this.attribute("d").value;e=e.replace(/,/gm," ");for(var i=0;i<2;i++)e=e.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");for(e=(e=e.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2")).replace(/([0-9])([+\-])/gm,"$1 $2"),i=0;i<2;i++)e=e.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");e=e.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),e=s.compressSpaces(e),e=s.trim(e),this.PathParser=new function(t){this.tokens=t.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new s.Point(0,0),this.control=new s.Point(0,0),this.current=new s.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return!!this.isEnd()||null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var t=new s.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(t)},this.getAsControlPoint=function(){var t=this.getPoint();return this.control=t,t},this.getAsCurrentPoint=function(){var t=this.getPoint();return this.current=t,t},this.getReflectedControlPoint=function(){return"c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase()?this.current:new s.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y)},this.makeAbsolute=function(t){return this.isRelativeCommand()&&(t.x+=this.current.x,t.y+=this.current.y),t},this.addMarker=function(t,e,i){null!=i&&this.angles.length>0&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(i)),this.addMarkerAngle(t,null==e?null:e.angleTo(t))},this.addMarkerAngle=function(t,e){this.points.push(t),this.angles.push(e)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var t=0;t<this.angles.length;t++)if(null==this.angles[t])for(var e=t+1;e<this.angles.length;e++)if(null!=this.angles[e]){this.angles[t]=this.angles[e];break}return this.angles}}(e),this.path=function(t){var e=this.PathParser;e.reset();var i=new s.BoundingBox;for(null!=t&&t.beginPath();!e.isEnd();)switch(e.nextCommand(),e.command){case"M":case"m":var n=e.getAsCurrentPoint();for(e.addMarker(n),i.addPoint(n.x,n.y),null!=t&&t.moveTo(n.x,n.y),e.start=e.current;!e.isCommandOrEnd();)n=e.getAsCurrentPoint(),e.addMarker(n,e.start),i.addPoint(n.x,n.y),null!=t&&t.lineTo(n.x,n.y);break;case"L":case"l":for(;!e.isCommandOrEnd();){var a=e.current;n=e.getAsCurrentPoint(),e.addMarker(n,a),i.addPoint(n.x,n.y),null!=t&&t.lineTo(n.x,n.y)}break;case"H":case"h":for(;!e.isCommandOrEnd();){var r=new s.Point((e.isRelativeCommand()?e.current.x:0)+e.getScalar(),e.current.y);e.addMarker(r,e.current),e.current=r,i.addPoint(e.current.x,e.current.y),null!=t&&t.lineTo(e.current.x,e.current.y)}break;case"V":case"v":for(;!e.isCommandOrEnd();)r=new s.Point(e.current.x,(e.isRelativeCommand()?e.current.y:0)+e.getScalar()),e.addMarker(r,e.current),e.current=r,i.addPoint(e.current.x,e.current.y),null!=t&&t.lineTo(e.current.x,e.current.y);break;case"C":case"c":for(;!e.isCommandOrEnd();){var o=e.current,h=e.getPoint(),l=e.getAsControlPoint(),u=e.getAsCurrentPoint();e.addMarker(u,l,h),i.addBezierCurve(o.x,o.y,h.x,h.y,l.x,l.y,u.x,u.y),null!=t&&t.bezierCurveTo(h.x,h.y,l.x,l.y,u.x,u.y)}break;case"S":case"s":for(;!e.isCommandOrEnd();)o=e.current,h=e.getReflectedControlPoint(),l=e.getAsControlPoint(),u=e.getAsCurrentPoint(),e.addMarker(u,l,h),i.addBezierCurve(o.x,o.y,h.x,h.y,l.x,l.y,u.x,u.y),null!=t&&t.bezierCurveTo(h.x,h.y,l.x,l.y,u.x,u.y);break;case"Q":case"q":for(;!e.isCommandOrEnd();)o=e.current,l=e.getAsControlPoint(),u=e.getAsCurrentPoint(),e.addMarker(u,l,l),i.addQuadraticCurve(o.x,o.y,l.x,l.y,u.x,u.y),null!=t&&t.quadraticCurveTo(l.x,l.y,u.x,u.y);break;case"T":case"t":for(;!e.isCommandOrEnd();)o=e.current,l=e.getReflectedControlPoint(),e.control=l,u=e.getAsCurrentPoint(),e.addMarker(u,l,l),i.addQuadraticCurve(o.x,o.y,l.x,l.y,u.x,u.y),null!=t&&t.quadraticCurveTo(l.x,l.y,u.x,u.y);break;case"A":case"a":for(;!e.isCommandOrEnd();){o=e.current;var c=e.getScalar(),p=e.getScalar(),f=e.getScalar()*(Math.PI/180),m=e.getScalar(),d=e.getScalar(),y=(u=e.getAsCurrentPoint(),new s.Point(Math.cos(f)*(o.x-u.x)/2+Math.sin(f)*(o.y-u.y)/2,-Math.sin(f)*(o.x-u.x)/2+Math.cos(f)*(o.y-u.y)/2)),v=Math.pow(y.x,2)/Math.pow(c,2)+Math.pow(y.y,2)/Math.pow(p,2);v>1&&(c*=Math.sqrt(v),p*=Math.sqrt(v));var g=(m==d?-1:1)*Math.sqrt((Math.pow(c,2)*Math.pow(p,2)-Math.pow(c,2)*Math.pow(y.y,2)-Math.pow(p,2)*Math.pow(y.x,2))/(Math.pow(c,2)*Math.pow(y.y,2)+Math.pow(p,2)*Math.pow(y.x,2)));isNaN(g)&&(g=0);var x=new s.Point(g*c*y.y/p,g*-p*y.x/c),b=new s.Point((o.x+u.x)/2+Math.cos(f)*x.x-Math.sin(f)*x.y,(o.y+u.y)/2+Math.sin(f)*x.x+Math.cos(f)*x.y),P=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))},E=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(P(t)*P(e))},w=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(E(t,e))},C=w([1,0],[(y.x-x.x)/c,(y.y-x.y)/p]),B=[(y.x-x.x)/c,(y.y-x.y)/p],M=[(-y.x-x.x)/c,(-y.y-x.y)/p],T=w(B,M);E(B,M)<=-1&&(T=Math.PI),E(B,M)>=1&&(T=0);var V=1-d?1:-1,S=C+V*(T/2),k=new s.Point(b.x+c*Math.cos(S),b.y+p*Math.sin(S));if(e.addMarkerAngle(k,S-V*Math.PI/2),e.addMarkerAngle(u,S-V*Math.PI),i.addPoint(u.x,u.y),null!=t){E=c>p?c:p;var A=c>p?1:c/p,D=c>p?p/c:1;t.translate(b.x,b.y),t.rotate(f),t.scale(A,D),t.arc(0,0,E,C,C+T,1-d),t.scale(1/A,1/D),t.rotate(-f),t.translate(-b.x,-b.y)}}break;case"Z":case"z":null!=t&&t.closePath(),e.current=e.start}return i},this.getMarkers=function(){for(var t=this.PathParser.getMarkerPoints(),e=this.PathParser.getMarkerAngles(),i=[],n=0;n<t.length;n++)i.push([t[n],e[n]]);return i}},s.Element.path.prototype=new s.Element.PathElementBase,s.Element.pattern=function(t){this.base=s.Element.ElementBase,this.base(t),this.createPattern=function(t,e){var i=this.attribute("width").toPixels("x",!0),n=this.attribute("height").toPixels("y",!0),a=new s.Element.svg;a.attributes.viewBox=new s.Property("viewBox",this.attribute("viewBox").value),a.attributes.width=new s.Property("width",i+"px"),a.attributes.height=new s.Property("height",n+"px"),a.attributes.transform=new s.Property("transform",this.attribute("patternTransform").value),a.children=this.children;var r=document.createElement("canvas");r.width=i,r.height=n;var o=r.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&o.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var h=-1;h<=1;h++)for(var l=-1;l<=1;l++)o.save(),a.attributes.x=new s.Property("x",h*r.width),a.attributes.y=new s.Property("y",l*r.height),a.render(o),o.restore();return t.createPattern(r,"repeat")}},s.Element.pattern.prototype=new s.Element.ElementBase,s.Element.marker=function(t){this.base=s.Element.ElementBase,this.base(t),this.baseRender=this.render,this.render=function(t,e,i){t.translate(e.x,e.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(i),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(t.lineWidth,t.lineWidth),t.save();var n=new s.Element.svg;n.attributes.viewBox=new s.Property("viewBox",this.attribute("viewBox").value),n.attributes.refX=new s.Property("refX",this.attribute("refX").value),n.attributes.refY=new s.Property("refY",this.attribute("refY").value),n.attributes.width=new s.Property("width",this.attribute("markerWidth").value),n.attributes.height=new s.Property("height",this.attribute("markerHeight").value),n.attributes.fill=new s.Property("fill",this.attribute("fill").valueOrDefault("black")),n.attributes.stroke=new s.Property("stroke",this.attribute("stroke").valueOrDefault("none")),n.children=this.children,n.render(t),t.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(1/t.lineWidth,1/t.lineWidth),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(-i),t.translate(-e.x,-e.y)}},s.Element.marker.prototype=new s.Element.ElementBase,s.Element.defs=function(t){this.base=s.Element.ElementBase,this.base(t),this.render=function(t){}},s.Element.defs.prototype=new s.Element.ElementBase,s.Element.GradientBase=function(t){this.base=s.Element.ElementBase,this.base(t),this.stops=[];for(var e=0;e<this.children.length;e++){var i=this.children[e];"stop"==i.type&&this.stops.push(i)}this.getGradient=function(){},this.gradientUnits=function(){return this.attribute("gradientUnits").valueOrDefault("objectBoundingBox")},this.attributesToInherit=["gradientUnits"],this.inheritStopContainer=function(t){for(var e=0;e<this.attributesToInherit.length;e++){var i=this.attributesToInherit[e];!this.attribute(i).hasValue()&&t.attribute(i).hasValue()&&(this.attribute(i,!0).value=t.attribute(i).value)}},this.createGradient=function(t,e,i){var n=this;this.getHrefAttribute().hasValue()&&(n=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(n));var a=function(t){return i.hasValue()?new s.Property("color",t).addOpacity(i).value:t},r=this.getGradient(t,e);if(null==r)return a(n.stops[n.stops.length-1].color);for(var o=0;o<n.stops.length;o++)r.addColorStop(n.stops[o].offset,a(n.stops[o].color));if(this.attribute("gradientTransform").hasValue()){var h=s.ViewPort.viewPorts[0],l=new s.Element.rect;l.attributes.x=new s.Property("x",-s.MAX_VIRTUAL_PIXELS/3),l.attributes.y=new s.Property("y",-s.MAX_VIRTUAL_PIXELS/3),l.attributes.width=new s.Property("width",s.MAX_VIRTUAL_PIXELS),l.attributes.height=new s.Property("height",s.MAX_VIRTUAL_PIXELS);var u=new s.Element.g;u.attributes.transform=new s.Property("transform",this.attribute("gradientTransform").value),u.children=[l];var c=new s.Element.svg;c.attributes.x=new s.Property("x",0),c.attributes.y=new s.Property("y",0),c.attributes.width=new s.Property("width",h.width),c.attributes.height=new s.Property("height",h.height),c.children=[u];var p=document.createElement("canvas");p.width=h.width,p.height=h.height;var f=p.getContext("2d");return f.fillStyle=r,c.render(f),f.createPattern(p,"no-repeat")}return r}},s.Element.GradientBase.prototype=new s.Element.ElementBase,s.Element.linearGradient=function(t){this.base=s.Element.GradientBase,this.base(t),this.attributesToInherit.push("x1"),this.attributesToInherit.push("y1"),this.attributesToInherit.push("x2"),this.attributesToInherit.push("y2"),this.getGradient=function(t,e){var i="objectBoundingBox"==this.gradientUnits()?e.getBoundingBox():null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var n="objectBoundingBox"==this.gradientUnits()?i.x()+i.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),s="objectBoundingBox"==this.gradientUnits()?i.y()+i.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),a="objectBoundingBox"==this.gradientUnits()?i.x()+i.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),r="objectBoundingBox"==this.gradientUnits()?i.y()+i.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return n==a&&s==r?null:t.createLinearGradient(n,s,a,r)}},s.Element.linearGradient.prototype=new s.Element.GradientBase,s.Element.radialGradient=function(t){this.base=s.Element.GradientBase,this.base(t),this.attributesToInherit.push("cx"),this.attributesToInherit.push("cy"),this.attributesToInherit.push("r"),this.attributesToInherit.push("fx"),this.attributesToInherit.push("fy"),this.getGradient=function(t,e){var i=e.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var n="objectBoundingBox"==this.gradientUnits()?i.x()+i.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),s="objectBoundingBox"==this.gradientUnits()?i.y()+i.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),a=n,r=s;this.attribute("fx").hasValue()&&(a="objectBoundingBox"==this.gradientUnits()?i.x()+i.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(r="objectBoundingBox"==this.gradientUnits()?i.y()+i.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var o="objectBoundingBox"==this.gradientUnits()?(i.width()+i.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return t.createRadialGradient(a,r,0,n,s,o)}},s.Element.radialGradient.prototype=new s.Element.GradientBase,s.Element.stop=function(t){this.base=s.Element.ElementBase,this.base(t),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),this.offset>1&&(this.offset=1);var e=this.style("stop-color",!0);""===e.value&&(e.value="#000"),this.style("stop-opacity").hasValue()&&(e=e.addOpacity(this.style("stop-opacity"))),this.color=e.value},s.Element.stop.prototype=new s.Element.ElementBase,s.Element.AnimateBase=function(t){this.base=s.Element.ElementBase,this.base(t),s.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var t=this.attribute("attributeType").value,e=this.attribute("attributeName").value;return"CSS"==t?this.parent.style(e,!0):this.parent.attribute(e,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(t){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"==this.attribute("repeatCount").value||"indefinite"==this.attribute("repeatDur").value)this.duration=0;else if("freeze"!=this.attribute("fill").valueOrDefault("remove")||this.frozen){if("remove"==this.attribute("fill").valueOrDefault("remove")&&!this.removed)return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0}else this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value;return!1}this.duration=this.duration+t;var e=!1;if(this.begin<this.duration){var i=this.calcValue();this.attribute("type").hasValue()&&(i=this.attribute("type").value+"("+i+")"),this.getProperty().value=i,e=!0}return e},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var t={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var e=t.progress*(this.values.value.length-1),i=Math.floor(e),n=Math.ceil(e);t.from=new s.Property("from",parseFloat(this.values.value[i])),t.to=new s.Property("to",parseFloat(this.values.value[n])),t.progress=(e-i)/(n-i)}else t.from=this.from,t.to=this.to;return t}},s.Element.AnimateBase.prototype=new s.Element.ElementBase,s.Element.animate=function(t){this.base=s.Element.AnimateBase,this.base(t),this.calcValue=function(){var t=this.progress();return t.from.numValue()+(t.to.numValue()-t.from.numValue())*t.progress+this.initialUnits}},s.Element.animate.prototype=new s.Element.AnimateBase,s.Element.animateColor=function(e){this.base=s.Element.AnimateBase,this.base(e),this.calcValue=function(){var e=this.progress(),i=new t(e.from.value),n=new t(e.to.value);if(i.ok&&n.ok){var s=i.r+(n.r-i.r)*e.progress,a=i.g+(n.g-i.g)*e.progress,r=i.b+(n.b-i.b)*e.progress;return"rgb("+parseInt(s,10)+","+parseInt(a,10)+","+parseInt(r,10)+")"}return this.attribute("from").value}},s.Element.animateColor.prototype=new s.Element.AnimateBase,s.Element.animateTransform=function(t){this.base=s.Element.AnimateBase,this.base(t),this.calcValue=function(){for(var t=this.progress(),e=s.ToNumberArray(t.from.value),i=s.ToNumberArray(t.to.value),n="",a=0;a<e.length;a++)n+=e[a]+(i[a]-e[a])*t.progress+" ";return n}},s.Element.animateTransform.prototype=new s.Element.animate,s.Element.font=function(t){this.base=s.Element.ElementBase,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var e=0;e<this.children.length;e++){var i=this.children[e];"font-face"==i.type?(this.fontFace=i,i.style("font-family").hasValue()&&(s.Definitions[i.style("font-family").value]=this)):"missing-glyph"==i.type?this.missingGlyph=i:"glyph"==i.type&&(""!=i.arabicForm?(this.isRTL=!0,this.isArabic=!0,void 0===this.glyphs[i.unicode]&&(this.glyphs[i.unicode]=[]),this.glyphs[i.unicode][i.arabicForm]=i):this.glyphs[i.unicode]=i)}},s.Element.font.prototype=new s.Element.ElementBase,s.Element.fontface=function(t){this.base=s.Element.ElementBase,this.base(t),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},s.Element.fontface.prototype=new s.Element.ElementBase,s.Element.missingglyph=function(t){this.base=s.Element.path,this.base(t),this.horizAdvX=0},s.Element.missingglyph.prototype=new s.Element.path,s.Element.glyph=function(t){this.base=s.Element.path,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},s.Element.glyph.prototype=new s.Element.path,s.Element.text=function(t){this.captureTextNodes=!0,this.base=s.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(t){this.baseSetContext(t);var e=this.style("dominant-baseline").toTextBaseline();null==e&&(e=this.style("alignment-baseline").toTextBaseline()),null!=e&&(t.textBaseline=e)},this.getBoundingBox=function(){var t=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),i=this.parent.style("font-size").numValueOrDefault(s.Font.Parse(s.ctx.font).fontSize);return new s.BoundingBox(t,e-i,t+Math.floor(2*i/3)*this.children[0].getText().length,e)},this.renderChildren=function(t){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),this.x+=this.getAnchorDelta(t,this,0);for(var e=0;e<this.children.length;e++)this.renderChild(t,this,this,e)},this.getAnchorDelta=function(t,e,i){var n=this.style("text-anchor").valueOrDefault("start");if("start"!=n){for(var s=0,a=i;a<e.children.length;a++){var r=e.children[a];if(a>i&&r.attribute("x").hasValue())break;r.measureTextRecursive&&(s+=r.measureTextRecursive(t))}return-1*("end"==n?s:s/2)}return 0},this.renderChild=function(t,e,i,n){var s=i.children[n];for(s.attribute("x").hasValue()?(s.x=s.attribute("x").toPixels("x")+e.getAnchorDelta(t,i,n),s.attribute("dx").hasValue()&&(s.x+=s.attribute("dx").toPixels("x"))):(s.attribute("dx").hasValue()&&(e.x+=s.attribute("dx").toPixels("x")),s.x=e.x),e.x=s.x+s.measureText(t),s.attribute("y").hasValue()?(s.y=s.attribute("y").toPixels("y"),s.attribute("dy").hasValue()&&(s.y+=s.attribute("dy").toPixels("y"))):(s.attribute("dy").hasValue()&&(e.y+=s.attribute("dy").toPixels("y")),s.y=e.y),e.y=s.y,s.render(t),n=0;n<s.children.length;n++)e.renderChild(t,e,s,n)}},s.Element.text.prototype=new s.Element.RenderedElementBase,s.Element.TextElementBase=function(t){this.base=s.Element.RenderedElementBase,this.base(t),this.getGlyph=function(t,e,i){var n=e[i],s=null;if(t.isArabic){var a="isolated";(0==i||" "==e[i-1])&&i<e.length-2&&" "!=e[i+1]&&(a="terminal"),i>0&&" "!=e[i-1]&&i<e.length-2&&" "!=e[i+1]&&(a="medial"),i>0&&" "!=e[i-1]&&(i==e.length-1||" "==e[i+1])&&(a="initial"),void 0!==t.glyphs[n]&&null==(s=t.glyphs[n][a])&&"glyph"==t.glyphs[n].type&&(s=t.glyphs[n])}else s=t.glyphs[n];return null==s&&(s=t.missingGlyph),s},this.renderChildren=function(t){var e=this.parent.style("font-family").getDefinition();if(null==e)""!=t.fillStyle&&t.fillText(s.compressSpaces(this.getText()),this.x,this.y),""!=t.strokeStyle&&t.strokeText(s.compressSpaces(this.getText()),this.x,this.y);else{var i=this.parent.style("font-size").numValueOrDefault(s.Font.Parse(s.ctx.font).fontSize),n=this.parent.style("font-style").valueOrDefault(s.Font.Parse(s.ctx.font).fontStyle),a=this.getText();e.isRTL&&(a=a.split("").reverse().join(""));for(var r=s.ToNumberArray(this.parent.attribute("dx").value),o=0;o<a.length;o++){var h=this.getGlyph(e,a,o),l=i/e.fontFace.unitsPerEm;t.translate(this.x,this.y),t.scale(l,-l);var u=t.lineWidth;t.lineWidth=t.lineWidth*e.fontFace.unitsPerEm/i,"italic"==n&&t.transform(1,0,.4,1,0,0),h.render(t),"italic"==n&&t.transform(1,0,-.4,1,0,0),t.lineWidth=u,t.scale(1/l,-1/l),t.translate(-this.x,-this.y),this.x+=i*(h.horizAdvX||e.horizAdvX)/e.fontFace.unitsPerEm,void 0===r[o]||isNaN(r[o])||(this.x+=r[o])}}},this.getText=function(){},this.measureTextRecursive=function(t){for(var e=this.measureText(t),i=0;i<this.children.length;i++)e+=this.children[i].measureTextRecursive(t);return e},this.measureText=function(t){var e=this.parent.style("font-family").getDefinition();if(null!=e){var i=this.parent.style("font-size").numValueOrDefault(s.Font.Parse(s.ctx.font).fontSize),n=0,a=this.getText();e.isRTL&&(a=a.split("").reverse().join(""));for(var r=s.ToNumberArray(this.parent.attribute("dx").value),o=0;o<a.length;o++)n+=(this.getGlyph(e,a,o).horizAdvX||e.horizAdvX)*i/e.fontFace.unitsPerEm,void 0===r[o]||isNaN(r[o])||(n+=r[o]);return n}var h=s.compressSpaces(this.getText());if(!t.measureText)return 10*h.length;t.save(),this.setContext(t);var l=t.measureText(h).width;return t.restore(),l}},s.Element.TextElementBase.prototype=new s.Element.RenderedElementBase,s.Element.tspan=function(t){this.captureTextNodes=!0,this.base=s.Element.TextElementBase,this.base(t),this.text=s.compressSpaces(t.value||t.text||t.textContent||""),this.getText=function(){return this.children.length>0?"":this.text}},s.Element.tspan.prototype=new s.Element.TextElementBase,s.Element.tref=function(t){this.base=s.Element.TextElementBase,this.base(t),this.getText=function(){var t=this.getHrefAttribute().getDefinition();if(null!=t)return t.children[0].getText()}},s.Element.tref.prototype=new s.Element.TextElementBase,s.Element.a=function(t){this.base=s.Element.TextElementBase,this.base(t),this.hasText=t.childNodes.length>0;for(var e=0;e<t.childNodes.length;e++)3!=t.childNodes[e].nodeType&&(this.hasText=!1);this.text=this.hasText?t.childNodes[0].value:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(t){if(this.hasText){this.baseRenderChildren(t);var e=new s.Property("fontSize",s.Font.Parse(s.ctx.font).fontSize);s.Mouse.checkBoundingBox(this,new s.BoundingBox(this.x,this.y-e.toPixels("y"),this.x+this.measureText(t),this.y))}else if(this.children.length>0){var i=new s.Element.g;i.children=this.children,i.parent=this,i.render(t)}},this.onclick=function(){window.open(this.getHrefAttribute().value)},this.onmousemove=function(){s.ctx.canvas.style.cursor="pointer"}},s.Element.a.prototype=new s.Element.TextElementBase,s.Element.textPath=function(t){this.base=s.Element.TextElementBase,this.base(t);var e=this.getHrefAttribute().getDefinition();this.text=s.compressSpaces(t.value||t.text||t.textContent||""),this.renderChildren=function(t){this.setTextData(t),t.save();var e=this.parent.style("text-decoration").value,i=this.fontSize(),n=this.glyphInfo,a=t.fillStyle;"underline"===e&&t.beginPath();for(var r=0;r<n.length;r++){var o=n[r].p0,h=n[r].p1,l=n[r].text;t.save(),t.translate(o.x,o.y),t.rotate(n[r].rotation),""!=t.fillStyle&&t.fillText(s.compressSpaces(l),0,0),""!=t.strokeStyle&&t.strokeText(s.compressSpaces(l),0,0),t.restore(),"underline"===e&&(0===r&&t.moveTo(o.x,o.y+i/8),t.lineTo(h.x,h.y+i/5))}"underline"===e&&(t.lineWidth=i/20,t.strokeStyle=a,t.stroke(),t.closePath()),t.restore()},this.path=function(t){var e=this.dataArray;null!=t&&t.beginPath();for(var i=0;i<e.length;i++){var n=e[i].command,s=e[i].points;switch(n){case"L":null!=t&&t.lineTo(s[0],s[1]);break;case"M":null!=t&&t.moveTo(s[0],s[1]);break;case"C":null!=t&&t.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case"Q":null!=t&&t.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case"A":var a=s[0],r=s[1],o=s[2],h=s[3],l=s[4],u=s[5],c=s[6],p=s[7],f=o>h?o:h,m=o>h?1:o/h,d=o>h?h/o:1;null!=t&&(t.translate(a,r),t.rotate(c),t.scale(m,d),t.arc(0,0,f,l,l+u,1-p),t.scale(1/m,1/d),t.rotate(-c),t.translate(-a,-r));break;case"z":null!=t&&t.closePath()}}},this.getText=function(){return this.text},this.fontSize=function(){return this.parent.style("font-size").numValueOrDefault(s.Font.Parse(s.ctx.font).fontSize)},this.measureText=function(t,e){var i=this.parent.style("font-family").getDefinition();if(e=e||this.getText(),null!=i){var n=this.fontSize(),a=0;i.isRTL&&(e=e.split("").reverse().join(""));for(var r=s.ToNumberArray(this.parent.attribute("dx").value),o=0;o<e.length;o++)a+=(this.getGlyph(i,e,o).horizAdvX||i.horizAdvX)*n/i.fontFace.unitsPerEm,void 0===r[o]||isNaN(r[o])||(a+=r[o]);return a}var h=s.compressSpaces(e);if(!t.measureText)return 10*h.length;t.save(),this.setContext(t);var l=t.measureText(h).width;return t.restore(),l},this.setTextData=function(t){if(!this.hasOwnProperty("glyphInfo")){var e=this,i=this.getText().split(""),n=this.getText().split(" ").length-1,a=s.ToNumberArray(this.parent.attribute("dx").valueOrDefault("0")),r=this.parent.style("letter-spacing").numValueOrDefault(0),o=this.parent.style("text-anchor").valueOrDefault("start");this.letterSpacingCache=[];for(var h=0;h<this.getText().length;h++)this.letterSpacingCache.push(void 0!==a[h]?a[h]:r);var l=this.letterSpacingCache.reduce(function(t,e){return t+e||0},0);this.textWidth=this.measureText(t),this.textHeight=this.fontSize();var u=Math.max(this.textWidth+l,0);this.glyphInfo=[];var c=this.getPathLength(),p=this.style("startOffset").numValueOrDefault(0)*c,f=0;"middle"!==o&&"center"!==o||(f=-u/2),"end"!==o&&"right"!==o||(f=-u),f+=p;var m=function(i,s){var a,r=e.measureText(t,i);" "===i&&"justify"===o&&u<c&&(r+=(c-u)/n),s>-1&&(f+=(a=(a=s)||0,e.letterSpacingCache[a]||0));var h=e.textHeight/20,l={p0:e.getEquidistantPointOnPath(f,h),p1:e.getEquidistantPointOnPath(f+r,h)};return f+=r,l};for(h=0;h<i.length;h++){var d=m(i[h],h);if(void 0!==d.p0&&void 0!==d.p1){var y=e.getLineLength(d.p0.x,d.p0.y,d.p1.x,d.p1.y),v=e.getPointOnLine(0+y/2,d.p0.x,d.p0.y,d.p1.x,d.p1.y),g=Math.atan2(d.p1.y-d.p0.y,d.p1.x-d.p0.x);this.glyphInfo.push({transposeX:v.x,transposeY:v.y,text:i[h],rotation:g,p0:d.p0,p1:d.p1})}}}},this.parsePathData=function(t){if(this.pathLength=void 0,!t)return[];var e=[],i=t.PathParser;for(i.reset();!i.isEnd();){var n=[],a=null,r=i.current?i.current.x:0,o=i.current?i.current.y:0;i.nextCommand();var h=i.command.toUpperCase();switch(i.command){case"M":case"m":var l=i.getAsCurrentPoint();for(n.push(l.x,l.y),i.start=i.current;!i.isCommandOrEnd();)l=i.getAsCurrentPoint(),n.push(l.x,l.y),a="L";break;case"L":case"l":for(;!i.isCommandOrEnd();)l=i.getAsCurrentPoint(),n.push(l.x,l.y);a="L";break;case"H":case"h":for(;!i.isCommandOrEnd();){var u=new s.Point((i.isRelativeCommand()?i.current.x:0)+i.getScalar(),i.current.y);n.push(u.x,u.y),i.current=u}a="L";break;case"V":case"v":for(;!i.isCommandOrEnd();)u=new s.Point(i.current.x,(i.isRelativeCommand()?i.current.y:0)+i.getScalar()),n.push(u.x,u.y),i.current=u;a="L";break;case"C":case"c":for(;!i.isCommandOrEnd();){var c=i.getPoint(),p=i.getAsControlPoint(),f=i.getAsCurrentPoint();n.push(c.x,c.y,p.x,p.y,f.x,f.y)}break;case"S":case"s":for(;!i.isCommandOrEnd();)c=i.getReflectedControlPoint(),p=i.getAsControlPoint(),f=i.getAsCurrentPoint(),n.push(c.x,c.y,p.x,p.y,f.x,f.y);a="C";break;case"Q":case"q":for(;!i.isCommandOrEnd();)p=i.getAsControlPoint(),f=i.getAsCurrentPoint(),n.push(p.x,p.y,f.x,f.y);break;case"T":case"t":for(;!i.isCommandOrEnd();)p=i.getReflectedControlPoint(),i.control=p,f=i.getAsCurrentPoint(),n.push(p.x,p.y,f.x,f.y);a="Q";break;case"A":case"a":for(;!i.isCommandOrEnd();){var m=i.current,d=i.getScalar(),y=i.getScalar(),v=i.getScalar()*(Math.PI/180),g=i.getScalar(),x=i.getScalar(),b=(f=i.getAsCurrentPoint(),new s.Point(Math.cos(v)*(m.x-f.x)/2+Math.sin(v)*(m.y-f.y)/2,-Math.sin(v)*(m.x-f.x)/2+Math.cos(v)*(m.y-f.y)/2)),P=Math.pow(b.x,2)/Math.pow(d,2)+Math.pow(b.y,2)/Math.pow(y,2);P>1&&(d*=Math.sqrt(P),y*=Math.sqrt(P));var E=(g==x?-1:1)*Math.sqrt((Math.pow(d,2)*Math.pow(y,2)-Math.pow(d,2)*Math.pow(b.y,2)-Math.pow(y,2)*Math.pow(b.x,2))/(Math.pow(d,2)*Math.pow(b.y,2)+Math.pow(y,2)*Math.pow(b.x,2)));isNaN(E)&&(E=0);var w=new s.Point(E*d*b.y/y,E*-y*b.x/d),C=new s.Point((m.x+f.x)/2+Math.cos(v)*w.x-Math.sin(v)*w.y,(m.y+f.y)/2+Math.sin(v)*w.x+Math.cos(v)*w.y),B=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))},M=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(B(t)*B(e))},T=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(M(t,e))},V=T([1,0],[(b.x-w.x)/d,(b.y-w.y)/y]),S=[(b.x-w.x)/d,(b.y-w.y)/y],k=[(-b.x-w.x)/d,(-b.y-w.y)/y],A=T(S,k);M(S,k)<=-1&&(A=Math.PI),M(S,k)>=1&&(A=0),0===x&&A>0&&(A-=2*Math.PI),1===x&&A<0&&(A+=2*Math.PI),n=[C.x,C.y,d,y,V,A,v,x]}break;case"Z":case"z":i.current=i.start}"Z"!==h?e.push({command:a||h,points:n,start:{x:r,y:o},pathLength:this.calcLength(r,o,a||h,n)}):e.push({command:"z",points:[],start:void 0,pathLength:0})}return e},this.getPathLength=function(){if(void 0===this.pathLength||null===this.pathLength||isNaN(this.pathLength)){this.pathLength=0;for(var t=0;t<this.dataArray.length;t++)this.dataArray[t].pathLength>0&&(this.pathLength+=this.dataArray[t].pathLength)}return this.pathLength},this.getPointOnPath=function(t){var e=0,i=this.getPathLength(),n=void 0;if(!(t<-5e-5||t-5e-5>i))for(var s=0;s<this.dataArray.length;s++){var a=this.dataArray[s];if(!a||!(a.pathLength<5e-5||e+a.pathLength+5e-5<t)){var r=t-e,o=void 0;switch(a.command){case"L":n=this.getPointOnLine(r,a.start.x,a.start.y,a.points[0],a.points[1],a.start.x,a.start.y);break;case"A":var h=a.points[4],l=a.points[5],u=a.points[4]+l;if(o=h+r/a.pathLength*l,l<0&&o<u||l>=0&&o>u)break;n=this.getPointOnEllipticalArc(a.points[0],a.points[1],a.points[2],a.points[3],o,a.points[6]);break;case"C":(o=r/a.pathLength)>1&&(o=1),n=this.getPointOnCubicBezier(o,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3],a.points[4],a.points[5]);break;case"Q":(o=r/a.pathLength)>1&&(o=1),n=this.getPointOnQuadraticBezier(o,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3])}if(void 0!==n&&n!=={})return n;break}e+=a.pathLength}},this.buildEquidistantCache=function(t,e){var i=this.getPathLength();if(e=e||.25,t=t||i/100,this.equidistantCache=this.equidistantCache||{},!this.equidistantCache.hasOwnProperty("points")||this.equidistantCache.step!=t||this.equidistantCache.precision!=e){this.equidistantCache={step:t,precision:e,points:[]};for(var n=0,s=0;s<=i;s+=e){var a=this.getPointOnPath(s),r=this.getPointOnPath(s+e);void 0!==a&&void 0!==r&&(n+=this.getLineLength(a.x,a.y,r.x,r.y))>=t&&(this.equidistantCache.points.push({x:a.x,y:a.y,distance:s}),n-=t)}}},this.getEquidistantPointOnPath=function(t,e,i){if(this.buildEquidistantCache(e,i),!(t<0||t-this.getPathLength()>5e-5)){var n=Math.round(t/this.getPathLength()*(this.equidistantCache.points.length-1));return this.equidistantCache.points[n]||void 0}},this.getLineLength=function(t,e,i,n){return Math.sqrt((i-t)*(i-t)+(n-e)*(n-e))},this.getPointOnLine=function(t,e,i,n,s,a,r){void 0===a&&(a=e),void 0===r&&(r=i);var o=(s-i)/(n-e+1e-8),h=Math.sqrt(t*t/(1+o*o));n<e&&(h*=-1);var l,u=o*h;if(n===e)l={x:a,y:r+u};else if((r-i)/(a-e+1e-8)===o)l={x:a+h,y:r+u};else{var c,p,f=this.getLineLength(e,i,n,s);if(f<1e-8)return;var m=(a-e)*(n-e)+(r-i)*(s-i);c=e+(m/=f*f)*(n-e),p=i+m*(s-i);var d=this.getLineLength(a,r,c,p),y=Math.sqrt(t*t-d*d);h=Math.sqrt(y*y/(1+o*o)),n<e&&(h*=-1),l={x:c+h,y:p+(u=o*h)}}return l},this.getPointOnCubicBezier=function(t,e,i,n,s,a,r,o,h){function l(t){return t*t*t}function u(t){return 3*t*t*(1-t)}function c(t){return 3*t*(1-t)*(1-t)}function p(t){return(1-t)*(1-t)*(1-t)}return{x:o*l(t)+a*u(t)+n*c(t)+e*p(t),y:h*l(t)+r*u(t)+s*c(t)+i*p(t)}},this.getPointOnQuadraticBezier=function(t,e,i,n,s,a,r){function o(t){return t*t}function h(t){return 2*t*(1-t)}function l(t){return(1-t)*(1-t)}return{x:a*o(t)+n*h(t)+e*l(t),y:r*o(t)+s*h(t)+i*l(t)}},this.getPointOnEllipticalArc=function(t,e,i,n,s,a){var r=Math.cos(a),o=Math.sin(a),h=i*Math.cos(s),l=n*Math.sin(s);return{x:t+(h*r-l*o),y:e+(h*o+l*r)}},this.calcLength=function(t,e,i,n){var s,a,r,o;switch(i){case"L":return this.getLineLength(t,e,n[0],n[1]);case"C":for(s=0,a=this.getPointOnCubicBezier(0,t,e,n[0],n[1],n[2],n[3],n[4],n[5]),o=.01;o<=1;o+=.01)r=this.getPointOnCubicBezier(o,t,e,n[0],n[1],n[2],n[3],n[4],n[5]),s+=this.getLineLength(a.x,a.y,r.x,r.y),a=r;return s;case"Q":for(s=0,a=this.getPointOnQuadraticBezier(0,t,e,n[0],n[1],n[2],n[3]),o=.01;o<=1;o+=.01)r=this.getPointOnQuadraticBezier(o,t,e,n[0],n[1],n[2],n[3]),s+=this.getLineLength(a.x,a.y,r.x,r.y),a=r;return s;case"A":s=0;var h=n[4],l=n[5],u=n[4]+l,c=Math.PI/180;if(Math.abs(h-u)<c&&(c=Math.abs(h-u)),a=this.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],h,0),l<0)for(o=h-c;o>u;o-=c)r=this.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],o,0),s+=this.getLineLength(a.x,a.y,r.x,r.y),a=r;else for(o=h+c;o<u;o+=c)r=this.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],o,0),s+=this.getLineLength(a.x,a.y,r.x,r.y),a=r;return r=this.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],u,0),s+=this.getLineLength(a.x,a.y,r.x,r.y)}return 0},this.dataArray=this.parsePathData(e)},s.Element.textPath.prototype=new s.Element.TextElementBase,s.Element.image=function(t){this.base=s.Element.RenderedElementBase,this.base(t);var e=this.getHrefAttribute().value;if(""!=e){var i=e.match(/\.svg$/);if(s.Images.push(this),this.loaded=!1,i)this.img=s.ajax(e),this.loaded=!0;else{this.img=document.createElement("img"),1==s.opts.useCORS&&(this.img.crossOrigin="Anonymous");var n=this;this.img.onload=function(){n.loaded=!0},this.img.onerror=function(){s.log('ERROR: image "'+e+'" not found'),n.loaded=!0},this.img.src=e}this.renderChildren=function(t){var e=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),a=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y");0!=a&&0!=r&&(t.save(),i?t.drawSvg(this.img,e,n,a,r):(t.translate(e,n),s.AspectRatio(t,this.attribute("preserveAspectRatio").value,a,this.img.width,r,this.img.height,0,0),t.drawImage(this.img,0,0)),t.restore())},this.getBoundingBox=function(){var t=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),i=this.attribute("width").toPixels("x"),n=this.attribute("height").toPixels("y");return new s.BoundingBox(t,e,t+i,e+n)}}},s.Element.image.prototype=new s.Element.RenderedElementBase,s.Element.g=function(t){this.base=s.Element.RenderedElementBase,this.base(t),this.getBoundingBox=function(){for(var t=new s.BoundingBox,e=0;e<this.children.length;e++)t.addBoundingBox(this.children[e].getBoundingBox());return t}},s.Element.g.prototype=new s.Element.RenderedElementBase,s.Element.symbol=function(t){this.base=s.Element.RenderedElementBase,this.base(t),this.render=function(t){}},s.Element.symbol.prototype=new s.Element.RenderedElementBase,s.Element.style=function(t){this.base=s.Element.ElementBase,this.base(t);for(var e="",i=0;i<t.childNodes.length;i++)e+=t.childNodes[i].data;e=e.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"");var n=(e=s.compressSpaces(e)).split("}");for(i=0;i<n.length;i++)if(""!=s.trim(n[i]))for(var a=n[i].split("{"),r=a[0].split(","),o=a[1].split(";"),h=0;h<r.length;h++){var l=s.trim(r[h]);if(""!=l){for(var u=s.Styles[l]||{},p=0;p<o.length;p++){var f=o[p].indexOf(":"),m=o[p].substr(0,f),d=o[p].substr(f+1,o[p].length-f);null!=m&&null!=d&&(u[s.trim(m)]=new s.Property(s.trim(m),s.trim(d)))}if(s.Styles[l]=u,s.StylesSpecificity[l]=c(l),"@font-face"==l)for(var y=u["font-family"].value.replace(/"/g,""),v=u.src.value.split(","),g=0;g<v.length;g++)if(v[g].indexOf('format("svg")')>0)for(var x=v[g].indexOf("url"),b=v[g].indexOf(")",x),P=v[g].substr(x+5,b-x-6),E=s.parseXml(s.ajax(P)).getElementsByTagName("font"),w=0;w<E.length;w++){var C=s.CreateElement(E[w]);s.Definitions[y]=C}}}},s.Element.style.prototype=new s.Element.ElementBase,s.Element.use=function(t){this.base=s.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(t){this.baseSetContext(t),this.attribute("x").hasValue()&&t.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&t.translate(0,this.attribute("y").toPixels("y"))};var e=this.getHrefAttribute().getDefinition();this.path=function(t){null!=e&&e.path(t)},this.getBoundingBox=function(){if(null!=e)return e.getBoundingBox()},this.renderChildren=function(t){if(null!=e){var i=e;"symbol"==e.type&&((i=new s.Element.svg).type="svg",i.attributes.viewBox=new s.Property("viewBox",e.attribute("viewBox").value),i.attributes.preserveAspectRatio=new s.Property("preserveAspectRatio",e.attribute("preserveAspectRatio").value),i.attributes.overflow=new s.Property("overflow",e.attribute("overflow").value),i.children=e.children),"svg"==i.type&&(this.attribute("width").hasValue()&&(i.attributes.width=new s.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(i.attributes.height=new s.Property("height",this.attribute("height").value)));var n=i.parent;i.parent=null,i.render(t),i.parent=n}}},s.Element.use.prototype=new s.Element.RenderedElementBase,s.Element.mask=function(t){this.base=s.Element.ElementBase,this.base(t),this.apply=function(t,e){var i=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),a=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y");if(0==a&&0==r){for(var o=new s.BoundingBox,h=0;h<this.children.length;h++)o.addBoundingBox(this.children[h].getBoundingBox());i=Math.floor(o.x1),n=Math.floor(o.y1),a=Math.floor(o.width()),r=Math.floor(o.height())}var l=e.attribute("mask").value;e.attribute("mask").value="";var u=document.createElement("canvas");u.width=i+a,u.height=n+r;var c=u.getContext("2d");this.renderChildren(c);var p=document.createElement("canvas");p.width=i+a,p.height=n+r;var f=p.getContext("2d");e.render(f),f.globalCompositeOperation="destination-in",f.fillStyle=c.createPattern(u,"no-repeat"),f.fillRect(0,0,i+a,n+r),t.fillStyle=f.createPattern(p,"no-repeat"),t.fillRect(0,0,i+a,n+r),e.attribute("mask").value=l},this.render=function(t){}},s.Element.mask.prototype=new s.Element.ElementBase,s.Element.clipPath=function(t){this.base=s.Element.ElementBase,this.base(t),this.apply=function(t){var e=CanvasRenderingContext2D.prototype.beginPath;CanvasRenderingContext2D.prototype.beginPath=function(){};var i=CanvasRenderingContext2D.prototype.closePath;CanvasRenderingContext2D.prototype.closePath=function(){},e.call(t);for(var n=0;n<this.children.length;n++){var a=this.children[n];if(void 0!==a.path){var r=null;a.style("transform",!1,!0).hasValue()&&(r=new s.Transform(a.style("transform",!1,!0).value)).apply(t),a.path(t),CanvasRenderingContext2D.prototype.closePath=i,r&&r.unapply(t)}}i.call(t),t.clip(),CanvasRenderingContext2D.prototype.beginPath=e,CanvasRenderingContext2D.prototype.closePath=i},this.render=function(t){}},s.Element.clipPath.prototype=new s.Element.ElementBase,s.Element.filter=function(t){this.base=s.Element.ElementBase,this.base(t),this.apply=function(t,e){var i=e.getBoundingBox(),n=Math.floor(i.x1),s=Math.floor(i.y1),a=Math.floor(i.width()),r=Math.floor(i.height()),o=e.style("filter").value;e.style("filter").value="";for(var h=0,l=0,u=0;u<this.children.length;u++){var c=this.children[u].extraFilterDistance||0;h=Math.max(h,c),l=Math.max(l,c)}var p=document.createElement("canvas");p.width=a+2*h,p.height=r+2*l;var f=p.getContext("2d");for(f.translate(-n+h,-s+l),e.render(f),u=0;u<this.children.length;u++)"function"==typeof this.children[u].apply&&this.children[u].apply(f,0,0,a+2*h,r+2*l);t.drawImage(p,0,0,a+2*h,r+2*l,n-h,s-l,a+2*h,r+2*l),e.style("filter",!0).value=o},this.render=function(t){}},s.Element.filter.prototype=new s.Element.ElementBase,s.Element.feMorphology=function(t){this.base=s.Element.ElementBase,this.base(t),this.apply=function(t,e,i,n,s){}},s.Element.feMorphology.prototype=new s.Element.ElementBase,s.Element.feComposite=function(t){this.base=s.Element.ElementBase,this.base(t),this.apply=function(t,e,i,n,s){}},s.Element.feComposite.prototype=new s.Element.ElementBase,s.Element.feColorMatrix=function(t){this.base=s.Element.ElementBase,this.base(t);var e=s.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":var i=e[0];e=[.213+.787*i,.715-.715*i,.072-.072*i,0,0,.213-.213*i,.715+.285*i,.072-.072*i,0,0,.213-.213*i,.715-.715*i,.072+.928*i,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var n=e[0]*Math.PI/180,a=function(t,e,i){return t+Math.cos(n)*e+Math.sin(n)*i};e=[a(.213,.787,-.213),a(.715,-.715,-.715),a(.072,-.072,.928),0,0,a(.213,-.213,.143),a(.715,.285,.14),a(.072,-.072,-.283),0,0,a(.213,-.213,-.787),a(.715,-.715,.715),a(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}function r(t,e,i,n,s,a){return t[i*n*4+4*e+a]}function o(t,e,i,n,s,a,r){t[i*n*4+4*e+a]=r}function h(t,i){var n=e[t];return n*(n<0?i-255:i)}this.apply=function(t,e,i,n,s){var a=t.getImageData(0,0,n,s);for(i=0;i<s;i++)for(e=0;e<n;e++){var l=r(a.data,e,i,n,0,0),u=r(a.data,e,i,n,0,1),c=r(a.data,e,i,n,0,2),p=r(a.data,e,i,n,0,3);o(a.data,e,i,n,0,0,h(0,l)+h(1,u)+h(2,c)+h(3,p)+h(4,1)),o(a.data,e,i,n,0,1,h(5,l)+h(6,u)+h(7,c)+h(8,p)+h(9,1)),o(a.data,e,i,n,0,2,h(10,l)+h(11,u)+h(12,c)+h(13,p)+h(14,1)),o(a.data,e,i,n,0,3,h(15,l)+h(16,u)+h(17,c)+h(18,p)+h(19,1))}t.clearRect(0,0,n,s),t.putImageData(a,0,0)}},s.Element.feColorMatrix.prototype=new s.Element.ElementBase,s.Element.feGaussianBlur=function(t){this.base=s.Element.ElementBase,this.base(t),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(t,i,n,a,r){void 0!==e.canvasRGBA?(t.canvas.id=s.UniqueId(),t.canvas.style.display="none",document.body.appendChild(t.canvas),e.canvasRGBA(t.canvas.id,i,n,a,r,this.blurRadius),document.body.removeChild(t.canvas)):s.log("ERROR: StackBlur.js must be included for blur to work")}},s.Element.feGaussianBlur.prototype=new s.Element.ElementBase,s.Element.title=function(t){},s.Element.title.prototype=new s.Element.ElementBase,s.Element.desc=function(t){},s.Element.desc.prototype=new s.Element.ElementBase,s.Element.MISSING=function(t){s.log("ERROR: Element '"+t.nodeName+"' not yet implemented.")},s.Element.MISSING.prototype=new s.Element.ElementBase,s.CreateElement=function(t){var e=t.nodeName.replace(/^[^:]+:/,"");e=e.replace(/\-/g,"");var i=null;return(i=void 0!==s.Element[e]?new s.Element[e](t):new s.Element.MISSING(t)).type=t.nodeName,i},s.load=function(t,e){s.loadXml(t,s.ajax(e))},s.loadXml=function(t,e){s.loadXmlDoc(t,s.parseXml(e))},s.loadXmlDoc=function(t,e){s.init(t);var i=function(e){for(var i=t.canvas;i;)e.x-=i.offsetLeft,e.y-=i.offsetTop,i=i.offsetParent;return window.scrollX&&(e.x+=window.scrollX),window.scrollY&&(e.y+=window.scrollY),e};1!=s.opts.ignoreMouse&&(t.canvas.onclick=function(t){var e=i(new s.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));s.Mouse.onclick(e.x,e.y)},t.canvas.onmousemove=function(t){var e=i(new s.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));s.Mouse.onmousemove(e.x,e.y)});var n=s.CreateElement(e.documentElement);n.root=!0,n.addStylesFromStyleDefinition();var a=!0,r=function(){s.ViewPort.Clear(),t.canvas.parentNode&&s.ViewPort.SetCurrent(t.canvas.parentNode.clientWidth,t.canvas.parentNode.clientHeight),1!=s.opts.ignoreDimensions&&(n.style("width").hasValue()&&(t.canvas.width=n.style("width").toPixels("x"),t.canvas.style.width=t.canvas.width+"px"),n.style("height").hasValue()&&(t.canvas.height=n.style("height").toPixels("y"),t.canvas.style.height=t.canvas.height+"px"));var i=t.canvas.clientWidth||t.canvas.width,r=t.canvas.clientHeight||t.canvas.height;if(1==s.opts.ignoreDimensions&&n.style("width").hasValue()&&n.style("height").hasValue()&&(i=n.style("width").toPixels("x"),r=n.style("height").toPixels("y")),s.ViewPort.SetCurrent(i,r),null!=s.opts.offsetX&&(n.attribute("x",!0).value=s.opts.offsetX),null!=s.opts.offsetY&&(n.attribute("y",!0).value=s.opts.offsetY),null!=s.opts.scaleWidth||null!=s.opts.scaleHeight){var o=null,h=null,l=s.ToNumberArray(n.attribute("viewBox").value);null!=s.opts.scaleWidth&&(n.attribute("width").hasValue()?o=n.attribute("width").toPixels("x")/s.opts.scaleWidth:isNaN(l[2])||(o=l[2]/s.opts.scaleWidth)),null!=s.opts.scaleHeight&&(n.attribute("height").hasValue()?h=n.attribute("height").toPixels("y")/s.opts.scaleHeight:isNaN(l[3])||(h=l[3]/s.opts.scaleHeight)),null==o&&(o=h),null==h&&(h=o),n.attribute("width",!0).value=s.opts.scaleWidth,n.attribute("height",!0).value=s.opts.scaleHeight,n.style("transform",!0,!0).value+=" scale("+1/o+","+1/h+")"}1!=s.opts.ignoreClear&&t.clearRect(0,0,i,r),n.render(t),a&&(a=!1,"function"==typeof s.opts.renderCallback&&s.opts.renderCallback(e))},o=!0;s.ImagesLoaded()&&(o=!1,r()),s.intervalID=setInterval(function(){var t=!1;if(o&&s.ImagesLoaded()&&(o=!1,t=!0),1!=s.opts.ignoreMouse&&(t|=s.Mouse.hasEvents()),1!=s.opts.ignoreAnimation)for(var e=0;e<s.Animations.length;e++)t|=s.Animations[e].update(1e3/s.FRAMERATE);"function"==typeof s.opts.forceRedraw&&1==s.opts.forceRedraw()&&(t=!0),t&&(r(),s.Mouse.runEvents())},1e3/s.FRAMERATE)},s.stop=function(){s.intervalID&&clearInterval(s.intervalID)},s.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(t,e){this.events.push({type:"onclick",x:t,y:e,run:function(t){t.onclick&&t.onclick()}})},this.onmousemove=function(t,e){this.events.push({type:"onmousemove",x:t,y:e,run:function(t){t.onmousemove&&t.onmousemove()}})},this.eventElements=[],this.checkPath=function(t,e){for(var i=0;i<this.events.length;i++){var n=this.events[i];e.isPointInPath&&e.isPointInPath(n.x,n.y)&&(this.eventElements[i]=t)}},this.checkBoundingBox=function(t,e){for(var i=0;i<this.events.length;i++){var n=this.events[i];e.isPointInBox(n.x,n.y)&&(this.eventElements[i]=t)}},this.runEvents=function(){s.ctx.canvas.style.cursor="";for(var t=0;t<this.events.length;t++)for(var e=this.events[t],i=this.eventElements[t];i;)e.run(i),i=i.parent;this.events=[],this.eventElements=[]}},s}(r||{});1==s.childNodes.length&&"OBJECT"==s.childNodes[0].nodeName||(s.svg=o);var h=s.getContext("2d");void 0!==a.documentElement?o.loadXmlDoc(h,a):"<"==a.substr(0,1)?o.loadXml(h,a):o.load(h,a)}else for(var l=document.querySelectorAll("svg"),u=0;u<l.length;u++){var p=l[u],f=document.createElement("canvas");f.width=p.clientWidth,f.height=p.clientHeight,p.parentNode.insertBefore(f,p),p.parentNode.removeChild(p);var m=document.createElement("div");m.appendChild(p),n(f,m.innerHTML)}};void 0!==Element.prototype.matches?i=function(t,e){return t.matches(e)}:void 0!==Element.prototype.webkitMatchesSelector?i=function(t,e){return t.webkitMatchesSelector(e)}:void 0!==Element.prototype.mozMatchesSelector?i=function(t,e){return t.mozMatchesSelector(e)}:void 0!==Element.prototype.msMatchesSelector?i=function(t,e){return t.msMatchesSelector(e)}:void 0!==Element.prototype.oMatchesSelector?i=function(t,e){return t.oMatchesSelector(e)}:("function"!=typeof jQuery&&"function"!=typeof Zepto||(i=function(t,e){return $(t).is(e)}),void 0===i&&(i=Sizzle.matchesSelector));var s=/(\[[^\]]+\])/g,a=/(#[^\s\+>~\.\[:]+)/g,r=/(\.[^\s\+>~\.\[:]+)/g,o=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,h=/(:[\w-]+\([^\)]*\))/gi,l=/(:[^\s\+>~\.\[:]+)/g,u=/([^\s\+>~\.\[:]+)/g;function c(t){var e=[0,0,0],i=function(i,n){var s=t.match(i);null!=s&&(e[n]+=s.length,t=t.replace(i," "))};return t=(t=t.replace(/:not\(([^\)]*)\)/g,"     $1 ")).replace(/{[\s\S]*/gm," "),i(s,1),i(a,0),i(r,1),i(o,2),i(h,1),i(l,1),t=(t=t.replace(/[\*\s\+>~]/g," ")).replace(/[#\.]/g," "),i(u,2),e.join("")}return"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(t,e,i,s,a,r){var o={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:e,offsetY:i,scaleWidth:s,scaleHeight:a};for(var h in r)r.hasOwnProperty(h)&&(o[h]=r[h]);n(this.canvas,t,o)}),n});
!function(t){var a=t.UserAction;function e(t,a,e){this.passage=t,this.options=a,this.delimiterString=e,this.characterKeyMap={}}e.prototype={setMaxLineLimit:function(t){this.lineLimit=t},detect:function(){this._clearCache(),this.passageArray=this.passage.trim().split("\n"),this.options.ignoreWhiteSpaces&&(this.passageArray=this.passageArray.replace(/ /g,""));for(var t=0,a=0;a<this.passageArray.length;a++){var e=this.passageArray[a].trim();if(!this.ignoreEmptyLines||""!=e){t++;for(var r=0;r<e.length;r++){if('"'==e[r])for(r+=1;'"'!=e[r]&&r<e.length;)r++;this._isSpecialCharacter(e[r])&&this._updateCharacterStack(e[r])}if(t==this.lineLimit)break}}var i=",",s=0;for(var h in this.characterKeyMap)this.characterKeyMap[h]>s&&(s=this.characterKeyMap[h],i=h);return i},getDelimiterList:function(){return this._clearCache(),this.detect(),this.characterKeyMap},getSplittedArray:function(t){for(var a="",e=[],r=[],i=0;i<this.passageArray.length;i++){var s=this.passageArray[i];r=[];for(var h=0;h<s.length;h++)a+=s[h],-1==t.indexOf(s[h])&&h!=s.length-1||(r.push(h==s.length-1?a:a.substr(0,a.length-1)),a="");e.push(r)}return e},_clearCache:function(){this.characterKeyMap={}},_isSpecialCharacter:function(t){return this.delimiterString?this.delimiterString.contains(t):"~`!#^&*-_:;'?,| \t".contains(t)},_updateCharacterStack:function(t){this.characterKeyMap[t]||(this.characterKeyMap[t]=0),this.characterKeyMap[t]=this.characterKeyMap[t]+1}},a.DelimiterDetector=e}(this);
